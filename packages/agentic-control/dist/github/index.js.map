{"version":3,"sources":["../../src/core/tokens.ts","../../src/core/validation.ts","../../src/core/config.ts","../../src/github/client.ts"],"names":["config"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Intelligent Token Management for Multi-Organization GitHub Access\n *\n * This module provides automatic token switching based on repository organization.\n * ALL configuration is user-provided - no hardcoded organizations or tokens.\n *\n * Configuration methods (in priority order):\n * 1. Programmatic: setTokenConfig() / addOrganization()\n * 2. Config file: agentic.config.json with \"tokens\" section\n * 3. Environment variables: AGENTIC_ORG_<NAME>_TOKEN pattern\n *\n * @example Config file (agentic.config.json):\n * ```json\n * {\n *   \"tokens\": {\n *     \"organizations\": {\n *       \"MyOrg\": { \"name\": \"MyOrg\", \"tokenEnvVar\": \"GITHUB_MYORG_TOKEN\" },\n *       \"AnotherOrg\": { \"name\": \"AnotherOrg\", \"tokenEnvVar\": \"ANOTHER_TOKEN\" }\n *     },\n *     \"defaultTokenEnvVar\": \"GITHUB_TOKEN\",\n *     \"prReviewTokenEnvVar\": \"GITHUB_TOKEN\"\n *   }\n * }\n * ```\n *\n * @example Environment variables:\n * ```bash\n * # Define org-to-token mappings\n * export AGENTIC_ORG_MYORG_TOKEN=GITHUB_MYORG_TOKEN\n * export AGENTIC_ORG_ANOTHER_TOKEN=ANOTHER_ORG_PAT\n *\n * # Override defaults\n * export AGENTIC_DEFAULT_TOKEN=GITHUB_TOKEN\n * export AGENTIC_PR_REVIEW_TOKEN=GITHUB_TOKEN\n * ```\n */\n\nimport type { OrganizationConfig, Result, TokenConfig } from './types.js';\n\n// ============================================\n// Configuration State (NO HARDCODED VALUES)\n// ============================================\n\n/**\n * Default token configuration - uses standard GITHUB_TOKEN\n * Users MUST configure their own organizations\n */\nconst DEFAULT_CONFIG: TokenConfig = {\n  organizations: {}, // Empty by default - users configure their own\n  defaultTokenEnvVar: 'GITHUB_TOKEN',\n  prReviewTokenEnvVar: 'GITHUB_TOKEN',\n};\n\nlet currentConfig: TokenConfig = { ...DEFAULT_CONFIG };\n\n// ============================================\n// Environment Configuration Loading\n// ============================================\n\n/**\n * Load organization configs from environment variables\n *\n * Pattern: AGENTIC_ORG_<NAME>_TOKEN=<TOKEN_ENV_VAR_NAME>\n *\n * @example\n * AGENTIC_ORG_MYCOMPANY_TOKEN=GITHUB_MYCOMPANY_TOKEN\n * This maps \"mycompany\" org to use the value from GITHUB_MYCOMPANY_TOKEN env var\n */\nfunction loadEnvConfig(): void {\n  const orgPattern = /^AGENTIC_ORG_([A-Z0-9_]+)_TOKEN$/;\n\n  for (const [key, value] of Object.entries(process.env)) {\n    const match = key.match(orgPattern);\n    if (match?.[1] && value) {\n      // Convert UPPER_CASE to kebab-case for org name\n      const orgName = match[1].toLowerCase().replace(/_/g, '-');\n      if (!currentConfig.organizations[orgName]) {\n        currentConfig.organizations[orgName] = {\n          name: orgName,\n          tokenEnvVar: value,\n        };\n      }\n    }\n  }\n\n  // Override PR review token if specified\n  if (process.env.AGENTIC_PR_REVIEW_TOKEN) {\n    currentConfig.prReviewTokenEnvVar = process.env.AGENTIC_PR_REVIEW_TOKEN;\n  }\n\n  // Override default token if specified\n  if (process.env.AGENTIC_DEFAULT_TOKEN) {\n    currentConfig.defaultTokenEnvVar = process.env.AGENTIC_DEFAULT_TOKEN;\n  }\n}\n\n// Load env config on module initialization\nloadEnvConfig();\n\n// ============================================\n// Public Configuration API\n// ============================================\n\n/**\n * Get the current token configuration\n */\nexport function getTokenConfig(): TokenConfig {\n  return { ...currentConfig };\n}\n\n/**\n * Update the token configuration\n *\n * @example\n * setTokenConfig({\n *   organizations: {\n *     \"my-org\": { name: \"my-org\", tokenEnvVar: \"MY_ORG_TOKEN\" }\n *   },\n *   prReviewTokenEnvVar: \"PR_REVIEW_TOKEN\"\n * });\n */\nexport function setTokenConfig(config: Partial<TokenConfig>): void {\n  currentConfig = {\n    ...currentConfig,\n    ...config,\n    organizations: {\n      ...currentConfig.organizations,\n      ...config.organizations,\n    },\n  };\n}\n\n/**\n * Reset configuration to defaults (useful for testing)\n */\nexport function resetTokenConfig(): void {\n  currentConfig = { ...DEFAULT_CONFIG, organizations: {} };\n  loadEnvConfig();\n}\n\n/**\n * Add or update an organization configuration\n *\n * @example\n * addOrganization({\n *   name: \"my-company\",\n *   tokenEnvVar: \"GITHUB_MYCOMPANY_TOKEN\",\n *   defaultBranch: \"main\",\n *   isEnterprise: true\n * });\n */\nexport function addOrganization(org: OrganizationConfig): void {\n  currentConfig.organizations[org.name] = org;\n}\n\n/**\n * Remove an organization configuration\n */\nexport function removeOrganization(orgName: string): void {\n  delete currentConfig.organizations[orgName];\n}\n\n// ============================================\n// Organization Extraction\n// ============================================\n\n/**\n * Extract organization name from a repository URL or full name\n * Uses a safe regex pattern to prevent ReDoS attacks\n *\n * @example\n * extractOrg(\"https://github.com/my-org/my-repo\") // \"my-org\"\n * extractOrg(\"my-org/my-repo\") // \"my-org\"\n * extractOrg(\"git@github.com:my-org/my-repo.git\") // \"my-org\"\n */\nexport function extractOrg(repoUrl: string): string | null {\n  // Handle full GitHub URLs - safe pattern with character class restriction\n  const urlMatch = repoUrl.match(/github\\.com[/:]([a-zA-Z0-9_.-]+)/);\n  if (urlMatch?.[1]) {\n    return urlMatch[1];\n  }\n\n  // Handle owner/repo format\n  const shortMatch = repoUrl.match(/^([a-zA-Z0-9_.-]+)\\//);\n  if (shortMatch?.[1]) {\n    return shortMatch[1];\n  }\n\n  return null;\n}\n\n// ============================================\n// Token Resolution\n// ============================================\n\n/**\n * Get the token environment variable name for a given organization\n * Returns the default if org is not configured\n *\n * @param org - Organization name (case-insensitive)\n */\nexport function getTokenEnvVar(org: string): string {\n  // Try exact match first\n  const config = currentConfig.organizations[org];\n  if (config?.tokenEnvVar) {\n    return config.tokenEnvVar;\n  }\n\n  // Try case-insensitive match\n  const lowerOrg = org.toLowerCase();\n  for (const [key, value] of Object.entries(currentConfig.organizations)) {\n    if (key.toLowerCase() === lowerOrg && value.tokenEnvVar) {\n      return value.tokenEnvVar;\n    }\n  }\n\n  return currentConfig.defaultTokenEnvVar;\n}\n\n/**\n * Get the actual token value for an organization\n *\n * @param org - Organization name\n * @returns Token value or undefined if not set\n */\nexport function getTokenForOrg(org: string): string | undefined {\n  const envVar = getTokenEnvVar(org);\n  return process.env[envVar];\n}\n\n/**\n * Get the token for a repository URL\n * Automatically extracts the organization and returns the appropriate token\n *\n * @param repoUrl - Repository URL or owner/repo format\n * @returns Token value or undefined if not set\n *\n * @example\n * // If configured: addOrganization({ name: \"myorg\", tokenEnvVar: \"MYORG_TOKEN\" })\n * getTokenForRepo(\"https://github.com/myorg/my-repo\")\n * // Returns value of MYORG_TOKEN\n */\nexport function getTokenForRepo(repoUrl: string): string | undefined {\n  const org = extractOrg(repoUrl);\n  if (!org) {\n    return process.env[currentConfig.defaultTokenEnvVar];\n  }\n  return getTokenForOrg(org);\n}\n\n/**\n * Get the token that should be used for PR reviews\n * Ensures a consistent identity across all PR interactions\n *\n * @returns Token value or undefined if not set\n */\nexport function getPRReviewToken(): string | undefined {\n  return process.env[currentConfig.prReviewTokenEnvVar];\n}\n\n/**\n * Get the PR review token environment variable name\n */\nexport function getPRReviewTokenEnvVar(): string {\n  return currentConfig.prReviewTokenEnvVar;\n}\n\n// ============================================\n// Validation\n// ============================================\n\n/**\n * Validate that required tokens are available\n *\n * @param orgs - Organization names to validate (optional, validates all configured if not specified)\n * @returns Validation result with any missing tokens\n */\nexport function validateTokens(orgs?: string[]): Result<string[]> {\n  const missing: string[] = [];\n  const orgsToCheck = orgs ?? Object.keys(currentConfig.organizations);\n\n  for (const org of orgsToCheck) {\n    const token = getTokenForOrg(org);\n    if (!token) {\n      const envVar = getTokenEnvVar(org);\n      missing.push(`${org}: ${envVar} not set`);\n    }\n  }\n\n  // Check PR review token\n  if (!getPRReviewToken()) {\n    missing.push(`PR Review: ${currentConfig.prReviewTokenEnvVar} not set`);\n  }\n\n  // Check default token\n  if (!process.env[currentConfig.defaultTokenEnvVar]) {\n    missing.push(`Default: ${currentConfig.defaultTokenEnvVar} not set`);\n  }\n\n  return {\n    success: missing.length === 0,\n    data: missing,\n    error: missing.length > 0 ? `Missing tokens: ${missing.join(', ')}` : undefined,\n  };\n}\n\n// ============================================\n// Organization Configuration Access\n// ============================================\n\n/**\n * Get organization configuration (case-insensitive)\n */\nexport function getOrgConfig(org: string): OrganizationConfig | undefined {\n  // Try exact match first\n  if (currentConfig.organizations[org]) {\n    return currentConfig.organizations[org];\n  }\n\n  // Try case-insensitive match\n  const lowerOrg = org.toLowerCase();\n  for (const [key, value] of Object.entries(currentConfig.organizations)) {\n    if (key.toLowerCase() === lowerOrg) {\n      return value;\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Get all configured organizations\n */\nexport function getConfiguredOrgs(): string[] {\n  return Object.keys(currentConfig.organizations);\n}\n\n/**\n * Check if an organization is configured (case-insensitive)\n */\nexport function isOrgConfigured(org: string): boolean {\n  if (org in currentConfig.organizations) {\n    return true;\n  }\n\n  const lowerOrg = org.toLowerCase();\n  for (const key of Object.keys(currentConfig.organizations)) {\n    if (key.toLowerCase() === lowerOrg) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// ============================================\n// Environment Helpers for Subprocesses\n// ============================================\n\n/**\n * Create environment variables object for a subprocess targeting a specific org\n * Useful when spawning child processes that need the correct GitHub token\n *\n * @param repoUrl - Repository URL to get token for\n * @returns Object with GH_TOKEN and GITHUB_TOKEN set\n *\n * @example\n * import { spawnSync } from 'node:child_process';\n * const proc = spawnSync('gh', ['pr', 'list'], {\n *   env: { ...process.env, ...getEnvForRepo(\"owner/repo\") }\n * });\n */\nexport function getEnvForRepo(repoUrl: string): Record<string, string> {\n  const token = getTokenForRepo(repoUrl);\n  if (!token) {\n    return {};\n  }\n  return {\n    GH_TOKEN: token,\n    GITHUB_TOKEN: token,\n  };\n}\n\n/**\n * Create environment variables for PR review operations\n * Uses the configured PR review identity\n *\n * @returns Object with GH_TOKEN and GITHUB_TOKEN set for PR review\n */\nexport function getEnvForPRReview(): Record<string, string> {\n  const token = getPRReviewToken();\n  if (!token) {\n    return {};\n  }\n  return {\n    GH_TOKEN: token,\n    GITHUB_TOKEN: token,\n  };\n}\n\n// ============================================\n// Convenience Utilities\n// ============================================\n\n/**\n * Check if we have a valid token for an organization\n */\nexport function hasTokenForOrg(org: string): boolean {\n  return !!getTokenForOrg(org);\n}\n\n/**\n * Check if we have a valid token for a repository\n */\nexport function hasTokenForRepo(repoUrl: string): boolean {\n  return !!getTokenForRepo(repoUrl);\n}\n\n/**\n * Get a summary of token availability for debugging/display\n */\nexport function getTokenSummary(): Record<\n  string,\n  { envVar: string; available: boolean; configured: boolean }\n> {\n  const summary: Record<string, { envVar: string; available: boolean; configured: boolean }> = {};\n\n  for (const org of getConfiguredOrgs()) {\n    const envVar = getTokenEnvVar(org);\n    summary[org] = {\n      envVar,\n      available: !!process.env[envVar],\n      configured: true,\n    };\n  }\n\n  summary._default = {\n    envVar: currentConfig.defaultTokenEnvVar,\n    available: !!process.env[currentConfig.defaultTokenEnvVar],\n    configured: true,\n  };\n\n  summary._pr_review = {\n    envVar: currentConfig.prReviewTokenEnvVar,\n    available: !!getPRReviewToken(),\n    configured: true,\n  };\n\n  return summary;\n}\n","/**\n * Configuration validation using Zod schemas\n */\n\nimport { z } from 'zod';\nimport { ConfigErrorCode, ConfigurationError } from './errors.js';\n\n// ============================================\n// Base Schemas\n// ============================================\n\nconst TokenOrgSchema = z.object({\n  name: z.string().min(1).max(39),\n  tokenEnvVar: z.string().min(1),\n});\n\nconst TokenConfigSchema = z.object({\n  organizations: z.record(z.string(), TokenOrgSchema).optional(),\n  defaultTokenEnvVar: z.string().optional(),\n  prReviewTokenEnvVar: z.string().optional(),\n});\n\nconst FleetConfigSchema = z.object({\n  autoCreatePr: z.boolean().optional(),\n  openAsCursorGithubApp: z.boolean().optional(),\n  skipReviewerRequest: z.boolean().optional(),\n});\n\nconst TriageConfigSchema = z.object({\n  provider: z.enum(['anthropic', 'openai', 'google', 'mistral', 'azure']).optional(),\n  model: z.string().optional(),\n  apiKeyEnvVar: z.string().optional(),\n});\n\nconst MCPServerConfigSchema = z.object({\n  enabled: z.boolean().optional(),\n  tokenEnvVar: z.string().optional(),\n  tokenEnvVarFallbacks: z.array(z.string()).optional(),\n  mode: z.enum(['stdio', 'proxy']).optional(),\n  command: z.string().optional(),\n  args: z.array(z.string()).optional(),\n  proxyUrl: z.string().url().optional(),\n});\n\nconst MCPConfigSchema = z\n  .object({\n    cursor: MCPServerConfigSchema.optional(),\n    github: MCPServerConfigSchema.optional(),\n    context7: MCPServerConfigSchema.optional(),\n    '21st-magic': MCPServerConfigSchema.optional(),\n  })\n  .catchall(MCPServerConfigSchema);\n\nconst CursorConfigSchema = z.object({\n  apiKeyEnvVar: z.string().optional(),\n  baseUrl: z.string().url().optional(),\n});\n\n// ============================================\n// Main Configuration Schema\n// ============================================\n\nexport const AgenticConfigSchema = z.object({\n  tokens: TokenConfigSchema.optional(),\n  defaultRepository: z.string().optional(),\n  coordinationPr: z.number().int().positive().optional(),\n  logLevel: z.enum(['debug', 'info', 'warn', 'error']).optional(),\n  verbose: z.boolean().optional(),\n  cursor: CursorConfigSchema.optional(),\n  fleet: FleetConfigSchema.optional(),\n  triage: TriageConfigSchema.optional(),\n  mcp: MCPConfigSchema.optional(),\n});\n\n// ============================================\n// Validation Functions\n// ============================================\n\n/**\n * Validate configuration object against schema\n */\nexport function validateConfig(config: unknown): void {\n  try {\n    AgenticConfigSchema.parse(config);\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      const firstIssue = error.issues[0];\n      if (firstIssue) {\n        const field = firstIssue.path.join('.');\n        const message = `Invalid configuration at '${field}': ${firstIssue.message}`;\n        throw new ConfigurationError(message, ConfigErrorCode.INVALID_SCHEMA, field);\n      }\n      throw new ConfigurationError('Invalid configuration', ConfigErrorCode.INVALID_SCHEMA);\n    }\n    throw error;\n  }\n}\n\n/**\n * Validate environment variable exists and is not empty\n */\nexport function validateEnvVar(envVar: string, description?: string): string {\n  const value = process.env[envVar];\n\n  if (!value || value.trim() === '') {\n    const desc = description ?? envVar;\n    throw new ConfigurationError(\n      `Missing required environment variable: ${envVar}. Please set ${desc} to continue.`,\n      ConfigErrorCode.MISSING_REQUIRED_FIELD,\n      envVar\n    );\n  }\n\n  return value.trim();\n}\n\n/**\n * Validate environment variable with clear error message\n */\nexport function validateEnvVarWithMessage(envVar: string, purpose: string): string {\n  const value = process.env[envVar];\n\n  if (!value || value.trim() === '') {\n    throw new ConfigurationError(\n      `${purpose} requires ${envVar} environment variable. Please set it and try again.`,\n      ConfigErrorCode.MISSING_REQUIRED_FIELD,\n      envVar\n    );\n  }\n\n  return value.trim();\n}\n\n/**\n * Validate repository format (owner/repo)\n */\nexport function validateRepository(repo: string): void {\n  const repoPattern = /^[a-zA-Z0-9._-]+\\/[a-zA-Z0-9._-]+$/;\n\n  if (!repoPattern.test(repo)) {\n    throw new ConfigurationError(\n      `Invalid repository format: ${repo}. Expected format: owner/repo`,\n      ConfigErrorCode.INVALID_VALUE,\n      'repository'\n    );\n  }\n}\n\n/**\n * Validate git reference format\n */\nexport function validateGitRef(ref: string): void {\n  if (!/^[a-zA-Z0-9._/-]+$/.test(ref)) {\n    throw new ConfigurationError(\n      `Invalid git reference format: ${ref}`,\n      ConfigErrorCode.INVALID_VALUE,\n      'gitRef'\n    );\n  }\n\n  if (ref.length > 200) {\n    throw new ConfigurationError(\n      `Git reference too long: ${ref} (max 200 characters)`,\n      ConfigErrorCode.INVALID_VALUE,\n      'gitRef'\n    );\n  }\n}\n\n/**\n * Validate positive integer\n */\nexport function validatePositiveInt(value: string, field: string): number {\n  const parsed = Number.parseInt(value, 10);\n\n  if (Number.isNaN(parsed) || parsed <= 0) {\n    throw new ConfigurationError(\n      `${field} must be a positive integer, got: ${value}`,\n      ConfigErrorCode.INVALID_VALUE,\n      field\n    );\n  }\n\n  return parsed;\n}\n","/**\n * Configuration Management for agentic-control\n *\n * Uses cosmiconfig for standard config file discovery and loading.\n * Searches for configuration in:\n *   - agentic.config.json\n *   - agentic.config.js\n *   - agentic.config.cjs\n *   - .agenticrc\n *   - .agenticrc.json\n *   - package.json \"agentic\" key\n *\n * Priority: CLI args > env vars > config file > defaults\n *\n * @example Config file (agentic.config.json):\n * ```json\n * {\n *   \"tokens\": {\n *     \"organizations\": {\n *       \"my-org\": { \"name\": \"my-org\", \"tokenEnvVar\": \"MY_ORG_TOKEN\" }\n *     }\n *   },\n *   \"defaultModel\": \"claude-sonnet-4-20250514\",\n *   \"fleet\": {\n *     \"autoCreatePr\": true\n *   }\n * }\n * ```\n */\n\nimport { cosmiconfigSync } from 'cosmiconfig';\nimport { setTokenConfig } from './tokens.js';\nimport type { TokenConfig } from './types.js';\nimport { validateConfig } from './validation.js';\n\n// ============================================\n// Configuration Types\n// ============================================\n\nexport interface FleetConfig {\n  /** Auto-create PR when agent completes */\n  autoCreatePr?: boolean;\n  /** Open PR as Cursor GitHub App */\n  openAsCursorGithubApp?: boolean;\n  /** Skip adding user as reviewer */\n  skipReviewerRequest?: boolean;\n}\n\nexport interface TriageConfig {\n  /** AI provider: anthropic, openai, google, mistral, azure */\n  provider?: string;\n  /** Model ID for the provider */\n  model?: string;\n  /** API key environment variable name */\n  apiKeyEnvVar?: string;\n}\n\nexport interface MCPServerConfig {\n  /** Whether this MCP server is enabled */\n  enabled?: boolean;\n  /** Environment variable name for the API key/token */\n  tokenEnvVar?: string;\n  /** Fallback env vars to try if primary not found */\n  tokenEnvVarFallbacks?: string[];\n  /** Transport mode: stdio or proxy */\n  mode?: 'stdio' | 'proxy';\n  /** Command to run for stdio transport */\n  command?: string;\n  /** Arguments for the command */\n  args?: string[];\n  /** Proxy URL for proxy mode */\n  proxyUrl?: string;\n}\n\nexport interface MCPConfig {\n  /** Cursor Background Agent MCP */\n  cursor?: MCPServerConfig;\n  /** GitHub MCP */\n  github?: MCPServerConfig;\n  /** Context7 documentation MCP */\n  context7?: MCPServerConfig;\n  /** 21st.dev Magic MCP */\n  '21st-magic'?: MCPServerConfig;\n  /** Custom MCP servers */\n  [key: string]: MCPServerConfig | undefined;\n}\n\nexport interface RoleConfig {\n  /** Enable/disable the role */\n  enabled?: boolean;\n  /** Override the system prompt */\n  systemPrompt?: string;\n  /** Model override */\n  model?: string;\n}\n\nexport interface RolesConfig {\n  /** Sage role configuration */\n  sage?: RoleConfig;\n  /** Harvester role configuration */\n  harvester?: RoleConfig;\n  /** Curator role configuration */\n  curator?: RoleConfig;\n  /** Reviewer role configuration */\n  reviewer?: RoleConfig;\n  /** Fixer role configuration */\n  fixer?: RoleConfig;\n  /** Delegator role configuration */\n  delegator?: RoleConfig;\n}\n\nexport interface AgenticConfig {\n  /** Token configuration for multi-org access */\n  tokens?: Partial<TokenConfig>;\n\n  /** Default repository for fleet operations */\n  defaultRepository?: string;\n\n  /** Coordination PR number for fleet communication */\n  coordinationPr?: number;\n\n  /** Log level */\n  logLevel?: 'debug' | 'info' | 'warn' | 'error';\n\n  /** Whether to enable verbose output */\n  verbose?: boolean;\n\n  /** Cursor API configuration */\n  cursor?: {\n    /** API key environment variable name */\n    apiKeyEnvVar?: string;\n    /** Base URL for Cursor API */\n    baseUrl?: string;\n  };\n\n  /** Fleet default options */\n  fleet?: FleetConfig;\n\n  /** Triage (AI analysis) configuration */\n  triage?: TriageConfig;\n\n  /** MCP server configuration */\n  mcp?: MCPConfig;\n\n  /** Roles configuration */\n  roles?: RolesConfig;\n}\n\n// ============================================\n// Cosmiconfig Setup\n// ============================================\n\nconst MODULE_NAME = 'agentic';\n\n// Security: Only allow JSON config files to prevent code execution\n// JavaScript config files could execute arbitrary code during require()\nconst explorer = cosmiconfigSync(MODULE_NAME, {\n  searchPlaces: ['package.json', 'agentic.config.json', '.agenticrc', '.agenticrc.json'],\n  // Security: Disable loaders that execute code\n  loaders: {\n    '.json': (_filepath: string, content: string) => JSON.parse(content),\n  },\n});\n\n// ============================================\n// Configuration State\n// ============================================\n\nlet config: AgenticConfig = {};\nlet configLoaded = false;\nlet configPath: string | null = null;\n\n// ============================================\n// Environment Variable Loading\n// ============================================\n\nfunction loadEnvConfig(): Partial<AgenticConfig> {\n  const envConfig: Partial<AgenticConfig> = {};\n\n  // Build triage config from environment variables\n  const triageFromEnv: Partial<TriageConfig> = {};\n  if (process.env.AGENTIC_MODEL) {\n    triageFromEnv.model = process.env.AGENTIC_MODEL;\n  }\n  if (process.env.AGENTIC_PROVIDER) {\n    triageFromEnv.provider = process.env.AGENTIC_PROVIDER;\n  }\n  if (Object.keys(triageFromEnv).length > 0) {\n    envConfig.triage = triageFromEnv;\n  }\n\n  if (process.env.AGENTIC_REPOSITORY) {\n    envConfig.defaultRepository = process.env.AGENTIC_REPOSITORY;\n  }\n\n  if (process.env.AGENTIC_COORDINATION_PR) {\n    const parsed = Number.parseInt(process.env.AGENTIC_COORDINATION_PR, 10);\n    if (!Number.isNaN(parsed) && parsed > 0) {\n      envConfig.coordinationPr = parsed;\n    }\n  }\n\n  if (process.env.AGENTIC_LOG_LEVEL) {\n    const level = process.env.AGENTIC_LOG_LEVEL.toLowerCase();\n    if (['debug', 'info', 'warn', 'error'].includes(level)) {\n      envConfig.logLevel = level as AgenticConfig['logLevel'];\n    }\n  }\n\n  if (process.env.AGENTIC_VERBOSE === 'true' || process.env.AGENTIC_VERBOSE === '1') {\n    envConfig.verbose = true;\n  }\n\n  return envConfig;\n}\n\n// ============================================\n// Configuration Loading\n// ============================================\n\n/**\n * Deep merge configuration objects\n */\nfunction mergeConfig(base: AgenticConfig, overrides: Partial<AgenticConfig>): AgenticConfig {\n  const result = { ...base };\n\n  for (const [key, value] of Object.entries(overrides)) {\n    if (value === undefined) continue;\n\n    if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n      const baseValue = (base as Record<string, unknown>)[key];\n      // Only spread baseValue if it's a non-null object\n      const baseObj =\n        typeof baseValue === 'object' && baseValue !== null && !Array.isArray(baseValue)\n          ? baseValue\n          : {};\n      (result as Record<string, unknown>)[key] = {\n        ...baseObj,\n        ...value,\n      };\n    } else {\n      (result as Record<string, unknown>)[key] = value;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Initialize configuration from all sources\n * Priority: programmatic overrides > env vars > config file\n */\nexport function initConfig(overrides?: Partial<AgenticConfig>): AgenticConfig {\n  // Search for config file using cosmiconfig\n  const result = explorer.search();\n\n  if (result && !result.isEmpty) {\n    // Validate configuration before using it\n    validateConfig(result.config);\n    config = result.config as AgenticConfig;\n    configPath = result.filepath;\n  } else {\n    config = {};\n    configPath = null;\n  }\n\n  // Merge environment variables\n  const envConfig = loadEnvConfig();\n  config = mergeConfig(config, envConfig);\n\n  // Apply programmatic overrides\n  if (overrides) {\n    config = mergeConfig(config, overrides);\n  }\n\n  // Validate final configuration\n  validateConfig(config);\n\n  // Apply token configuration\n  if (config.tokens) {\n    setTokenConfig(config.tokens);\n  }\n\n  configLoaded = true;\n  return config;\n}\n\n/**\n * Load config from a specific file path\n */\nexport function loadConfigFromPath(filepath: string): AgenticConfig {\n  const result = explorer.load(filepath);\n\n  if (result && !result.isEmpty) {\n    // Validate configuration before using it\n    validateConfig(result.config);\n    config = result.config as AgenticConfig;\n    configPath = result.filepath;\n\n    if (config.tokens) {\n      setTokenConfig(config.tokens);\n    }\n\n    configLoaded = true;\n    return config;\n  }\n\n  throw new Error(`Failed to load config from ${filepath}`);\n}\n\n// ============================================\n// Public API\n// ============================================\n\n/**\n * Get the current configuration\n */\nexport function getConfig(): AgenticConfig {\n  if (!configLoaded) {\n    initConfig();\n  }\n  return { ...config };\n}\n\n/**\n * Get path to loaded config file\n */\nexport function getConfigPath(): string | null {\n  return configPath;\n}\n\n/**\n * Update configuration at runtime\n */\nexport function setConfig(updates: Partial<AgenticConfig>): void {\n  config = mergeConfig(config, updates);\n\n  if (updates.tokens) {\n    setTokenConfig(updates.tokens);\n  }\n}\n\n/**\n * Reset configuration (useful for testing)\n */\nexport function resetConfig(): void {\n  config = {};\n  configLoaded = false;\n  configPath = null;\n}\n\n/**\n * Get a specific configuration value\n */\nexport function getConfigValue<K extends keyof AgenticConfig>(key: K): AgenticConfig[K] {\n  if (!configLoaded) {\n    initConfig();\n  }\n  return config[key];\n}\n\n/**\n * Check if verbose mode is enabled\n */\nexport function isVerbose(): boolean {\n  return config.verbose ?? false;\n}\n\n/**\n * Get triage configuration\n */\nexport function getTriageConfig(): TriageConfig {\n  if (!configLoaded) {\n    initConfig();\n  }\n  return (\n    config.triage ?? {\n      provider: 'anthropic',\n      model: 'claude-sonnet-4-20250514',\n      apiKeyEnvVar: 'ANTHROPIC_API_KEY',\n    }\n  );\n}\n\n/**\n * Get the default model for triage operations\n * @deprecated Use getTriageConfig() instead\n */\nexport function getDefaultModel(): string {\n  return getTriageConfig().model ?? 'claude-sonnet-4-20250514';\n}\n\n/**\n * Get fleet defaults\n */\nexport function getFleetDefaults(): FleetConfig {\n  if (!configLoaded) {\n    initConfig();\n  }\n  return config.fleet ?? {};\n}\n\n/**\n * Get the log level\n */\nexport function getLogLevel(): string {\n  return config.logLevel ?? 'info';\n}\n\n/**\n * Get Cursor API key from configured environment variable\n */\nexport function getCursorApiKey(): string | undefined {\n  const envVar = config.cursor?.apiKeyEnvVar ?? 'CURSOR_API_KEY';\n  return process.env[envVar];\n}\n\n/**\n * Get default API key env var for a provider\n */\nexport function getDefaultApiKeyEnvVar(provider?: string): string {\n  switch (provider) {\n    case 'openai':\n      return 'OPENAI_API_KEY';\n    case 'google':\n      return 'GOOGLE_API_KEY';\n    case 'mistral':\n      return 'MISTRAL_API_KEY';\n    case 'azure':\n      return 'AZURE_API_KEY';\n    case 'ollama':\n      return 'OLLAMA_API_KEY';\n    default:\n      return 'ANTHROPIC_API_KEY';\n  }\n}\n\n/**\n * Get triage API key from configured environment variable\n * @param providerOverride - Optional provider to use instead of config value\n */\nexport function getTriageApiKey(providerOverride?: string): string | undefined {\n  const triageConfig = getTriageConfig();\n  const provider = providerOverride ?? triageConfig.provider;\n  const envVar = triageConfig.apiKeyEnvVar ?? getDefaultApiKeyEnvVar(provider);\n  return process.env[envVar];\n}\n\n// ============================================\n// Logging Utilities\n// ============================================\n\nconst LOG_LEVELS = {\n  debug: 0,\n  info: 1,\n  warn: 2,\n  error: 3,\n};\n\nfunction shouldLog(level: keyof typeof LOG_LEVELS): boolean {\n  const currentLevel = LOG_LEVELS[getLogLevel() as keyof typeof LOG_LEVELS] ?? 1;\n  return LOG_LEVELS[level] >= currentLevel;\n}\n\nexport const log = {\n  debug: (...args: unknown[]): void => {\n    if (shouldLog('debug')) {\n      console.debug('[agentic:debug]', ...args);\n    }\n  },\n  info: (...args: unknown[]): void => {\n    if (shouldLog('info')) {\n      console.log('[agentic:info]', ...args);\n    }\n  },\n  warn: (...args: unknown[]): void => {\n    if (shouldLog('warn')) {\n      console.warn('[agentic:warn]', ...args);\n    }\n  },\n  error: (...args: unknown[]): void => {\n    if (shouldLog('error')) {\n      console.error('[agentic:error]', ...args);\n    }\n  },\n};\n","/**\n * GitHubClient - Unified GitHub API client\n *\n * Provides GitHub API operations with:\n * - Intelligent token switching based on organization\n * - Consistent identity for PR reviews\n * - CI status and feedback collection\n * - Safe git operations (no shell injection)\n *\n * This consolidates the former token-aware client and triage client.\n */\n\nimport { spawnSync } from 'node:child_process';\nimport { Octokit } from '@octokit/rest';\nimport { log } from '../core/config.js';\nimport { extractOrg, getPRReviewToken, getTokenForRepo } from '../core/tokens.js';\nimport type { PRComment, PullRequest, Repository, Result } from '../core/types.js';\nimport type {\n  CICheck,\n  CIStatus,\n  FeedbackItem,\n  FeedbackSeverity,\n  FeedbackStatus,\n} from '../triage/types.js';\n\n// ============================================\n// Octokit Cache (one per token)\n// ============================================\n\nconst octokitCache = new Map<string, Octokit>();\n\nfunction getOctokit(token: string): Octokit {\n  let octokit = octokitCache.get(token);\n  if (!octokit) {\n    octokit = new Octokit({ auth: token });\n    octokitCache.set(token, octokit);\n  }\n  return octokit;\n}\n\n// ============================================\n// Configuration\n// ============================================\n\nexport interface GitHubClientConfig {\n  /** Token for authentication */\n  token?: string;\n  /** Repository owner */\n  owner?: string;\n  /** Repository name */\n  repo?: string;\n}\n\n// ============================================\n// GitHub Client Class\n// ============================================\n\nexport class GitHubClient {\n  private token: string | null;\n  private owner: string | null;\n  private repo: string | null;\n\n  /**\n   * Create a new GitHubClient.\n   *\n   * Can be used in two modes:\n   * 1. With explicit config: new GitHubClient({ token, owner, repo })\n   * 2. Token-aware mode: new GitHubClient() - uses token based on repo\n   */\n  constructor(config: GitHubClientConfig = {}) {\n    this.token = config.token ?? null;\n    this.owner = config.owner ?? null;\n    this.repo = config.repo ?? null;\n  }\n\n  // ============================================\n  // Token Management (Static Methods)\n  // ============================================\n\n  /**\n   * Get an Octokit instance for a repository.\n   * Automatically selects the correct token based on org.\n   */\n  static forRepo(repoUrl: string): Octokit | null {\n    const token = getTokenForRepo(repoUrl);\n    if (!token) {\n      log.warn(`No token available for repo: ${repoUrl}`);\n      return null;\n    }\n    return getOctokit(token);\n  }\n\n  /**\n   * Get an Octokit instance for PR review operations.\n   * Always uses the consistent PR review identity.\n   */\n  static forPRReview(): Octokit | null {\n    const token = getPRReviewToken();\n    if (!token) {\n      log.warn('No PR review token available');\n      return null;\n    }\n    return getOctokit(token);\n  }\n\n  // ============================================\n  // Instance Helpers\n  // ============================================\n\n  private getOctokitInstance(): Octokit {\n    if (this.token) {\n      return getOctokit(this.token);\n    }\n    if (this.owner && this.repo) {\n      const octokit = GitHubClient.forRepo(`${this.owner}/${this.repo}`);\n      if (!octokit) {\n        throw new Error(`No token available for ${this.owner}/${this.repo}`);\n      }\n      return octokit;\n    }\n    throw new Error('GitHubClient requires either token or owner/repo');\n  }\n\n  private ensureRepo(): { owner: string; repo: string } {\n    if (!this.owner || !this.repo) {\n      throw new Error('owner and repo are required for this operation');\n    }\n    return { owner: this.owner, repo: this.repo };\n  }\n\n  // ============================================\n  // Repository Operations (Static)\n  // ============================================\n\n  /**\n   * Get repository information\n   */\n  static async getRepo(owner: string, repo: string): Promise<Result<Repository>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      const { data } = await octokit.repos.get({ owner, repo });\n      return {\n        success: true,\n        data: {\n          owner: data.owner.login,\n          name: data.name,\n          fullName: data.full_name,\n          defaultBranch: data.default_branch,\n          isPrivate: data.private,\n          url: data.html_url,\n        },\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * List repositories for an organization\n   */\n  static async listOrgRepos(\n    org: string,\n    options?: {\n      type?: 'all' | 'public' | 'private' | 'forks' | 'sources' | 'member';\n      perPage?: number;\n    }\n  ): Promise<Result<Repository[]>> {\n    const octokit = GitHubClient.forRepo(`${org}/any`);\n    if (!octokit) {\n      return { success: false, error: `No token available for org: ${org}` };\n    }\n\n    try {\n      const { data } = await octokit.repos.listForOrg({\n        org,\n        type: options?.type ?? 'all',\n        per_page: options?.perPage ?? 100,\n      });\n\n      return {\n        success: true,\n        data: data.map((r) => ({\n          owner: r.owner.login,\n          name: r.name,\n          fullName: r.full_name,\n          defaultBranch: r.default_branch ?? 'main',\n          isPrivate: r.private,\n          url: r.html_url,\n        })),\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  // ============================================\n  // Pull Request Operations\n  // ============================================\n\n  /**\n   * Get pull request information (static version)\n   */\n  static async getPRStatic(\n    owner: string,\n    repo: string,\n    prNumber: number\n  ): Promise<Result<PullRequest>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      const { data } = await octokit.pulls.get({ owner, repo, pull_number: prNumber });\n      return {\n        success: true,\n        data: {\n          number: data.number,\n          title: data.title,\n          body: data.body ?? undefined,\n          state: data.state as 'open' | 'closed',\n          draft: data.draft ?? false,\n          url: data.html_url,\n          headBranch: data.head.ref,\n          baseBranch: data.base.ref,\n          author: data.user?.login ?? 'unknown',\n        },\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Get pull request (instance version with full data)\n   */\n  async getPR(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.get({\n      owner,\n      repo,\n      pull_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * Get files changed in a PR\n   */\n  async getPRFiles(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.listFiles({\n      owner,\n      repo,\n      pull_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * Create a pull request\n   */\n  static async createPR(\n    owner: string,\n    repo: string,\n    options: {\n      title: string;\n      body?: string;\n      head: string;\n      base: string;\n      draft?: boolean;\n    }\n  ): Promise<Result<PullRequest>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      const { data } = await octokit.pulls.create({\n        owner,\n        repo,\n        title: options.title,\n        body: options.body,\n        head: options.head,\n        base: options.base,\n        draft: options.draft,\n      });\n\n      return {\n        success: true,\n        data: {\n          number: data.number,\n          title: data.title,\n          body: data.body ?? undefined,\n          state: data.state as 'open' | 'closed',\n          draft: data.draft ?? false,\n          url: data.html_url,\n          headBranch: data.head.ref,\n          baseBranch: data.base.ref,\n          author: data.user?.login ?? 'unknown',\n        },\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Merge a pull request\n   */\n  static async mergePRStatic(\n    owner: string,\n    repo: string,\n    prNumber: number,\n    options?: {\n      mergeMethod?: 'merge' | 'squash' | 'rebase';\n      commitTitle?: string;\n      commitMessage?: string;\n    }\n  ): Promise<Result<void>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      await octokit.pulls.merge({\n        owner,\n        repo,\n        pull_number: prNumber,\n        merge_method: options?.mergeMethod ?? 'squash',\n        commit_title: options?.commitTitle,\n        commit_message: options?.commitMessage,\n      });\n\n      return { success: true };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Merge a pull request (instance version)\n   */\n  async mergePR(prNumber: number, method: 'merge' | 'squash' | 'rebase' = 'squash') {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.merge({\n      owner,\n      repo,\n      pull_number: prNumber,\n      merge_method: method,\n    });\n    return data;\n  }\n\n  // ============================================\n  // Reviews and Comments\n  // ============================================\n\n  /**\n   * Get reviews on a PR\n   */\n  async getReviews(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.listReviews({\n      owner,\n      repo,\n      pull_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * Get review comments on a PR\n   */\n  async getReviewComments(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.listReviewComments({\n      owner,\n      repo,\n      pull_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * Get issue comments on a PR\n   */\n  async getIssueComments(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.issues.listComments({\n      owner,\n      repo,\n      issue_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * List PR comments (static version)\n   */\n  static async listPRComments(\n    owner: string,\n    repo: string,\n    prNumber: number\n  ): Promise<Result<PRComment[]>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      const { data } = await octokit.issues.listComments({\n        owner,\n        repo,\n        issue_number: prNumber,\n        per_page: 100,\n      });\n\n      return {\n        success: true,\n        data: data.map((c) => ({\n          id: c.id,\n          body: c.body ?? '',\n          author: c.user?.login ?? 'unknown',\n          createdAt: c.created_at,\n          updatedAt: c.updated_at,\n        })),\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Post a PR comment (ALWAYS uses PR review identity)\n   */\n  static async postPRComment(\n    owner: string,\n    repo: string,\n    prNumber: number,\n    body: string\n  ): Promise<Result<PRComment>> {\n    const octokit = GitHubClient.forPRReview();\n    if (!octokit) {\n      return { success: false, error: 'No PR review token available' };\n    }\n\n    try {\n      const { data } = await octokit.issues.createComment({\n        owner,\n        repo,\n        issue_number: prNumber,\n        body,\n      });\n\n      return {\n        success: true,\n        data: {\n          id: data.id,\n          body: data.body ?? '',\n          author: data.user?.login ?? 'unknown',\n          createdAt: data.created_at,\n          updatedAt: data.updated_at,\n        },\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Post a comment (instance version)\n   */\n  async postComment(prNumber: number, body: string) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.issues.createComment({\n      owner,\n      repo,\n      issue_number: prNumber,\n      body,\n    });\n    return data;\n  }\n\n  /**\n   * Reply to a review comment\n   */\n  async replyToComment(prNumber: number, commentId: number, body: string) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.createReplyForReviewComment({\n      owner,\n      repo,\n      pull_number: prNumber,\n      comment_id: commentId,\n      body,\n    });\n    return data;\n  }\n\n  /**\n   * Request a review on a PR (ALWAYS uses PR review identity)\n   */\n  static async requestReview(\n    owner: string,\n    repo: string,\n    prNumber: number,\n    reviewers: string[]\n  ): Promise<Result<void>> {\n    const octokit = GitHubClient.forPRReview();\n    if (!octokit) {\n      return { success: false, error: 'No PR review token available' };\n    }\n\n    try {\n      await octokit.pulls.requestReviewers({\n        owner,\n        repo,\n        pull_number: prNumber,\n        reviewers,\n      });\n\n      return { success: true };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  // ============================================\n  // CI Status\n  // ============================================\n\n  /**\n   * Get CI status for a PR\n   */\n  async getCIStatus(prNumber: number): Promise<CIStatus> {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n\n    const pr = await this.getPR(prNumber);\n    const ref = pr.head.sha;\n\n    const { data: checkRuns } = await octokit.checks.listForRef({\n      owner,\n      repo,\n      ref,\n    });\n\n    const checks: CICheck[] = checkRuns.check_runs.map((run) => ({\n      name: run.name,\n      status: this.mapCheckStatus(run.status, run.conclusion),\n      conclusion: run.conclusion,\n      url: run.html_url ?? '',\n      startedAt: run.started_at,\n      completedAt: run.completed_at,\n    }));\n\n    const failures = checks.filter((c) => c.status === 'failure');\n    const pending = checks.filter((c) => c.status === 'pending' || c.status === 'in_progress');\n\n    return {\n      allPassing: failures.length === 0 && pending.length === 0,\n      anyPending: pending.length > 0,\n      checks,\n      failures,\n    };\n  }\n\n  private mapCheckStatus(status: string, conclusion: string | null): CICheck['status'] {\n    if (status === 'queued' || status === 'pending') return 'pending';\n    if (status === 'in_progress') return 'in_progress';\n    if (conclusion === 'success') return 'success';\n    if (conclusion === 'failure' || conclusion === 'timed_out') return 'failure';\n    if (conclusion === 'skipped' || conclusion === 'cancelled') return 'skipped';\n    return 'pending';\n  }\n\n  // ============================================\n  // Feedback Collection\n  // ============================================\n\n  /**\n   * Collect all feedback on a PR\n   */\n  async collectFeedback(prNumber: number): Promise<FeedbackItem[]> {\n    const [reviewComments, reviews] = await Promise.all([\n      this.getReviewComments(prNumber),\n      this.getReviews(prNumber),\n    ]);\n\n    const feedbackItems: FeedbackItem[] = [];\n\n    // Process inline review comments\n    for (const comment of reviewComments) {\n      const severity = this.inferSeverity(comment.body);\n      feedbackItems.push({\n        id: `comment-${comment.id}`,\n        author: comment.user?.login ?? 'unknown',\n        body: comment.body,\n        path: comment.path,\n        line: comment.line ?? comment.original_line ?? null,\n        severity,\n        status: this.inferStatus(comment),\n        createdAt: comment.created_at,\n        url: comment.html_url,\n        isAutoResolvable: this.isAutoResolvable(comment.body, severity),\n        suggestedAction: this.extractSuggestion(comment.body),\n        resolution: null,\n      });\n    }\n\n    // Process review bodies (summary comments)\n    for (const review of reviews) {\n      if (!review.body || review.body.trim() === '') continue;\n\n      const severity = this.inferSeverity(review.body);\n      feedbackItems.push({\n        id: `review-${review.id}`,\n        author: review.user?.login ?? 'unknown',\n        body: review.body,\n        path: null,\n        line: null,\n        severity,\n        status: 'addressed', // Review summaries are informational\n        createdAt: review.submitted_at ?? new Date().toISOString(),\n        url: review.html_url,\n        isAutoResolvable: false,\n        suggestedAction: null,\n        resolution: null,\n      });\n    }\n\n    return feedbackItems;\n  }\n\n  private inferSeverity(body: string): FeedbackSeverity {\n    const lower = body.toLowerCase();\n\n    if (body.includes('') || body.includes(':stop_sign:') || lower.includes('critical')) {\n      return 'critical';\n    }\n    if (body.includes('medium-priority') || lower.includes('high severity')) {\n      return 'high';\n    }\n    if (body.includes('medium') || lower.includes('should')) {\n      return 'medium';\n    }\n    if (body.includes('nitpick') || body.includes('nit:') || lower.includes('consider')) {\n      return 'low';\n    }\n    if (body.includes('info') || body.includes('note:')) {\n      return 'info';\n    }\n\n    if (lower.includes('error') || lower.includes('bug') || lower.includes('fix')) {\n      return 'high';\n    }\n\n    return 'medium';\n  }\n\n  private inferStatus(comment: { body: string; in_reply_to_id?: number }): FeedbackStatus {\n    if (comment.in_reply_to_id) {\n      return 'addressed';\n    }\n    return 'unaddressed';\n  }\n\n  private isAutoResolvable(body: string, severity: FeedbackSeverity): boolean {\n    if (body.includes('```suggestion')) return true;\n    if (severity === 'low' || severity === 'info') return true;\n\n    const lower = body.toLowerCase();\n    if (lower.includes('formatting') || lower.includes('typo') || lower.includes('spelling')) {\n      return true;\n    }\n\n    return false;\n  }\n\n  private extractSuggestion(body: string): string | null {\n    const suggestionMatch = body.match(/```suggestion\\n([\\s\\S]*?)```/);\n    const suggestion = suggestionMatch?.[1];\n    if (suggestion !== undefined) {\n      return suggestion.trim();\n    }\n    return null;\n  }\n}\n\n// ============================================\n// Safe Git Operations\n// ============================================\n\n/**\n * Clone a repository with appropriate token.\n * Uses spawnSync for safe command execution (no shell injection).\n */\nexport function cloneRepo(repoUrl: string, destPath: string): Result<void> {\n  const token = getTokenForRepo(repoUrl);\n  if (!token) {\n    return { success: false, error: `No token available for repo: ${repoUrl}` };\n  }\n\n  let cloneUrl = repoUrl;\n  if (cloneUrl.startsWith('https://github.com/')) {\n    cloneUrl = cloneUrl.replace('https://github.com/', `https://oauth2:${token}@github.com/`);\n  } else if (!cloneUrl.includes('@') && !cloneUrl.startsWith('https://')) {\n    const org = extractOrg(repoUrl);\n    const repoName = repoUrl.replace(`${org}/`, '');\n    cloneUrl = `https://oauth2:${token}@github.com/${org}/${repoName}.git`;\n  }\n\n  const proc = spawnSync('git', ['clone', cloneUrl, destPath], {\n    encoding: 'utf-8',\n    stdio: 'pipe',\n    timeout: 120000,\n  });\n\n  if (proc.error) {\n    return { success: false, error: `Git clone error: ${proc.error.message}` };\n  }\n\n  if (proc.status !== 0) {\n    const errorOutput = (proc.stderr || 'Unknown error').replace(\n      /oauth2:[^@]+@/g,\n      'oauth2:[REDACTED]@'\n    );\n    return { success: false, error: `Git clone failed: ${errorOutput}` };\n  }\n\n  return { success: true };\n}\n\n/**\n * Validate a git ref/branch name to prevent injection\n */\nexport function isValidGitRef(ref: string): boolean {\n  return /^[a-zA-Z0-9._/-]+$/.test(ref) && ref.length <= 200;\n}\n\n/**\n * Validate owner/repo format\n */\nexport function isValidRepoFormat(repo: string): boolean {\n  return /^[a-zA-Z0-9._-]+\\/[a-zA-Z0-9._-]+$/.test(repo) && repo.length <= 200;\n}\n\n// ============================================\n// Configuration Type Export\n// ============================================\n\nexport type { GitHubClientConfig as GitHubConfig };\n"]}