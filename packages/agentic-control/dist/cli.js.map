{"version":3,"sources":["../src/core/tokens.ts","../src/core/errors.ts","../src/core/validation.ts","../src/core/config.ts","../src/core/security.ts","../src/core/subprocess.ts","../src/github/client.ts","../src/core/providers.ts","../src/triage/analyzer.ts","../src/sandbox/container.ts","../src/sandbox/runtime/claude.ts","../src/sandbox/runtime/cursor.ts","../src/sandbox/runtime/index.ts","../src/sandbox/executor.ts","../src/sandbox/index.ts","../src/triage/resolver.ts","../src/triage/triage.ts","../src/cli.ts","../src/fleet/cursor-api.ts","../src/fleet/fleet.ts","../src/handoff/manager.ts","../src/core/index.ts","../src/github/index.ts","../src/actions/index.ts","../src/triage/index.ts","../src/triage/mcp-clients.ts","../src/triage/agent.ts","../src/triage/pr-triage-agent.ts","../src/triage/types.ts","../src/crews/types.ts","../src/pipelines/index.ts","../src/roles/defaults.ts","../src/roles/executor.ts","../src/index.ts"],"names":["config","loadEnvConfig","resolve","provider","z","spawnSync","randomUUID","anthropic","generateText","existsSync","writeFile","sanitizeError","join","FeedbackSeveritySchema","FeedbackItemSchema","CIStatusSchema","require","validateGitRef","writeFileSync","Triage","getOrLoadProvider","getTriageConfig","getTriageApiKey","SandboxExecutor","configPath"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA,SAAS,aAAA,GAAsB;AAC7B,EAAA,MAAM,UAAA,GAAa,kCAAA;AAEnB,EAAA,KAAA,MAAW,CAAC,KAAK,KAAK,CAAA,IAAK,OAAO,OAAA,CAAQ,OAAA,CAAQ,GAAG,CAAA,EAAG;AACtD,IAAA,MAAM,KAAA,GAAQ,GAAA,CAAI,KAAA,CAAM,UAAU,CAAA;AAClC,IAAA,IAAI,KAAA,GAAQ,CAAC,CAAA,IAAK,KAAA,EAAO;AAEvB,MAAA,MAAM,OAAA,GAAU,MAAM,CAAC,CAAA,CAAE,aAAY,CAAE,OAAA,CAAQ,MAAM,GAAG,CAAA;AACxD,MAAA,IAAI,CAAC,aAAA,CAAc,aAAA,CAAc,OAAO,CAAA,EAAG;AACzC,QAAA,aAAA,CAAc,aAAA,CAAc,OAAO,CAAA,GAAI;AAAA,UACrC,IAAA,EAAM,OAAA;AAAA,UACN,WAAA,EAAa;AAAA,SACf;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAGA,EAAA,IAAI,OAAA,CAAQ,IAAI,uBAAA,EAAyB;AACvC,IAAA,aAAA,CAAc,mBAAA,GAAsB,QAAQ,GAAA,CAAI,uBAAA;AAAA,EAClD;AAGA,EAAA,IAAI,OAAA,CAAQ,IAAI,qBAAA,EAAuB;AACrC,IAAA,aAAA,CAAc,kBAAA,GAAqB,QAAQ,GAAA,CAAI,qBAAA;AAAA,EACjD;AACF;AA2BO,SAAS,eAAeA,OAAAA,EAAoC;AACjE,EAAA,aAAA,GAAgB;AAAA,IACd,GAAG,aAAA;AAAA,IACH,GAAGA,OAAAA;AAAA,IACH,aAAA,EAAe;AAAA,MACb,GAAG,aAAA,CAAc,aAAA;AAAA,MACjB,GAAGA,OAAAA,CAAO;AAAA;AACZ,GACF;AACF;AA6CO,SAAS,WAAW,OAAA,EAAgC;AAEzD,EAAA,MAAM,QAAA,GAAW,OAAA,CAAQ,KAAA,CAAM,kCAAkC,CAAA;AACjE,EAAA,IAAI,QAAA,GAAW,CAAC,CAAA,EAAG;AACjB,IAAA,OAAO,SAAS,CAAC,CAAA;AAAA,EACnB;AAGA,EAAA,MAAM,UAAA,GAAa,OAAA,CAAQ,KAAA,CAAM,sBAAsB,CAAA;AACvD,EAAA,IAAI,UAAA,GAAa,CAAC,CAAA,EAAG;AACnB,IAAA,OAAO,WAAW,CAAC,CAAA;AAAA,EACrB;AAEA,EAAA,OAAO,IAAA;AACT;AAYO,SAAS,eAAe,GAAA,EAAqB;AAElD,EAAA,MAAMA,OAAAA,GAAS,aAAA,CAAc,aAAA,CAAc,GAAG,CAAA;AAC9C,EAAA,IAAIA,SAAQ,WAAA,EAAa;AACvB,IAAA,OAAOA,OAAAA,CAAO,WAAA;AAAA,EAChB;AAGA,EAAA,MAAM,QAAA,GAAW,IAAI,WAAA,EAAY;AACjC,EAAA,KAAA,MAAW,CAAC,KAAK,KAAK,CAAA,IAAK,OAAO,OAAA,CAAQ,aAAA,CAAc,aAAa,CAAA,EAAG;AACtE,IAAA,IAAI,GAAA,CAAI,WAAA,EAAY,KAAM,QAAA,IAAY,MAAM,WAAA,EAAa;AACvD,MAAA,OAAO,KAAA,CAAM,WAAA;AAAA,IACf;AAAA,EACF;AAEA,EAAA,OAAO,aAAA,CAAc,kBAAA;AACvB;AAQO,SAAS,eAAe,GAAA,EAAiC;AAC9D,EAAA,MAAM,MAAA,GAAS,eAAe,GAAG,CAAA;AACjC,EAAA,OAAO,OAAA,CAAQ,IAAI,MAAM,CAAA;AAC3B;AAcO,SAAS,gBAAgB,OAAA,EAAqC;AACnE,EAAA,MAAM,GAAA,GAAM,WAAW,OAAO,CAAA;AAC9B,EAAA,IAAI,CAAC,GAAA,EAAK;AACR,IAAA,OAAO,OAAA,CAAQ,GAAA,CAAI,aAAA,CAAc,kBAAkB,CAAA;AAAA,EACrD;AACA,EAAA,OAAO,eAAe,GAAG,CAAA;AAC3B;AAQO,SAAS,gBAAA,GAAuC;AACrD,EAAA,OAAO,OAAA,CAAQ,GAAA,CAAI,aAAA,CAAc,mBAAmB,CAAA;AACtD;AAmBO,SAAS,eAAe,IAAA,EAAmC;AAChE,EAAA,MAAM,UAAoB,EAAC;AAC3B,EAAA,MAAM,WAAA,GAAc,IAAA,IAAQ,MAAA,CAAO,IAAA,CAAK,cAAc,aAAa,CAAA;AAEnE,EAAA,KAAA,MAAW,OAAO,WAAA,EAAa;AAC7B,IAAA,MAAM,KAAA,GAAQ,eAAe,GAAG,CAAA;AAChC,IAAA,IAAI,CAAC,KAAA,EAAO;AACV,MAAA,MAAM,MAAA,GAAS,eAAe,GAAG,CAAA;AACjC,MAAA,OAAA,CAAQ,IAAA,CAAK,CAAA,EAAG,GAAG,CAAA,EAAA,EAAK,MAAM,CAAA,QAAA,CAAU,CAAA;AAAA,IAC1C;AAAA,EACF;AAGA,EAAA,IAAI,CAAC,kBAAiB,EAAG;AACvB,IAAA,OAAA,CAAQ,IAAA,CAAK,CAAA,WAAA,EAAc,aAAA,CAAc,mBAAmB,CAAA,QAAA,CAAU,CAAA;AAAA,EACxE;AAGA,EAAA,IAAI,CAAC,OAAA,CAAQ,GAAA,CAAI,aAAA,CAAc,kBAAkB,CAAA,EAAG;AAClD,IAAA,OAAA,CAAQ,IAAA,CAAK,CAAA,SAAA,EAAY,aAAA,CAAc,kBAAkB,CAAA,QAAA,CAAU,CAAA;AAAA,EACrE;AAEA,EAAA,OAAO;AAAA,IACL,OAAA,EAAS,QAAQ,MAAA,KAAW,CAAA;AAAA,IAC5B,IAAA,EAAM,OAAA;AAAA,IACN,KAAA,EAAO,QAAQ,MAAA,GAAS,CAAA,GAAI,mBAAmB,OAAA,CAAQ,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA,GAAK;AAAA,GACxE;AACF;AA6BO,SAAS,iBAAA,GAA8B;AAC5C,EAAA,OAAO,MAAA,CAAO,IAAA,CAAK,aAAA,CAAc,aAAa,CAAA;AAChD;AAqCO,SAAS,cAAc,OAAA,EAAyC;AACrE,EAAA,MAAM,KAAA,GAAQ,gBAAgB,OAAO,CAAA;AACrC,EAAA,IAAI,CAAC,KAAA,EAAO;AACV,IAAA,OAAO,EAAC;AAAA,EACV;AACA,EAAA,OAAO;AAAA,IACL,QAAA,EAAU,KAAA;AAAA,IACV,YAAA,EAAc;AAAA,GAChB;AACF;AAQO,SAAS,iBAAA,GAA4C;AAC1D,EAAA,MAAM,QAAQ,gBAAA,EAAiB;AAC/B,EAAA,IAAI,CAAC,KAAA,EAAO;AACV,IAAA,OAAO,EAAC;AAAA,EACV;AACA,EAAA,OAAO;AAAA,IACL,QAAA,EAAU,KAAA;AAAA,IACV,YAAA,EAAc;AAAA,GAChB;AACF;AAuBO,SAAS,eAAA,GAGd;AACA,EAAA,MAAM,UAAuF,EAAC;AAE9F,EAAA,KAAA,MAAW,GAAA,IAAO,mBAAkB,EAAG;AACrC,IAAA,MAAM,MAAA,GAAS,eAAe,GAAG,CAAA;AACjC,IAAA,OAAA,CAAQ,GAAG,CAAA,GAAI;AAAA,MACb,MAAA;AAAA,MACA,SAAA,EAAW,CAAC,CAAC,OAAA,CAAQ,IAAI,MAAM,CAAA;AAAA,MAC/B,UAAA,EAAY;AAAA,KACd;AAAA,EACF;AAEA,EAAA,OAAA,CAAQ,QAAA,GAAW;AAAA,IACjB,QAAQ,aAAA,CAAc,kBAAA;AAAA,IACtB,WAAW,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,cAAc,kBAAkB,CAAA;AAAA,IACzD,UAAA,EAAY;AAAA,GACd;AAEA,EAAA,OAAA,CAAQ,UAAA,GAAa;AAAA,IACnB,QAAQ,aAAA,CAAc,mBAAA;AAAA,IACtB,SAAA,EAAW,CAAC,CAAC,gBAAA,EAAiB;AAAA,IAC9B,UAAA,EAAY;AAAA,GACd;AAEA,EAAA,OAAO,OAAA;AACT;AAjcA,IA+CM,cAAA,EAMF,aAAA;AArDJ,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,oBAAA,GAAA;AA+CA,IAAM,cAAA,GAA8B;AAAA,MAClC,eAAe,EAAC;AAAA;AAAA,MAChB,kBAAA,EAAoB,cAAA;AAAA,MACpB,mBAAA,EAAqB;AAAA,KACvB;AAEA,IAAI,aAAA,GAA6B,EAAE,GAAG,cAAA,EAAe;AAe5C,IAAA,MAAA,CAAA,aAAA,EAAA,eAAA,CAAA;AA6BT,IAAA,aAAA,EAAc;AAwBE,IAAA,MAAA,CAAA,cAAA,EAAA,gBAAA,CAAA;AAsDA,IAAA,MAAA,CAAA,UAAA,EAAA,YAAA,CAAA;AA0BA,IAAA,MAAA,CAAA,cAAA,EAAA,gBAAA,CAAA;AAwBA,IAAA,MAAA,CAAA,cAAA,EAAA,gBAAA,CAAA;AAiBA,IAAA,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAcA,IAAA,MAAA,CAAA,gBAAA,EAAA,kBAAA,CAAA;AAqBA,IAAA,MAAA,CAAA,cAAA,EAAA,gBAAA,CAAA;AAwDA,IAAA,MAAA,CAAA,iBAAA,EAAA,mBAAA,CAAA;AAuCA,IAAA,MAAA,CAAA,aAAA,EAAA,eAAA,CAAA;AAiBA,IAAA,MAAA,CAAA,iBAAA,EAAA,mBAAA,CAAA;AAgCA,IAAA,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACrahB,IAoDa,kBAAA;AApDb,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,oBAAA,GAAA;AAoDO,IAAM,kBAAA,GAAN,cAAiC,KAAA,CAAM;AAAA,MAC5C,WAAA,CACE,OAAA,EACO,IAAA,EACA,KAAA,EACS,KAAA,EAChB;AACA,QAAA,KAAA,CAAM,OAAO,CAAA;AAJN,QAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AACA,QAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AACS,QAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AAGhB,QAAA,IAAA,CAAK,IAAA,GAAO,oBAAA;AAAA,MACd;AAAA,MA7DF;AAoD8C,QAAA,MAAA,CAAA,IAAA,EAAA,oBAAA,CAAA;AAAA;AAAA,KAU9C;AAAA,EAAA;AAAA,CAAA,CAAA;ACmBO,SAAS,eAAeA,OAAAA,EAAuB;AACpD,EAAA,IAAI;AACF,IAAA,mBAAA,CAAoB,MAAMA,OAAM,CAAA;AAAA,EAClC,SAAS,KAAA,EAAO;AACd,IAAA,IAAI,KAAA,YAAiB,EAAE,QAAA,EAAU;AAC/B,MAAA,MAAM,UAAA,GAAa,KAAA,CAAM,MAAA,CAAO,CAAC,CAAA;AACjC,MAAA,IAAI,UAAA,EAAY;AACd,QAAA,MAAM,KAAA,GAAQ,UAAA,CAAW,IAAA,CAAK,IAAA,CAAK,GAAG,CAAA;AACtC,QAAA,MAAM,OAAA,GAAU,CAAA,0BAAA,EAA6B,KAAK,CAAA,GAAA,EAAM,WAAW,OAAO,CAAA,CAAA;AAC1E,QAAA,MAAM,IAAI,kBAAA,CAAmB,OAAA,EAAA,gBAAA,uBAAyC,KAAK,CAAA;AAAA,MAC7E;AACA,MAAA,MAAM,IAAI,mBAAmB,uBAAA,EAAA,gBAAA,sBAAuD;AAAA,IACtF;AACA,IAAA,MAAM,KAAA;AAAA,EACR;AACF;AAhGA,IAWM,gBAKA,iBAAA,EAMA,iBAAA,EAMA,kBAAA,EAMA,qBAAA,EAUA,iBASA,kBAAA,EASO,mBAAA;AA9Db,IAAA,eAAA,GAAA,KAAA,CAAA;AAAA,EAAA,wBAAA,GAAA;AAKA,IAAA,WAAA,EAAA;AAMA,IAAM,cAAA,GAAiB,EAAE,MAAA,CAAO;AAAA,MAC9B,IAAA,EAAM,EAAE,MAAA,EAAO,CAAE,IAAI,CAAC,CAAA,CAAE,IAAI,EAAE,CAAA;AAAA,MAC9B,WAAA,EAAa,CAAA,CAAE,MAAA,EAAO,CAAE,IAAI,CAAC;AAAA,KAC9B,CAAA;AAED,IAAM,iBAAA,GAAoB,EAAE,MAAA,CAAO;AAAA,MACjC,aAAA,EAAe,EAAE,MAAA,CAAO,CAAA,CAAE,QAAO,EAAG,cAAc,EAAE,QAAA,EAAS;AAAA,MAC7D,kBAAA,EAAoB,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,MACxC,mBAAA,EAAqB,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAAS,KAC1C,CAAA;AAED,IAAM,iBAAA,GAAoB,EAAE,MAAA,CAAO;AAAA,MACjC,YAAA,EAAc,CAAA,CAAE,OAAA,EAAQ,CAAE,QAAA,EAAS;AAAA,MACnC,qBAAA,EAAuB,CAAA,CAAE,OAAA,EAAQ,CAAE,QAAA,EAAS;AAAA,MAC5C,mBAAA,EAAqB,CAAA,CAAE,OAAA,EAAQ,CAAE,QAAA;AAAS,KAC3C,CAAA;AAED,IAAM,kBAAA,GAAqB,EAAE,MAAA,CAAO;AAAA,MAClC,QAAA,EAAU,CAAA,CAAE,IAAA,CAAK,CAAC,WAAA,EAAa,QAAA,EAAU,QAAA,EAAU,SAAA,EAAW,OAAO,CAAC,CAAA,CAAE,QAAA,EAAS;AAAA,MACjF,KAAA,EAAO,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,MAC3B,YAAA,EAAc,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAAS,KACnC,CAAA;AAED,IAAM,qBAAA,GAAwB,EAAE,MAAA,CAAO;AAAA,MACrC,OAAA,EAAS,CAAA,CAAE,OAAA,EAAQ,CAAE,QAAA,EAAS;AAAA,MAC9B,WAAA,EAAa,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,MACjC,sBAAsB,CAAA,CAAE,KAAA,CAAM,EAAE,MAAA,EAAQ,EAAE,QAAA,EAAS;AAAA,MACnD,IAAA,EAAM,EAAE,IAAA,CAAK,CAAC,SAAS,OAAO,CAAC,EAAE,QAAA,EAAS;AAAA,MAC1C,OAAA,EAAS,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,MAC7B,MAAM,CAAA,CAAE,KAAA,CAAM,EAAE,MAAA,EAAQ,EAAE,QAAA,EAAS;AAAA,MACnC,UAAU,CAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,QAAA;AAAS,KACrC,CAAA;AAED,IAAM,eAAA,GAAkB,EACrB,MAAA,CAAO;AAAA,MACN,MAAA,EAAQ,sBAAsB,QAAA,EAAS;AAAA,MACvC,MAAA,EAAQ,sBAAsB,QAAA,EAAS;AAAA,MACvC,QAAA,EAAU,sBAAsB,QAAA,EAAS;AAAA,MACzC,YAAA,EAAc,sBAAsB,QAAA;AAAS,KAC9C,CAAA,CACA,QAAA,CAAS,qBAAqB,CAAA;AAEjC,IAAM,kBAAA,GAAqB,EAAE,MAAA,CAAO;AAAA,MAClC,YAAA,EAAc,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,MAClC,SAAS,CAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,QAAA;AAAS,KACpC,CAAA;AAMM,IAAM,mBAAA,GAAsB,EAAE,MAAA,CAAO;AAAA,MAC1C,MAAA,EAAQ,kBAAkB,QAAA,EAAS;AAAA,MACnC,iBAAA,EAAmB,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,MACvC,cAAA,EAAgB,EAAE,MAAA,EAAO,CAAE,KAAI,CAAE,QAAA,GAAW,QAAA,EAAS;AAAA,MACrD,QAAA,EAAU,CAAA,CAAE,IAAA,CAAK,CAAC,OAAA,EAAS,QAAQ,MAAA,EAAQ,OAAO,CAAC,CAAA,CAAE,QAAA,EAAS;AAAA,MAC9D,OAAA,EAAS,CAAA,CAAE,OAAA,EAAQ,CAAE,QAAA,EAAS;AAAA,MAC9B,MAAA,EAAQ,mBAAmB,QAAA,EAAS;AAAA,MACpC,KAAA,EAAO,kBAAkB,QAAA,EAAS;AAAA,MAClC,MAAA,EAAQ,mBAAmB,QAAA,EAAS;AAAA,MACpC,GAAA,EAAK,gBAAgB,QAAA;AAAS,KAC/B,CAAA;AASe,IAAA,MAAA,CAAA,cAAA,EAAA,gBAAA,CAAA;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACjFhB,IAAA,cAAA,GAAA,EAAA;AAAA,QAAA,CAAA,cAAA,EAAA;AAAA,EAAA,SAAA,EAAA,MAAA,SAAA;AAAA,EAAA,aAAA,EAAA,MAAA,aAAA;AAAA,EAAA,cAAA,EAAA,MAAA,cAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,sBAAA,EAAA,MAAA,sBAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,gBAAA,EAAA,MAAA,gBAAA;AAAA,EAAA,WAAA,EAAA,MAAA,WAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,UAAA,EAAA,MAAA,UAAA;AAAA,EAAA,SAAA,EAAA,MAAA,SAAA;AAAA,EAAA,kBAAA,EAAA,MAAA,kBAAA;AAAA,EAAA,GAAA,EAAA,MAAA,GAAA;AAAA,EAAA,WAAA,EAAA,MAAA,WAAA;AAAA,EAAA,SAAA,EAAA,MAAA;AAAA,CAAA,CAAA;AAgLA,SAASC,cAAAA,GAAwC;AAC/C,EAAA,MAAM,YAAoC,EAAC;AAG3C,EAAA,MAAM,gBAAuC,EAAC;AAC9C,EAAA,IAAI,OAAA,CAAQ,IAAI,aAAA,EAAe;AAC7B,IAAA,aAAA,CAAc,KAAA,GAAQ,QAAQ,GAAA,CAAI,aAAA;AAAA,EACpC;AACA,EAAA,IAAI,OAAA,CAAQ,IAAI,gBAAA,EAAkB;AAChC,IAAA,aAAA,CAAc,QAAA,GAAW,QAAQ,GAAA,CAAI,gBAAA;AAAA,EACvC;AACA,EAAA,IAAI,MAAA,CAAO,IAAA,CAAK,aAAa,CAAA,CAAE,SAAS,CAAA,EAAG;AACzC,IAAA,SAAA,CAAU,MAAA,GAAS,aAAA;AAAA,EACrB;AAEA,EAAA,IAAI,OAAA,CAAQ,IAAI,kBAAA,EAAoB;AAClC,IAAA,SAAA,CAAU,iBAAA,GAAoB,QAAQ,GAAA,CAAI,kBAAA;AAAA,EAC5C;AAEA,EAAA,IAAI,OAAA,CAAQ,IAAI,uBAAA,EAAyB;AACvC,IAAA,MAAM,SAAS,MAAA,CAAO,QAAA,CAAS,OAAA,CAAQ,GAAA,CAAI,yBAAyB,EAAE,CAAA;AACtE,IAAA,IAAI,CAAC,MAAA,CAAO,KAAA,CAAM,MAAM,CAAA,IAAK,SAAS,CAAA,EAAG;AACvC,MAAA,SAAA,CAAU,cAAA,GAAiB,MAAA;AAAA,IAC7B;AAAA,EACF;AAEA,EAAA,IAAI,OAAA,CAAQ,IAAI,iBAAA,EAAmB;AACjC,IAAA,MAAM,KAAA,GAAQ,OAAA,CAAQ,GAAA,CAAI,iBAAA,CAAkB,WAAA,EAAY;AACxD,IAAA,IAAI,CAAC,SAAS,MAAA,EAAQ,MAAA,EAAQ,OAAO,CAAA,CAAE,QAAA,CAAS,KAAK,CAAA,EAAG;AACtD,MAAA,SAAA,CAAU,QAAA,GAAW,KAAA;AAAA,IACvB;AAAA,EACF;AAEA,EAAA,IAAI,QAAQ,GAAA,CAAI,eAAA,KAAoB,UAAU,OAAA,CAAQ,GAAA,CAAI,oBAAoB,GAAA,EAAK;AACjF,IAAA,SAAA,CAAU,OAAA,GAAU,IAAA;AAAA,EACtB;AAEA,EAAA,OAAO,SAAA;AACT;AASA,SAAS,WAAA,CAAY,MAAqB,SAAA,EAAkD;AAC1F,EAAA,MAAM,MAAA,GAAS,EAAE,GAAG,IAAA,EAAK;AAEzB,EAAA,KAAA,MAAW,CAAC,GAAA,EAAK,KAAK,KAAK,MAAA,CAAO,OAAA,CAAQ,SAAS,CAAA,EAAG;AACpD,IAAA,IAAI,UAAU,MAAA,EAAW;AAEzB,IAAA,IAAI,OAAO,UAAU,QAAA,IAAY,KAAA,KAAU,QAAQ,CAAC,KAAA,CAAM,OAAA,CAAQ,KAAK,CAAA,EAAG;AACxE,MAAA,MAAM,SAAA,GAAa,KAAiC,GAAG,CAAA;AAEvD,MAAA,MAAM,OAAA,GACJ,OAAO,SAAA,KAAc,QAAA,IAAY,SAAA,KAAc,IAAA,IAAQ,CAAC,KAAA,CAAM,OAAA,CAAQ,SAAS,CAAA,GAC3E,SAAA,GACA,EAAC;AACP,MAAC,MAAA,CAAmC,GAAG,CAAA,GAAI;AAAA,QACzC,GAAG,OAAA;AAAA,QACH,GAAG;AAAA,OACL;AAAA,IACF,CAAA,MAAO;AACL,MAAC,MAAA,CAAmC,GAAG,CAAA,GAAI,KAAA;AAAA,IAC7C;AAAA,EACF;AAEA,EAAA,OAAO,MAAA;AACT;AAMO,SAAS,WAAW,SAAA,EAAmD;AAE5E,EAAA,MAAM,MAAA,GAAS,SAAS,MAAA,EAAO;AAE/B,EAAA,IAAI,MAAA,IAAU,CAAC,MAAA,CAAO,OAAA,EAAS;AAE7B,IAAA,cAAA,CAAe,OAAO,MAAM,CAAA;AAC5B,IAAA,MAAA,GAAS,MAAA,CAAO,MAAA;AAChB,IAAA,UAAA,GAAa,MAAA,CAAO,QAAA;AAAA,EACtB,CAAA,MAAO;AACL,IAAA,MAAA,GAAS,EAAC;AACV,IAAA,UAAA,GAAa,IAAA;AAAA,EACf;AAGA,EAAA,MAAM,YAAYA,cAAAA,EAAc;AAChC,EAAA,MAAA,GAAS,WAAA,CAAY,QAAQ,SAAS,CAAA;AAGtC,EAAA,IAAI,SAAA,EAAW;AACb,IAAA,MAAA,GAAS,WAAA,CAAY,QAAQ,SAAS,CAAA;AAAA,EACxC;AAGA,EAAA,cAAA,CAAe,MAAM,CAAA;AAGrB,EAAA,IAAI,OAAO,MAAA,EAAQ;AACjB,IAAA,cAAA,CAAe,OAAO,MAAM,CAAA;AAAA,EAC9B;AAEA,EAAA,YAAA,GAAe,IAAA;AACf,EAAA,OAAO,MAAA;AACT;AAKO,SAAS,mBAAmB,QAAA,EAAiC;AAClE,EAAA,MAAM,MAAA,GAAS,QAAA,CAAS,IAAA,CAAK,QAAQ,CAAA;AAErC,EAAA,IAAI,MAAA,IAAU,CAAC,MAAA,CAAO,OAAA,EAAS;AAE7B,IAAA,cAAA,CAAe,OAAO,MAAM,CAAA;AAC5B,IAAA,MAAA,GAAS,MAAA,CAAO,MAAA;AAChB,IAAA,UAAA,GAAa,MAAA,CAAO,QAAA;AAEpB,IAAA,IAAI,OAAO,MAAA,EAAQ;AACjB,MAAA,cAAA,CAAe,OAAO,MAAM,CAAA;AAAA,IAC9B;AAEA,IAAA,YAAA,GAAe,IAAA;AACf,IAAA,OAAO,MAAA;AAAA,EACT;AAEA,EAAA,MAAM,IAAI,KAAA,CAAM,CAAA,2BAAA,EAA8B,QAAQ,CAAA,CAAE,CAAA;AAC1D;AASO,SAAS,SAAA,GAA2B;AACzC,EAAA,IAAI,CAAC,YAAA,EAAc;AACjB,IAAA,UAAA,EAAW;AAAA,EACb;AACA,EAAA,OAAO,EAAE,GAAG,MAAA,EAAO;AACrB;AAKO,SAAS,aAAA,GAA+B;AAC7C,EAAA,OAAO,UAAA;AACT;AAKO,SAAS,UAAU,OAAA,EAAuC;AAC/D,EAAA,MAAA,GAAS,WAAA,CAAY,QAAQ,OAAO,CAAA;AAEpC,EAAA,IAAI,QAAQ,MAAA,EAAQ;AAClB,IAAA,cAAA,CAAe,QAAQ,MAAM,CAAA;AAAA,EAC/B;AACF;AAKO,SAAS,WAAA,GAAoB;AAClC,EAAA,MAAA,GAAS,EAAC;AACV,EAAA,YAAA,GAAe,KAAA;AACf,EAAA,UAAA,GAAa,IAAA;AACf;AAKO,SAAS,eAA8C,GAAA,EAA0B;AACtF,EAAA,IAAI,CAAC,YAAA,EAAc;AACjB,IAAA,UAAA,EAAW;AAAA,EACb;AACA,EAAA,OAAO,OAAO,GAAG,CAAA;AACnB;AAKO,SAAS,SAAA,GAAqB;AACnC,EAAA,OAAO,OAAO,OAAA,IAAW,KAAA;AAC3B;AAKO,SAAS,eAAA,GAAgC;AAC9C,EAAA,IAAI,CAAC,YAAA,EAAc;AACjB,IAAA,UAAA,EAAW;AAAA,EACb;AACA,EAAA,OACE,OAAO,MAAA,IAAU;AAAA,IACf,QAAA,EAAU,WAAA;AAAA,IACV,KAAA,EAAO,0BAAA;AAAA,IACP,YAAA,EAAc;AAAA,GAChB;AAEJ;AAMO,SAAS,eAAA,GAA0B;AACxC,EAAA,OAAO,eAAA,GAAkB,KAAA,IAAS,0BAAA;AACpC;AAKO,SAAS,gBAAA,GAAgC;AAC9C,EAAA,IAAI,CAAC,YAAA,EAAc;AACjB,IAAA,UAAA,EAAW;AAAA,EACb;AACA,EAAA,OAAO,MAAA,CAAO,SAAS,EAAC;AAC1B;AAKO,SAAS,WAAA,GAAsB;AACpC,EAAA,OAAO,OAAO,QAAA,IAAY,MAAA;AAC5B;AAKO,SAAS,eAAA,GAAsC;AACpD,EAAA,MAAM,MAAA,GAAS,MAAA,CAAO,MAAA,EAAQ,YAAA,IAAgB,gBAAA;AAC9C,EAAA,OAAO,OAAA,CAAQ,IAAI,MAAM,CAAA;AAC3B;AAKO,SAAS,uBAAuB,QAAA,EAA2B;AAChE,EAAA,QAAQ,QAAA;AAAU,IAChB,KAAK,QAAA;AACH,MAAA,OAAO,gBAAA;AAAA,IACT,KAAK,QAAA;AACH,MAAA,OAAO,gBAAA;AAAA,IACT,KAAK,SAAA;AACH,MAAA,OAAO,iBAAA;AAAA,IACT,KAAK,OAAA;AACH,MAAA,OAAO,eAAA;AAAA,IACT,KAAK,QAAA;AACH,MAAA,OAAO,gBAAA;AAAA,IACT;AACE,MAAA,OAAO,mBAAA;AAAA;AAEb;AAMO,SAAS,gBAAgB,gBAAA,EAA+C;AAC7E,EAAA,MAAM,eAAe,eAAA,EAAgB;AACrC,EAAA,MAAM,QAAA,GAAW,oBAAoB,YAAA,CAAa,QAAA;AAClD,EAAA,MAAM,MAAA,GAAS,YAAA,CAAa,YAAA,IAAgB,sBAAA,CAAuB,QAAQ,CAAA;AAC3E,EAAA,OAAO,OAAA,CAAQ,IAAI,MAAM,CAAA;AAC3B;AAaA,SAAS,UAAU,KAAA,EAAyC;AAC1D,EAAA,MAAM,YAAA,GAAe,UAAA,CAAW,WAAA,EAAwC,CAAA,IAAK,CAAA;AAC7E,EAAA,OAAO,UAAA,CAAW,KAAK,CAAA,IAAK,YAAA;AAC9B;AA9cA,IAwJM,WAAA,EAIA,QAAA,EAYF,MAAA,EACA,YAAA,EACA,YA0RE,UAAA,EAYO,GAAA;AAhdb,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,oBAAA,GAAA;AA+BA,IAAA,WAAA,EAAA;AAEA,IAAA,eAAA,EAAA;AAuHA,IAAM,WAAA,GAAc,SAAA;AAIpB,IAAM,QAAA,GAAW,gBAAgB,WAAA,EAAa;AAAA,MAC5C,YAAA,EAAc,CAAC,cAAA,EAAgB,qBAAA,EAAuB,cAAc,iBAAiB,CAAA;AAAA;AAAA,MAErF,OAAA,EAAS;AAAA,QACP,yBAAS,MAAA,CAAA,CAAC,SAAA,EAAmB,YAAoB,IAAA,CAAK,KAAA,CAAM,OAAO,CAAA,EAA1D,OAAA;AAAA;AACX,KACD,CAAA;AAMD,IAAI,SAAwB,EAAC;AAC7B,IAAI,YAAA,GAAe,KAAA;AACnB,IAAI,UAAA,GAA4B,IAAA;AAMvB,IAAA,MAAA,CAAAA,cAAAA,EAAA,eAAA,CAAA;AA+CA,IAAA,MAAA,CAAA,WAAA,EAAA,aAAA,CAAA;AA6BO,IAAA,MAAA,CAAA,UAAA,EAAA,YAAA,CAAA;AAsCA,IAAA,MAAA,CAAA,kBAAA,EAAA,oBAAA,CAAA;AA2BA,IAAA,MAAA,CAAA,SAAA,EAAA,WAAA,CAAA;AAUA,IAAA,MAAA,CAAA,aAAA,EAAA,eAAA,CAAA;AAOA,IAAA,MAAA,CAAA,SAAA,EAAA,WAAA,CAAA;AAWA,IAAA,MAAA,CAAA,WAAA,EAAA,aAAA,CAAA;AASA,IAAA,MAAA,CAAA,cAAA,EAAA,gBAAA,CAAA;AAUA,IAAA,MAAA,CAAA,SAAA,EAAA,WAAA,CAAA;AAOA,IAAA,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAiBA,IAAA,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAOA,IAAA,MAAA,CAAA,gBAAA,EAAA,kBAAA,CAAA;AAUA,IAAA,MAAA,CAAA,WAAA,EAAA,aAAA,CAAA;AAOA,IAAA,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAQA,IAAA,MAAA,CAAA,sBAAA,EAAA,wBAAA,CAAA;AAqBA,IAAA,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAWhB,IAAM,UAAA,GAAa;AAAA,MACjB,KAAA,EAAO,CAAA;AAAA,MACP,IAAA,EAAM,CAAA;AAAA,MACN,IAAA,EAAM,CAAA;AAAA,MACN,KAAA,EAAO;AAAA,KACT;AAES,IAAA,MAAA,CAAA,SAAA,EAAA,WAAA,CAAA;AAKF,IAAM,GAAA,GAAM;AAAA,MACjB,KAAA,6BAAW,IAAA,KAA0B;AACnC,QAAA,IAAI,SAAA,CAAU,OAAO,CAAA,EAAG;AACtB,UAAA,OAAA,CAAQ,KAAA,CAAM,iBAAA,EAAmB,GAAG,IAAI,CAAA;AAAA,QAC1C;AAAA,MACF,CAAA,EAJO,OAAA,CAAA;AAAA,MAKP,IAAA,6BAAU,IAAA,KAA0B;AAClC,QAAA,IAAI,SAAA,CAAU,MAAM,CAAA,EAAG;AACrB,UAAA,OAAA,CAAQ,GAAA,CAAI,gBAAA,EAAkB,GAAG,IAAI,CAAA;AAAA,QACvC;AAAA,MACF,CAAA,EAJM,MAAA,CAAA;AAAA,MAKN,IAAA,6BAAU,IAAA,KAA0B;AAClC,QAAA,IAAI,SAAA,CAAU,MAAM,CAAA,EAAG;AACrB,UAAA,OAAA,CAAQ,IAAA,CAAK,gBAAA,EAAkB,GAAG,IAAI,CAAA;AAAA,QACxC;AAAA,MACF,CAAA,EAJM,MAAA,CAAA;AAAA,MAKN,KAAA,6BAAW,IAAA,KAA0B;AACnC,QAAA,IAAI,SAAA,CAAU,OAAO,CAAA,EAAG;AACtB,UAAA,OAAA,CAAQ,KAAA,CAAM,iBAAA,EAAmB,GAAG,IAAI,CAAA;AAAA,QAC1C;AAAA,MACF,CAAA,EAJO,OAAA;AAAA,KAKT;AAAA,EAAA;AAAA,CAAA,CAAA;;;AC9dO,SAAS,cAAc,KAAA,EAA+B;AAC3D,EAAA,MAAM,OAAA,GAAU,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,KAAA;AAGzD,EAAA,MAAM,aAAA,GAAgB;AAAA;AAAA,IAEpB,6BAAA;AAAA;AAAA,IAEA,8BAAA;AAAA;AAAA,IAEA,4BAAA;AAAA;AAAA,IAEA,sBAAA;AAAA;AAAA,IAEA;AAAA,GACF;AAEA,EAAA,IAAI,SAAA,GAAY,OAAA;AAEhB,EAAA,KAAA,MAAW,WAAW,aAAA,EAAe;AACnC,IAAA,SAAA,GAAY,SAAA,CAAU,OAAA,CAAQ,OAAA,EAAS,kBAAkB,CAAA;AAAA,EAC3D;AAEA,EAAA,OAAO,SAAA;AACT;AA/BA,IAAA,aAAA,GAAA,KAAA,CAAA;AAAA,EAAA,sBAAA,GAAA;AAOgB,IAAA,MAAA,CAAA,aAAA,EAAA,eAAA,CAAA;AAAA,EAAA;AAAA,CAAA,CAAA;ACOT,SAAS,cACd,OAAA,EACA,IAAA,GAAiB,EAAC,EAClB,OAAA,GAA4B,EAAC,EAC8C;AAE3E,EAAA,IAAI,OAAO,OAAA,KAAY,QAAA,IAAY,OAAA,CAAQ,IAAA,OAAW,EAAA,EAAI;AACxD,IAAA,MAAM,IAAI,MAAM,oCAAoC,CAAA;AAAA,EACtD;AAEA,EAAA,IAAI,CAAC,KAAA,CAAM,OAAA,CAAQ,IAAI,CAAA,EAAG;AACxB,IAAA,MAAM,IAAI,MAAM,4BAA4B,CAAA;AAAA,EAC9C;AAGA,EAAA,MAAM,WAAA,GAAgC;AAAA,IACpC,GAAG,OAAA;AAAA,IACH,KAAA,EAAO,KAAA;AAAA;AAAA,IACP,QAAA,EAAU;AAAA,GACZ;AAEA,EAAA,IAAI;AACF,IAAA,MAAM,MAAA,GAAS,SAAA,CAAU,OAAA,EAAS,IAAA,EAAM,WAAW,CAAA;AAEnD,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,OAAO,MAAA,KAAW,CAAA;AAAA,MAC3B,MAAA,EAAQ,MAAA,CAAO,MAAA,EAAQ,QAAA,EAAS,IAAK,EAAA;AAAA,MACrC,MAAA,EAAQ,MAAA,CAAO,MAAA,EAAQ,QAAA,EAAS,IAAK,EAAA;AAAA,MACrC,MAAM,MAAA,CAAO;AAAA,KACf;AAAA,EACF,SAAS,KAAA,EAAO;AACd,IAAA,MAAM,cAAA,GAAiB,cAAc,KAAA,YAAiB,KAAA,GAAQ,MAAM,OAAA,GAAU,MAAA,CAAO,KAAK,CAAC,CAAA;AAC3F,IAAA,MAAM,IAAI,KAAA,CAAM,CAAA,0BAAA,EAA6B,cAAc,CAAA,CAAE,CAAA;AAAA,EAC/D;AACF;AAKO,SAAS,UACd,OAAA,EACA,IAAA,GAAiB,EAAC,EAClB,OAAA,GAAwB,EAAC,EAC2D;AACpF,EAAA,OAAO,IAAI,OAAA,CAAQ,CAACC,QAAAA,EAAS,MAAA,KAAW;AAEtC,IAAA,IAAI,OAAO,OAAA,KAAY,QAAA,IAAY,OAAA,CAAQ,IAAA,OAAW,EAAA,EAAI;AACxD,MAAA,MAAA,CAAO,IAAI,KAAA,CAAM,oCAAoC,CAAC,CAAA;AACtD,MAAA;AAAA,IACF;AAEA,IAAA,IAAI,CAAC,KAAA,CAAM,OAAA,CAAQ,IAAI,CAAA,EAAG;AACxB,MAAA,MAAA,CAAO,IAAI,KAAA,CAAM,4BAA4B,CAAC,CAAA;AAC9C,MAAA;AAAA,IACF;AAGA,IAAA,MAAM,WAAA,GAA4B;AAAA,MAChC,GAAG,OAAA;AAAA,MACH,KAAA,EAAO;AAAA;AAAA,KACT;AAEA,IAAA,MAAM,KAAA,GAAQ,KAAA,CAAM,OAAA,EAAS,IAAA,EAAM,WAAW,CAAA;AAE9C,IAAA,IAAI,MAAA,GAAS,EAAA;AACb,IAAA,IAAI,MAAA,GAAS,EAAA;AAEb,IAAA,KAAA,CAAM,MAAA,EAAQ,EAAA,CAAG,MAAA,EAAQ,CAAC,IAAA,KAAS;AACjC,MAAA,MAAA,IAAU,KAAK,QAAA,EAAS;AAAA,IAC1B,CAAC,CAAA;AAED,IAAA,KAAA,CAAM,MAAA,EAAQ,EAAA,CAAG,MAAA,EAAQ,CAAC,IAAA,KAAS;AACjC,MAAA,MAAA,IAAU,KAAK,QAAA,EAAS;AAAA,IAC1B,CAAC,CAAA;AAED,IAAA,KAAA,CAAM,EAAA,CAAG,OAAA,EAAS,CAAC,IAAA,KAAS;AAC1B,MAAAA,QAAAA,CAAQ;AAAA,QACN,SAAS,IAAA,KAAS,CAAA;AAAA,QAClB,MAAA;AAAA,QACA,MAAA;AAAA,QACA;AAAA,OACD,CAAA;AAAA,IACH,CAAC,CAAA;AAED,IAAA,KAAA,CAAM,EAAA,CAAG,OAAA,EAAS,CAAC,KAAA,KAAU;AAC3B,MAAA,MAAM,cAAA,GAAiB,aAAA,CAAc,KAAA,CAAM,OAAO,CAAA;AAClD,MAAA,MAAA,CAAO,IAAI,KAAA,CAAM,CAAA,0BAAA,EAA6B,cAAc,EAAE,CAAC,CAAA;AAAA,IACjE,CAAC,CAAA;AAAA,EACH,CAAC,CAAA;AACH;AAKO,SAAS,oBAAoB,IAAA,EAAsB;AACxD,EAAA,KAAA,MAAW,OAAO,IAAA,EAAM;AACtB,IAAA,IAAI,OAAO,QAAQ,QAAA,EAAU;AAC3B,MAAA,MAAM,IAAI,MAAM,uCAAuC,CAAA;AAAA,IACzD;AAGA,IAAA,IAAI,IAAI,QAAA,CAAS,IAAI,KAAK,GAAA,CAAI,QAAA,CAAS,IAAI,CAAA,EAAG;AAC5C,MAAA,MAAM,IAAI,MAAM,qDAAqD,CAAA;AAAA,IACvE;AAGA,IAAA,IAAI,GAAA,CAAI,QAAA,CAAS,IAAI,CAAA,EAAG;AACtB,MAAA,MAAM,IAAI,MAAM,6CAA6C,CAAA;AAAA,IAC/D;AAAA,EACF;AACF;AAKO,SAAS,cAAA,CAAe,IAAA,EAAgB,OAAA,GAA4B,EAAC,EAAG;AAE7E,EAAA,mBAAA,CAAoB,IAAI,CAAA;AAGxB,EAAA,MAAM,kBAAA,GAAqB;AAAA,IACzB,MAAA;AAAA,IACA,KAAA;AAAA,IACA,MAAA;AAAA,IACA,QAAA;AAAA,IACA,QAAA;AAAA,IACA,QAAA;AAAA,IACA,QAAA;AAAA,IACA,WAAA;AAAA,IACA,WAAA;AAAA,IACA,OAAA;AAAA,IACA,MAAA;AAAA,IACA,MAAA;AAAA,IACA,OAAA;AAAA,IACA,UAAA;AAAA,IACA,OAAA;AAAA,IACA,QAAA;AAAA,IACA,QAAA;AAAA,IACA,KAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,MAAM,QAAA,GAAW,KAAK,CAAC,CAAA;AACvB,EAAA,IAAI,CAAC,QAAA,IAAY,CAAC,kBAAA,CAAmB,QAAA,CAAS,QAAQ,CAAA,EAAG;AACvD,IAAA,MAAM,IAAI,KAAA,CAAM,CAAA,yBAAA,EAA4B,QAAA,IAAY,SAAS,CAAA,CAAE,CAAA;AAAA,EACrE;AAEA,EAAA,OAAO,aAAA,CAAc,KAAA,EAAO,IAAA,EAAM,OAAO,CAAA;AAC3C;AAKO,SAAS,iBAAA,CAAkB,IAAA,EAAgB,OAAA,GAA4B,EAAC,EAAG;AAEhF,EAAA,mBAAA,CAAoB,IAAI,CAAA;AAGxB,EAAA,MAAM,qBAAA,GAAwB;AAAA,IAC5B,OAAA;AAAA,IACA,KAAA;AAAA,IACA,MAAA;AAAA,IACA,IAAA;AAAA,IACA,QAAA;AAAA,IACA,MAAA;AAAA,IACA,MAAA;AAAA,IACA,OAAA;AAAA,IACA,MAAA;AAAA,IACA,SAAA;AAAA,IACA,IAAA;AAAA,IACA,KAAA;AAAA,IACA,MAAA;AAAA,IACA,SAAA;AAAA,IACA,QAAA;AAAA,IACA,IAAA;AAAA,IACA,OAAA;AAAA,IACA,KAAA;AAAA,IACA,SAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,MAAM,QAAA,GAAW,KAAK,CAAC,CAAA;AACvB,EAAA,IAAI,CAAC,QAAA,IAAY,CAAC,qBAAA,CAAsB,QAAA,CAAS,QAAQ,CAAA,EAAG;AAC1D,IAAA,MAAM,IAAI,KAAA,CAAM,CAAA,4BAAA,EAA+B,QAAA,IAAY,SAAS,CAAA,CAAE,CAAA;AAAA,EACxE;AAEA,EAAA,OAAO,aAAA,CAAc,QAAA,EAAU,IAAA,EAAM,OAAO,CAAA;AAC9C;AAzMA,IAAA,eAAA,GAAA,KAAA,CAAA;AAAA,EAAA,wBAAA,GAAA;AAKA,IAAA,aAAA,EAAA;AASgB,IAAA,MAAA,CAAA,aAAA,EAAA,eAAA,CAAA;AAuCA,IAAA,MAAA,CAAA,SAAA,EAAA,WAAA,CAAA;AAuDA,IAAA,MAAA,CAAA,mBAAA,EAAA,qBAAA,CAAA;AAqBA,IAAA,MAAA,CAAA,cAAA,EAAA,gBAAA,CAAA;AAsCA,IAAA,MAAA,CAAA,iBAAA,EAAA,mBAAA,CAAA;AAAA,EAAA;AAAA,CAAA,CAAA;ACxIhB,SAAS,WAAW,KAAA,EAAwB;AAC1C,EAAA,IAAI,OAAA,GAAU,YAAA,CAAa,GAAA,CAAI,KAAK,CAAA;AACpC,EAAA,IAAI,CAAC,OAAA,EAAS;AACZ,IAAA,OAAA,GAAU,IAAI,OAAA,CAAQ,EAAE,IAAA,EAAM,OAAO,CAAA;AACrC,IAAA,YAAA,CAAa,GAAA,CAAI,OAAO,OAAO,CAAA;AAAA,EACjC;AACA,EAAA,OAAO,OAAA;AACT;AAtCA,IA6BM,YAAA,EA4BO,YAAA;AAzDb,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,sBAAA,GAAA;AAcA,IAAA,WAAA,EAAA;AACA,IAAA,WAAA,EAAA;AAcA,IAAM,YAAA,uBAAmB,GAAA,EAAqB;AAErC,IAAA,MAAA,CAAA,UAAA,EAAA,YAAA,CAAA;AA0BF,IAAM,YAAA,GAAN,MAAM,aAAA,CAAa;AAAA,MAzD1B;AAyD0B,QAAA,MAAA,CAAA,IAAA,EAAA,cAAA,CAAA;AAAA;AAAA,MAChB,KAAA;AAAA,MACA,KAAA;AAAA,MACA,IAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASR,WAAA,CAAYF,OAAAA,GAA6B,EAAC,EAAG;AAC3C,QAAA,IAAA,CAAK,KAAA,GAAQA,QAAO,KAAA,IAAS,IAAA;AAC7B,QAAA,IAAA,CAAK,KAAA,GAAQA,QAAO,KAAA,IAAS,IAAA;AAC7B,QAAA,IAAA,CAAK,IAAA,GAAOA,QAAO,IAAA,IAAQ,IAAA;AAAA,MAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUA,OAAO,QAAQ,OAAA,EAAiC;AAC9C,QAAA,MAAM,KAAA,GAAQ,gBAAgB,OAAO,CAAA;AACrC,QAAA,IAAI,CAAC,KAAA,EAAO;AACV,UAAA,GAAA,CAAI,IAAA,CAAK,CAAA,6BAAA,EAAgC,OAAO,CAAA,CAAE,CAAA;AAClD,UAAA,OAAO,IAAA;AAAA,QACT;AACA,QAAA,OAAO,WAAW,KAAK,CAAA;AAAA,MACzB;AAAA;AAAA;AAAA;AAAA;AAAA,MAMA,OAAO,WAAA,GAA8B;AACnC,QAAA,MAAM,QAAQ,gBAAA,EAAiB;AAC/B,QAAA,IAAI,CAAC,KAAA,EAAO;AACV,UAAA,GAAA,CAAI,KAAK,8BAA8B,CAAA;AACvC,UAAA,OAAO,IAAA;AAAA,QACT;AACA,QAAA,OAAO,WAAW,KAAK,CAAA;AAAA,MACzB;AAAA;AAAA;AAAA;AAAA,MAMQ,kBAAA,GAA8B;AACpC,QAAA,IAAI,KAAK,KAAA,EAAO;AACd,UAAA,OAAO,UAAA,CAAW,KAAK,KAAK,CAAA;AAAA,QAC9B;AACA,QAAA,IAAI,IAAA,CAAK,KAAA,IAAS,IAAA,CAAK,IAAA,EAAM;AAC3B,UAAA,MAAM,OAAA,GAAU,cAAa,OAAA,CAAQ,CAAA,EAAG,KAAK,KAAK,CAAA,CAAA,EAAI,IAAA,CAAK,IAAI,CAAA,CAAE,CAAA;AACjE,UAAA,IAAI,CAAC,OAAA,EAAS;AACZ,YAAA,MAAM,IAAI,MAAM,CAAA,uBAAA,EAA0B,IAAA,CAAK,KAAK,CAAA,CAAA,EAAI,IAAA,CAAK,IAAI,CAAA,CAAE,CAAA;AAAA,UACrE;AACA,UAAA,OAAO,OAAA;AAAA,QACT;AACA,QAAA,MAAM,IAAI,MAAM,kDAAkD,CAAA;AAAA,MACpE;AAAA,MAEQ,UAAA,GAA8C;AACpD,QAAA,IAAI,CAAC,IAAA,CAAK,KAAA,IAAS,CAAC,KAAK,IAAA,EAAM;AAC7B,UAAA,MAAM,IAAI,MAAM,gDAAgD,CAAA;AAAA,QAClE;AACA,QAAA,OAAO,EAAE,KAAA,EAAO,IAAA,CAAK,KAAA,EAAO,IAAA,EAAM,KAAK,IAAA,EAAK;AAAA,MAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,aAAa,OAAA,CAAQ,KAAA,EAAe,IAAA,EAA2C;AAC7E,QAAA,MAAM,UAAU,aAAA,CAAa,OAAA,CAAQ,GAAG,KAAK,CAAA,CAAA,EAAI,IAAI,CAAA,CAAE,CAAA;AACvD,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,wCAAA,EAAyC;AAAA,QAC3E;AAEA,QAAA,IAAI;AACF,UAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,GAAA,CAAI,EAAE,KAAA,EAAO,IAAA,EAAM,CAAA;AACxD,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,IAAA,EAAM;AAAA,cACJ,KAAA,EAAO,KAAK,KAAA,CAAM,KAAA;AAAA,cAClB,MAAM,IAAA,CAAK,IAAA;AAAA,cACX,UAAU,IAAA,CAAK,SAAA;AAAA,cACf,eAAe,IAAA,CAAK,cAAA;AAAA,cACpB,WAAW,IAAA,CAAK,OAAA;AAAA,cAChB,KAAK,IAAA,CAAK;AAAA;AACZ,WACF;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,QAChD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,aAAa,YAAA,CACX,GAAA,EACA,OAAA,EAI+B;AAC/B,QAAA,MAAM,OAAA,GAAU,aAAA,CAAa,OAAA,CAAQ,CAAA,EAAG,GAAG,CAAA,IAAA,CAAM,CAAA;AACjD,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,CAAA,4BAAA,EAA+B,GAAG,CAAA,CAAA,EAAG;AAAA,QACvE;AAEA,QAAA,IAAI;AACF,UAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,UAAA,CAAW;AAAA,YAC9C,GAAA;AAAA,YACA,IAAA,EAAM,SAAS,IAAA,IAAQ,KAAA;AAAA,YACvB,QAAA,EAAU,SAAS,OAAA,IAAW;AAAA,WAC/B,CAAA;AAED,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,IAAA,EAAM,IAAA,CAAK,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,cACrB,KAAA,EAAO,EAAE,KAAA,CAAM,KAAA;AAAA,cACf,MAAM,CAAA,CAAE,IAAA;AAAA,cACR,UAAU,CAAA,CAAE,SAAA;AAAA,cACZ,aAAA,EAAe,EAAE,cAAA,IAAkB,MAAA;AAAA,cACnC,WAAW,CAAA,CAAE,OAAA;AAAA,cACb,KAAK,CAAA,CAAE;AAAA,aACT,CAAE;AAAA,WACJ;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,QAChD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,aAAa,WAAA,CACX,KAAA,EACA,IAAA,EACA,QAAA,EAC8B;AAC9B,QAAA,MAAM,UAAU,aAAA,CAAa,OAAA,CAAQ,GAAG,KAAK,CAAA,CAAA,EAAI,IAAI,CAAA,CAAE,CAAA;AACvD,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,wCAAA,EAAyC;AAAA,QAC3E;AAEA,QAAA,IAAI;AACF,UAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,KAAA,CAAM,GAAA,CAAI,EAAE,KAAA,EAAO,IAAA,EAAM,WAAA,EAAa,QAAA,EAAU,CAAA;AAC/E,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,IAAA,EAAM;AAAA,cACJ,QAAQ,IAAA,CAAK,MAAA;AAAA,cACb,OAAO,IAAA,CAAK,KAAA;AAAA,cACZ,IAAA,EAAM,KAAK,IAAA,IAAQ,KAAA,CAAA;AAAA,cACnB,OAAO,IAAA,CAAK,KAAA;AAAA,cACZ,KAAA,EAAO,KAAK,KAAA,IAAS,KAAA;AAAA,cACrB,KAAK,IAAA,CAAK,QAAA;AAAA,cACV,UAAA,EAAY,KAAK,IAAA,CAAK,GAAA;AAAA,cACtB,UAAA,EAAY,KAAK,IAAA,CAAK,GAAA;AAAA,cACtB,MAAA,EAAQ,IAAA,CAAK,IAAA,EAAM,KAAA,IAAS;AAAA;AAC9B,WACF;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,QAChD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,MAAM,QAAA,EAAkB;AAC5B,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AACxC,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,GAAA,CAAI;AAAA,UACvC,KAAA;AAAA,UACA,IAAA;AAAA,UACA,WAAA,EAAa;AAAA,SACd,CAAA;AACD,QAAA,OAAO,IAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,WAAW,QAAA,EAAkB;AACjC,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AACxC,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,SAAA,CAAU;AAAA,UAC7C,KAAA;AAAA,UACA,IAAA;AAAA,UACA,WAAA,EAAa;AAAA,SACd,CAAA;AACD,QAAA,OAAO,IAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAKA,aAAa,QAAA,CACX,KAAA,EACA,IAAA,EACA,OAAA,EAO8B;AAC9B,QAAA,MAAM,UAAU,aAAA,CAAa,OAAA,CAAQ,GAAG,KAAK,CAAA,CAAA,EAAI,IAAI,CAAA,CAAE,CAAA;AACvD,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,wCAAA,EAAyC;AAAA,QAC3E;AAEA,QAAA,IAAI;AACF,UAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,MAAA,CAAO;AAAA,YAC1C,KAAA;AAAA,YACA,IAAA;AAAA,YACA,OAAO,OAAA,CAAQ,KAAA;AAAA,YACf,MAAM,OAAA,CAAQ,IAAA;AAAA,YACd,MAAM,OAAA,CAAQ,IAAA;AAAA,YACd,MAAM,OAAA,CAAQ,IAAA;AAAA,YACd,OAAO,OAAA,CAAQ;AAAA,WAChB,CAAA;AAED,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,IAAA,EAAM;AAAA,cACJ,QAAQ,IAAA,CAAK,MAAA;AAAA,cACb,OAAO,IAAA,CAAK,KAAA;AAAA,cACZ,IAAA,EAAM,KAAK,IAAA,IAAQ,KAAA,CAAA;AAAA,cACnB,OAAO,IAAA,CAAK,KAAA;AAAA,cACZ,KAAA,EAAO,KAAK,KAAA,IAAS,KAAA;AAAA,cACrB,KAAK,IAAA,CAAK,QAAA;AAAA,cACV,UAAA,EAAY,KAAK,IAAA,CAAK,GAAA;AAAA,cACtB,UAAA,EAAY,KAAK,IAAA,CAAK,GAAA;AAAA,cACtB,MAAA,EAAQ,IAAA,CAAK,IAAA,EAAM,KAAA,IAAS;AAAA;AAC9B,WACF;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,QAChD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,aAAa,aAAA,CACX,KAAA,EACA,IAAA,EACA,UACA,OAAA,EAKuB;AACvB,QAAA,MAAM,UAAU,aAAA,CAAa,OAAA,CAAQ,GAAG,KAAK,CAAA,CAAA,EAAI,IAAI,CAAA,CAAE,CAAA;AACvD,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,wCAAA,EAAyC;AAAA,QAC3E;AAEA,QAAA,IAAI;AACF,UAAA,MAAM,OAAA,CAAQ,MAAM,KAAA,CAAM;AAAA,YACxB,KAAA;AAAA,YACA,IAAA;AAAA,YACA,WAAA,EAAa,QAAA;AAAA,YACb,YAAA,EAAc,SAAS,WAAA,IAAe,QAAA;AAAA,YACtC,cAAc,OAAA,EAAS,WAAA;AAAA,YACvB,gBAAgB,OAAA,EAAS;AAAA,WAC1B,CAAA;AAED,UAAA,OAAO,EAAE,SAAS,IAAA,EAAK;AAAA,QACzB,SAAS,KAAA,EAAO;AACd,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,QAChD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,OAAA,CAAQ,QAAA,EAAkB,MAAA,GAAwC,QAAA,EAAU;AAChF,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AACxC,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,KAAA,CAAM;AAAA,UACzC,KAAA;AAAA,UACA,IAAA;AAAA,UACA,WAAA,EAAa,QAAA;AAAA,UACb,YAAA,EAAc;AAAA,SACf,CAAA;AACD,QAAA,OAAO,IAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,WAAW,QAAA,EAAkB;AACjC,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AACxC,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,WAAA,CAAY;AAAA,UAC/C,KAAA;AAAA,UACA,IAAA;AAAA,UACA,WAAA,EAAa;AAAA,SACd,CAAA;AACD,QAAA,OAAO,IAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,kBAAkB,QAAA,EAAkB;AACxC,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AACxC,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,kBAAA,CAAmB;AAAA,UACtD,KAAA;AAAA,UACA,IAAA;AAAA,UACA,WAAA,EAAa;AAAA,SACd,CAAA;AACD,QAAA,OAAO,IAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,iBAAiB,QAAA,EAAkB;AACvC,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AACxC,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,OAAO,YAAA,CAAa;AAAA,UACjD,KAAA;AAAA,UACA,IAAA;AAAA,UACA,YAAA,EAAc;AAAA,SACf,CAAA;AACD,QAAA,OAAO,IAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAKA,aAAa,cAAA,CACX,KAAA,EACA,IAAA,EACA,QAAA,EAC8B;AAC9B,QAAA,MAAM,UAAU,aAAA,CAAa,OAAA,CAAQ,GAAG,KAAK,CAAA,CAAA,EAAI,IAAI,CAAA,CAAE,CAAA;AACvD,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,wCAAA,EAAyC;AAAA,QAC3E;AAEA,QAAA,IAAI;AACF,UAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,OAAO,YAAA,CAAa;AAAA,YACjD,KAAA;AAAA,YACA,IAAA;AAAA,YACA,YAAA,EAAc,QAAA;AAAA,YACd,QAAA,EAAU;AAAA,WACX,CAAA;AAED,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,IAAA,EAAM,IAAA,CAAK,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,cACrB,IAAI,CAAA,CAAE,EAAA;AAAA,cACN,IAAA,EAAM,EAAE,IAAA,IAAQ,EAAA;AAAA,cAChB,MAAA,EAAQ,CAAA,CAAE,IAAA,EAAM,KAAA,IAAS,SAAA;AAAA,cACzB,WAAW,CAAA,CAAE,UAAA;AAAA,cACb,WAAW,CAAA,CAAE;AAAA,aACf,CAAE;AAAA,WACJ;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,QAChD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,aAAa,aAAA,CACX,KAAA,EACA,IAAA,EACA,UACA,IAAA,EAC4B;AAC5B,QAAA,MAAM,OAAA,GAAU,cAAa,WAAA,EAAY;AACzC,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,8BAAA,EAA+B;AAAA,QACjE;AAEA,QAAA,IAAI;AACF,UAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,OAAO,aAAA,CAAc;AAAA,YAClD,KAAA;AAAA,YACA,IAAA;AAAA,YACA,YAAA,EAAc,QAAA;AAAA,YACd;AAAA,WACD,CAAA;AAED,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,IAAA,EAAM;AAAA,cACJ,IAAI,IAAA,CAAK,EAAA;AAAA,cACT,IAAA,EAAM,KAAK,IAAA,IAAQ,EAAA;AAAA,cACnB,MAAA,EAAQ,IAAA,CAAK,IAAA,EAAM,KAAA,IAAS,SAAA;AAAA,cAC5B,WAAW,IAAA,CAAK,UAAA;AAAA,cAChB,WAAW,IAAA,CAAK;AAAA;AAClB,WACF;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,QAChD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,WAAA,CAAY,QAAA,EAAkB,IAAA,EAAc;AAChD,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AACxC,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,OAAO,aAAA,CAAc;AAAA,UAClD,KAAA;AAAA,UACA,IAAA;AAAA,UACA,YAAA,EAAc,QAAA;AAAA,UACd;AAAA,SACD,CAAA;AACD,QAAA,OAAO,IAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,cAAA,CAAe,QAAA,EAAkB,SAAA,EAAmB,IAAA,EAAc;AACtE,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AACxC,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,OAAA,CAAQ,MAAM,2BAAA,CAA4B;AAAA,UAC/D,KAAA;AAAA,UACA,IAAA;AAAA,UACA,WAAA,EAAa,QAAA;AAAA,UACb,UAAA,EAAY,SAAA;AAAA,UACZ;AAAA,SACD,CAAA;AACD,QAAA,OAAO,IAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAKA,aAAa,aAAA,CACX,KAAA,EACA,IAAA,EACA,UACA,SAAA,EACuB;AACvB,QAAA,MAAM,OAAA,GAAU,cAAa,WAAA,EAAY;AACzC,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,8BAAA,EAA+B;AAAA,QACjE;AAEA,QAAA,IAAI;AACF,UAAA,MAAM,OAAA,CAAQ,MAAM,gBAAA,CAAiB;AAAA,YACnC,KAAA;AAAA,YACA,IAAA;AAAA,YACA,WAAA,EAAa,QAAA;AAAA,YACb;AAAA,WACD,CAAA;AAED,UAAA,OAAO,EAAE,SAAS,IAAA,EAAK;AAAA,QACzB,SAAS,KAAA,EAAO;AACd,UAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,QAChD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,YAAY,QAAA,EAAqC;AACrD,QAAA,MAAM,EAAE,KAAA,EAAO,IAAA,EAAK,GAAI,KAAK,UAAA,EAAW;AACxC,QAAA,MAAM,OAAA,GAAU,KAAK,kBAAA,EAAmB;AAExC,QAAA,MAAM,EAAA,GAAK,MAAM,IAAA,CAAK,KAAA,CAAM,QAAQ,CAAA;AACpC,QAAA,MAAM,GAAA,GAAM,GAAG,IAAA,CAAK,GAAA;AAEpB,QAAA,MAAM,EAAE,IAAA,EAAM,SAAA,KAAc,MAAM,OAAA,CAAQ,OAAO,UAAA,CAAW;AAAA,UAC1D,KAAA;AAAA,UACA,IAAA;AAAA,UACA;AAAA,SACD,CAAA;AAED,QAAA,MAAM,MAAA,GAAoB,SAAA,CAAU,UAAA,CAAW,GAAA,CAAI,CAAC,GAAA,MAAS;AAAA,UAC3D,MAAM,GAAA,CAAI,IAAA;AAAA,UACV,QAAQ,IAAA,CAAK,cAAA,CAAe,GAAA,CAAI,MAAA,EAAQ,IAAI,UAAU,CAAA;AAAA,UACtD,YAAY,GAAA,CAAI,UAAA;AAAA,UAChB,GAAA,EAAK,IAAI,QAAA,IAAY,EAAA;AAAA,UACrB,WAAW,GAAA,CAAI,UAAA;AAAA,UACf,aAAa,GAAA,CAAI;AAAA,SACnB,CAAE,CAAA;AAEF,QAAA,MAAM,WAAW,MAAA,CAAO,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,CAAE,WAAW,SAAS,CAAA;AAC5D,QAAA,MAAM,OAAA,GAAU,MAAA,CAAO,MAAA,CAAO,CAAC,CAAA,KAAM,EAAE,MAAA,KAAW,SAAA,IAAa,CAAA,CAAE,MAAA,KAAW,aAAa,CAAA;AAEzF,QAAA,OAAO;AAAA,UACL,UAAA,EAAY,QAAA,CAAS,MAAA,KAAW,CAAA,IAAK,QAAQ,MAAA,KAAW,CAAA;AAAA,UACxD,UAAA,EAAY,QAAQ,MAAA,GAAS,CAAA;AAAA,UAC7B,MAAA;AAAA,UACA;AAAA,SACF;AAAA,MACF;AAAA,MAEQ,cAAA,CAAe,QAAgB,UAAA,EAA8C;AACnF,QAAA,IAAI,MAAA,KAAW,QAAA,IAAY,MAAA,KAAW,SAAA,EAAW,OAAO,SAAA;AACxD,QAAA,IAAI,MAAA,KAAW,eAAe,OAAO,aAAA;AACrC,QAAA,IAAI,UAAA,KAAe,WAAW,OAAO,SAAA;AACrC,QAAA,IAAI,UAAA,KAAe,SAAA,IAAa,UAAA,KAAe,WAAA,EAAa,OAAO,SAAA;AACnE,QAAA,IAAI,UAAA,KAAe,SAAA,IAAa,UAAA,KAAe,WAAA,EAAa,OAAO,SAAA;AACnE,QAAA,OAAO,SAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,gBAAgB,QAAA,EAA2C;AAC/D,QAAA,MAAM,CAAC,cAAA,EAAgB,OAAO,CAAA,GAAI,MAAM,QAAQ,GAAA,CAAI;AAAA,UAClD,IAAA,CAAK,kBAAkB,QAAQ,CAAA;AAAA,UAC/B,IAAA,CAAK,WAAW,QAAQ;AAAA,SACzB,CAAA;AAED,QAAA,MAAM,gBAAgC,EAAC;AAGvC,QAAA,KAAA,MAAW,WAAW,cAAA,EAAgB;AACpC,UAAA,MAAM,QAAA,GAAW,IAAA,CAAK,aAAA,CAAc,OAAA,CAAQ,IAAI,CAAA;AAChD,UAAA,aAAA,CAAc,IAAA,CAAK;AAAA,YACjB,EAAA,EAAI,CAAA,QAAA,EAAW,OAAA,CAAQ,EAAE,CAAA,CAAA;AAAA,YACzB,MAAA,EAAQ,OAAA,CAAQ,IAAA,EAAM,KAAA,IAAS,SAAA;AAAA,YAC/B,MAAM,OAAA,CAAQ,IAAA;AAAA,YACd,MAAM,OAAA,CAAQ,IAAA;AAAA,YACd,IAAA,EAAM,OAAA,CAAQ,IAAA,IAAQ,OAAA,CAAQ,aAAA,IAAiB,IAAA;AAAA,YAC/C,QAAA;AAAA,YACA,MAAA,EAAQ,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AAAA,YAChC,WAAW,OAAA,CAAQ,UAAA;AAAA,YACnB,KAAK,OAAA,CAAQ,QAAA;AAAA,YACb,gBAAA,EAAkB,IAAA,CAAK,gBAAA,CAAiB,OAAA,CAAQ,MAAM,QAAQ,CAAA;AAAA,YAC9D,eAAA,EAAiB,IAAA,CAAK,iBAAA,CAAkB,OAAA,CAAQ,IAAI,CAAA;AAAA,YACpD,UAAA,EAAY;AAAA,WACb,CAAA;AAAA,QACH;AAGA,QAAA,KAAA,MAAW,UAAU,OAAA,EAAS;AAC5B,UAAA,IAAI,CAAC,MAAA,CAAO,IAAA,IAAQ,OAAO,IAAA,CAAK,IAAA,OAAW,EAAA,EAAI;AAE/C,UAAA,MAAM,QAAA,GAAW,IAAA,CAAK,aAAA,CAAc,MAAA,CAAO,IAAI,CAAA;AAC/C,UAAA,aAAA,CAAc,IAAA,CAAK;AAAA,YACjB,EAAA,EAAI,CAAA,OAAA,EAAU,MAAA,CAAO,EAAE,CAAA,CAAA;AAAA,YACvB,MAAA,EAAQ,MAAA,CAAO,IAAA,EAAM,KAAA,IAAS,SAAA;AAAA,YAC9B,MAAM,MAAA,CAAO,IAAA;AAAA,YACb,IAAA,EAAM,IAAA;AAAA,YACN,IAAA,EAAM,IAAA;AAAA,YACN,QAAA;AAAA,YACA,MAAA,EAAQ,WAAA;AAAA;AAAA,YACR,WAAW,MAAA,CAAO,YAAA,IAAA,iBAAgB,IAAI,IAAA,IAAO,WAAA,EAAY;AAAA,YACzD,KAAK,MAAA,CAAO,QAAA;AAAA,YACZ,gBAAA,EAAkB,KAAA;AAAA,YAClB,eAAA,EAAiB,IAAA;AAAA,YACjB,UAAA,EAAY;AAAA,WACb,CAAA;AAAA,QACH;AAEA,QAAA,OAAO,aAAA;AAAA,MACT;AAAA,MAEQ,cAAc,IAAA,EAAgC;AACpD,QAAA,MAAM,KAAA,GAAQ,KAAK,WAAA,EAAY;AAE/B,QAAA,IAAI,IAAA,CAAK,QAAA,CAAS,WAAI,CAAA,IAAK,IAAA,CAAK,QAAA,CAAS,aAAa,CAAA,IAAK,KAAA,CAAM,QAAA,CAAS,UAAU,CAAA,EAAG;AACrF,UAAA,OAAO,UAAA;AAAA,QACT;AACA,QAAA,IAAI,KAAK,QAAA,CAAS,iBAAiB,KAAK,KAAA,CAAM,QAAA,CAAS,eAAe,CAAA,EAAG;AACvE,UAAA,OAAO,MAAA;AAAA,QACT;AACA,QAAA,IAAI,KAAK,QAAA,CAAS,QAAQ,KAAK,KAAA,CAAM,QAAA,CAAS,QAAQ,CAAA,EAAG;AACvD,UAAA,OAAO,QAAA;AAAA,QACT;AACA,QAAA,IAAI,IAAA,CAAK,QAAA,CAAS,SAAS,CAAA,IAAK,IAAA,CAAK,QAAA,CAAS,MAAM,CAAA,IAAK,KAAA,CAAM,QAAA,CAAS,UAAU,CAAA,EAAG;AACnF,UAAA,OAAO,KAAA;AAAA,QACT;AACA,QAAA,IAAI,KAAK,QAAA,CAAS,MAAM,KAAK,IAAA,CAAK,QAAA,CAAS,OAAO,CAAA,EAAG;AACnD,UAAA,OAAO,MAAA;AAAA,QACT;AAEA,QAAA,IAAI,KAAA,CAAM,QAAA,CAAS,OAAO,CAAA,IAAK,KAAA,CAAM,QAAA,CAAS,KAAK,CAAA,IAAK,KAAA,CAAM,QAAA,CAAS,KAAK,CAAA,EAAG;AAC7E,UAAA,OAAO,MAAA;AAAA,QACT;AAEA,QAAA,OAAO,QAAA;AAAA,MACT;AAAA,MAEQ,YAAY,OAAA,EAAoE;AACtF,QAAA,IAAI,QAAQ,cAAA,EAAgB;AAC1B,UAAA,OAAO,WAAA;AAAA,QACT;AACA,QAAA,OAAO,aAAA;AAAA,MACT;AAAA,MAEQ,gBAAA,CAAiB,MAAc,QAAA,EAAqC;AAC1E,QAAA,IAAI,IAAA,CAAK,QAAA,CAAS,eAAe,CAAA,EAAG,OAAO,IAAA;AAC3C,QAAA,IAAI,QAAA,KAAa,KAAA,IAAS,QAAA,KAAa,MAAA,EAAQ,OAAO,IAAA;AAEtD,QAAA,MAAM,KAAA,GAAQ,KAAK,WAAA,EAAY;AAC/B,QAAA,IAAI,KAAA,CAAM,QAAA,CAAS,YAAY,CAAA,IAAK,KAAA,CAAM,QAAA,CAAS,MAAM,CAAA,IAAK,KAAA,CAAM,QAAA,CAAS,UAAU,CAAA,EAAG;AACxF,UAAA,OAAO,IAAA;AAAA,QACT;AAEA,QAAA,OAAO,KAAA;AAAA,MACT;AAAA,MAEQ,kBAAkB,IAAA,EAA6B;AACrD,QAAA,MAAM,eAAA,GAAkB,IAAA,CAAK,KAAA,CAAM,8BAA8B,CAAA;AACjE,QAAA,MAAM,UAAA,GAAa,kBAAkB,CAAC,CAAA;AACtC,QAAA,IAAI,eAAe,MAAA,EAAW;AAC5B,UAAA,OAAO,WAAW,IAAA,EAAK;AAAA,QACzB;AACA,QAAA,OAAO,IAAA;AAAA,MACT;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;AC7rBA,IAAA,iBAAA,GAAA,EAAA;AAAA,QAAA,CAAA,iBAAA,EAAA;AAAA,EAAA,aAAA,EAAA,MAAA,aAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,kBAAA,EAAA,MAAA,kBAAA;AAAA,EAAA,iBAAA,EAAA,MAAA,iBAAA;AAAA,EAAA,qBAAA,EAAA,MAAA,qBAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,YAAA,EAAA,MAAA,YAAA;AAAA,EAAA,sBAAA,EAAA,MAAA;AAAA,CAAA,CAAA;AAyEO,SAAS,gBAAgB,IAAA,EAAyC;AACvE,EAAA,OAAO,IAAA,IAAQ,eAAA;AACjB;AAKO,SAAS,qBAAA,GAA6C;AAC3D,EAAA,OAAO,MAAA,CAAO,KAAK,eAAe,CAAA;AACpC;AAcA,eAAsB,YAAA,CAAa,cAAsB,MAAA,EAAuC;AAE9F,EAAA,IAAI,CAAC,eAAA,CAAgB,YAAY,CAAA,EAAG;AAClC,IAAA,MAAM,IAAI,KAAA;AAAA,MACR,qBAAqB,YAAY;AAAA,qBAAA,EACP,qBAAA,EAAsB,CAAE,IAAA,CAAK,IAAI,CAAC,CAAA;AAAA,KAC9D;AAAA,EACF;AAEA,EAAA,MAAMA,OAAAA,GAAS,gBAAgB,YAAY,CAAA;AAE3C,EAAA,IAAI;AAEF,IAAA,IAAI,MAAA;AACJ,IAAA,QAAQ,YAAA;AAAc,MACpB,KAAK,WAAA;AACH,QAAA,MAAA,GAAS,MAAM,OAAO,mBAAmB,CAAA;AACzC,QAAA;AAAA,MACF,KAAK,QAAA;AACH,QAAA,MAAA,GAAS,MAAM,OAAO,gBAAgB,CAAA;AACtC,QAAA;AAAA,MACF,KAAK,QAAA;AACH,QAAA,MAAA,GAAS,MAAM,OAAO,gBAAgB,CAAA;AACtC,QAAA;AAAA,MACF,KAAK,SAAA;AACH,QAAA,MAAA,GAAS,MAAM,OAAO,iBAAiB,CAAA;AACvC,QAAA;AAAA,MACF,KAAK,OAAA;AACH,QAAA,MAAA,GAAS,MAAM,OAAO,eAAe,CAAA;AACrC,QAAA;AAAA,MACF,KAAK,QAAA;AACH,QAAA,MAAA,GAAS,MAAM,OAAO,eAAe,CAAA;AACrC,QAAA;AAAA,MACF;AAEE,QAAA,MAAM,IAAI,KAAA,CAAM,CAAA,SAAA,EAAY,YAAY,CAAA,gBAAA,CAAkB,CAAA;AAAA;AAG9D,IAAA,MAAM,OAAA,GAAU,MAAA,CAAOA,OAAAA,CAAO,OAAO,CAAA;AAErC,IAAA,IAAI,OAAO,YAAY,UAAA,EAAY;AACjC,MAAA,MAAM,IAAI,MAAM,CAAA,QAAA,EAAWA,OAAAA,CAAO,OAAO,CAAA,cAAA,EAAiBA,OAAAA,CAAO,OAAO,CAAA,CAAE,CAAA;AAAA,IAC5E;AAGA,IAAA,IAAI,iBAAiB,QAAA,EAAU;AAE7B,MAAA,MAAM,OACJ,OAAA,CAAQ,GAAA,CAAI,gBAAgB,MAAA,GAAS,aAAA,CAAc,YAAY,aAAA,CAAc,SAAA,CAAA;AAE/E,MAAA,MAAM,cAAA,GAAiB,KAAK,OAAA,CAAQ,WAAA,EAAa,EAAE,CAAA,CAAE,OAAA,CAAQ,OAAO,EAAE,CAAA;AAqBtE,MAAA,MAAMG,YAAY,OAAA,CAA6C;AAAA,QAC7D,OAAA,EAAS,cAAA;AAAA,QACT,SAAS,MAAA,GAAS,EAAE,eAAe,CAAA,OAAA,EAAU,MAAM,IAAG,GAAI,KAAA;AAAA,OAC3D,CAAA;AAGD,MAAA,OAAO,CAAC,KAAA,KACLA,SAAAA,CAAgC,KAAA,EAAO;AAAA;AAAA,QAEtC,0BAA0B,aAAA,CAAc,wBAAA;AAAA,QACxC,yBAAyB,aAAA,CAAc;AAAA,OACxC,CAAA;AAAA,IACL;AAEA,IAAA,MAAM,QAAA,GAAW,OAAA,CAAQ,EAAE,MAAA,EAAQ,CAAA;AACnC,IAAA,OAAO,CAAC,KAAA,KAAmB,QAAA,CAA0B,KAAK,CAAA;AAAA,EAC5D,SAAS,GAAA,EAAK;AACZ,IAAA,IAAK,GAAA,CAA8B,SAAS,sBAAA,EAAwB;AAClE,MAAA,MAAM,IAAI,KAAA;AAAA,QACR,CAAA,gCAAA,EAAmCH,QAAO,OAAO;AAAA,0BAAA,EAClBA,QAAO,OAAO,CAAA;AAAA,OAC/C;AAAA,IACF;AACA,IAAA,MAAM,GAAA;AAAA,EACR;AACF;AAkBA,eAAsB,iBAAA,CACpB,cACA,MAAA,EACuB;AACvB,EAAA,MAAM,QAAA,GAAW,GAAG,YAAY,CAAA,CAAA,EAAI,OAAO,KAAA,CAAM,CAAA,EAAG,CAAC,CAAC,CAAA,CAAA;AAEtD,EAAA,IAAI,QAAA,GAAW,aAAA,CAAc,GAAA,CAAI,QAAQ,CAAA;AACzC,EAAA,IAAI,CAAC,QAAA,EAAU;AACb,IAAA,QAAA,GAAW,MAAM,YAAA,CAAa,YAAA,EAAc,MAAM,CAAA;AAClD,IAAA,aAAA,CAAc,GAAA,CAAI,UAAU,QAAQ,CAAA;AAAA,EACtC;AAEA,EAAA,OAAO,QAAA;AACT;AAKO,SAAS,kBAAA,GAA2B;AACzC,EAAA,aAAA,CAAc,KAAA,EAAM;AACtB;AAsBO,SAAS,sBAAA,CAAuB,OAAA,GAA2B,EAAC,EAIjE;AACA,EAAA,MAAM,eAAe,eAAA,EAAgB;AAErC,EAAA,MAAM,YAAA,GAAe,OAAA,CAAQ,QAAA,IAAY,YAAA,CAAa,QAAA,IAAY,WAAA;AAClE,EAAA,MAAM,KAAA,GAAQ,OAAA,CAAQ,KAAA,IAAS,YAAA,CAAa,KAAA,IAAS,0BAAA;AAGrD,EAAA,MAAM,iBAAA,GAAoB,OAAA,CAAQ,QAAA,IAAY,YAAA,CAAa,QAAA,IAAY,WAAA;AACvE,EAAA,MAAM,UAAA,GACJ,OAAA,CAAQ,QAAA,IAAY,OAAA,CAAQ,QAAA,KAAa,YAAA,CAAa,QAAA,GAClD,sBAAA,CAAuB,iBAAiB,CAAA,GACvC,YAAA,CAAa,YAAA,IAAgB,uBAAuB,iBAAiB,CAAA;AAE5E,EAAA,MAAM,SAAS,OAAA,CAAQ,MAAA,IAAU,OAAA,CAAQ,GAAA,CAAI,UAAU,CAAA,IAAK,EAAA;AAE5D,EAAA,IAAI,CAAC,MAAA,EAAQ;AACX,IAAA,MAAM,IAAA,GAAO,uBAAuB,iBAAiB,CAAA;AACrD,IAAA,MAAM,IAAI,KAAA;AAAA,MACR,wBAAwB,YAAY,CAAA;AAAA,IAAA,EAC3B,IAAI,CAAA,4CAAA;AAAA,KACf;AAAA,EACF;AAEA,EAAA,OAAO,EAAE,YAAA,EAAc,KAAA,EAAO,MAAA,EAAO;AACvC;AAxRA,IAwCa,iBAYA,aAAA,EAqJP,aAAA;AAzMN,IAAA,cAAA,GAAA,KAAA,CAAA;AAAA,EAAA,uBAAA,GAAA;AAgBA,IAAA,WAAA,EAAA;AAwBO,IAAM,eAAA,GAA6D;AAAA,MACxE,SAAA,EAAW,EAAE,OAAA,EAAS,mBAAA,EAAqB,SAAS,iBAAA,EAAkB;AAAA,MACtE,MAAA,EAAQ,EAAE,OAAA,EAAS,gBAAA,EAAkB,SAAS,cAAA,EAAe;AAAA,MAC7D,MAAA,EAAQ,EAAE,OAAA,EAAS,gBAAA,EAAkB,SAAS,0BAAA,EAA2B;AAAA,MACzE,OAAA,EAAS,EAAE,OAAA,EAAS,iBAAA,EAAmB,SAAS,eAAA,EAAgB;AAAA,MAChE,KAAA,EAAO,EAAE,OAAA,EAAS,eAAA,EAAiB,SAAS,aAAA,EAAc;AAAA,MAC1D,MAAA,EAAQ,EAAE,OAAA,EAAS,eAAA,EAAiB,SAAS,cAAA;AAAe,KAC9D;AAKO,IAAM,aAAA,GAAgB;AAAA;AAAA,MAE3B,YAAA,EAAc,wBAAA;AAAA;AAAA,MAEd,SAAA,EAAW,oBAAA;AAAA;AAAA,MAEX,SAAA,EAAW,wBAAA;AAAA;AAAA,MAEX,wBAAA,EAA0B,IAAA;AAAA;AAAA,MAE1B,uBAAA,EAAyB;AAAA;AAAA,QAEvB,gBAAA,EAAkB,IAAA;AAAA;AAAA,QAElB,UAAA,EAAY;AAAA;AACd,KACF;AAKgB,IAAA,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAOA,IAAA,MAAA,CAAA,qBAAA,EAAA,uBAAA,CAAA;AAgBM,IAAA,MAAA,CAAA,YAAA,EAAA,cAAA,CAAA;AAyGtB,IAAM,aAAA,uBAAoB,GAAA,EAA0B;AAS9B,IAAA,MAAA,CAAA,iBAAA,EAAA,mBAAA,CAAA;AAkBN,IAAA,MAAA,CAAA,kBAAA,EAAA,oBAAA,CAAA;AAwBA,IAAA,MAAA,CAAA,sBAAA,EAAA,wBAAA,CAAA;AAAA,EAAA;AAAA,CAAA,CAAA;AC5PhB,IAqCM,kBAAA,EAwDA,kBAgCA,iBAAA,EAgDO,QAAA;AA7Kb,IAAA,aAAA,GAAA,KAAA,CAAA;AAAA,EAAA,wBAAA,GAAA;AAYA,IAAA,WAAA,EAAA;AACA,IAAA,cAAA,EAAA;AAMA,IAAA,WAAA,EAAA;AAkBA,IAAM,kBAAA,GAAqBI,EAAE,MAAA,CAAO;AAAA,MAClC,gBAAgBA,CAAAA,CAAE,KAAA;AAAA,QAChBA,EAAE,MAAA,CAAO;AAAA,UACP,EAAA,EAAIA,EAAE,MAAA,EAAO;AAAA,UACb,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA,UAChB,WAAA,EAAaA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,UACjC,QAAA,EAAUA,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAA,EAAO,MAAM,CAAC,CAAA;AAAA,UAC9D,QAAA,EAAUA,EAAE,IAAA,CAAK;AAAA,YACf,KAAA;AAAA,YACA,SAAA;AAAA,YACA,UAAA;AAAA,YACA,aAAA;AAAA,YACA,eAAA;AAAA,YACA,gBAAA;AAAA,YACA,YAAA;AAAA,YACA,IAAA;AAAA,YACA;AAAA,WACD,CAAA;AAAA,UACD,MAAA,EAAQA,CAAAA,CAAE,OAAA,CAAQ,WAAW,CAAA;AAAA,UAC7B,QAAA,EAAUA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,UAC9B,UAAUA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,GAAW,QAAA;AAAS,SAC1C;AAAA,OACH;AAAA,MACA,kBAAkBA,CAAAA,CAAE,KAAA;AAAA,QAClBA,EAAE,MAAA,CAAO;AAAA,UACP,EAAA,EAAIA,EAAE,MAAA,EAAO;AAAA,UACb,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA,UAChB,WAAA,EAAaA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,UACjC,QAAA,EAAUA,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAA,EAAO,MAAM,CAAC,CAAA;AAAA,UAC9D,QAAA,EAAUA,EAAE,IAAA,CAAK;AAAA,YACf,KAAA;AAAA,YACA,SAAA;AAAA,YACA,UAAA;AAAA,YACA,aAAA;AAAA,YACA,eAAA;AAAA,YACA,gBAAA;AAAA,YACA,YAAA;AAAA,YACA,IAAA;AAAA,YACA;AAAA,WACD,CAAA;AAAA,UACD,QAAQA,CAAAA,CAAE,IAAA,CAAK,CAAC,SAAA,EAAW,aAAA,EAAe,SAAS,CAAC,CAAA;AAAA,UACpD,UAAUA,CAAAA,CAAE,KAAA,CAAMA,EAAE,MAAA,EAAQ,EAAE,QAAA,EAAS;AAAA,UACvC,iBAAiBA,CAAAA,CAAE,KAAA,CAAMA,EAAE,MAAA,EAAQ,EAAE,QAAA;AAAS,SAC/C;AAAA,OACH;AAAA,MACA,UAAUA,CAAAA,CAAE,KAAA;AAAA,QACVA,EAAE,MAAA,CAAO;AAAA,UACP,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA,UAChB,QAAA,EAAUA,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAA,EAAO,MAAM,CAAC,CAAA;AAAA,UAC9D,mBAAA,EAAqBA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAAS,SAC1C;AAAA,OACH;AAAA,MACA,OAAA,EAASA,EAAE,MAAA,EAAO;AAAA,MAClB,eAAA,EAAiBA,CAAAA,CAAE,KAAA,CAAMA,CAAAA,CAAE,QAAQ;AAAA,KACpC,CAAA;AAED,IAAM,gBAAA,GAAmBA,EAAE,MAAA,CAAO;AAAA,MAChC,QAAQA,CAAAA,CAAE,KAAA;AAAA,QACRA,EAAE,MAAA,CAAO;AAAA,UACP,IAAA,EAAMA,EAAE,MAAA,EAAO;AAAA,UACf,IAAA,EAAMA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,UAC1B,QAAA,EAAUA,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAA,EAAO,MAAM,CAAC,CAAA;AAAA,UAC9D,QAAA,EAAUA,EAAE,IAAA,CAAK;AAAA,YACf,KAAA;AAAA,YACA,UAAA;AAAA,YACA,aAAA;AAAA,YACA,OAAA;AAAA,YACA,OAAA;AAAA,YACA,eAAA;AAAA,YACA,MAAA;AAAA,YACA;AAAA,WACD,CAAA;AAAA,UACD,WAAA,EAAaA,EAAE,MAAA,EAAO;AAAA,UACtB,YAAA,EAAcA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAAS,SACnC;AAAA,OACH;AAAA,MACA,cAAcA,CAAAA,CAAE,KAAA;AAAA,QACdA,EAAE,MAAA,CAAO;AAAA,UACP,IAAA,EAAMA,EAAE,MAAA,EAAO;AAAA,UACf,UAAA,EAAYA,EAAE,MAAA,EAAO;AAAA,UACrB,QAAQA,CAAAA,CAAE,IAAA,CAAK,CAAC,KAAA,EAAO,QAAA,EAAU,MAAM,CAAC;AAAA,SACzC;AAAA,OACH;AAAA,MACA,iBAAA,EAAmBA,EAAE,MAAA,EAAO;AAAA,MAC5B,YAAA,EAAcA,EAAE,OAAA,EAAQ;AAAA,MACxB,aAAA,EAAeA,CAAAA,CAAE,KAAA,CAAMA,CAAAA,CAAE,QAAQ;AAAA,KAClC,CAAA;AAED,IAAM,iBAAA,GAAoBA,EAAE,MAAA,CAAO;AAAA,MACjC,QAAA,EAAUA,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAA,EAAO,MAAM,CAAC,CAAA;AAAA,MAC9D,QAAA,EAAUA,EAAE,IAAA,CAAK;AAAA,QACf,KAAA;AAAA,QACA,SAAA;AAAA,QACA,UAAA;AAAA,QACA,aAAA;AAAA,QACA,eAAA;AAAA,QACA,gBAAA;AAAA,QACA,YAAA;AAAA,QACA,IAAA;AAAA,QACA;AAAA,OACD,CAAA;AAAA,MACD,OAAA,EAASA,EAAE,MAAA,EAAO;AAAA,MAClB,eAAA,EAAiBA,EAAE,MAAA,EAAO;AAAA,MAC1B,UAAA,EAAYA,EAAE,MAAA,EAAO,CAAE,IAAI,CAAC,CAAA,CAAE,IAAI,CAAC;AAAA,KACpC,CAAA;AAgCM,IAAM,WAAN,MAAe;AAAA,MA7KtB;AA6KsB,QAAA,MAAA,CAAA,IAAA,EAAA,UAAA,CAAA;AAAA;AAAA,MACZ,YAAA;AAAA,MACA,KAAA;AAAA,MACA,MAAA;AAAA,MACA,IAAA;AAAA,MACA,UAAA,GAAkC,IAAA;AAAA,MAE1C,WAAA,CAAY,OAAA,GAA2B,EAAC,EAAG;AACzC,QAAA,MAAM,QAAA,GAAW,uBAAuB,OAAO,CAAA;AAC/C,QAAA,IAAA,CAAK,eAAe,QAAA,CAAS,YAAA;AAC7B,QAAA,IAAA,CAAK,QAAQ,QAAA,CAAS,KAAA;AACtB,QAAA,IAAA,CAAK,SAAS,QAAA,CAAS,MAAA;AACvB,QAAA,IAAA,CAAK,IAAA,GAAO,OAAA,CAAQ,IAAA,IAAQ,SAAA,EAAU,CAAE,iBAAA;AAAA,MAC1C;AAAA,MAEA,MAAc,QAAA,GAA6B;AACzC,QAAA,IAAI,CAAC,KAAK,UAAA,EAAY;AACpB,UAAA,IAAA,CAAK,aAAa,MAAM,iBAAA,CAAkB,IAAA,CAAK,YAAA,EAAc,KAAK,MAAM,CAAA;AAAA,QAC1E;AACA,QAAA,OAAO,IAAA,CAAK,UAAA,CAAW,IAAA,CAAK,KAAK,CAAA;AAAA,MACnC;AAAA;AAAA;AAAA;AAAA,MAKA,QAAQ,IAAA,EAAoB;AAC1B,QAAA,IAAA,CAAK,IAAA,GAAO,IAAA;AAAA,MACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,oBAAoB,YAAA,EAAqD;AAC7E,QAAA,MAAM,QAAA,GAAW,YAAA,CAAa,QAAA,IAAY,EAAC;AAC3C,QAAA,MAAM,gBAAA,GAAmB,IAAA,CAAK,uBAAA,CAAwB,QAAQ,CAAA;AAE9D,QAAA,MAAM,EAAE,MAAA,EAAO,GAAI,MAAM,cAAA,CAAe;AAAA,UACtC,KAAA,EAAQ,MAAM,IAAA,CAAK,QAAA,EAAS;AAAA,UAC5B,MAAA,EAAQ,kBAAA;AAAA,UACR,MAAA,EAAQ,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA,EAWZ,gBAAgB,CAAA;AAAA,SACb,CAAA;AAGD,QAAA,MAAM,cAAA,GAAyB,MAAA,CAAO,cAAA,CAAe,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,UAC/D,IAAI,CAAA,CAAE,EAAA;AAAA,UACN,OAAO,CAAA,CAAE,KAAA;AAAA,UACT,aAAa,CAAA,CAAE,WAAA;AAAA,UACf,UAAU,CAAA,CAAE,QAAA;AAAA,UACZ,UAAU,CAAA,CAAE,QAAA;AAAA,UACZ,MAAA,EAAQ;AAAA,SACV,CAAE,CAAA;AAEF,QAAA,MAAM,gBAAA,GAA2B,MAAA,CAAO,gBAAA,CAAiB,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,UACnE,IAAI,CAAA,CAAE,EAAA;AAAA,UACN,OAAO,CAAA,CAAE,KAAA;AAAA,UACT,aAAa,CAAA,CAAE,WAAA;AAAA,UACf,UAAU,CAAA,CAAE,QAAA;AAAA,UACZ,UAAU,CAAA,CAAE,QAAA;AAAA,UACZ,MAAA,EAAQ,CAAA,CAAE,MAAA,KAAW,SAAA,GAAa,SAAA,GAAuB,SAAA;AAAA,UACzD,UAAU,CAAA,CAAE;AAAA,SACd,CAAE,CAAA;AAEF,QAAA,MAAM,QAAA,GAA0B,MAAA,CAAO,QAAA,CAAS,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,UAC1D,OAAO,CAAA,CAAE,KAAA;AAAA,UACT,UAAU,CAAA,CAAE,QAAA;AAAA,UACZ,qBAAqB,CAAA,CAAE;AAAA,SACzB,CAAE,CAAA;AAEF,QAAA,OAAO;AAAA,UACL,SAAS,MAAA,CAAO,OAAA;AAAA,UAChB,cAAA;AAAA,UACA,gBAAA;AAAA,UACA,QAAA;AAAA,UACA,iBAAiB,MAAA,CAAO;AAAA,SAC1B;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,UAAA,CAAW,IAAA,EAAc,OAAA,EAA6C;AAC1E,QAAA,MAAM,EAAE,MAAA,EAAO,GAAI,MAAM,cAAA,CAAe;AAAA,UACtC,KAAA,EAAQ,MAAM,IAAA,CAAK,QAAA,EAAS;AAAA,UAC5B,MAAA,EAAQ,gBAAA;AAAA,UACR,MAAA,EAAQ,CAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,EAQZ,OAAA,GAAU,CAAA;AAAA,EAAa,OAAO;;AAAA,CAAA,GAAS,EAAE,CAAA;AAAA,EACzC,IAAI,CAAA;AAAA,SACD,CAAA;AAED,QAAA,MAAM,MAAA,GAAwB,MAAA,CAAO,MAAA,CAAO,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,UACtD,MAAM,CAAA,CAAE,IAAA;AAAA,UACR,MAAM,CAAA,CAAE,IAAA;AAAA,UACR,UAAU,CAAA,CAAE,QAAA;AAAA,UACZ,UAAU,CAAA,CAAE,QAAA;AAAA,UACZ,aAAa,CAAA,CAAE,WAAA;AAAA,UACf,cAAc,CAAA,CAAE;AAAA,SAClB,CAAE,CAAA;AAEF,QAAA,MAAM,YAAA,GAAoC,MAAA,CAAO,YAAA,CAAa,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,UACxE,MAAM,CAAA,CAAE,IAAA;AAAA,UACR,YAAY,CAAA,CAAE,UAAA;AAAA,UACd,QAAQ,CAAA,CAAE;AAAA,SACZ,CAAE,CAAA;AAEF,QAAA,OAAO;AAAA,UACL,cAAc,MAAA,CAAO,YAAA;AAAA,UACrB,eAAe,MAAA,CAAO,aAAA;AAAA,UACtB,MAAA;AAAA,UACA,YAAA;AAAA,UACA,mBAAmB,MAAA,CAAO;AAAA,SAC5B;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,YAAY,KAAA,EAA0C;AAC1D,QAAA,MAAM,EAAE,MAAA,EAAO,GAAI,MAAM,cAAA,CAAe;AAAA,UACtC,KAAA,EAAQ,MAAM,IAAA,CAAK,QAAA,EAAS;AAAA,UAC5B,MAAA,EAAQ,iBAAA;AAAA,UACR,MAAA,EAAQ,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,EAQZ,KAAK,CAAA;AAAA,SACF,CAAA;AAED,QAAA,OAAO;AAAA,UACL,UAAU,MAAA,CAAO,QAAA;AAAA,UACjB,UAAU,MAAA,CAAO,QAAA;AAAA,UACjB,SAAS,MAAA,CAAO,OAAA;AAAA,UAChB,iBAAiB,MAAA,CAAO,eAAA;AAAA,UACxB,YAAY,MAAA,CAAO;AAAA,SACrB;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,SAAA,CAAU,MAAA,EAA+B,QAAA,EAAyC;AAEtF,QAAA,MAAM,CAAC,EAAA,EAAI,EAAA,EAAI,QAAQ,CAAA,GAAI,MAAM,QAAQ,GAAA,CAAI;AAAA,UAC3C,MAAA,CAAO,MAAM,QAAQ,CAAA;AAAA,UACrB,MAAA,CAAO,YAAY,QAAQ,CAAA;AAAA,UAC3B,MAAA,CAAO,gBAAgB,QAAQ;AAAA,SAChC,CAAA;AAGD,QAAA,MAAM,gBAAA,GAAmB,MAAM,IAAA,CAAK,eAAA,CAAgB,QAAQ,CAAA;AAC5D,QAAA,MAAM,sBAAsB,gBAAA,CAAiB,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,CAAE,WAAW,aAAa,CAAA;AAGrF,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,gBAAA,CAAiB,EAAA,EAAI,IAAI,mBAAmB,CAAA;AAGxE,QAAA,MAAM,SAAS,IAAA,CAAK,eAAA,CAAgB,EAAA,EAAI,EAAA,EAAI,UAAU,mBAAmB,CAAA;AAGzE,QAAA,MAAM,WAAA,GAAc,IAAA,CAAK,mBAAA,CAAoB,MAAA,EAAQ,UAAU,mBAAmB,CAAA;AAGlF,QAAA,MAAM,UAAU,MAAM,IAAA,CAAK,kBAAkB,EAAA,EAAI,EAAA,EAAI,UAAU,mBAAmB,CAAA;AAElF,QAAA,OAAO;AAAA,UACL,QAAA;AAAA,UACA,OAAO,EAAA,CAAG,QAAA;AAAA,UACV,SAAS,EAAA,CAAG,KAAA;AAAA,UACZ,MAAA;AAAA,UACA,EAAA;AAAA,UACA,QAAA,EAAU;AAAA,YACR,OAAO,QAAA,CAAS,MAAA;AAAA,YAChB,aAAa,mBAAA,CAAoB,MAAA;AAAA,YACjC,KAAA,EAAO;AAAA,WACT;AAAA,UACA,QAAA;AAAA,UACA,WAAA;AAAA,UACA,OAAA;AAAA,UACA,SAAA,EAAA,iBAAW,IAAI,IAAA,EAAK,EAAE,WAAA;AAAY,SACpC;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,wBAAA,CACJ,QAAA,EACA,OAAA,EAC6D;AAC7D,QAAA,MAAM,EAAE,MAAA,EAAO,GAAI,MAAM,cAAA,CAAe;AAAA,UACtC,KAAA,EAAQ,MAAM,IAAA,CAAK,QAAA,EAAS;AAAA,UAC5B,MAAA,EAAQA,EAAE,MAAA,CAAO;AAAA,YACf,MAAMA,CAAAA,CAAE,IAAA,CAAK,CAAC,KAAA,EAAO,eAAe,CAAC,CAAA;AAAA,YACrC,OAAA,EAASA,EAAE,MAAA,EAAO;AAAA,YAClB,SAAA,EAAWA,EAAE,MAAA;AAAO,WACrB,CAAA;AAAA,UACD,MAAA,EAAQ,CAAA;;AAAA,IAAA,EAER,QAAQ,OAAO;AAAA,eAAA,EACJ,OAAA,CAAQ,KAAA,CAAM,IAAA,CAAK,IAAI,CAAC;;AAAA,cAAA,EAEzB,SAAS,MAAM,CAAA;AAAA,EAC7B,SAAS,IAAI;;AAAA,EAEb,SAAS,IAAA,GAAO,CAAA,MAAA,EAAS,QAAA,CAAS,IAAI,KAAK,EAAE;AAAA,EAC7C,SAAS,IAAA,GAAO,CAAA,MAAA,EAAS,QAAA,CAAS,IAAI,KAAK,EAAE;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA,wEAAA;AAAA,SAiB1C,CAAA;AAED,QAAA,OAAO;AAAA,UACL,MAAM,MAAA,CAAO,IAAA;AAAA,UACb,SAAS,MAAA,CAAO;AAAA,SAClB;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUA,MAAM,wBAAA,CACJ,QAAA,EACA,OAAA,EAMmB;AACnB,QAAA,MAAM,IAAA,GAAO,OAAA,EAAS,IAAA,IAAQ,IAAA,CAAK,IAAA;AACnC,QAAA,IAAI,CAAC,IAAA,EAAM;AACT,UAAA,MAAM,IAAI,KAAA;AAAA,YACR;AAAA,WAKF;AAAA,QACF;AAEA,QAAA,MAAM,gBAA0B,EAAC;AACjC,QAAA,MAAM,MAAM,EAAE,GAAG,QAAQ,GAAA,EAAK,GAAG,mBAAkB,EAAE;AAErD,QAAA,KAAA,MAAW,IAAA,IAAQ,SAAS,gBAAA,EAAkB;AAC5C,UAAA,MAAM,SAAmB,CAAC,GAAI,OAAA,EAAS,MAAA,IAAU,EAAG,CAAA;AAEpD,UAAA,IAAI,OAAA,EAAS,kBAAkB,KAAA,EAAO;AACpC,YAAA,MAAA,CAAO,KAAK,SAAS,CAAA;AAAA,UACvB;AAEA,UAAA,IAAI,IAAA,CAAK,QAAA,KAAa,UAAA,IAAc,IAAA,CAAK,aAAa,MAAA,EAAQ;AAC5D,YAAA,MAAA,CAAO,IAAA,CAAK,CAAA,SAAA,EAAY,IAAA,CAAK,QAAQ,CAAA,CAAE,CAAA;AAAA,UACzC;AAEA,UAAA,MAAM,IAAA,GAAO,CAAA;AAAA,EACjB,IAAA,CAAK,WAAA,IAAe,IAAA,CAAK,KAAK;;AAAA;AAAA,EAAA,EAG5B,IAAA,CAAK,QAAA,CAAS,WAAA,EAAa,CAAA;;AAAA,EAE7B,IAAA,CAAK,UAAU,MAAA,GAAS,CAAA;AAAA,EAAkB,IAAA,CAAK,QAAA,CAAS,IAAA,CAAK,IAAI,CAAC;AAAA,CAAA,GAAO,EAAE;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,uCAAA,CAAA;AAgBvE,UAAA,IAAI,SAAS,MAAA,EAAQ;AACnB,YAAA,GAAA,CAAI,IAAA,CAAK,CAAA,8BAAA,EAAiC,IAAA,CAAK,KAAK,CAAA,CAAE,CAAA;AACtD,YAAA,aAAA,CAAc,IAAA,CAAK,CAAA,UAAA,EAAa,IAAA,CAAK,KAAK,CAAA,CAAE,CAAA;AAC5C,YAAA;AAAA,UACF;AAEA,UAAA,IAAI;AAEF,YAAA,MAAM,IAAA,GAAO,CAAC,OAAA,EAAS,QAAA,EAAU,QAAA,EAAU,MAAM,SAAA,EAAW,IAAA,CAAK,KAAA,EAAO,aAAA,EAAe,GAAG,CAAA;AAG1F,YAAA,IAAI,MAAA,CAAO,SAAS,CAAA,EAAG;AACrB,cAAA,IAAA,CAAK,IAAA,CAAK,SAAA,EAAW,MAAA,CAAO,IAAA,CAAK,GAAG,CAAC,CAAA;AAAA,YACvC;AAGA,YAAA,MAAM,IAAA,GAAOC,SAAAA,CAAU,IAAA,EAAM,IAAA,EAAM;AAAA,cACjC,KAAA,EAAO,IAAA;AAAA,cACP,QAAA,EAAU,OAAA;AAAA,cACV,GAAA;AAAA,cACA,SAAA,EAAW,KAAK,IAAA,GAAO;AAAA;AAAA,aACxB,CAAA;AAED,YAAA,IAAI,KAAK,KAAA,EAAO;AACd,cAAA,MAAM,IAAA,CAAK,KAAA;AAAA,YACb;AAEA,YAAA,IAAI,IAAA,CAAK,WAAW,CAAA,EAAG;AACrB,cAAA,MAAM,IAAI,KAAA,CAAM,IAAA,CAAK,MAAA,IAAU,wBAAwB,CAAA;AAAA,YACzD;AAEA,YAAA,MAAM,MAAA,GAAS,IAAA,CAAK,MAAA,CAAO,IAAA,EAAK;AAChC,YAAA,aAAA,CAAc,KAAK,MAAM,CAAA;AACzB,YAAA,GAAA,CAAI,IAAA,CAAK,CAAA,sBAAA,EAAoB,MAAM,CAAA,CAAE,CAAA;AAAA,UACvC,SAAS,GAAA,EAAK;AACZ,YAAA,GAAA,CAAI,KAAA,CAAM,CAAA,+BAAA,EAA6B,IAAA,CAAK,KAAK,IAAI,GAAG,CAAA;AAAA,UAC1D;AAAA,QACF;AAEA,QAAA,OAAO,aAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,eAAe,YAAA,EAA6C;AAChE,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,mBAAA,CAAoB,YAAY,CAAA;AAE5D,QAAA,OAAO,CAAA;;AAAA;AAAA,EAGT,SAAS,OAAO;;AAAA,oBAAA,EAEI,QAAA,CAAS,eAAe,MAAM,CAAA;AAAA,EAClD,SAAS,cAAA,CACR,GAAA;AAAA,UACC,CAAC,CAAA,KAAM;AAAA,WAAA,EACH,EAAE,KAAK;AAAA,EACb,CAAA,CAAE,eAAe,EAAE;AAAA;AAAA,SAEnB,CACC,IAAA,CAAK,IAAI,CAAC;;AAAA,sBAAA,EAEW,QAAA,CAAS,iBAAiB,MAAM,CAAA;AAAA,EACtD,SAAS,gBAAA,CACR,GAAA;AAAA,UACC,CAAC,CAAA,KAAM;AAAA,cAAA,EACF,EAAE,KAAK;AAAA,cAAA,EACA,EAAE,QAAQ;AAAA,EACxB,CAAA,CAAE,eAAe,EAAE;AAAA,EACnB,CAAA,CAAE,QAAA,EAAU,MAAA,GAAS,CAAA,gBAAA,EAAmB,CAAA,CAAE,SAAS,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA,GAAK,EAAE;AAAA;AAAA,SAEpE,CACC,IAAA,CAAK,IAAI,CAAC;;AAAA,aAAA,EAEE,QAAA,CAAS,SAAS,MAAM,CAAA;AAAA,EACrC,SAAS,QAAA,CACR,GAAA;AAAA,UACC,CAAC,CAAA,KAAM;AAAA,iBAAA,EACF,EAAE,KAAK;AAAA,cAAA,EACA,EAAE,QAAQ;AAAA,0BAAA,EACE,CAAA,CAAE,uBAAuB,eAAe;AAAA;AAAA,SAElE,CACC,IAAA,CAAK,IAAI,CAAC;;AAAA;AAAA,EAGX,QAAA,CAAS,eAAA,CAAgB,GAAA,CAAI,CAAC,CAAA,KAAM,CAAA,EAAA,EAAK,CAAC,CAAA,CAAE,CAAA,CAAE,IAAA,CAAK,IAAI,CAAC;;AAAA;AAAA,6CAAA,EAGX,IAAA,CAAK,YAAY,CAAA,CAAA,EAAI,IAAA,CAAK,KAAK,CAAA;AAAA,YAAA,EAAA,iBAChE,IAAI,IAAA,EAAK,EAAE,WAAA,EAAa,CAAA;AAAA,CAAA;AAAA,MAEpC;AAAA;AAAA;AAAA;AAAA,MAMQ,uBAAA,CAAwB,QAAA,EAAiC,SAAA,GAAY,GAAA,EAAgB;AAC3F,QAAA,MAAM,WAAW,SAAA,GAAY,CAAA;AAC7B,QAAA,MAAM,wBAAA,GAA2B,GAAA;AAEjC,QAAA,IAAI,IAAA,GAAO,QAAA,CACR,GAAA,CAAI,CAAC,GAAG,CAAA,KAAM;AACb,UAAA,MAAM,IAAA,GAAO,CAAA,CAAE,IAAA,KAAS,cAAA,GAAiB,MAAA,GAAS,WAAA;AAClD,UAAA,OAAO,CAAA,CAAA,EAAI,CAAA,GAAI,CAAC,CAAA,EAAA,EAAK,IAAI,CAAA;AAAA,EAAM,EAAE,IAAI;AAAA,CAAA;AAAA,QACvC,CAAC,CAAA,CACA,IAAA,CAAK,SAAS,CAAA;AAEjB,QAAA,IAAI,IAAA,CAAK,SAAS,QAAA,EAAU;AAC1B,UAAA,MAAM,SAAA,GAAY,KAAK,KAAA,CAAM,CAAA,EAAG,KAAK,KAAA,CAAM,QAAA,GAAW,GAAG,CAAC,CAAA;AAC1D,UAAA,MAAM,QAAA,GAAW,KAAK,KAAA,CAAM,CAAC,KAAK,KAAA,CAAM,QAAA,GAAW,GAAG,CAAC,CAAA;AACvD,UAAA,MAAM,cAAA,GAAiB,IAAA,CAAK,MAAA,IAAU,SAAA,CAAU,SAAS,QAAA,CAAS,MAAA,CAAA;AAClE,UAAA,MAAM,iBAAA,GAAoB,IAAA,CAAK,IAAA,CAAK,cAAA,GAAiB,wBAAwB,CAAA;AAC7E,UAAA,IAAA,GAAO,GAAG,SAAS;;AAAA,mBAAA,EAA0B,iBAAiB,wBAAwB,cAAc,CAAA;;AAAA,EAAmB,QAAQ,CAAA,CAAA;AAAA,QACjI;AAEA,QAAA,OAAO,IAAA;AAAA,MACT;AAAA,MAEA,MAAc,gBAAgB,QAAA,EAAmD;AAC/E,QAAA,IAAI,QAAA,CAAS,MAAA,KAAW,CAAA,EAAG,OAAO,EAAC;AAEnC,QAAA,MAAM,EAAE,MAAA,EAAO,GAAI,MAAM,cAAA,CAAe;AAAA,UACtC,KAAA,EAAQ,MAAM,IAAA,CAAK,QAAA,EAAS;AAAA,UAC5B,MAAA,EAAQD,EAAE,MAAA,CAAO;AAAA,YACf,OAAOA,CAAAA,CAAE,KAAA;AAAA,cACPA,EAAE,MAAA,CAAO;AAAA,gBACP,EAAA,EAAIA,EAAE,MAAA,EAAO;AAAA,gBACb,MAAA,EAAQA,EAAE,IAAA,CAAK,CAAC,eAAe,WAAA,EAAa,WAAA,EAAa,UAAU,CAAC,CAAA;AAAA,gBACpE,gBAAA,EAAkBA,EAAE,OAAA,EAAQ;AAAA,gBAC5B,eAAA,EAAiBA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAAS,eACtC;AAAA;AACH,WACD,CAAA;AAAA,UACD,MAAA,EAAQ,CAAA;;AAAA;AAAA,EAGZ,QAAA,CACC,GAAA;AAAA,YACC,CAAC,CAAA,KAAM;AAAA,IAAA,EACL,EAAE,EAAE;AAAA,QAAA,EACA,EAAE,MAAM;AAAA,UAAA,EACN,EAAE,QAAQ;AAAA,MAAA,EACd,CAAA,CAAE,QAAQ,SAAS;AAAA,MAAA,EACnB,EAAE,IAAI;AAAA,GAAA;AAAA,WAEZ,CACC,IAAA,CAAK,IAAI,CAAC;;AAAA;AAAA;AAAA;AAAA;;AAAA,oCAAA;AAAA,SAQR,CAAA;AAED,QAAA,OAAO,QAAA,CAAS,GAAA,CAAI,CAAC,IAAA,KAAS;AAC5B,UAAA,MAAM,QAAA,GAAW,OAAO,KAAA,CAAM,IAAA,CAAK,CAAC,CAAA,KAAM,CAAA,CAAE,EAAA,KAAO,IAAA,CAAK,EAAE,CAAA;AAC1D,UAAA,IAAI,QAAA,EAAU;AACZ,YAAA,OAAO;AAAA,cACL,GAAG,IAAA;AAAA,cACH,QAAQ,QAAA,CAAS,MAAA;AAAA,cACjB,kBAAkB,QAAA,CAAS,gBAAA;AAAA,cAC3B,iBAAiB,QAAA,CAAS;AAAA,aAC5B;AAAA,UACF;AACA,UAAA,OAAO,IAAA;AAAA,QACT,CAAC,CAAA;AAAA,MACH;AAAA,MAEA,MAAc,gBAAA,CACZ,EAAA,EACA,EAAA,EACA,mBAAA,EACoB;AACpB,QAAA,MAAM,WAAsB,EAAC;AAG7B,QAAA,KAAA,MAAW,OAAA,IAAW,GAAG,QAAA,EAAU;AACjC,UAAA,QAAA,CAAS,IAAA,CAAK;AAAA,YACZ,IAAA,EAAM,YAAA;AAAA,YACN,WAAA,EAAa,CAAA,UAAA,EAAa,OAAA,CAAQ,IAAI,CAAA,QAAA,CAAA;AAAA,YACtC,gBAAA,EAAkB,IAAA;AAAA,YAClB,YAAA,EAAc,CAAA,wBAAA,EAA2B,OAAA,CAAQ,GAAG,CAAA,kBAAA,CAAA;AAAA,YACpD,KAAK,OAAA,CAAQ,GAAA;AAAA,YACb,QAAA,EAAU;AAAA,WACX,CAAA;AAAA,QACH;AAGA,QAAA,MAAM,mBAAmB,mBAAA,CAAoB,MAAA;AAAA,UAC3C,CAAC,CAAA,KAAM,CAAA,CAAE,QAAA,KAAa,UAAA,IAAc,EAAE,QAAA,KAAa;AAAA,SACrD;AACA,QAAA,IAAI,gBAAA,CAAiB,SAAS,CAAA,EAAG;AAC/B,UAAA,QAAA,CAAS,IAAA,CAAK;AAAA,YACZ,IAAA,EAAM,iBAAA;AAAA,YACN,WAAA,EAAa,CAAA,EAAG,gBAAA,CAAiB,MAAM,CAAA,kDAAA,CAAA;AAAA,YACvC,kBAAkB,gBAAA,CAAiB,IAAA,CAAK,CAAC,CAAA,KAAM,EAAE,gBAAgB,CAAA;AAAA,YACjE,YAAA,EAAc,6DAAA;AAAA,YACd,GAAA,EAAK,IAAA;AAAA,YACL,QAAA,EAAU;AAAA,WACX,CAAA;AAAA,QACH;AAGA,QAAA,IAAI,EAAA,CAAG,SAAA,KAAc,KAAA,IAAS,EAAA,CAAG,oBAAoB,OAAA,EAAS;AAC5D,UAAA,QAAA,CAAS,IAAA,CAAK;AAAA,YACZ,IAAA,EAAM,gBAAA;AAAA,YACN,WAAA,EAAa,8CAAA;AAAA,YACb,gBAAA,EAAkB,KAAA;AAAA,YAClB,YAAA,EAAc,mDAAA;AAAA,YACd,GAAA,EAAK,IAAA;AAAA,YACL,QAAA,EAAU;AAAA,WACX,CAAA;AAAA,QACH;AAGA,QAAA,IAAI,EAAA,CAAG,oBAAoB,SAAA,EAAW;AACpC,UAAA,QAAA,CAAS,IAAA,CAAK;AAAA,YACZ,IAAA,EAAM,mBAAA;AAAA,YACN,WAAA,EAAa,uCAAA;AAAA,YACb,gBAAA,EAAkB,KAAA;AAAA,YAClB,YAAA,EAAc,4DAAA;AAAA,YACd,GAAA,EAAK,IAAA;AAAA,YACL,QAAA,EAAU;AAAA,WACX,CAAA;AAAA,QACH;AAEA,QAAA,OAAO,QAAA;AAAA,MACT;AAAA,MAEQ,eAAA,CACN,EAAA,EACA,EAAA,EACA,QAAA,EACA,mBAAA,EACU;AACV,QAAA,IAAI,EAAA,CAAG,QAAQ,OAAO,QAAA;AACtB,QAAA,IAAI,EAAA,CAAG,KAAA,KAAU,QAAA,EAAU,OAAO,QAAA;AAElC,QAAA,MAAM,eAAe,QAAA,CAAS,MAAA,CAAO,CAAC,CAAA,KAAM,CAAC,EAAE,gBAAgB,CAAA;AAC/D,QAAA,IAAI,YAAA,CAAa,MAAA,GAAS,CAAA,EAAG,OAAO,SAAA;AAEpC,QAAA,IAAI,EAAA,CAAG,YAAY,OAAO,UAAA;AAE1B,QAAA,IAAI,GAAG,QAAA,CAAS,MAAA,GAAS,CAAA,IAAK,mBAAA,CAAoB,SAAS,CAAA,EAAG;AAC5D,UAAA,OAAO,YAAA;AAAA,QACT;AAEA,QAAA,IAAI,EAAA,CAAG,UAAA,IAAc,mBAAA,CAAoB,MAAA,KAAW,CAAA,EAAG;AACrD,UAAA,OAAO,gBAAA;AAAA,QACT;AAEA,QAAA,OAAO,cAAA;AAAA,MACT;AAAA,MAEQ,mBAAA,CACN,MAAA,EACA,QAAA,EACA,mBAAA,EAC6B;AAC7B,QAAA,MAAM,UAAuC,EAAC;AAE9C,QAAA,IAAI,WAAW,YAAA,EAAc;AAC3B,UAAA,MAAM,aAAa,QAAA,CAAS,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,CAAE,SAAS,YAAY,CAAA;AACjE,UAAA,KAAA,MAAW,WAAW,UAAA,EAAY;AAChC,YAAA,OAAA,CAAQ,IAAA,CAAK;AAAA,cACX,MAAA,EAAQ,CAAA,gBAAA,EAAmB,OAAA,CAAQ,WAAW,CAAA,CAAA;AAAA,cAC9C,QAAA,EAAU,UAAA;AAAA,cACV,SAAA,EAAW,IAAA;AAAA,cACX,MAAA,EAAQ;AAAA,aACT,CAAA;AAAA,UACH;AAEA,UAAA,KAAA,MAAW,YAAY,mBAAA,EAAqB;AAC1C,YAAA,OAAA,CAAQ,IAAA,CAAK;AAAA,cACX,MAAA,EAAQ,SAAS,gBAAA,GACb,CAAA,UAAA,EAAa,SAAS,eAAA,IAAmB,QAAA,CAAS,IAAA,CAAK,KAAA,CAAM,CAAA,EAAG,GAAG,CAAC,CAAA,CAAA,GACpE,CAAA,sBAAA,EAAyB,SAAS,MAAM,CAAA,EAAA,EAAK,SAAS,IAAA,CAAK,KAAA,CAAM,CAAA,EAAG,GAAG,CAAC,CAAA,CAAA;AAAA,cAC5E,UAAU,QAAA,CAAS,QAAA;AAAA,cACnB,WAAW,QAAA,CAAS,gBAAA;AAAA,cACpB,MAAA,EAAQ,CAAA,EAAG,QAAA,CAAS,QAAQ,CAAA,sCAAA;AAAA,aAC7B,CAAA;AAAA,UACH;AAAA,QACF;AAEA,QAAA,IAAI,WAAW,cAAA,EAAgB;AAC7B,UAAA,OAAA,CAAQ,IAAA,CAAK;AAAA,YACX,MAAA,EAAQ,+CAAA;AAAA,YACR,QAAA,EAAU,MAAA;AAAA,YACV,SAAA,EAAW,IAAA;AAAA,YACX,MAAA,EAAQ;AAAA,WACT,CAAA;AAAA,QACH;AAEA,QAAA,IAAI,WAAW,gBAAA,EAAkB;AAC/B,UAAA,OAAA,CAAQ,IAAA,CAAK;AAAA,YACX,MAAA,EAAQ,UAAA;AAAA,YACR,QAAA,EAAU,MAAA;AAAA,YACV,SAAA,EAAW,KAAA;AAAA,YACX,MAAA,EAAQ;AAAA,WACT,CAAA;AAAA,QACH;AAEA,QAAA,OAAO,OAAA;AAAA,MACT;AAAA,MAEA,MAAc,iBAAA,CACZ,EAAA,EACA,EAAA,EACA,UACA,mBAAA,EACiB;AACjB,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAM,YAAA,CAAa;AAAA,UAClC,KAAA,EAAQ,MAAM,IAAA,CAAK,QAAA,EAAS;AAAA,UAC5B,MAAA,EAAQ,CAAA;;AAAA,IAAA,EAER,GAAG,KAAK;AAAA,IAAA,EACR,EAAA,CAAG,UAAA,GAAa,oBAAA,GAAkB,EAAA,CAAG,UAAA,GAAa,mBAAc,CAAA,OAAA,EAAK,EAAA,CAAG,QAAA,CAAS,MAAM,CAAA,SAAA,CAAW;AAAA,UAAA,EAC5F,QAAA,CAAS,MAAA,GAAS,CAAA,GAAI,QAAA,CAAS,GAAA,CAAI,CAAC,CAAA,KAAM,CAAA,CAAE,WAAW,CAAA,CAAE,IAAA,CAAK,IAAI,IAAI,MAAM;AAAA,sBAAA,EAChE,oBAAoB,MAAM,CAAA;;AAAA,gFAAA;AAAA,SAG7C,CAAA;AAED,QAAA,OAAO,IAAA;AAAA,MACT;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;ACt0BA,IAQa,gBAAA;AARb,IAAA,cAAA,GAAA,KAAA,CAAA;AAAA,EAAA,0BAAA,GAAA;AAKA,IAAA,eAAA,EAAA;AAGO,IAAM,mBAAN,MAAuB;AAAA,MAR9B;AAQ8B,QAAA,MAAA,CAAA,IAAA,EAAA,kBAAA,CAAA;AAAA;AAAA,MAC5B,MAAM,OAAOJ,OAAAA,EAA0C;AACrD,QAAA,MAAM,cAAc,CAAA,gBAAA,EAAmBM,UAAAA,GAAa,KAAA,CAAM,CAAA,EAAG,CAAC,CAAC,CAAA,CAAA;AAE/D,QAAA,MAAM,UAAA,GAAa;AAAA,UACjB,QAAA;AAAA,UACA,QAAA;AAAA,UACA,WAAA;AAAA,UACA,MAAA;AAAA,UACA,WAAA;AAAA,UACA,YAAA;AAAA,UACA,IAAA;AAAA,UACA,CAAA,EAAGN,QAAO,SAAS,CAAA,cAAA,CAAA;AAAA,UACnB,IAAA;AAAA,UACA,CAAA,EAAGA,QAAO,SAAS,CAAA,QAAA;AAAA,SACrB;AAGA,QAAA,IAAIA,QAAO,MAAA,EAAQ;AACjB,UAAA,UAAA,CAAW,IAAA,CAAK,IAAA,EAAM,CAAA,EAAGA,OAAAA,CAAO,MAAM,CAAA,CAAA,CAAG,CAAA;AAAA,QAC3C;AAGA,QAAA,IAAIA,QAAO,GAAA,EAAK;AACd,UAAA,KAAA,MAAW,CAAC,KAAK,KAAK,CAAA,IAAK,OAAO,OAAA,CAAQA,OAAAA,CAAO,GAAG,CAAA,EAAG;AACrD,YAAA,UAAA,CAAW,KAAK,IAAA,EAAM,CAAA,EAAG,GAAG,CAAA,CAAA,EAAI,KAAK,CAAA,CAAE,CAAA;AAAA,UACzC;AAAA,QACF;AAGA,QAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,kBAAA,CAAmBA,OAAAA,CAAO,OAAO,CAAA;AACpD,QAAA,UAAA,CAAW,KAAK,KAAK,CAAA;AAErB,QAAA,MAAM,MAAA,GAAS,kBAAkB,UAAU,CAAA;AAC3C,QAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,UAAA,MAAM,IAAI,KAAA,CAAM,CAAA,4BAAA,EAA+B,MAAA,CAAO,MAAM,CAAA,CAAE,CAAA;AAAA,QAChE;AAEA,QAAA,OAAO,WAAA;AAAA,MACT;AAAA,MAEA,MAAM,MAAM,WAAA,EAAoC;AAC9C,QAAA,MAAM,MAAA,GAAS,iBAAA,CAAkB,CAAC,OAAA,EAAS,WAAW,CAAC,CAAA;AACvD,QAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,UAAA,MAAM,IAAI,KAAA,CAAM,CAAA,0BAAA,EAA6B,WAAW,CAAA,EAAA,EAAK,MAAA,CAAO,MAAM,CAAA,CAAE,CAAA;AAAA,QAC9E;AAAA,MACF;AAAA,MAEA,MAAM,KAAK,WAAA,EAAoC;AAC7C,QAAA,MAAM,MAAA,GAAS,iBAAA,CAAkB,CAAC,MAAA,EAAQ,WAAW,CAAC,CAAA;AACtD,QAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AAEnB,UAAA,OAAA,CAAQ,KAAK,CAAA,kCAAA,EAAqC,WAAW,CAAA,EAAA,EAAK,MAAA,CAAO,MAAM,CAAA,CAAE,CAAA;AAAA,QACnF;AAAA,MACF;AAAA,MAEA,MAAM,OAAO,WAAA,EAAoC;AAC/C,QAAA,MAAM,SAAS,iBAAA,CAAkB,CAAC,IAAA,EAAM,IAAA,EAAM,WAAW,CAAC,CAAA;AAC1D,QAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AAEnB,UAAA,OAAA,CAAQ,KAAK,CAAA,oCAAA,EAAuC,WAAW,CAAA,EAAA,EAAK,MAAA,CAAO,MAAM,CAAA,CAAE,CAAA;AAAA,QACrF;AAAA,MACF;AAAA,MAEA,MAAM,IAAA,CAAK,WAAA,EAAqB,OAAA,EAA6C;AAC3E,QAAA,MAAM,SAAA,GAAY,KAAK,GAAA,EAAI;AAE3B,QAAA,MAAM,UAAA,GAAa,CAAC,MAAA,EAAQ,WAAA,EAAa,GAAG,OAAO,CAAA;AAEnD,QAAA,IAAI;AACF,UAAA,MAAM,MAAA,GAAS,MAAM,SAAA,CAAU,QAAA,EAAU,UAAU,CAAA;AACnD,UAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,EAAI,GAAI,SAAA;AAE9B,UAAA,OAAO;AAAA,YACL,SAAS,MAAA,CAAO,OAAA;AAAA,YAChB,QAAQ,MAAA,CAAO,MAAA;AAAA,YACf,OAAO,MAAA,CAAO,MAAA;AAAA,YACd,QAAA,EAAU,OAAO,IAAA,IAAQ,CAAA;AAAA,YACzB;AAAA,WACF;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,EAAI,GAAI,SAAA;AAC9B,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,OAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,OAAO,KAAK,CAAA;AAAA,YAC5D,QAAA,EAAU,CAAA;AAAA,YACV;AAAA,WACF;AAAA,QACF;AAAA,MACF;AAAA,MAEA,MAAM,KAAK,WAAA,EAAsC;AAC/C,QAAA,MAAM,MAAA,GAAS,iBAAA,CAAkB,CAAC,MAAA,EAAQ,WAAW,CAAC,CAAA;AACtD,QAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,UAAA,MAAM,IAAI,KAAA,CAAM,CAAA,iCAAA,EAAoC,WAAW,CAAA,EAAA,EAAK,MAAA,CAAO,MAAM,CAAA,CAAE,CAAA;AAAA,QACrF;AACA,QAAA,OAAO,MAAA,CAAO,MAAA;AAAA,MAChB;AAAA,MAEQ,mBAAmB,OAAA,EAAyB;AAClD,QAAA,QAAQ,OAAA;AAAS,UACf,KAAK,QAAA;AAAA,UACL,KAAK,QAAA;AACH,YAAA,OAAO,8BAAA;AAAA,UACT,KAAK,QAAA;AACH,YAAA,OAAO,8BAAA;AAAA,UACT;AACE,YAAA,OAAO,8BAAA;AAAA;AACX,MACF;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACtHA,IAMa,aAAA;AANb,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,+BAAA,GAAA;AAMO,IAAM,gBAAN,MAA8C;AAAA,MANrD;AAMqD,QAAA,MAAA,CAAA,IAAA,EAAA,eAAA,CAAA;AAAA;AAAA,MAC1C,IAAA,GAAO,QAAA;AAAA,MACP,KAAA,GAAQ,8BAAA;AAAA,MAEjB,cAAA,CAAe,QAAgB,OAAA,EAAmC;AAChE,QAAA,MAAM,UAAU,CAAC,KAAA,EAAO,gCAAA,EAAkC,OAAA,EAAS,YAAY,MAAM,CAAA;AAErF,QAAA,IAAI,QAAQ,OAAA,EAAS;AACnB,UAAA,OAAA,CAAQ,IAAA,CAAK,WAAA,EAAa,OAAA,CAAQ,OAAA,CAAQ,UAAU,CAAA;AAAA,QACtD;AAEA,QAAA,OAAO,OAAA;AAAA,MACT;AAAA,MAEA,WAAA,CAAY,QAAgB,MAAA,EAA6B;AACvD,QAAA,IAAI;AAEF,UAAA,MAAM,MAAA,GAAS,IAAA,CAAK,KAAA,CAAM,MAAM,CAAA;AAChC,UAAA,OAAO;AAAA,YACL,MAAA,EAAQ,OAAO,MAAA,IAAU,MAAA;AAAA,YACzB,KAAA,EAAO,MAAA,CAAO,KAAA,IAAS,EAAC;AAAA,YACxB,KAAA,EAAO,UAAU,MAAA,CAAO;AAAA,WAC1B;AAAA,QACF,CAAA,CAAA,MAAQ;AAEN,UAAA,OAAO;AAAA,YACL,MAAA,EAAQ,MAAA;AAAA,YACR,OAAO,EAAC;AAAA,YACR,KAAA,EAAO;AAAA,WACT;AAAA,QACF;AAAA,MACF;AAAA,MAEA,MAAM,mBAAA,GAAwC;AAC5C,QAAA,OAAO,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,iBAAA;AAAA,MACvB;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;AC1CA,IAMa,aAAA;AANb,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,+BAAA,GAAA;AAMO,IAAM,gBAAN,MAA8C;AAAA,MANrD;AAMqD,QAAA,MAAA,CAAA,IAAA,EAAA,eAAA,CAAA;AAAA;AAAA,MAC1C,IAAA,GAAO,QAAA;AAAA,MACP,KAAA,GAAQ,8BAAA;AAAA,MAEjB,cAAA,CAAe,QAAgB,OAAA,EAAmC;AAChE,QAAA,MAAM,OAAA,GAAU,CAAC,cAAA,EAAgB,KAAA,EAAO,UAAU,MAAM,CAAA;AAExD,QAAA,IAAI,QAAQ,OAAA,EAAS;AACnB,UAAA,OAAA,CAAQ,IAAA,CAAK,WAAA,EAAa,OAAA,CAAQ,OAAA,CAAQ,UAAU,CAAA;AAAA,QACtD;AAEA,QAAA,OAAO,OAAA;AAAA,MACT;AAAA,MAEA,WAAA,CAAY,QAAgB,MAAA,EAA6B;AACvD,QAAA,IAAI;AAEF,UAAA,MAAM,MAAA,GAAS,IAAA,CAAK,KAAA,CAAM,MAAM,CAAA;AAChC,UAAA,OAAO;AAAA,YACL,MAAA,EAAQ,OAAO,MAAA,IAAU,MAAA;AAAA,YACzB,KAAA,EAAO,MAAA,CAAO,KAAA,IAAS,EAAC;AAAA,YACxB,KAAA,EAAO,UAAU,MAAA,CAAO;AAAA,WAC1B;AAAA,QACF,CAAA,CAAA,MAAQ;AAEN,UAAA,OAAO;AAAA,YACL,MAAA,EAAQ,MAAA;AAAA,YACR,OAAO,EAAC;AAAA,YACR,KAAA,EAAO;AAAA,WACT;AAAA,QACF;AAAA,MACF;AAAA,MAEA,MAAM,mBAAA,GAAwC;AAC5C,QAAA,OAAO,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,cAAA;AAAA,MACvB;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;AC1CA,IAAA,YAAA,GAAA,KAAA,CAAA;AAAA,EAAA,8BAAA,GAAA;AAIA,IAAA,WAAA,EAAA;AACA,IAAA,WAAA,EAAA;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACLA,IAQa,eAAA;AARb,IAAA,aAAA,GAAA,KAAA,CAAA;AAAA,EAAA,yBAAA,GAAA;AAIA,IAAA,cAAA,EAAA;AACA,IAAA,YAAA,EAAA;AAGO,IAAM,kBAAN,MAAsB;AAAA,MAR7B;AAQ6B,QAAA,MAAA,CAAA,IAAA,EAAA,iBAAA,CAAA;AAAA;AAAA,MACnB,gBAAA;AAAA,MACA,QAAA;AAAA,MAER,WAAA,GAAc;AACZ,QAAA,IAAA,CAAK,gBAAA,GAAmB,IAAI,gBAAA,EAAiB;AAC7C,QAAA,IAAA,CAAK,QAAA,uBAAe,GAAA,CAA4B;AAAA,UAC9C,CAAC,QAAA,EAAU,IAAI,aAAA,EAAe,CAAA;AAAA,UAC9B,CAAC,QAAA,EAAU,IAAI,aAAA,EAAe;AAAA,SAC/B,CAAA;AAAA,MACH;AAAA,MAEA,MAAM,QAAQ,OAAA,EAAmD;AAC/D,QAAA,MAAM,OAAA,GAAU,IAAA,CAAK,QAAA,CAAS,GAAA,CAAI,QAAQ,OAAO,CAAA;AACjD,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,MAAM,IAAI,KAAA,CAAM,CAAA,iBAAA,EAAoB,OAAA,CAAQ,OAAO,CAAA,CAAE,CAAA;AAAA,QACvD;AAGA,QAAA,MAAM,OAAA,GAAU,MAAM,OAAA,CAAQ,mBAAA,EAAoB;AAClD,QAAA,IAAI,CAAC,OAAA,EAAS;AACZ,UAAA,MAAM,IAAI,KAAA,CAAM,CAAA,2CAAA,EAA8C,OAAA,CAAQ,OAAO,CAAA,CAAE,CAAA;AAAA,QACjF;AAEA,QAAA,MAAM,WAAA,GAAc,MAAM,IAAA,CAAK,gBAAA,CAAiB,MAAA,CAAO;AAAA,UACrD,SAAS,OAAA,CAAQ,OAAA;AAAA,UACjB,WAAW,OAAA,CAAQ,SAAA;AAAA,UACnB,WAAW,OAAA,CAAQ,SAAA;AAAA,UACnB,QAAQ,OAAA,CAAQ,MAAA;AAAA,UAChB,SAAS,OAAA,CAAQ,OAAA;AAAA,UACjB,KAAK,OAAA,CAAQ;AAAA,SACd,CAAA;AAED,QAAA,IAAI;AACF,UAAA,MAAM,IAAA,CAAK,gBAAA,CAAiB,KAAA,CAAM,WAAW,CAAA;AAC7C,UAAA,MAAM,OAAA,GAAU,OAAA,CAAQ,cAAA,CAAe,OAAA,CAAQ,MAAA,EAAQ;AAAA,YACrD,SAAS,OAAA,CAAQ,OAAA;AAAA,YACjB,QAAQ,OAAA,CAAQ,MAAA;AAAA,YAChB,KAAK,OAAA,CAAQ;AAAA,WACd,CAAA;AAED,UAAA,MAAM,SAAS,MAAM,IAAA,CAAK,gBAAA,CAAiB,IAAA,CAAK,aAAa,OAAO,CAAA;AAGpE,UAAA,IAAI,MAAA,CAAO,OAAA,IAAW,MAAA,CAAO,MAAA,EAAQ;AACnC,YAAA,MAAM,SAAS,OAAA,CAAQ,WAAA,CAAY,OAAO,MAAA,EAAQ,MAAA,CAAO,SAAS,EAAE,CAAA;AACpE,YAAA,OAAO;AAAA,cACL,GAAG,MAAA;AAAA,cACH,MAAA,EAAQ,IAAA,CAAK,SAAA,CAAU,MAAM;AAAA,aAC/B;AAAA,UACF;AAEA,UAAA,OAAO,MAAA;AAAA,QACT,CAAA,SAAE;AACA,UAAA,MAAM,IAAA,CAAK,gBAAA,CAAiB,IAAA,CAAK,WAAW,CAAA;AAC5C,UAAA,MAAM,IAAA,CAAK,gBAAA,CAAiB,MAAA,CAAO,WAAW,CAAA;AAAA,QAChD;AAAA,MACF;AAAA,MAEA,MAAM,aAAa,OAAA,EAAuD;AAExE,QAAA,MAAM,QAAA,GAAW,QAAQ,GAAA,CAAI,CAAC,WAAW,IAAA,CAAK,OAAA,CAAQ,MAAM,CAAC,CAAA;AAC7D,QAAA,OAAO,OAAA,CAAQ,IAAI,QAAQ,CAAA;AAAA,MAC7B;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACxEA,IAAA,eAAA,GAAA,EAAA;AAAA,QAAA,CAAA,eAAA,EAAA;AAAA,EAAA,aAAA,EAAA,MAAA,aAAA;AAAA,EAAA,gBAAA,EAAA,MAAA,gBAAA;AAAA,EAAA,aAAA,EAAA,MAAA,aAAA;AAAA,EAAA,eAAA,EAAA,MAAA;AAAA,CAAA,CAAA;AAAA,IAAA,YAAA,GAAA,KAAA,CAAA;AAAA,EAAA,sBAAA,GAAA;AAIA,IAAA,cAAA,EAAA;AACA,IAAA,aAAA,EAAA;AACA,IAAA,YAAA,EAAA;AAAA,EAAA;AAAA,CAAA,CAAA;ACNA,IAaa,QAAA;AAbb,IAAA,aAAA,GAAA,KAAA,CAAA;AAAA,EAAA,wBAAA,GAAA;AAaO,IAAM,WAAN,MAAe;AAAA,MAbtB;AAasB,QAAA,MAAA,CAAA,IAAA,EAAA,UAAA,CAAA;AAAA;AAAA,MACZ,KAAA,GAAQO,UAAU,0BAA0B,CAAA;AAAA,MAC5C,MAAA;AAAA,MACA,GAAA;AAAA,MAER,YAAYP,OAAAA,EAAwB;AAClC,QAAA,IAAA,CAAK,MAAA,GAASA,OAAAA;AACd,QAAA,IAAA,CAAK,GAAA,GAAM,SAAA,CAAUA,OAAAA,CAAO,gBAAgB,CAAA;AAAA,MAC9C;AAAA;AAAA;AAAA;AAAA,MAMA,MAAM,eAAA,CAAgB,MAAA,EAAsB,MAAA,EAA+C;AACzF,QAAA,MAAM,UAA0B,EAAC;AAEjC,QAAA,KAAA,MAAW,OAAA,IAAW,OAAO,QAAA,EAAU;AACrC,UAAA,IAAI,CAAC,QAAQ,gBAAA,EAAkB;AAC7B,YAAA,OAAA,CAAQ,IAAA,CAAK;AAAA,cACX,OAAA,EAAS,KAAA;AAAA,cACT,MAAA,EAAQ,CAAA,QAAA,EAAW,OAAA,CAAQ,IAAI,CAAA,CAAA;AAAA,cAC/B,aAAa,OAAA,CAAQ,WAAA;AAAA,cACrB,KAAA,EAAO,qCAAA;AAAA,cACP,OAAA,EAAS,IAAA;AAAA,cACT,SAAA,EAAW;AAAA,aACZ,CAAA;AACD,YAAA;AAAA,UACF;AAEA,UAAA,MAAM,SAAS,MAAM,IAAA,CAAK,eAAe,MAAA,EAAQ,MAAA,CAAO,UAAU,OAAO,CAAA;AACzE,UAAA,OAAA,CAAQ,KAAK,MAAM,CAAA;AAAA,QACrB;AAEA,QAAA,OAAO,OAAA;AAAA,MACT;AAAA,MAEA,MAAM,eAAA,CAAgB,MAAA,EAAsB,MAAA,EAA+C;AACzF,QAAA,MAAM,UAA0B,EAAC;AACjC,QAAA,MAAM,WAAA,GAAc,OAAO,QAAA,CAAS,KAAA,CAAM,OAAO,CAAC,CAAA,KAAM,CAAA,CAAE,MAAA,KAAW,aAAa,CAAA;AAElF,QAAA,KAAA,MAAW,YAAY,WAAA,EAAa;AAClC,UAAA,MAAM,SAAS,MAAM,IAAA,CAAK,oBAAoB,MAAA,EAAQ,MAAA,CAAO,UAAU,QAAA,EAAU;AAAA,YAC/E,SAAS,MAAA,CAAO;AAAA,WACjB,CAAA;AACD,UAAA,OAAA,CAAQ,KAAK,MAAM,CAAA;AAAA,QACrB;AAEA,QAAA,OAAO,OAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAMA,MAAc,cAAA,CACZ,MAAA,EACA,QAAA,EACA,OAAA,EACuB;AACvB,QAAA,QAAQ,QAAQ,IAAA;AAAM,UACpB,KAAK,YAAA;AACH,YAAA,OAAO,IAAA,CAAK,YAAA,CAAa,MAAA,EAAQ,QAAA,EAAU,OAAO,CAAA;AAAA,UACpD,KAAK,iBAAA;AAEH,YAAA,OAAO;AAAA,cACL,OAAA,EAAS,IAAA;AAAA,cACT,MAAA,EAAQ,yBAAA;AAAA,cACR,WAAA,EAAa,8BAAA;AAAA,cACb,KAAA,EAAO,IAAA;AAAA,cACP,OAAA,EAAS,IAAA;AAAA,cACT,SAAA,EAAW;AAAA,aACb;AAAA,UACF;AACE,YAAA,OAAO;AAAA,cACL,OAAA,EAAS,KAAA;AAAA,cACT,MAAA,EAAQ,CAAA,QAAA,EAAW,OAAA,CAAQ,IAAI,CAAA,CAAA;AAAA,cAC/B,aAAa,OAAA,CAAQ,WAAA;AAAA,cACrB,KAAA,EAAO,CAAA,kCAAA,EAAqC,OAAA,CAAQ,IAAI,CAAA,CAAA;AAAA,cACxD,OAAA,EAAS,IAAA;AAAA,cACT,SAAA,EAAW;AAAA,aACb;AAAA;AACJ,MACF;AAAA,MAEA,MAAc,YAAA,CACZ,MAAA,EACA,QAAA,EACA,OAAA,EACuB;AACvB,QAAA,IAAI;AAEF,UAAA,MAAM,QAAQ,OAAA,CAAQ,GAAA;AACtB,UAAA,IAAI,CAAC,KAAA,EAAO;AACV,YAAA,OAAO;AAAA,cACL,OAAA,EAAS,KAAA;AAAA,cACT,MAAA,EAAQ,gBAAA;AAAA,cACR,aAAa,OAAA,CAAQ,WAAA;AAAA,cACrB,KAAA,EAAO,gCAAA;AAAA,cACP,OAAA,EAAS,IAAA;AAAA,cACT,SAAA,EAAW;AAAA,aACb;AAAA,UACF;AAGA,UAAA,MAAM,EAAE,IAAA,EAAM,QAAA,EAAS,GAAI,MAAMQ,YAAAA,CAAa;AAAA,YAC5C,OAAO,IAAA,CAAK,KAAA;AAAA,YACZ,MAAA,EAAQ,CAAA;;AAAA,YAAA,EAEF,QAAQ,WAAW;AAAA,KAAA,EAC1B,KAAK;;AAAA;AAAA,iEAAA;AAAA,WAIL,CAAA;AAID,UAAA,MAAM,MAAA,CAAO,WAAA;AAAA,YACX,QAAA;AAAA,YACA,CAAA;;AAAA,EAA6B,QAAQ;;AAAA,6BAAA;AAAA,WACvC;AAEA,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,MAAA,EAAQ,oBAAA;AAAA,YACR,WAAA,EAAa,CAAA,qBAAA,EAAwB,OAAA,CAAQ,WAAW,CAAA,CAAA;AAAA,YACxD,KAAA,EAAO,IAAA;AAAA,YACP,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,MAAA,EAAQ,gBAAA;AAAA,YACR,aAAa,OAAA,CAAQ,WAAA;AAAA,YACrB,OAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,OAAO,KAAK,CAAA;AAAA,YAC5D,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAMA,MAAc,mBAAA,CACZ,MAAA,EACA,QAAA,EACA,UACA,OAAA,EACuB;AACvB,QAAA,IAAI;AAEF,UAAA,IAAI,QAAA,CAAS,eAAA,IAAmB,QAAA,CAAS,IAAA,EAAM;AAC7C,YAAA,OAAO,IAAA,CAAK,eAAA,CAAgB,MAAA,EAAQ,QAAA,EAAU,QAAQ,CAAA;AAAA,UACxD;AAGA,UAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,gBAAA,CAAiB,UAAU,OAAO,CAAA;AAE9D,UAAA,IAAI,QAAA,CAAS,IAAA,KAAS,KAAA,IAAS,QAAA,CAAS,IAAA,EAAM;AAE5C,YAAA,OAAO,KAAK,QAAA,CAAS,MAAA,EAAQ,QAAA,EAAU,QAAA,EAAU,SAAS,OAAO,CAAA;AAAA,UACnE,CAAA,MAAO;AAEL,YAAA,OAAO,KAAK,iBAAA,CAAkB,MAAA,EAAQ,QAAA,EAAU,QAAA,EAAU,SAAS,OAAO,CAAA;AAAA,UAC5E;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,MAAA,EAAQ,CAAA,iBAAA,EAAoB,QAAA,CAAS,EAAE,CAAA,CAAA;AAAA,YACvC,WAAA,EAAa,QAAA,CAAS,IAAA,CAAK,KAAA,CAAM,GAAG,GAAG,CAAA;AAAA,YACvC,OAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,OAAO,KAAK,CAAA;AAAA,YAC5D,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAAA,MACF;AAAA,MAEA,MAAc,eAAA,CACZ,OAAA,EACA,SAAA,EACA,QAAA,EACuB;AACvB,QAAA,IAAI,CAAC,QAAA,CAAS,IAAA,IAAQ,CAAC,SAAS,eAAA,EAAiB;AAC/C,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,MAAA,EAAQ,kBAAA;AAAA,YACR,WAAA,EAAa,4BAAA;AAAA,YACb,KAAA,EAAO,uDAAA;AAAA,YACP,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAEA,QAAA,MAAM,WAAW,CAAA,EAAG,IAAA,CAAK,OAAO,gBAAgB,CAAA,CAAA,EAAI,SAAS,IAAI,CAAA,CAAA;AAEjE,QAAA,IAAI,CAACC,UAAAA,CAAW,QAAQ,CAAA,EAAG;AACzB,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,MAAA,EAAQ,kBAAA;AAAA,YACR,WAAA,EAAa,CAAA,gBAAA,EAAmB,QAAA,CAAS,IAAI,CAAA,CAAA;AAAA,YAC7C,KAAA,EAAO,4BAAA;AAAA,YACP,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAEA,QAAA,IAAI,IAAA,CAAK,OAAO,MAAA,EAAQ;AACtB,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,MAAA,EAAQ,4BAAA;AAAA,YACR,WAAA,EAAa,CAAA,0BAAA,EAA6B,QAAA,CAAS,IAAI,CAAA,CAAA;AAAA,YACvD,KAAA,EAAO,IAAA;AAAA,YACP,OAAA,EAAS,CAAC,EAAE,IAAA,EAAM,SAAS,IAAA,EAAM,IAAA,EAAM,YAAY,CAAA;AAAA,YACnD,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAKA,QAAA,MAAM,aAAa,QAAA,CAAS,eAAA;AAE5B,QAAA,MAAMC,SAAAA,CAAU,QAAA,EAAU,UAAA,EAAY,OAAO,CAAA;AAE7C,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,IAAA;AAAA,UACT,MAAA,EAAQ,kBAAA;AAAA,UACR,WAAA,EAAa,CAAA,sBAAA,EAAyB,QAAA,CAAS,IAAI,CAAA,CAAA;AAAA,UACnD,KAAA,EAAO,IAAA;AAAA,UACP,OAAA,EAAS,CAAC,EAAE,IAAA,EAAM,SAAS,IAAA,EAAM,IAAA,EAAM,YAAY,CAAA;AAAA,UACnD,SAAA,EAAW;AAAA,SACb;AAAA,MACF;AAAA,MAEA,MAAc,gBAAA,CACZ,QAAA,EACA,OAAA,EAC6D;AAC7D,QAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAMF,YAAAA,CAAa;AAAA,UAClC,OAAO,IAAA,CAAK,KAAA;AAAA,UACZ,MAAA,EAAQ,CAAA;;AAAA,IAAA,EAER,QAAQ,OAAO;;AAAA,cAAA,EAEL,QAAA,CAAS,MAAM,CAAA,EAAA,EAAK,QAAA,CAAS,QAAQ,CAAA;AAAA,EACnD,SAAS,IAAI;;AAAA,EAEb,SAAS,IAAA,GAAO,CAAA,MAAA,EAAS,QAAA,CAAS,IAAI,KAAK,EAAE;;AAAA;;AAAA;AAAA;AAAA,6CAAA;AAAA,SAO1C,CAAA;AAED,QAAA,MAAM,SAAA,GAAY,IAAA,CAAK,KAAA,CAAM,8BAA8B,CAAA;AAC3D,QAAA,MAAM,YAAA,GAAe,IAAA,CAAK,KAAA,CAAM,uBAAuB,CAAA;AAEvD,QAAA,OAAO;AAAA,UACL,IAAA,EAAO,SAAA,GAAY,CAAC,CAAA,EAAG,aAAY,IAAiC,eAAA;AAAA,UACpE,OAAA,EAAS,YAAA,GAAe,CAAC,CAAA,EAAG,MAAK,IAAK;AAAA,SACxC;AAAA,MACF;AAAA,MAEA,MAAc,QAAA,CACZ,MAAA,EACA,QAAA,EACA,UACA,GAAA,EACuB;AACvB,QAAA,IAAI,CAAC,SAAS,IAAA,EAAM;AAClB,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,MAAA,EAAQ,WAAA;AAAA,YACR,WAAA,EAAa,sBAAA;AAAA,YACb,KAAA,EAAO,sCAAA;AAAA,YACP,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAEA,QAAA,IAAI,IAAA,CAAK,OAAO,MAAA,EAAQ;AACtB,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,MAAA,EAAQ,qBAAA;AAAA,YACR,WAAA,EAAa,CAAA,mBAAA,EAAsB,QAAA,CAAS,IAAI,CAAA,CAAA;AAAA,YAChD,KAAA,EAAO,IAAA;AAAA,YACP,OAAA,EAAS,CAAC,EAAE,IAAA,EAAM,SAAS,IAAA,EAAM,IAAA,EAAM,YAAY,CAAA;AAAA,YACnD,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAGA,QAAA,IAAI;AAEF,UAAA,MAAM,MAAA,CAAO,WAAA;AAAA,YACX,QAAA;AAAA,YACA,CAAA,qBAAA,EAAwB,SAAS,IAAI;;AAAA;AAAA,EAAe,GAAG;AAAA;;AAAA,6BAAA,EAA4C,SAAS,MAAM,CAAA,CAAA;AAAA,WACpH;AAEA,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,MAAA,EAAQ,aAAA;AAAA,YACR,WAAA,EAAa,CAAA,0BAAA,EAA6B,QAAA,CAAS,IAAI,CAAA,CAAA;AAAA,YACvD,KAAA,EAAO,IAAA;AAAA,YACP,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,MAAA,EAAQ,WAAA;AAAA,YACR,WAAA,EAAa,CAAA,uBAAA,EAA0B,QAAA,CAAS,IAAI,CAAA,CAAA;AAAA,YACpD,OAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,OAAO,KAAK,CAAA;AAAA,YAC5D,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAAA,MACF;AAAA,MAEA,MAAc,iBAAA,CACZ,MAAA,EACA,QAAA,EACA,UACA,aAAA,EACuB;AACvB,QAAA,IAAI;AAEF,UAAA,MAAM,cAAA,GAAiB,QAAA,CAAS,EAAA,CAAG,KAAA,CAAM,eAAe,CAAA;AACxD,UAAA,MAAM,SAAA,GAAY,iBAAiB,CAAC,CAAA;AACpC,UAAA,IAAI,SAAA,EAAW;AACb,YAAA,MAAM,MAAA,CAAO,eAAe,QAAA,EAAU,MAAA,CAAO,SAAS,SAAA,EAAW,EAAE,GAAG,aAAa,CAAA;AAAA,UACrF,CAAA,MAAO;AACL,YAAA,MAAM,MAAA,CAAO,WAAA,CAAY,QAAA,EAAU,CAAA,IAAA,EAAO,SAAS,MAAM,CAAA;;AAAA,EAAkB,aAAa,CAAA,CAAE,CAAA;AAAA,UAC5F;AAEA,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,MAAA,EAAQ,oBAAA;AAAA,YACR,WAAA,EAAa,CAAA,aAAA,EAAgB,QAAA,CAAS,MAAM,CAAA,WAAA,CAAA;AAAA,YAC5C,KAAA,EAAO,IAAA;AAAA,YACP,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,MAAA,EAAQ,oBAAA;AAAA,YACR,WAAA,EAAa,CAAA,qBAAA,EAAwB,QAAA,CAAS,MAAM,CAAA,CAAA;AAAA,YACpD,OAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,OAAO,KAAK,CAAA;AAAA,YAC5D,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAMA,MAAM,cAAc,OAAA,EAAwC;AAC1D,QAAA,IAAI,IAAA,CAAK,OAAO,MAAA,EAAQ;AACtB,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,MAAA,EAAQ,2BAAA;AAAA,YACR,WAAA,EAAa,iBAAiB,OAAO,CAAA,CAAA;AAAA,YACrC,KAAA,EAAO,IAAA;AAAA,YACP,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAEA,QAAA,IAAI;AAEF,UAAA,MAAM,IAAA,CAAK,GAAA,CAAI,GAAA,CAAI,IAAI,CAAA;AACvB,UAAA,MAAM,IAAA,CAAK,GAAA,CAAI,MAAA,CAAO,OAAO,CAAA;AAC7B,UAAA,MAAM,YAAY,MAAM,IAAA,CAAK,IAAI,QAAA,CAAS,CAAC,MAAM,CAAC,CAAA;AAClD,UAAA,MAAM,IAAA,CAAK,IAAI,IAAA,EAAK;AAEpB,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,IAAA;AAAA,YACT,MAAA,EAAQ,iBAAA;AAAA,YACR,WAAA,EAAa,OAAA;AAAA,YACb,KAAA,EAAO,IAAA;AAAA,YACP,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW,UAAU,IAAA;AAAK,WAC5B;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAO;AAAA,YACL,OAAA,EAAS,KAAA;AAAA,YACT,MAAA,EAAQ,iBAAA;AAAA,YACR,WAAA,EAAa,OAAA;AAAA,YACb,OAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,OAAO,KAAK,CAAA;AAAA,YAC5D,OAAA,EAAS,IAAA;AAAA,YACT,SAAA,EAAW;AAAA,WACb;AAAA,QACF;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,SAAA,GAAoF;AACxF,QAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,GAAA,CAAI,MAAA,EAAO;AACrC,QAAA,OAAO;AAAA,UACL,UAAU,MAAA,CAAO,QAAA;AAAA,UACjB,QAAQ,MAAA,CAAO,MAAA;AAAA,UACf,WAAW,MAAA,CAAO;AAAA,SACpB;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,OAAA,CAAQ,MAAA,GAAS,KAAA,EAAwB;AAC7C,QAAA,IAAI,MAAA,EAAQ;AACV,UAAA,OAAO,IAAA,CAAK,GAAA,CAAI,IAAA,CAAK,CAAC,UAAU,CAAC,CAAA;AAAA,QACnC;AACA,QAAA,OAAO,IAAA,CAAK,IAAI,IAAA,EAAK;AAAA,MACvB;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACtbA,IAAA,cAAA,GAAA,EAAA;AAAA,QAAA,CAAA,cAAA,EAAA;AAAA,EAAA,MAAA,EAAA,MAAA;AAAA,CAAA,CAAA;AAAA,IAUa,MAAA;AAVb,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,sBAAA,GAAA;AAAA,IAAA,WAAA,EAAA;AACA,IAAA,aAAA,EAAA;AACA,IAAA,aAAA,EAAA;AAQO,IAAM,SAAN,MAAa;AAAA,MAVpB;AAUoB,QAAA,MAAA,CAAA,IAAA,EAAA,QAAA,CAAA;AAAA;AAAA,MACV,MAAA;AAAA,MACA,QAAA;AAAA,MACA,QAAA;AAAA,MAER,YAAYR,OAAAA,EAAsB;AAChC,QAAA,IAAA,CAAK,MAAA,GAAS,IAAI,YAAA,CAAaA,OAAAA,CAAO,MAAM,CAAA;AAC5C,QAAA,IAAA,CAAK,QAAA,GAAW,IAAI,QAAA,EAAS;AAC7B,QAAA,IAAA,CAAK,QAAA,GAAW,IAAI,QAAA,CAASA,OAAAA,CAAO,QAAQ,CAAA;AAAA,MAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,QAAQ,QAAA,EAAyC;AACrD,QAAA,OAAO,IAAA,CAAK,QAAA,CAAS,SAAA,CAAU,IAAA,CAAK,QAAQ,QAAQ,CAAA;AAAA,MACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,QAAQ,QAAA,EAGX;AACD,QAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,OAAA,CAAQ,QAAQ,CAAA;AAC1C,QAAA,MAAM,UAA0B,EAAC;AAGjC,QAAA,MAAM,iBAAiB,MAAM,IAAA,CAAK,SAAS,eAAA,CAAgB,IAAA,CAAK,QAAQ,MAAM,CAAA;AAC9E,QAAA,OAAA,CAAQ,IAAA,CAAK,GAAG,cAAc,CAAA;AAG9B,QAAA,MAAM,kBAAkB,MAAM,IAAA,CAAK,SAAS,eAAA,CAAgB,IAAA,CAAK,QAAQ,MAAM,CAAA;AAC/E,QAAA,OAAA,CAAQ,IAAA,CAAK,GAAG,eAAe,CAAA;AAG/B,QAAA,MAAM,aAAA,GAAgB,MAAM,IAAA,CAAK,OAAA,CAAQ,QAAQ,CAAA;AAEjD,QAAA,OAAO;AAAA,UACL,MAAA,EAAQ,aAAA;AAAA,UACR;AAAA,SACF;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,KAAK,QAAA,EAA2C;AACpD,QAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,OAAA,CAAQ,QAAQ,CAAA;AAC1C,QAAA,MAAM,QAAiC,EAAC;AACxC,QAAA,IAAI,KAAA,GAAQ,CAAA;AAGZ,QAAA,KAAA,MAAW,OAAA,IAAW,OAAO,QAAA,CAAS,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,CAAE,IAAA,KAAS,YAAY,CAAA,EAAG;AAC5E,UAAA,KAAA,CAAM,IAAA,CAAK;AAAA,YACT,KAAA,EAAO,KAAA,EAAA;AAAA,YACP,MAAA,EAAQ,gBAAA;AAAA,YACR,aAAa,OAAA,CAAQ,WAAA;AAAA,YACrB,WAAW,OAAA,CAAQ,gBAAA;AAAA,YACnB,iBAAA,EAAmB,cAAA;AAAA,YACnB,cAAc;AAAC,WAChB,CAAA;AAAA,QACH;AAGA,QAAA,MAAM,YAAA,GAAe,KAAA;AACrB,QAAA,MAAM,WAAA,GAAc,OAAO,QAAA,CAAS,KAAA,CAAM,OAAO,CAAC,CAAA,KAAM,CAAA,CAAE,MAAA,KAAW,aAAa,CAAA;AAClF,QAAA,IAAI,WAAA,CAAY,SAAS,CAAA,EAAG;AAC1B,UAAA,KAAA,CAAM,IAAA,CAAK;AAAA,YACT,KAAA,EAAO,KAAA,EAAA;AAAA,YACP,MAAA,EAAQ,kBAAA;AAAA,YACR,WAAA,EAAa,CAAA,EAAG,WAAA,CAAY,MAAM,CAAA,0BAAA,CAAA;AAAA,YAClC,WAAW,WAAA,CAAY,KAAA,CAAM,CAAC,CAAA,KAAM,EAAE,gBAAgB,CAAA;AAAA,YACtD,iBAAA,EAAmB,GAAG,WAAA,CAAY,MAAA,GAAS,CAAC,CAAA,CAAA,EAAI,WAAA,CAAY,SAAS,CAAC,CAAA,QAAA,CAAA;AAAA,YACtE,YAAA,EAAc,KAAA,CAAM,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,CAAE,MAAA,KAAW,gBAAgB,CAAA,CAAE,GAAA,CAAI,CAAC,CAAA,KAAM,EAAE,KAAK;AAAA,WACpF,CAAA;AAAA,QACH;AAGA,QAAA,IAAI,KAAA,CAAM,SAAS,CAAA,EAAG;AACpB,UAAA,KAAA,CAAM,IAAA,CAAK;AAAA,YACT,KAAA,EAAO,KAAA,EAAA;AAAA,YACP,MAAA,EAAQ,mBAAA;AAAA,YACR,WAAA,EAAa,2CAAA;AAAA,YACb,SAAA,EAAW,IAAA;AAAA,YACX,iBAAA,EAAmB,aAAA;AAAA,YACnB,YAAA,EAAc,CAAC,YAAY;AAAA,WAC5B,CAAA;AAAA,QACH;AAGA,QAAA,KAAA,CAAM,IAAA,CAAK;AAAA,UACT,KAAA,EAAO,KAAA,EAAA;AAAA,UACP,MAAA,EAAQ,aAAA;AAAA,UACR,WAAA,EAAa,oCAAA;AAAA,UACb,SAAA,EAAW,IAAA;AAAA,UACX,iBAAA,EAAmB,cAAA;AAAA,UACnB,cAAc,KAAA,CAAM,GAAA,CAAI,CAAC,CAAA,KAAM,EAAE,KAAK;AAAA,SACvC,CAAA;AAGD,QAAA,KAAA,CAAM,IAAA,CAAK;AAAA,UACT,KAAA,EAAO,KAAA,EAAA;AAAA,UACP,MAAA,EAAQ,UAAA;AAAA,UACR,WAAA,EAAa,mCAAA;AAAA,UACb,SAAA,EAAW,KAAA;AAAA;AAAA,UACX,iBAAA,EAAmB,UAAA;AAAA,UACnB,YAAA,EAAc,CAAC,KAAA,GAAQ,CAAC;AAAA,SACzB,CAAA;AAED,QAAA,MAAM,eAAe,KAAA,CAAM,IAAA,CAAK,CAAC,CAAA,KAAM,CAAC,EAAE,SAAS,CAAA;AAEnD,QAAA,OAAO;AAAA,UACL,QAAA;AAAA,UACA,KAAA;AAAA,UACA,sBAAA,EAAwB,eAAA;AAAA,UACxB,yBAAA,EAA2B,YAAA;AAAA,UAC3B,uBAAA,EAAyB,eAAe,8CAAA,GAAiD;AAAA,SAC3F;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,aAAA,CACJ,QAAA,EACA,OAAA,GAGI,EAAC,EAMJ;AACD,QAAA,MAAM,aAAA,GAAgB,QAAQ,aAAA,IAAiB,EAAA;AAC/C,QAAA,MAAM,aAA6B,EAAC;AACpC,QAAA,IAAI,SAAA,GAAY,CAAA;AAEhB,QAAA,OAAO,YAAY,aAAA,EAAe;AAChC,UAAA,SAAA,EAAA;AAEA,UAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,OAAA,CAAQ,QAAQ,CAAA;AAC1C,UAAA,OAAA,CAAQ,UAAA,GAAa,QAAQ,SAAS,CAAA;AAEtC,UAAA,IAAI,MAAA,CAAO,WAAW,gBAAA,EAAkB;AACtC,YAAA,OAAO;AAAA,cACL,OAAA,EAAS,IAAA;AAAA,cACT,WAAA,EAAa,MAAA;AAAA,cACb,UAAA,EAAY,SAAA;AAAA,cACZ;AAAA,aACF;AAAA,UACF;AAEA,UAAA,IAAI,MAAA,CAAO,WAAW,SAAA,EAAW;AAC/B,YAAA,OAAO;AAAA,cACL,OAAA,EAAS,KAAA;AAAA,cACT,WAAA,EAAa,MAAA;AAAA,cACb,UAAA,EAAY,SAAA;AAAA,cACZ;AAAA,aACF;AAAA,UACF;AAEA,UAAA,IAAI,MAAA,CAAO,WAAW,UAAA,EAAY;AAEhC,YAAA,MAAM,IAAA,CAAK,UAAU,QAAQ,CAAA;AAC7B,YAAA;AAAA,UACF;AAGA,UAAA,MAAM,EAAE,OAAA,EAAQ,GAAI,MAAM,IAAA,CAAK,QAAQ,QAAQ,CAAA;AAC/C,UAAA,UAAA,CAAW,IAAA,CAAK,GAAG,OAAO,CAAA;AAG1B,UAAA,MAAM,oBAAoB,OAAA,CAAQ,MAAA,CAAO,CAAC,CAAA,KAAM,EAAE,OAAO,CAAA;AACzD,UAAA,IAAI,iBAAA,CAAkB,WAAW,CAAA,EAAG;AAClC,YAAA,OAAO;AAAA,cACL,OAAA,EAAS,KAAA;AAAA,cACT,WAAA,EAAa,MAAA;AAAA,cACb,UAAA,EAAY,SAAA;AAAA,cACZ;AAAA,aACF;AAAA,UACF;AAGA,UAAA,MAAM,UAAA,GAAa,OAAA,CAAQ,IAAA,CAAK,CAAC,CAAA,KAAM,EAAE,OAAA,IAAW,CAAA,CAAE,OAAA,CAAQ,MAAA,GAAS,CAAC,CAAA;AACxE,UAAA,IAAI,UAAA,EAAY;AACd,YAAA,MAAM,IAAA,CAAK,QAAA,CAAS,aAAA,CAAc,CAAA,iCAAA,EAAoC,SAAS,CAAA,CAAA,CAAG,CAAA;AAAA,UACpF;AAGA,UAAA,MAAM,IAAI,OAAA,CAAQ,CAACE,aAAY,UAAA,CAAWA,QAAAA,EAAS,GAAI,CAAC,CAAA;AAAA,QAC1D;AAEA,QAAA,MAAM,WAAA,GAAc,MAAM,IAAA,CAAK,OAAA,CAAQ,QAAQ,CAAA;AAC/C,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,YAAY,MAAA,KAAW,gBAAA;AAAA,UAChC,WAAA;AAAA,UACA,UAAA,EAAY,SAAA;AAAA,UACZ;AAAA,SACF;AAAA,MACF;AAAA,MAEA,MAAc,SAAA,CAAU,QAAA,EAAkB,SAAA,GAAY,GAAA,EAAuB;AAC3E,QAAA,MAAM,SAAA,GAAY,KAAK,GAAA,EAAI;AAC3B,QAAA,MAAM,YAAA,GAAe,GAAA;AAErB,QAAA,OAAO,IAAA,CAAK,GAAA,EAAI,GAAI,SAAA,GAAY,SAAA,EAAW;AACzC,UAAA,MAAM,EAAA,GAAK,MAAM,IAAA,CAAK,MAAA,CAAO,YAAY,QAAQ,CAAA;AACjD,UAAA,IAAI,CAAC,GAAG,UAAA,EAAY;AAClB,YAAA;AAAA,UACF;AACA,UAAA,MAAM,IAAI,OAAA,CAAQ,CAACA,aAAY,UAAA,CAAWA,QAAAA,EAAS,YAAY,CAAC,CAAA;AAAA,QAClE;AAEA,QAAA,MAAM,IAAI,MAAM,qBAAqB,CAAA;AAAA,MACvC;AAAA;AAAA;AAAA;AAAA,MAMA,MAAM,eAAe,QAAA,EAAiC;AAEpD,QAAA,MAAM,cAAA,GAAiB,CAAC,gBAAA,EAAkB,WAAW,CAAA;AACrD,QAAA,KAAA,MAAW,WAAW,cAAA,EAAgB;AACpC,UAAA,MAAM,IAAA,CAAK,MAAA,CAAO,WAAA,CAAY,QAAA,EAAU,OAAO,CAAA;AAAA,QACjD;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAMA,mBAAmB,MAAA,EAA8B;AAC/C,QAAA,MAAM,QAAkB,EAAC;AAEzB,QAAA,KAAA,CAAM,IAAA,CAAK,CAAA,qBAAA,EAAwB,MAAA,CAAO,QAAQ,CAAA,CAAE,CAAA;AACpD,QAAA,KAAA,CAAM,KAAK,EAAE,CAAA;AACb,QAAA,KAAA,CAAM,IAAA,CAAK,CAAA,WAAA,EAAc,MAAA,CAAO,OAAO,CAAA,CAAE,CAAA;AACzC,QAAA,KAAA,CAAM,IAAA,CAAK,CAAA,YAAA,EAAe,MAAA,CAAO,MAAM,CAAA,CAAE,CAAA;AACzC,QAAA,KAAA,CAAM,IAAA,CAAK,CAAA,SAAA,EAAY,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACrC,QAAA,KAAA,CAAM,KAAK,EAAE,CAAA;AAEb,QAAA,KAAA,CAAM,KAAK,cAAc,CAAA;AACzB,QAAA,KAAA,CAAM,IAAA,CAAK,MAAA,CAAO,EAAA,CAAG,UAAA,GAAa,8BAAyB,EAAE,CAAA;AAC7D,QAAA,KAAA,CAAM,IAAA,CAAK,MAAA,CAAO,EAAA,CAAG,UAAA,GAAa,0BAAqB,EAAE,CAAA;AACzD,QAAA,IAAI,MAAA,CAAO,EAAA,CAAG,QAAA,CAAS,MAAA,GAAS,CAAA,EAAG;AACjC,UAAA,KAAA,CAAM,KAAK,CAAA,OAAA,EAAK,MAAA,CAAO,EAAA,CAAG,QAAA,CAAS,MAAM,CAAA,gBAAA,CAAkB,CAAA;AAC3D,UAAA,KAAA,MAAW,OAAA,IAAW,MAAA,CAAO,EAAA,CAAG,QAAA,EAAU;AACxC,YAAA,KAAA,CAAM,KAAK,CAAA,IAAA,EAAO,OAAA,CAAQ,IAAI,CAAA,EAAA,EAAK,OAAA,CAAQ,GAAG,CAAA,CAAE,CAAA;AAAA,UAClD;AAAA,QACF;AACA,QAAA,KAAA,CAAM,KAAK,EAAE,CAAA;AAEb,QAAA,KAAA,CAAM,KAAK,aAAa,CAAA;AACxB,QAAA,KAAA,CAAM,IAAA,CAAK,UAAU,MAAA,CAAO,QAAA,CAAS,KAAK,CAAA,gBAAA,EAAmB,MAAA,CAAO,QAAA,CAAS,WAAW,CAAA,CAAE,CAAA;AAC1F,QAAA,IAAI,MAAA,CAAO,QAAA,CAAS,WAAA,GAAc,CAAA,EAAG;AACnC,UAAA,KAAA,CAAM,KAAK,EAAE,CAAA;AACb,UAAA,KAAA,CAAM,KAAK,wBAAwB,CAAA;AACnC,UAAA,KAAA,MAAW,IAAA,IAAQ,MAAA,CAAO,QAAA,CAAS,KAAA,CAAM,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,CAAE,MAAA,KAAW,aAAa,CAAA,EAAG;AAClF,YAAA,KAAA,CAAM,IAAA,CAAK,CAAA,IAAA,EAAO,IAAA,CAAK,QAAQ,WAAW,IAAA,CAAK,MAAM,CAAA,EAAA,EAAK,IAAA,CAAK,IAAA,CAAK,KAAA,CAAM,CAAA,EAAG,GAAG,CAAC,CAAA,GAAA,CAAK,CAAA;AACtF,YAAA,IAAI,KAAK,gBAAA,EAAkB;AACzB,cAAA,KAAA,CAAM,KAAK,CAAA,0BAAA,CAAuB,CAAA;AAAA,YACpC;AAAA,UACF;AAAA,QACF;AACA,QAAA,KAAA,CAAM,KAAK,EAAE,CAAA;AAEb,QAAA,KAAA,CAAM,KAAK,aAAa,CAAA;AACxB,QAAA,IAAI,MAAA,CAAO,QAAA,CAAS,MAAA,KAAW,CAAA,EAAG;AAChC,UAAA,KAAA,CAAM,KAAK,MAAM,CAAA;AAAA,QACnB,CAAA,MAAO;AACL,UAAA,KAAA,MAAW,OAAA,IAAW,OAAO,QAAA,EAAU;AACrC,YAAA,KAAA,CAAM,KAAK,CAAA,IAAA,EAAO,OAAA,CAAQ,IAAI,CAAA,IAAA,EAAO,OAAA,CAAQ,WAAW,CAAA,CAAE,CAAA;AAC1D,YAAA,KAAA,CAAM,KAAK,CAAA,qBAAA,EAAwB,OAAA,CAAQ,gBAAA,GAAmB,KAAA,GAAQ,IAAI,CAAA,CAAE,CAAA;AAAA,UAC9E;AAAA,QACF;AACA,QAAA,KAAA,CAAM,KAAK,EAAE,CAAA;AAEb,QAAA,KAAA,CAAM,KAAK,iBAAiB,CAAA;AAC5B,QAAA,KAAA,MAAW,MAAA,IAAU,OAAO,WAAA,EAAa;AACvC,UAAA,MAAM,IAAA,GAAO,MAAA,CAAO,SAAA,GAAY,WAAA,GAAO,WAAA;AACvC,UAAA,KAAA,CAAM,IAAA,CAAK,GAAG,IAAI,CAAA,EAAA,EAAK,OAAO,QAAQ,CAAA,EAAA,EAAK,MAAA,CAAO,MAAM,CAAA,CAAE,CAAA;AAAA,QAC5D;AACA,QAAA,KAAA,CAAM,KAAK,EAAE,CAAA;AAEb,QAAA,KAAA,CAAM,KAAK,YAAY,CAAA;AACvB,QAAA,KAAA,CAAM,IAAA,CAAK,OAAO,OAAO,CAAA;AACzB,QAAA,KAAA,CAAM,KAAK,EAAE,CAAA;AAEb,QAAA,KAAA,CAAM,IAAA,CAAK,CAAA,YAAA,EAAe,MAAA,CAAO,SAAS,CAAA,CAAA,CAAG,CAAA;AAE7C,QAAA,OAAO,KAAA,CAAM,KAAK,IAAI,CAAA;AAAA,MACxB;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;AClTA,WAAA,EAAA;AACA,eAAA,EAAA;AACA,WAAA,EAAA;;;ACRA,WAAA,EAAA;AAIA,IAAM,gBAAA,GAAmB,2BAAA;AAGzB,IAAM,yBAAyB,CAAC,GAAA,EAAK,GAAA,EAAK,GAAA,EAAK,KAAK,GAAG,CAAA;AAGvD,IAAM,mBAAA,GAAsB,CAAA;AAG5B,IAAM,mBAAA,GAAsB,GAAA;AAG5B,IAAM,gBAAA,GAAmB,iBAAA;AAGzB,IAAM,iBAAA,GAAoB,GAAA;AAG1B,IAAM,eAAA,GAAkB,GAAA;AAkBxB,SAAS,gBAAgB,OAAA,EAAuB;AAC9C,EAAA,IAAI,CAAC,OAAA,IAAW,OAAO,OAAA,KAAY,QAAA,EAAU;AAC3C,IAAA,MAAM,IAAI,MAAM,2CAA2C,CAAA;AAAA,EAC7D;AACA,EAAA,IAAI,OAAA,CAAQ,SAAS,GAAA,EAAK;AACxB,IAAA,MAAM,IAAI,MAAM,kDAAkD,CAAA;AAAA,EACpE;AACA,EAAA,IAAI,CAAC,gBAAA,CAAiB,IAAA,CAAK,OAAO,CAAA,EAAG;AACnC,IAAA,MAAM,IAAI,MAAM,8EAA8E,CAAA;AAAA,EAChG;AACF;AAVS,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAeT,SAAS,mBAAmB,IAAA,EAAoB;AAC9C,EAAA,IAAI,CAAC,IAAA,IAAQ,OAAO,IAAA,KAAS,QAAA,EAAU;AACrC,IAAA,MAAM,IAAI,MAAM,8CAA8C,CAAA;AAAA,EAChE;AACA,EAAA,IAAI,IAAA,CAAK,IAAA,EAAK,CAAE,MAAA,KAAW,CAAA,EAAG;AAC5B,IAAA,MAAM,IAAI,MAAM,6BAA6B,CAAA;AAAA,EAC/C;AACA,EAAA,IAAI,IAAA,CAAK,SAAS,iBAAA,EAAmB;AACnC,IAAA,MAAM,IAAI,KAAA,CAAM,CAAA,oCAAA,EAAuC,iBAAiB,CAAA,YAAA,CAAc,CAAA;AAAA,EACxF;AACF;AAVS,MAAA,CAAA,kBAAA,EAAA,oBAAA,CAAA;AAeT,SAAS,mBAAmB,UAAA,EAA0B;AACpD,EAAA,IAAI,CAAC,UAAA,IAAc,OAAO,UAAA,KAAe,QAAA,EAAU;AACjD,IAAA,MAAM,IAAI,MAAM,6CAA6C,CAAA;AAAA,EAC/D;AACA,EAAA,IAAI,UAAA,CAAW,SAAS,eAAA,EAAiB;AACvC,IAAA,MAAM,IAAI,KAAA,CAAM,CAAA,wCAAA,EAA2C,eAAe,CAAA,YAAA,CAAc,CAAA;AAAA,EAC1F;AAEA,EAAA,IAAI,CAAC,UAAA,CAAW,QAAA,CAAS,GAAG,CAAA,EAAG;AAC7B,IAAA,MAAM,IAAI,MAAM,0DAA0D,CAAA;AAAA,EAC5E;AACF;AAXS,MAAA,CAAA,kBAAA,EAAA,oBAAA,CAAA;AAiBT,SAAS,mBAAmB,GAAA,EAAmB;AAC7C,EAAA,IAAI,CAAC,GAAA,IAAO,OAAO,GAAA,KAAQ,QAAA,EAAU;AACnC,IAAA,MAAM,IAAI,MAAM,8CAA8C,CAAA;AAAA,EAChE;AAEA,EAAA,IAAI,MAAA;AACJ,EAAA,IAAI;AACF,IAAA,MAAA,GAAS,IAAI,IAAI,GAAG,CAAA;AAAA,EACtB,CAAA,CAAA,MAAQ;AACN,IAAA,MAAM,IAAI,MAAM,gCAAgC,CAAA;AAAA,EAClD;AAGA,EAAA,IAAI,MAAA,CAAO,aAAa,QAAA,EAAU;AAChC,IAAA,MAAM,IAAI,MAAM,qCAAqC,CAAA;AAAA,EACvD;AAGA,EAAA,MAAM,QAAA,GAAW,MAAA,CAAO,QAAA,CAAS,WAAA,EAAY;AAC7C,EAAA,MAAM,eAAA,GAAkB;AAAA,IACtB,cAAA;AAAA,IACA,QAAA;AAAA,IACA,OAAA;AAAA,IACA,gCAAA;AAAA,IACA,aAAA;AAAA,IACA,aAAA;AAAA,IACA,MAAA;AAAA,IACA,WAAA;AAAA,IACA,QAAA;AAAA,IACA,QAAA;AAAA,IACA,WAAA;AAAA,IACA,cAAA;AAAA,IACA,cAAA;AAAA,IACA,WAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,KAAA,MAAW,WAAW,eAAA,EAAiB;AACrC,IAAA,IAAI,OAAA,CAAQ,IAAA,CAAK,QAAQ,CAAA,EAAG;AAC1B,MAAA,MAAM,IAAI,MAAM,wDAAwD,CAAA;AAAA,IAC1E;AAAA,EACF;AAGA,EAAA,IAAI,QAAA,KAAa,iBAAA,IAAqB,QAAA,CAAS,QAAA,CAAS,iBAAiB,CAAA,EAAG;AAC1E,IAAA,MAAM,IAAI,MAAM,qDAAqD,CAAA;AAAA,EACvE;AACF;AA/CS,MAAA,CAAA,kBAAA,EAAA,oBAAA,CAAA;AAoDT,SAASS,eAAc,KAAA,EAAwB;AAC7C,EAAA,MAAM,UAAU,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,OAAO,KAAK,CAAA;AAErE,EAAA,OAAO,OAAA,CACJ,OAAA,CAAQ,4BAAA,EAA8B,mBAAmB,CAAA,CACzD,OAAA,CAAQ,+CAAA,EAAiD,oBAAoB,CAAA,CAC7E,OAAA,CAAQ,yCAAA,EAA2C,kBAAkB,CAAA;AAC1E;AAPS,MAAA,CAAAA,cAAAA,EAAA,eAAA,CAAA;AASF,IAAM,YAAN,MAAgB;AAAA,EA3JvB;AA2JuB,IAAA,MAAA,CAAA,IAAA,EAAA,WAAA,CAAA;AAAA;AAAA,EACJ,MAAA;AAAA,EACA,OAAA;AAAA,EACA,OAAA;AAAA,EACA,UAAA;AAAA,EACA,UAAA;AAAA,EAEjB,WAAA,CAAY,OAAA,GAA4B,EAAC,EAAG;AAE1C,IAAA,IAAA,CAAK,MAAA,GAAS,OAAA,CAAQ,MAAA,IAAU,OAAA,CAAQ,IAAI,cAAA,IAAkB,EAAA;AAC9D,IAAA,IAAA,CAAK,OAAA,GAAU,QAAQ,OAAA,IAAW,GAAA;AAGlC,IAAA,IAAA,CAAK,OAAA,GAAU,QAAQ,OAAA,IAAW,gBAAA;AAClC,IAAA,IAAA,CAAK,UAAA,GAAa,QAAQ,UAAA,IAAc,mBAAA;AACxC,IAAA,IAAA,CAAK,UAAA,GAAa,QAAQ,UAAA,IAAc,mBAAA;AAExC,IAAA,IAAI,CAAC,KAAK,MAAA,EAAQ;AAChB,MAAA,MAAM,IAAI,MAAM,2EAA2E,CAAA;AAAA,IAC7F;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,WAAA,GAAuB;AAC5B,IAAA,OAAO,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,cAAA;AAAA,EACvB;AAAA,EAEA,MAAc,OAAA,CACZ,QAAA,EACA,SAAiB,KAAA,EACjB,IAAA,EACA,UAAkB,CAAA,EACE;AACpB,IAAA,MAAM,GAAA,GAAM,CAAA,EAAG,IAAA,CAAK,OAAO,GAAG,QAAQ,CAAA,CAAA;AACtC,IAAA,MAAM,UAAA,GAAa,IAAI,eAAA,EAAgB;AACvC,IAAA,MAAM,YAAY,UAAA,CAAW,MAAM,WAAW,KAAA,EAAM,EAAG,KAAK,OAAO,CAAA;AAEnE,IAAA,IAAI;AACF,MAAA,MAAM,QAAA,GAAW,MAAM,KAAA,CAAM,GAAA,EAAK;AAAA,QAChC,MAAA;AAAA,QACA,OAAA,EAAS;AAAA,UACP,aAAA,EAAe,CAAA,OAAA,EAAU,IAAA,CAAK,MAAM,CAAA,CAAA;AAAA,UACpC,cAAA,EAAgB;AAAA,SAClB;AAAA,QACA,IAAA,EAAM,IAAA,GAAO,IAAA,CAAK,SAAA,CAAU,IAAI,CAAA,GAAI,KAAA,CAAA;AAAA,QACpC,QAAQ,UAAA,CAAW;AAAA,OACpB,CAAA;AAED,MAAA,IAAI,CAAC,SAAS,EAAA,EAAI;AAEhB,QAAA,IAAI,UAAU,IAAA,CAAK,UAAA,IAAc,uBAAuB,QAAA,CAAS,QAAA,CAAS,MAAM,CAAA,EAAG;AACjF,UAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,UAAA,GAAa,CAAA,IAAK,OAAA;AACrC,UAAA,GAAA,CAAI,IAAA;AAAA,YACF,CAAA,UAAA,EAAa,QAAA,CAAS,MAAM,CAAA,IAAA,EAAO,MAAM,CAAA,CAAA,EAAI,QAAQ,CAAA,cAAA,EAAiB,KAAK,CAAA,eAAA,EAAkB,OAAA,GAAU,CAAC,CAAA,CAAA,EAAI,KAAK,UAAU,CAAA,CAAA;AAAA,WAC7H;AACA,UAAA,MAAM,IAAI,OAAA,CAAQ,CAACT,aAAY,UAAA,CAAWA,QAAAA,EAAS,KAAK,CAAC,CAAA;AACzD,UAAA,OAAO,KAAK,OAAA,CAAW,QAAA,EAAU,MAAA,EAAQ,IAAA,EAAM,UAAU,CAAC,CAAA;AAAA,QAC5D;AAEA,QAAA,MAAM,SAAA,GAAY,MAAM,QAAA,CAAS,IAAA,EAAK;AACtC,QAAA,IAAI,OAAA;AACJ,QAAA,IAAI;AACF,UAAA,MAAM,MAAA,GAAS,IAAA,CAAK,KAAA,CAAM,SAAS,CAAA;AACnC,UAAA,OAAA,GAAU,MAAA,CAAO,OAAA,IAAW,MAAA,CAAO,KAAA,IAAS,mBAAA;AAAA,QAC9C,CAAA,CAAA,MAAQ;AACN,UAAA,OAAA,GAAUS,eAAc,SAAS,CAAA;AAAA,QACnC;AAEA,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,KAAA;AAAA,UACT,KAAA,EAAO,CAAA,UAAA,EAAa,QAAA,CAAS,MAAM,KAAK,OAAO,CAAA;AAAA,SACjD;AAAA,MACF;AAGA,MAAA,MAAM,WAAA,GAAc,QAAA,CAAS,OAAA,CAAQ,GAAA,CAAI,cAAc,CAAA;AACvD,MAAA,IAAI,CAAC,WAAA,IAAe,CAAC,WAAA,CAAY,QAAA,CAAS,kBAAkB,CAAA,EAAG;AAC7D,QAAA,OAAO,EAAE,OAAA,EAAS,IAAA,EAAM,IAAA,EAAM,EAAC,EAAO;AAAA,MACxC;AAEA,MAAA,MAAM,IAAA,GAAO,MAAM,QAAA,CAAS,IAAA,EAAK;AACjC,MAAA,IAAI,CAAC,IAAA,IAAQ,IAAA,CAAK,IAAA,OAAW,EAAA,EAAI;AAC/B,QAAA,OAAO,EAAE,OAAA,EAAS,IAAA,EAAM,IAAA,EAAM,EAAC,EAAO;AAAA,MACxC;AAEA,MAAA,IAAI;AACF,QAAA,MAAM,IAAA,GAAO,IAAA,CAAK,KAAA,CAAM,IAAI,CAAA;AAC5B,QAAA,OAAO,EAAE,OAAA,EAAS,IAAA,EAAM,IAAA,EAAK;AAAA,MAC/B,CAAA,CAAA,MAAQ;AACN,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,KAAA;AAAA,UACT,KAAA,EAAO;AAAA,SACT;AAAA,MACF;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,IAAI,KAAA,YAAiB,KAAA,IAAS,KAAA,CAAM,IAAA,KAAS,YAAA,EAAc;AAEzD,QAAA,IAAI,OAAA,GAAU,KAAK,UAAA,EAAY;AAC7B,UAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,UAAA,GAAa,CAAA,IAAK,OAAA;AACrC,UAAA,GAAA,CAAI,IAAA;AAAA,YACF,CAAA,mBAAA,EAAsB,MAAM,CAAA,CAAA,EAAI,QAAQ,CAAA,cAAA,EAAiB,KAAK,CAAA,eAAA,EAAkB,OAAA,GAAU,CAAC,CAAA,CAAA,EAAI,IAAA,CAAK,UAAU,CAAA,CAAA;AAAA,WAChH;AACA,UAAA,MAAM,IAAI,OAAA,CAAQ,CAACT,aAAY,UAAA,CAAWA,QAAAA,EAAS,KAAK,CAAC,CAAA;AACzD,UAAA,OAAO,KAAK,OAAA,CAAW,QAAA,EAAU,MAAA,EAAQ,IAAA,EAAM,UAAU,CAAC,CAAA;AAAA,QAC5D;AACA,QAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,OAAO,CAAA,sBAAA,EAAyB,IAAA,CAAK,OAAO,CAAA,EAAA,CAAA,EAAK;AAAA,MAC5E;AAGA,MAAA,IACE,OAAA,GAAU,KAAK,UAAA,KACd,KAAA,YAAiB,aACf,KAAA,YAAiB,KAAA,KACf,MAAM,OAAA,CAAQ,QAAA,CAAS,SAAS,CAAA,IAC/B,KAAA,CAAM,QAAQ,QAAA,CAAS,OAAO,KAC9B,KAAA,CAAM,OAAA,CAAQ,QAAA,CAAS,YAAY,CAAA,CAAA,CAAA,EACzC;AACA,QAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,UAAA,GAAa,CAAA,IAAK,OAAA;AACrC,QAAA,GAAA,CAAI,IAAA;AAAA,UACF,CAAA,iBAAA,EAAoB,MAAM,CAAA,CAAA,EAAI,QAAQ,KAAKS,cAAAA,CAAc,KAAK,CAAC,CAAA,cAAA,EAAiB,KAAK,CAAA,eAAA,EAAkB,OAAA,GAAU,CAAC,CAAA,CAAA,EAAI,KAAK,UAAU,CAAA,CAAA;AAAA,SACvI;AACA,QAAA,MAAM,IAAI,OAAA,CAAQ,CAACT,aAAY,UAAA,CAAWA,QAAAA,EAAS,KAAK,CAAC,CAAA;AACzD,QAAA,OAAO,KAAK,OAAA,CAAW,QAAA,EAAU,MAAA,EAAQ,IAAA,EAAM,UAAU,CAAC,CAAA;AAAA,MAC5D;AAEA,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAOS,cAAAA,CAAc,KAAK,CAAA,EAAE;AAAA,IACvD,CAAA,SAAE;AACA,MAAA,YAAA,CAAa,SAAS,CAAA;AAAA,IACxB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAA,GAAuC;AAC3C,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,OAAA,CAAkD,SAAS,CAAA;AACrF,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAA,EAAM;AAClE,IAAA,OAAO,EAAE,SAAS,IAAA,EAAM,IAAA,EAAM,OAAO,IAAA,EAAM,MAAA,IAAU,EAAC,EAAE;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,OAAA,EAAyC;AAC5D,IAAA,eAAA,CAAgB,OAAO,CAAA;AACvB,IAAA,MAAM,SAAA,GAAY,mBAAmB,OAAO,CAAA;AAC5C,IAAA,OAAO,IAAA,CAAK,OAAA,CAAe,CAAA,QAAA,EAAW,SAAS,CAAA,CAAE,CAAA;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqB,OAAA,EAAgD;AACzE,IAAA,eAAA,CAAgB,OAAO,CAAA;AACvB,IAAA,MAAM,SAAA,GAAY,mBAAmB,OAAO,CAAA;AAC5C,IAAA,OAAO,IAAA,CAAK,OAAA,CAAsB,CAAA,QAAA,EAAW,SAAS,CAAA,aAAA,CAAe,CAAA;AAAA,EACvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,YAAY,OAAA,EAmBS;AACzB,IAAA,kBAAA,CAAmB,OAAA,CAAQ,OAAO,IAAI,CAAA;AACtC,IAAA,kBAAA,CAAmB,OAAA,CAAQ,OAAO,UAAU,CAAA;AAE5C,IAAA,IAAI,OAAA,CAAQ,MAAA,CAAO,GAAA,KAAQ,MAAA,EAAW;AACpC,MAAA,IAAI,OAAO,QAAQ,MAAA,CAAO,GAAA,KAAQ,YAAY,OAAA,CAAQ,MAAA,CAAO,GAAA,CAAI,MAAA,GAAS,GAAA,EAAK;AAC7E,QAAA,MAAM,IAAI,MAAM,oDAAoD,CAAA;AAAA,MACtE;AAAA,IACF;AAGA,IAAA,IAAI,OAAA,CAAQ,SAAS,GAAA,EAAK;AACxB,MAAA,kBAAA,CAAmB,OAAA,CAAQ,QAAQ,GAAG,CAAA;AAAA,IACxC;AAEA,IAAA,OAAO,IAAA,CAAK,OAAA,CAAe,SAAA,EAAW,MAAA,EAAQ,OAAO,CAAA;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAA,CAAY,OAAA,EAAiB,MAAA,EAAiD;AAClF,IAAA,eAAA,CAAgB,OAAO,CAAA;AACvB,IAAA,kBAAA,CAAmB,OAAO,IAAI,CAAA;AAC9B,IAAA,MAAM,SAAA,GAAY,mBAAmB,OAAO,CAAA;AAC5C,IAAA,OAAO,IAAA,CAAK,QAAc,CAAA,QAAA,EAAW,SAAS,aAAa,MAAA,EAAQ,EAAE,QAAQ,CAAA;AAAA,EAC/E;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAA,GAAkD;AACtD,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,OAAA,CAAwC,eAAe,CAAA;AACjF,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAA,EAAM;AAClE,IAAA,OAAO,EAAE,SAAS,IAAA,EAAM,IAAA,EAAM,OAAO,IAAA,EAAM,YAAA,IAAgB,EAAC,EAAE;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,UAAA,GAAwC;AAC5C,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,OAAA,CAA8B,SAAS,CAAA;AACjE,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAA,EAAM;AAClE,IAAA,OAAO,EAAE,SAAS,IAAA,EAAM,IAAA,EAAM,OAAO,IAAA,EAAM,MAAA,IAAU,EAAC,EAAE;AAAA,EAC1D;AACF,CAAA;;;AClXA,WAAA,EAAA;AACA,WAAA,EAAA;AAWA,WAAA,EAAA;AAyDO,IAAM,QAAN,MAAY;AAAA,EArFnB;AAqFmB,IAAA,MAAA,CAAA,IAAA,EAAA,OAAA,CAAA;AAAA;AAAA,EACT,GAAA;AAAA,EACA,WAAA;AAAA,EACA,YAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,WAAA,CAAYX,OAAAA,GAAsB,EAAC,EAAG;AACpC,IAAA,IAAA,CAAK,WAAA,GAAcA,QAAO,WAAA,IAAe,wBAAA;AAGzC,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,GAAM,IAAI,SAAA,CAAU;AAAA,QACvB,QAAQA,OAAAA,CAAO,MAAA;AAAA,QACf,SAASA,OAAAA,CAAO,OAAA;AAAA,QAChB,YAAYA,OAAAA,CAAO,UAAA;AAAA,QACnB,YAAYA,OAAAA,CAAO;AAAA,OACpB,CAAA;AACD,MAAA,IAAA,CAAK,YAAA,GAAe,IAAA;AAAA,IACtB,CAAA,CAAA,MAAQ;AAEN,MAAA,IAAA,CAAK,GAAA,GAAM,IAAA;AACX,MAAA,IAAA,CAAK,YAAA,GAAe,KAAA;AACpB,MAAA,GAAA,CAAI,MAAM,oDAAoD,CAAA;AAAA,IAChE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,cAAA,GAA0B;AACxB,IAAA,OAAO,IAAA,CAAK,YAAA,IAAgB,IAAA,CAAK,GAAA,KAAQ,IAAA;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,IAAA,GAAiC;AACrC,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,0BAAA,EAA2B;AAAA,IAC7D;AACA,IAAA,OAAO,IAAA,CAAK,IAAI,UAAA,EAAW;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,MAAA,EAA+C;AAChE,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,IAAA,EAAK;AAC/B,IAAA,IAAI,CAAC,MAAA,CAAO,OAAA,EAAS,OAAO,MAAA;AAC5B,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT,IAAA,EAAM,MAAA,CAAO,IAAA,EAAM,MAAA,CAAO,CAAC,MAAM,CAAA,CAAE,MAAA,KAAW,MAAM,CAAA,IAAK;AAAC,KAC5D;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAA,GAAoC;AACxC,IAAA,OAAO,IAAA,CAAK,aAAa,SAAS,CAAA;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,KAAK,OAAA,EAAqD;AAC9D,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,IAAA,EAAK;AAC/B,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAA,EAAM;AAClE,IAAA,OAAO,EAAE,OAAA,EAAS,IAAA,EAAM,IAAA,EAAM,MAAA,CAAO,IAAA,EAAM,IAAA,CAAK,CAAC,CAAA,KAAM,CAAA,CAAE,EAAA,KAAO,OAAO,CAAA,EAAE;AAAA,EAC3E;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,OAAA,EAAyC;AACpD,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,0BAAA,EAA2B;AAAA,IAC7D;AACA,IAAA,OAAO,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,OAAO,CAAA;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,MAAM,MAAM,OAAA,EAA4E;AACtF,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,0BAAA,EAA2B;AAAA,IAC7D;AAEA,IAAA,MAAM,OAAO,IAAA,CAAK,oBAAA,CAAqB,OAAA,CAAQ,IAAA,EAAM,QAAQ,OAAO,CAAA;AAEpE,IAAA,GAAA,CAAI,IAAA,CAAK,CAAA,kBAAA,EAAqB,OAAA,CAAQ,UAAU,CAAA,CAAE,CAAA;AAElD,IAAA,OAAO,IAAA,CAAK,IAAI,WAAA,CAAY;AAAA,MAC1B,MAAA,EAAQ,EAAE,IAAA,EAAM,IAAA,EAAK;AAAA,MACrB,MAAA,EAAQ;AAAA,QACN,YAAY,OAAA,CAAQ,UAAA;AAAA,QACpB,GAAA,EAAK,QAAQ,GAAA,IAAO;AAAA,OACtB;AAAA,MACA,QAAQ,OAAA,CAAQ,MAAA;AAAA,MAChB,SAAS,OAAA,CAAQ;AAAA,KAClB,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKQ,oBAAA,CAAqB,MAAc,OAAA,EAAgC;AACzE,IAAA,IAAI,CAAC,SAAS,OAAO,IAAA;AAErB,IAAA,MAAM,KAAA,GAAQ,CAAC,IAAA,EAAM,EAAA,EAAI,8BAA8B,CAAA;AAEvD,IAAA,IAAI,QAAQ,gBAAA,EAAkB;AAC5B,MAAA,KAAA,CAAM,IAAA,CAAK,CAAA,uBAAA,EAA0B,OAAA,CAAQ,gBAAgB,CAAA,CAAE,CAAA;AAAA,IACjE;AACA,IAAA,IAAI,QAAQ,aAAA,EAAe;AACzB,MAAA,KAAA,CAAM,IAAA,CAAK,CAAA,gBAAA,EAAmB,OAAA,CAAQ,aAAa,CAAA,CAAE,CAAA;AAAA,IACvD;AACA,IAAA,IAAI,OAAA,CAAQ,eAAe,MAAA,EAAQ;AACjC,MAAA,KAAA,CAAM,KAAK,CAAA,gBAAA,EAAmB,OAAA,CAAQ,cAAc,IAAA,CAAK,IAAI,CAAC,CAAA,CAAE,CAAA;AAAA,IAClE;AACA,IAAA,IAAI,QAAQ,QAAA,EAAU;AACpB,MAAA,KAAA,CAAM,KAAK,CAAA,UAAA,EAAa,IAAA,CAAK,UAAU,OAAA,CAAQ,QAAQ,CAAC,CAAA,CAAE,CAAA;AAAA,IAC5D;AACA,IAAA,KAAA,CAAM,KAAK,kDAAkD,CAAA;AAC7D,IAAA,KAAA,CAAM,KAAK,qBAAqB,CAAA;AAEhC,IAAA,OAAO,KAAA,CAAM,KAAK,IAAI,CAAA;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,QAAA,CAAS,OAAA,EAAiB,OAAA,EAAwC;AACtE,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,0BAAA,EAA2B;AAAA,IAC7D;AACA,IAAA,OAAO,KAAK,GAAA,CAAI,WAAA,CAAY,SAAS,EAAE,IAAA,EAAM,SAAS,CAAA;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAA,CAAU,QAAA,EAAoB,OAAA,EAAqD;AACvF,IAAA,MAAM,OAAA,uBAAc,GAAA,EAA0B;AAE9C,IAAA,MAAM,OAAA,CAAQ,GAAA;AAAA,MACZ,QAAA,CAAS,GAAA,CAAI,OAAO,EAAA,KAAO;AACzB,QAAA,OAAA,CAAQ,IAAI,EAAA,EAAI,MAAM,KAAK,QAAA,CAAS,EAAA,EAAI,OAAO,CAAC,CAAA;AAAA,MAClD,CAAC;AAAA,KACH;AAEA,IAAA,OAAO,OAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,aAAa,OAAA,EAAgD;AACjE,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,0BAAA,EAA2B;AAAA,IAC7D;AACA,IAAA,OAAO,IAAA,CAAK,GAAA,CAAI,oBAAA,CAAqB,OAAO,CAAA;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAA,CAAQ,OAAA,EAAiB,UAAA,EAA8C;AAC3E,IAAA,MAAM,IAAA,GAAO,MAAM,IAAA,CAAK,YAAA,CAAa,OAAO,CAAA;AAC5C,IAAA,IAAI,CAAC,KAAK,OAAA,EAAS,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,IAAA,CAAK,KAAA,EAAM;AAE9D,IAAA,MAAM,OAAO,UAAA,IAAc,IAAA,CAAK,KAAK,WAAA,EAAa,CAAA,aAAA,EAAgB,OAAO,CAAA,KAAA,CAAO,CAAA;AAEhF,IAAA,IAAI;AACF,MAAA,MAAM,MAAM,OAAA,CAAQ,IAAI,GAAG,EAAE,SAAA,EAAW,MAAM,CAAA;AAC9C,MAAA,MAAM,SAAA,CAAU,MAAM,IAAA,CAAK,SAAA,CAAU,KAAK,IAAA,EAAM,IAAA,EAAM,CAAC,CAAC,CAAA;AACxD,MAAA,OAAO,EAAE,OAAA,EAAS,IAAA,EAAM,IAAA,EAAM,IAAA,EAAK;AAAA,IACrC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAK,CAAA,EAAE;AAAA,IAChD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,YAAA,GAA8C;AAClD,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,0BAAA,EAA2B;AAAA,IAC7D;AACA,IAAA,OAAO,IAAA,CAAK,IAAI,gBAAA,EAAiB;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAA,GAAwC;AAC5C,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,0BAAA,EAA2B;AAAA,IAC7D;AACA,IAAA,OAAO,IAAA,CAAK,IAAI,UAAA,EAAW;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,cAAcA,OAAAA,EAKlB;AAEA,IAAA,MAAM,aAAA,GAAgB,MAAM,IAAA,CAAK,OAAA,EAAQ;AACzC,IAAA,MAAM,IAAA,GAAO,aAAA,CAAc,IAAA,GAAO,CAAC,GAAG,EAAA,IAAM,iBAAA;AAG5C,IAAA,MAAM,eAAwB,EAAC;AAC/B,IAAA,KAAA,MAAW,MAAA,IAAUA,QAAO,WAAA,EAAa;AACvC,MAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,KAAA,CAAM;AAAA,QAC9B,GAAG,MAAA;AAAA,QACH,OAAA,EAAS;AAAA,UACP,gBAAA,EAAkB,IAAA;AAAA,UAClB,eAAeA,OAAAA,CAAO;AAAA;AACxB,OACD,CAAA;AACD,MAAA,IAAI,MAAA,CAAO,OAAA,IAAW,MAAA,CAAO,IAAA,EAAM;AACjC,QAAA,YAAA,CAAa,IAAA,CAAK,OAAO,IAAI,CAAA;AAAA,MAC/B;AAAA,IACF;AAGA,IAAA,MAAM,kBAAA,GAAqB,MAAM,IAAA,CAAK,KAAA,CAAM;AAAA,MAC1C,GAAGA,OAAAA,CAAO,YAAA;AAAA,MACV,OAAA,EAAS;AAAA,QACP,gBAAA,EAAkB,IAAA;AAAA,QAClB,eAAeA,OAAAA,CAAO,aAAA;AAAA,QACtB,eAAe,YAAA,CAAa,GAAA,CAAI,CAAC,CAAA,KAAM,EAAE,EAAE,CAAA;AAAA,QAC3C,QAAA,EAAU;AAAA,UACR,OAAA,EAAS,SAAA;AAAA,UACT,aAAaA,OAAAA,CAAO,WAAA,CAAY,IAAI,CAAC,CAAA,KAAM,EAAE,UAAU;AAAA;AACzD;AACF,KACD,CAAA;AAED,IAAA,IAAI,CAAC,kBAAA,CAAmB,OAAA,IAAW,CAAC,mBAAmB,IAAA,EAAM;AAC3D,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,KAAA;AAAA,QACT,KAAA,EAAO,mBAAmB,KAAA,IAAS;AAAA,OACrC;AAAA,IACF;AAGA,IAAA,KAAA,MAAW,SAAS,YAAA,EAAc;AAChC,MAAA,MAAM,IAAA,CAAK,QAAA;AAAA,QACT,KAAA,CAAM,EAAA;AAAA,QACN,CAAA,4BAAA,EAA+B,kBAAA,CAAmB,IAAA,CAAK,EAAE;AAAA,sEAAA;AAAA,OAE3D;AAAA,IACF;AAEA,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT,IAAA,EAAM;AAAA,QACJ,YAAA;AAAA,QACA,mBAAmB,kBAAA,CAAmB;AAAA;AACxC,KACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,OAAA,GAQJ;AACA,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,IAAA,EAAK;AAC/B,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,MAAA,CAAO,KAAA,EAAM;AAElE,IAAA,MAAM,MAAA,GAAS,MAAA,CAAO,IAAA,IAAQ,EAAC;AAC/B,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT,IAAA,EAAM;AAAA,QACJ,OAAO,MAAA,CAAO,MAAA;AAAA,QACd,OAAA,EAAS,OAAO,MAAA,CAAO,CAAC,MAAM,CAAA,CAAE,MAAA,KAAW,SAAS,CAAA,CAAE,MAAA;AAAA,QACtD,SAAA,EAAW,MAAA,CAAO,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,CAAE,MAAA,KAAW,WAAA,IAAe,CAAA,CAAE,MAAA,KAAW,UAAU,CAAA,CAAE,MAAA;AAAA,QACrF,MAAA,EAAQ,OAAO,MAAA,CAAO,CAAC,MAAM,CAAA,CAAE,MAAA,KAAW,QAAQ,CAAA,CAAE,MAAA;AAAA,QACpD;AAAA;AACF,KACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAA,CACJ,OAAA,EACA,OAAA,EAIwB;AACxB,IAAA,MAAM,OAAA,GAAU,SAAS,OAAA,IAAW,GAAA;AACpC,IAAA,MAAM,YAAA,GAAe,SAAS,YAAA,IAAgB,GAAA;AAC9C,IAAA,MAAM,KAAA,GAAQ,KAAK,GAAA,EAAI;AAEvB,IAAA,OAAO,IAAA,CAAK,GAAA,EAAI,GAAI,KAAA,GAAQ,OAAA,EAAS;AACnC,MAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,MAAA,CAAO,OAAO,CAAA;AACxC,MAAA,IAAI,CAAC,MAAA,CAAO,OAAA,EAAS,OAAO,MAAA;AAE5B,MAAA,IAAI,MAAA,CAAO,IAAA,EAAM,MAAA,KAAW,SAAA,EAAW;AACrC,QAAA,OAAO,MAAA;AAAA,MACT;AAEA,MAAA,MAAM,IAAI,OAAA,CAAQ,CAAC,MAAM,UAAA,CAAW,CAAA,EAAG,YAAY,CAAC,CAAA;AAAA,IACtD;AAEA,IAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,CAAA,0BAAA,EAA6B,OAAO,CAAA,CAAA,EAAG;AAAA,EACzE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAA,CACJ,QAAA,EACA,OAAA,EAI6B;AAC7B,IAAA,MAAM,YAAA,GAAe,SAAS,YAAA,IAAgB,IAAA;AAC9C,IAAA,MAAM,OAAA,uBAAc,GAAA,EAAmB;AACvC,IAAA,MAAM,OAAA,GAAU,IAAI,GAAA,CAAI,QAAQ,CAAA;AAChC,IAAA,MAAM,oCAAoB,IAAI,GAAA,CAAiB,CAAC,SAAA,EAAW,SAAS,CAAC,CAAA;AAErE,IAAA,OAAO,OAAA,CAAQ,OAAO,CAAA,EAAG;AACvB,MAAA,MAAM,SAAA,uBAAgB,GAAA,EAAyB;AAE/C,MAAA,KAAA,MAAW,MAAM,OAAA,EAAS;AACxB,QAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,MAAA,CAAO,EAAE,CAAA;AACnC,QAAA,IAAI,MAAA,CAAO,OAAA,IAAW,MAAA,CAAO,IAAA,EAAM;AACjC,UAAA,SAAA,CAAU,GAAA,CAAI,EAAA,EAAI,MAAA,CAAO,IAAA,CAAK,MAAM,CAAA;AAEpC,UAAA,IAAI,CAAC,iBAAA,CAAkB,GAAA,CAAI,MAAA,CAAO,IAAA,CAAK,MAAM,CAAA,EAAG;AAC9C,YAAA,OAAA,CAAQ,GAAA,CAAI,EAAA,EAAI,MAAA,CAAO,IAAI,CAAA;AAC3B,YAAA,OAAA,CAAQ,OAAO,EAAE,CAAA;AAAA,UACnB;AAAA,QACF;AAAA,MACF;AAEA,MAAA,OAAA,EAAS,aAAa,SAAS,CAAA;AAE/B,MAAA,IAAI,OAAA,CAAQ,OAAO,CAAA,EAAG;AACpB,QAAA,MAAM,IAAI,OAAA,CAAQ,CAAC,MAAM,UAAA,CAAW,CAAA,EAAG,YAAY,CAAC,CAAA;AAAA,MACtD;AAAA,IACF;AAEA,IAAA,OAAO,OAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,WAAWA,OAAAA,EAA2C;AAC1D,IAAA,MAAM,gBAAA,GAAmBA,QAAO,gBAAA,IAAoB,GAAA;AACpD,IAAA,MAAM,eAAA,GAAkBA,QAAO,eAAA,IAAmB,IAAA;AAClD,IAAA,MAAM,WAAW,IAAI,GAAA,CAAIA,OAAAA,CAAO,QAAA,IAAY,EAAE,CAAA;AAC9C,IAAA,MAAM,mBAAA,uBAA0B,GAAA,EAAY;AAG5C,IAAA,MAAM,CAAC,KAAA,EAAO,IAAI,IAAIA,OAAAA,CAAO,IAAA,CAAK,MAAM,GAAG,CAAA;AAC3C,IAAA,IAAI,CAAC,KAAA,IAAS,CAAC,IAAA,EAAM;AACnB,MAAA,MAAM,IAAI,MAAM,4CAA4C,CAAA;AAAA,IAC9D;AAEA,IAAA,GAAA,CAAI,KAAK,mCAAmC,CAAA;AAC5C,IAAA,GAAA,CAAI,IAAA,CAAK,CAAA,kBAAA,EAAqBA,OAAAA,CAAO,cAAc,CAAA,CAAE,CAAA;AACrD,IAAA,GAAA,CAAI,IAAA,CAAK,CAAA,WAAA,EAAc,QAAA,CAAS,IAAI,CAAA,OAAA,CAAS,CAAA;AAC7C,IAAA,GAAA,CAAI,KAAK,CAAA,qBAAA,EAAwB,UAAA,CAAWA,OAAAA,CAAO,IAAI,CAAC,CAAA,CAAE,CAAA;AAG1D,IAAA,MAAM,QAAQ,GAAA,CAAI;AAAA,MAChB,IAAA,CAAK,YAAA,CAAaA,OAAAA,EAAQ,QAAA,EAAU,gBAAgB,CAAA;AAAA,MACpD,KAAK,WAAA,CAAYA,OAAAA,EAAQ,OAAO,IAAA,EAAM,QAAA,EAAU,qBAAqB,eAAe;AAAA,KACrF,CAAA;AAAA,EACH;AAAA,EAEA,MAAc,YAAA,CACZA,OAAAA,EACA,QAAA,EACA,QAAA,EACe;AACf,IAAA,OAAO,IAAA,EAAM;AACX,MAAA,IAAI;AACF,QAAA,GAAA,CAAI,KAAA,CAAM,CAAA,oBAAA,EAAuB,QAAA,CAAS,IAAI,CAAA,UAAA,CAAY,CAAA;AAE1D,QAAA,KAAA,MAAW,OAAA,IAAW,CAAC,GAAG,QAAQ,CAAA,EAAG;AACnC,UAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,MAAA,CAAO,OAAO,CAAA;AAExC,UAAA,IAAI,CAAC,MAAA,CAAO,OAAA,IAAW,CAAC,OAAO,IAAA,EAAM;AACnC,YAAA,GAAA,CAAI,KAAK,CAAA,EAAG,OAAA,CAAQ,MAAM,CAAA,EAAG,EAAE,CAAC,CAAA,wBAAA,CAA0B,CAAA;AAC1D,YAAA;AAAA,UACF;AAEA,UAAA,MAAM,QAAQ,MAAA,CAAO,IAAA;AAErB,UAAA,IAAI,KAAA,CAAM,WAAW,SAAA,EAAW;AAC9B,YAAA,MAAM,OAAA,GAAU;AAAA,cACd,+CAAA;AAAA,cACA,EAAA;AAAA,cACA,uDAAA;AAAA,cACA,CAAA,mBAAA,EAAsBA,OAAAA,CAAO,IAAI,CAAA,MAAA,EAASA,QAAO,cAAc,CAAA;AAAA,aACjE,CAAE,KAAK,IAAI,CAAA;AAEX,YAAA,MAAM,IAAA,CAAK,QAAA,CAAS,OAAA,EAAS,OAAO,CAAA;AAAA,UACtC,CAAA,MAAO;AACL,YAAA,QAAA,CAAS,OAAO,OAAO,CAAA;AAAA,UACzB;AAAA,QACF;AAAA,MACF,SAAS,GAAA,EAAK;AACZ,QAAA,GAAA,CAAI,KAAA,CAAM,oBAAoB,GAAG,CAAA;AAAA,MACnC;AAEA,MAAA,MAAM,IAAI,OAAA,CAAQ,CAAC,MAAM,UAAA,CAAW,CAAA,EAAG,QAAQ,CAAC,CAAA;AAAA,IAClD;AAAA,EACF;AAAA,EAEA,MAAc,WAAA,CACZA,OAAAA,EACA,OACA,IAAA,EACA,QAAA,EACA,cACA,QAAA,EACe;AACf,IAAA,OAAO,IAAA,EAAM;AACX,MAAA,IAAI;AAEF,QAAA,MAAM,cAAA,GAAiB,MAAM,YAAA,CAAa,cAAA;AAAA,UACxC,KAAA;AAAA,UACA,IAAA;AAAA,UACAA,OAAAA,CAAO;AAAA,SACT;AAEA,QAAA,IAAI,CAAC,cAAA,CAAe,OAAA,IAAW,CAAC,eAAe,IAAA,EAAM;AACnD,UAAA,GAAA,CAAI,IAAA,CAAK,qCAAA,EAAuC,cAAA,CAAe,KAAK,CAAA;AACpE,UAAA,MAAM,IAAI,OAAA,CAAQ,CAAC,MAAM,UAAA,CAAW,CAAA,EAAG,QAAQ,CAAC,CAAA;AAChD,UAAA;AAAA,QACF;AAEA,QAAA,KAAA,MAAW,OAAA,IAAW,eAAe,IAAA,EAAM;AACzC,UAAA,IAAI,YAAA,CAAa,GAAA,CAAI,OAAA,CAAQ,EAAE,CAAA,EAAG;AAElC,UAAA,IAAI,OAAA,CAAQ,IAAA,CAAK,QAAA,CAAS,SAAS,CAAA,EAAG;AACpC,YAAA,GAAA,CAAI,IAAA,CAAK,CAAA,mCAAA,EAAsC,OAAA,CAAQ,MAAM,CAAA,CAAE,CAAA;AAC/D,YAAA,MAAM,KAAK,0BAAA,CAA2B,KAAA,EAAO,IAAA,EAAMA,OAAAA,EAAQ,UAAU,OAAO,CAAA;AAAA,UAC9E;AAEA,UAAA,YAAA,CAAa,GAAA,CAAI,QAAQ,EAAE,CAAA;AAAA,QAC7B;AAAA,MACF,SAAS,GAAA,EAAK;AACZ,QAAA,GAAA,CAAI,KAAA,CAAM,mBAAmB,GAAG,CAAA;AAAA,MAClC;AAEA,MAAA,MAAM,IAAI,OAAA,CAAQ,CAAC,MAAM,UAAA,CAAW,CAAA,EAAG,QAAQ,CAAC,CAAA;AAAA,IAClD;AAAA,EACF;AAAA,EAEA,MAAc,0BAAA,CACZ,KAAA,EACA,IAAA,EACAA,OAAAA,EACA,UACA,OAAA,EACe;AACf,IAAA,MAAM,OAAO,OAAA,CAAQ,IAAA;AAErB,IAAA,IAAI,IAAA,CAAK,QAAA,CAAS,cAAS,CAAA,EAAG;AAC5B,MAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,KAAA,CAAM,8BAA8B,CAAA;AACvD,MAAA,MAAM,OAAA,GAAU,QAAQ,CAAC,CAAA;AACzB,MAAA,MAAM,OAAA,GAAU,QAAQ,CAAC,CAAA;AACzB,MAAA,IAAI,OAAA,IAAW,YAAY,MAAA,EAAW;AACpC,QAAA,GAAA,CAAI,IAAA,CAAK,CAAA,MAAA,EAAS,OAAO,CAAA,YAAA,EAAe,OAAO,CAAA,CAAE,CAAA;AACjD,QAAA,QAAA,CAAS,OAAO,OAAO,CAAA;AAGvB,QAAA,MAAM,YAAA,CAAa,aAAA;AAAA,UACjB,KAAA;AAAA,UACA,IAAA;AAAA,UACAA,OAAAA,CAAO,cAAA;AAAA,UACP,uCAAkC,OAAA,CAAQ,KAAA,CAAM,GAAG,EAAE,CAAC,cAAc,OAAO,CAAA;AAAA,SAC7E;AAAA,MACF;AAAA,IACF,CAAA,MAAA,IAAW,IAAA,CAAK,QAAA,CAAS,uBAAa,CAAA,EAAG;AACvC,MAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,KAAA,CAAM,kCAAkC,CAAA;AAC3D,MAAA,MAAM,OAAA,GAAU,QAAQ,CAAC,CAAA;AACzB,MAAA,MAAM,KAAA,GAAQ,QAAQ,CAAC,CAAA;AACvB,MAAA,IAAI,OAAA,IAAW,UAAU,MAAA,EAAW;AAClC,QAAA,GAAA,CAAI,IAAA,CAAK,CAAA,MAAA,EAAS,OAAO,CAAA,UAAA,EAAa,KAAK,CAAA,CAAE,CAAA;AAE7C,QAAA,MAAM,YAAA,CAAa,aAAA;AAAA,UACjB,KAAA;AAAA,UACA,IAAA;AAAA,UACAA,OAAAA,CAAO,cAAA;AAAA,UACP,sBAAY,OAAA,CAAQ,KAAA,CAAM,GAAG,EAAE,CAAC,aAAa,KAAK;;AAAA,oCAAA;AAAA,SACpD;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF,CAAA;;;AC9mBA,WAAA,EAAA;AACA,WAAA,EAAA;AAGA,aAAA,EAAA;AAsBA,SAAS,kBAAkB,MAAA,EAAyB;AAClD,EAAA,OAAO,oBAAA,CAAqB,IAAA,CAAK,MAAM,CAAA,IAAK,OAAO,MAAA,IAAU,GAAA;AAC/D;AAFS,MAAA,CAAA,iBAAA,EAAA,mBAAA,CAAA;AAUF,IAAM,iBAAN,MAAqB;AAAA,EAtD5B;AAsD4B,IAAA,MAAA,CAAA,IAAA,EAAA,gBAAA,CAAA;AAAA;AAAA,EAClB,GAAA;AAAA,EACA,QAAA;AAAA,EACA,IAAA;AAAA,EAER,YAAY,OAAA,EAA2E;AAErF,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,MAAM,IAAI,SAAA,CAAU,EAAE,MAAA,EAAQ,OAAA,EAAS,cAAc,CAAA;AAAA,IAC5D,CAAA,CAAA,MAAQ;AACN,MAAA,IAAA,CAAK,GAAA,GAAM,IAAA;AACX,MAAA,GAAA,CAAI,KAAK,iDAAiD,CAAA;AAAA,IAC5D;AAGA,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,WAAW,IAAI,QAAA,CAAW,EAAE,MAAA,EAAQ,OAAA,EAAS,cAAc,CAAA;AAAA,IAClE,CAAA,CAAA,MAAQ;AACN,MAAA,IAAA,CAAK,QAAA,GAAW,IAAA;AAChB,MAAA,GAAA,CAAI,KAAK,gDAAgD,CAAA;AAAA,IAC3D;AAGA,IAAA,IAAA,CAAK,IAAA,GAAO,OAAA,EAAS,IAAA,IAAQ,SAAA,EAAU,CAAE,iBAAA;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,IAAA,EAAoB;AAC1B,IAAA,IAAA,CAAK,IAAA,GAAO,IAAA;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAA,CAAgB,aAAA,EAAuB,OAAA,EAAiD;AAC5F,IAAA,GAAA,CAAI,KAAK,8CAA8C,CAAA;AAEvD,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,0BAAA,EAA2B;AAAA,IAC7D;AAGA,IAAA,GAAA,CAAI,KAAK,iDAA0C,CAAA;AACnD,IAAA,MAAM,UAAA,GAAa,MAAM,IAAA,CAAK,GAAA,CAAI,qBAAqB,aAAa,CAAA;AACpE,IAAA,IAAI,CAAC,UAAA,CAAW,OAAA,IAAW,CAAC,WAAW,IAAA,EAAM;AAC3C,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,OAAO,CAAA,4BAAA,EAA+B,UAAA,CAAW,KAAK,CAAA,CAAA,EAAG;AAAA,IACpF;AAEA,IAAA,IAAI,gBAA0B,EAAC;AAC/B,IAAA,IAAI,gBAAA,GAA6B,OAAA,CAAQ,KAAA,IAAS,EAAC;AACnD,IAAA,IAAI,YAAsB,EAAC;AAG3B,IAAA,IAAI,KAAK,QAAA,EAAU;AACjB,MAAA,IAAI;AACF,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,QAAA,CAAS,mBAAA,CAAoB,WAAW,IAAI,CAAA;AACxE,QAAA,aAAA,GAAgB,SAAS,cAAA,CAAe,GAAA,CAAI,CAAC,CAAA,KAAM,EAAE,KAAK,CAAA;AAC1D,QAAA,gBAAA,GAAmB;AAAA,UACjB,GAAG,QAAA,CAAS,gBAAA,CAAiB,GAAA,CAAI,CAAC,CAAA,KAAM,CAAA,CAAA,EAAI,CAAA,CAAE,QAAQ,CAAA,EAAA,EAAK,CAAA,CAAE,KAAK,CAAA,CAAE,CAAA;AAAA,UACpE,GAAG;AAAA,SACL;AACA,QAAA,SAAA,GAAY,QAAA,CAAS,eAAA;AAAA,MACvB,SAAS,GAAA,EAAK;AACZ,QAAA,GAAA,CAAI,IAAA,CAAK,8CAA8C,GAAG,CAAA;AAAA,MAC5D;AAAA,IACF;AAGA,IAAA,MAAM,cAAA,GAAiC;AAAA,MACrC,aAAA;AAAA,MACA,eAAe,OAAA,CAAQ,SAAA;AAAA,MACvB,mBAAmB,OAAA,CAAQ,aAAA;AAAA,MAC3B,WAAA,EAAA,iBAAa,IAAI,IAAA,EAAK,EAAE,WAAA,EAAY;AAAA,MACpC,aAAA,EAAe,aAAA,CAAc,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,QACvC,EAAA,EAAI,CAAA,UAAA,EAAa,UAAA,EAAY,CAAA,CAAA;AAAA,QAC7B,KAAA,EAAO,CAAA;AAAA,QACP,WAAA,EAAa,CAAA;AAAA,QACb,QAAA,EAAU,QAAA;AAAA,QACV,QAAA,EAAU,OAAA;AAAA,QACV,MAAA,EAAQ;AAAA,OACV,CAAE,CAAA;AAAA,MACF,gBAAA,EAAkB,gBAAA,CAAiB,GAAA,CAAI,CAAC,CAAA,MAAO;AAAA,QAC7C,EAAA,EAAI,CAAA,KAAA,EAAQ,UAAA,EAAY,CAAA,CAAA;AAAA,QACxB,KAAA,EAAO,CAAA;AAAA,QACP,WAAA,EAAa,CAAA;AAAA,QACb,QAAA,EAAU,QAAA;AAAA,QACV,QAAA,EAAU,OAAA;AAAA,QACV,MAAA,EAAQ;AAAA,OACV,CAAE,CAAA;AAAA,MACF;AAAA,KACF;AAGA,IAAA,MAAM,UAAA,GAAaY,IAAAA,CAAK,SAAA,EAAW,SAAA,EAAW,aAAa,CAAA;AAC3D,IAAA,IAAI,CAAC,UAAA,CAAW,UAAU,CAAA,EAAG;AAC3B,MAAA,SAAA,CAAU,UAAA,EAAY,EAAE,SAAA,EAAW,IAAA,EAAM,CAAA;AAAA,IAC3C;AACA,IAAA,aAAA,CAAcA,IAAAA,CAAK,YAAY,cAAc,CAAA,EAAG,KAAK,SAAA,CAAU,cAAA,EAAgB,IAAA,EAAM,CAAC,CAAC,CAAA;AAGvF,IAAA,MAAM,eAAA,GAAkB,IAAA,CAAK,oBAAA,CAAqB,cAAA,EAAgB,OAAO,CAAA;AAGzE,IAAA,GAAA,CAAI,KAAK,uCAAgC,CAAA;AACzC,IAAA,MAAM,WAAA,GAAc,MAAM,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY;AAAA,MAC7C,MAAA,EAAQ,EAAE,IAAA,EAAM,eAAA,EAAgB;AAAA,MAChC,MAAA,EAAQ;AAAA,QACN,YAAY,OAAA,CAAQ,UAAA;AAAA,QACpB,GAAA,EAAK,QAAQ,GAAA,IAAO;AAAA;AACtB,KACD,CAAA;AAED,IAAA,IAAI,CAAC,WAAA,CAAY,OAAA,IAAW,CAAC,YAAY,IAAA,EAAM;AAC7C,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,OAAO,CAAA,2BAAA,EAA8B,WAAA,CAAY,KAAK,CAAA,CAAA,EAAG;AAAA,IACpF;AAEA,IAAA,MAAM,WAAA,GAAc,YAAY,IAAA,CAAK,EAAA;AACrC,IAAA,GAAA,CAAI,IAAA,CAAK,CAAA,0BAAA,EAAwB,WAAW,CAAA,CAAE,CAAA;AAG9C,IAAA,GAAA,CAAI,KAAK,qDAAgD,CAAA;AACzD,IAAA,MAAM,iBAAA,GAAoB,MAAM,IAAA,CAAK,kBAAA;AAAA,MACnC,WAAA;AAAA,MACA,QAAQ,kBAAA,IAAsB;AAAA,KAChC;AAEA,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT,WAAA;AAAA,MACA,kBAAkB,iBAAA,CAAkB;AAAA,KACtC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAA,CAAsB,WAAA,EAAqB,aAAA,EAAsC;AACrF,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,MAAM,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY,aAAA,EAAe;AAAA,MACxC,IAAA,EAAM,CAAA;;AAAA,gBAAA,EAEM,WAAW,CAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA,2BAAA,EAUP,WAAW,CAAA,kBAAA;AAAA,KAC5B,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,QAAA,CACJ,aAAA,EACA,aAAA,EACA,eACA,OAAA,EACuB;AACvB,IAAA,GAAA,CAAI,KAAK,4BAA4B,CAAA;AAErC,IAAA,IAAI,CAAC,KAAK,IAAA,EAAM;AACd,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,KAAA;AAAA,QACT,KAAA,EAAO;AAAA,OACT;AAAA,IACF;AAGA,IAAA,IAAI,CAAC,iBAAA,CAAkB,aAAa,CAAA,EAAG;AACrC,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,4BAAA,EAA6B;AAAA,IAC/D;AAEA,IAAA,IAAI,OAAA,EAAS,KAAA,IAAS,OAAA,EAAS,IAAA,EAAM;AACnC,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,8CAAA,EAA+C;AAAA,IACjF;AAGA,IAAA,MAAM,GAAA,GAAM,EAAE,GAAG,OAAA,CAAQ,KAAK,GAAG,aAAA,CAAc,IAAA,CAAK,IAAI,CAAA,EAAE;AAG1D,IAAA,GAAA,CAAI,IAAA,CAAK,CAAA,kCAAA,EAA8B,aAAa,CAAA,GAAA,CAAK,CAAA;AACzD,IAAA,IAAI;AACF,MAAA,MAAM,WAAA,GAAc,SAAS,WAAA,IAAe,QAAA;AAC5C,MAAA,MAAM,YAAA,GAAe,SAAS,YAAA,KAAiB,KAAA;AAG/C,MAAA,MAAM,SAAA,GAAY;AAAA,QAChB,IAAA;AAAA,QACA,OAAA;AAAA,QACA,OAAO,aAAa,CAAA;AAAA,QACpB,KAAK,WAAW,CAAA,CAAA;AAAA,QAChB,QAAA;AAAA,QACA,IAAA,CAAK;AAAA,OACP;AAEA,MAAA,IAAI,YAAA,EAAc;AAChB,QAAA,SAAA,CAAU,KAAK,iBAAiB,CAAA;AAAA,MAClC;AAEA,MAAA,IAAI,SAAS,KAAA,EAAO;AAClB,QAAA,SAAA,CAAU,KAAK,SAAS,CAAA;AAAA,MAC1B,CAAA,MAAA,IAAW,SAAS,IAAA,EAAM;AACxB,QAAA,SAAA,CAAU,KAAK,QAAQ,CAAA;AAAA,MACzB;AAEA,MAAA,MAAM,SAAA,GAAYP,UAAU,IAAA,EAAM,SAAA,EAAW,EAAE,QAAA,EAAU,OAAA,EAAS,KAAK,CAAA;AACvE,MAAA,IAAI,SAAA,CAAU,KAAA,IAAS,SAAA,CAAU,MAAA,KAAW,CAAA,EAAG;AAC7C,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,KAAA;AAAA,UACT,KAAA,EAAO,CAAA,oBAAA,EAAuB,SAAA,CAAU,MAAA,IAAU,UAAU,KAAK,CAAA;AAAA,SACnE;AAAA,MACF;AACA,MAAA,GAAA,CAAI,KAAK,8BAAyB,CAAA;AAAA,IACpC,SAAS,GAAA,EAAK;AACZ,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,CAAA,oBAAA,EAAuB,GAAG,CAAA,CAAA,EAAG;AAAA,IAC/D;AAGA,IAAA,GAAA,CAAI,KAAK,kCAA2B,CAAA;AACpC,IAAA,IAAI;AAEF,MAAA,MAAM,YAAA,GAAeA,SAAAA,CAAU,KAAA,EAAO,CAAC,UAAA,EAAY,MAAM,CAAA,EAAG,EAAE,QAAA,EAAU,OAAA,EAAS,CAAA;AACjF,MAAA,IAAI,YAAA,CAAa,KAAA,IAAS,YAAA,CAAa,MAAA,KAAW,CAAA,EAAG;AACnD,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,KAAA;AAAA,UACT,KAAA,EAAO,CAAA,yBAAA,EAA4B,YAAA,CAAa,MAAA,IAAU,aAAa,KAAK,CAAA;AAAA,SAC9E;AAAA,MACF;AAGA,MAAA,MAAM,QAAA,GAAWA,UAAU,KAAA,EAAO,CAAC,MAAM,CAAA,EAAG,EAAE,QAAA,EAAU,OAAA,EAAS,CAAA;AACjE,MAAA,IAAI,QAAA,CAAS,KAAA,IAAS,QAAA,CAAS,MAAA,KAAW,CAAA,EAAG;AAC3C,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,KAAA;AAAA,UACT,KAAA,EAAO,CAAA,qBAAA,EAAwB,QAAA,CAAS,MAAA,IAAU,SAAS,KAAK,CAAA;AAAA,SAClE;AAAA,MACF;AAAA,IACF,SAAS,GAAA,EAAK;AACZ,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,CAAA,qBAAA,EAAwB,GAAG,CAAA,CAAA,EAAG;AAAA,IAChE;AAGA,IAAA,GAAA,CAAI,IAAA,CAAK,CAAA,2BAAA,EAAuB,aAAa,CAAA,GAAA,CAAK,CAAA;AAClD,IAAA,IAAI;AACF,MAAA,MAAM,aAAaA,SAAAA,CAAU,KAAA,EAAO,CAAC,UAAA,EAAY,IAAA,EAAM,aAAa,CAAA,EAAG;AAAA,QACrE,QAAA,EAAU;AAAA,OACX,CAAA;AACD,MAAA,IAAI,UAAA,CAAW,KAAA,IAAS,UAAA,CAAW,MAAA,KAAW,CAAA,EAAG;AAC/C,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,KAAA;AAAA,UACT,KAAA,EAAO,CAAA,yBAAA,EAA4B,UAAA,CAAW,MAAA,IAAU,WAAW,KAAK,CAAA;AAAA,SAC1E;AAAA,MACF;AAAA,IACF,SAAS,GAAA,EAAK;AACZ,MAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,CAAA,yBAAA,EAA4B,GAAG,CAAA,CAAA,EAAG;AAAA,IACpE;AAGA,IAAA,IAAI,KAAK,GAAA,EAAK;AACZ,MAAA,MAAM,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY,aAAA,EAAe;AAAA,QACxC,IAAA,EAAM,CAAA;;AAAA;AAAA,mBAAA,EAGO,aAAa;AAAA,0BAAA,EACN,aAAa;AAAA;;AAAA;;AAAA,qBAAA,EAKvB,aAAa,CAAA,wBAAA;AAAA,OACxB,CAAA;AAAA,IACH;AAEA,IAAA,GAAA,CAAI,KAAK,0BAAqB,CAAA;AAC9B,IAAA,OAAO,EAAE,SAAS,IAAA,EAAK;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA,EAKQ,oBAAA,CAAqB,SAAyB,OAAA,EAAiC;AACrF,IAAA,OAAO,CAAA;;AAAA,uDAAA,EAE8C,QAAQ,aAAa,CAAA;;AAAA;;AAAA;AAAA;AAAA,2BAAA,EAMjD,QAAQ,aAAa;AAAA;;AAAA;AAAA,qBAAA,EAI3B,QAAQ,aAAa,CAAA;;AAAA;AAAA;AAAA,4BAAA,EAId,OAAA,CAAQ,aAAa,CAAA,CAAA,EAAI,OAAA,CAAQ,aAAa,CAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA,EAQ1E,OAAA,CAAQ,aAAA,CAAc,GAAA,CAAI,CAAC,CAAA,KAAM,CAAA,EAAA,EAAK,CAAA,CAAE,KAAK,CAAA,CAAE,CAAA,CAAE,IAAA,CAAK,IAAI,CAAC;;AAAA;AAAA,EAG3D,OAAA,CAAQ,gBAAA,CAAiB,GAAA,CAAI,CAAC,CAAA,KAAM,CAAA,EAAA,EAAK,CAAA,CAAE,KAAK,CAAA,CAAE,CAAA,CAAE,IAAA,CAAK,IAAI,CAAC;;AAAA;AAAA,EAG9D,OAAA,CAAQ,SAAA,CAAU,GAAA,CAAI,CAAC,CAAA,KAAM,CAAA,EAAA,EAAK,CAAC,CAAA,CAAE,CAAA,CAAE,IAAA,CAAK,IAAI,CAAC;;AAAA;;AAAA;AAAA,kBAAA,EAK/B,OAAA,CAAQ,aAAa,CAAA,aAAA,EAAgB,OAAA,CAAQ,iBAAiB,CAAA;AAAA,cAAA,EAClE,QAAQ,UAAU;AAAA,gBAAA,EAChB,QAAQ,WAAW;;AAAA;AAAA,CAAA;AAAA,EAInC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,kBAAA,CACZ,WAAA,EACA,OAAA,EAC+B;AAC/B,IAAA,IAAI,CAAC,KAAK,GAAA,EAAK;AACb,MAAA,OAAO,EAAE,SAAS,KAAA,EAAM;AAAA,IAC1B;AAEA,IAAA,MAAM,KAAA,GAAQ,KAAK,GAAA,EAAI;AACvB,IAAA,MAAM,QAAA,GAAW,IAAA;AAEjB,IAAA,OAAO,IAAA,CAAK,GAAA,EAAI,GAAI,KAAA,GAAQ,OAAA,EAAS;AACnC,MAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,GAAA,CAAI,eAAe,WAAW,CAAA;AAExD,MAAA,IAAI,MAAA,CAAO,OAAA,IAAW,MAAA,CAAO,IAAA,EAAM;AACjC,QAAA,IAAI,MAAA,CAAO,IAAA,CAAK,MAAA,KAAW,SAAA,EAAW;AACpC,UAAA,MAAM,IAAA,GAAO,MAAM,IAAA,CAAK,GAAA,CAAI,qBAAqB,WAAW,CAAA;AAC5D,UAAA,IAAI,IAAA,CAAK,OAAA,IAAW,IAAA,CAAK,IAAA,EAAM;AAC7B,YAAA,MAAM,QAAA,GAAW,IAAA,CAAK,IAAA,CAAK,QAAA,IAAY,EAAC;AACxC,YAAA,KAAA,MAAW,OAAO,QAAA,EAAU;AAC1B,cAAA,IAAI,GAAA,CAAI,IAAA,EAAM,QAAA,CAAS,mBAAmB,CAAA,EAAG;AAC3C,gBAAA,OAAO,EAAE,SAAS,IAAA,EAAK;AAAA,cACzB;AAAA,YACF;AAAA,UACF;AAAA,QACF,CAAA,MAAA,IAAW,MAAA,CAAO,IAAA,CAAK,MAAA,KAAW,QAAA,EAAU;AAC1C,UAAA,OAAO,EAAE,SAAS,KAAA,EAAM;AAAA,QAC1B;AAAA,MACF;AAEA,MAAA,MAAM,IAAI,OAAA,CAAQ,CAAC,MAAM,UAAA,CAAW,CAAA,EAAG,QAAQ,CAAC,CAAA;AAAA,IAClD;AAEA,IAAA,OAAO,EAAE,SAAS,KAAA,EAAM;AAAA,EAC1B;AACF,CAAA;;;ACpaA,WAAA,EAAA;AAsBA,WAAA,EAAA;AASA,cAAA,EAAA;AAaA,aAAA,EAAA;AAEA,eAAA,EAAA;AAQA,WAAA,EAAA;AAsBA,eAAA,EAAA;;;AC1EA,WAAA,EAAA;;;AC8BA,YAAA,EAAA;;;AC3BA,WAAA,EAAA;;;ACFA,WAAA,EAAA;;;ACmFkCD,EAAE,MAAA,CAAO;AAAA,EACzC,UAAA,EAAYA,CAAAA,CAAE,IAAA,CAAK,CAAC,QAAA,EAAU,YAAY,SAAS,CAAC,CAAA,CAAE,QAAA,CAAS,4BAA4B,CAAA;AAAA,EAC3F,cAAA,EAAgBA,CAAAA,CAAE,MAAA,EAAO,CAAE,SAAS,uCAAuC,CAAA;AAAA,EAC3E,iBAAA,EAAmBA,CAAAA,CAAE,OAAA,EAAQ,CAAE,SAAS,+BAA+B,CAAA;AAAA,EACvE,iBAAA,EAAmBA,CAAAA,CAAE,OAAA,EAAQ,CAAE,SAAS,sCAAsC,CAAA;AAAA,EAC9E,UAAUA,CAAAA,CAAE,KAAA;AAAA,IACVA,EAAE,MAAA,CAAO;AAAA,MACP,WAAA,EAAaA,EAAE,MAAA,EAAO;AAAA,MACtB,QAAA,EAAUA,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAK,CAAC,CAAA;AAAA,MACtD,KAAA,EAAOA,EAAE,KAAA,CAAMA,CAAAA,CAAE,QAAQ,CAAA,CAAE,SAAS,qBAAqB;AAAA,KAC1D;AAAA,GACH;AAAA,EACA,KAAA,EAAOA,EAAE,KAAA,CAAMA,CAAAA,CAAE,QAAQ,CAAA,CAAE,SAAS,6BAA6B;AACnE,CAAC;;;AFhFD,aAAA,EAAA;AGCA,IAAM,sBAAA,GAAyBA,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAA,EAAO,YAAY,CAAC,CAAA;AAEzF,IAAM,kBAAA,GAAqBA,EAAE,MAAA,CAAO;AAAA,EAClC,EAAA,EAAIA,EAAE,MAAA,EAAO;AAAA,EACb,MAAA,EAAQA,CAAAA,CAAE,MAAA,EAAO,CAAE,SAAS,gEAAgE,CAAA;AAAA,EAC5F,QAAA,EAAU,sBAAA;AAAA,EACV,QAAA,EAAUA,EAAE,IAAA,CAAK;AAAA,IACf,KAAA;AAAA,IACA,UAAA;AAAA,IACA,aAAA;AAAA,IACA,OAAA;AAAA,IACA,eAAA;AAAA,IACA,YAAA;AAAA,IACA;AAAA,GACD,CAAA;AAAA,EACD,IAAA,EAAMA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EAC1B,IAAA,EAAMA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EAC1B,OAAA,EAASA,EAAE,MAAA,EAAO;AAAA,EAClB,YAAYA,CAAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,qCAAqC,CAAA;AAAA,EAChF,SAAA,EAAWA,EAAE,OAAA,EAAQ;AAAA,EACrB,aAAaA,CAAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,mDAAmD;AACjG,CAAC,CAAA;AAED,IAAM,cAAA,GAAiBA,EAAE,MAAA,CAAO;AAAA,EAC9B,MAAA,EAAQA,EAAE,IAAA,CAAK,CAAC,WAAW,SAAA,EAAW,SAAA,EAAW,SAAS,CAAC,CAAA;AAAA,EAC3D,QAAQA,CAAAA,CAAE,KAAA;AAAA,IACRA,EAAE,MAAA,CAAO;AAAA,MACP,IAAA,EAAMA,EAAE,MAAA,EAAO;AAAA,MACf,MAAA,EAAQA,EAAE,IAAA,CAAK,CAAC,WAAW,SAAA,EAAW,SAAA,EAAW,SAAS,CAAC,CAAA;AAAA,MAC3D,GAAA,EAAKA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,MACzB,OAAA,EAASA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAAS,KAC9B;AAAA,GACH;AAAA,EACA,cAAA,EAAgBA,CAAAA,CAAE,KAAA,CAAMA,CAAAA,CAAE,QAAQ;AACpC,CAAC,CAAA;AAEwBA,EAAE,MAAA,CAAO;AAAA,EAChC,QAAA,EAAUA,EAAE,MAAA,EAAO;AAAA,EACnB,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA,EAChB,OAAA,EAASA,EAAE,MAAA,EAAO;AAAA,EAClB,MAAA,EAAQA,EAAE,IAAA,CAAK,CAAC,SAAS,YAAA,EAAc,SAAA,EAAW,YAAA,EAAc,gBAAgB,CAAC,CAAA;AAAA,EACjF,EAAA,EAAI,cAAA;AAAA,EACJ,QAAA,EAAUA,EAAE,MAAA,CAAO;AAAA,IACjB,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA,IAChB,WAAA,EAAaA,EAAE,MAAA,EAAO;AAAA,IACtB,QAAA,EAAUA,EAAE,MAAA,EAAO;AAAA,IACnB,KAAA,EAAOA,CAAAA,CAAE,KAAA,CAAM,kBAAkB;AAAA,GAClC,CAAA;AAAA,EACD,UAAUA,CAAAA,CAAE,KAAA;AAAA,IACVA,EAAE,MAAA,CAAO;AAAA,MACP,IAAA,EAAMA,EAAE,IAAA,CAAK;AAAA,QACX,YAAA;AAAA,QACA,sBAAA;AAAA,QACA,gBAAA;AAAA,QACA,kBAAA;AAAA,QACA;AAAA,OACD,CAAA;AAAA,MACD,WAAA,EAAaA,EAAE,MAAA,EAAO;AAAA,MACtB,cAAA,EAAgBA,EAAE,OAAA,EAAQ;AAAA,MAC1B,YAAA,EAAcA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAAS,KACnC;AAAA,GACH;AAAA,EACA,OAAA,EAASA,EAAE,MAAA,EAAO;AAAA,EAClB,aAAaA,CAAAA,CAAE,KAAA;AAAA,IACbA,EAAE,MAAA,CAAO;AAAA,MACP,MAAA,EAAQA,EAAE,MAAA,EAAO;AAAA,MACjB,QAAA,EAAUA,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAK,CAAC,CAAA;AAAA,MACtD,SAAA,EAAWA,EAAE,OAAA,EAAQ;AAAA,MACrB,MAAA,EAAQA,EAAE,MAAA;AAAO,KAClB;AAAA;AAEL,CAAC;;;AHlDD,aAAA,EAAA;AAUA,WAAA,EAAA;AIzCO,IAAMS,uBAAAA,GAAyBT,EAAE,IAAA,CAAK,CAAC,YAAY,MAAA,EAAQ,QAAA,EAAU,KAAA,EAAO,MAAM,CAAC,CAAA;AAcnF,IAAM,oBAAA,GAAuBA,EAAE,IAAA,CAAK,CAAC,eAAe,WAAA,EAAa,WAAA,EAAa,UAAU,CAAC,CAAA;AAgBzF,IAAM,iBAAA,GAAoBA,EAAE,IAAA,CAAK;AAAA,EACtC,YAAA;AAAA,EACA,iBAAA;AAAA,EACA,gBAAA;AAAA,EACA,kBAAA;AAAA,EACA,mBAAA;AAAA,EACA;AACF,CAAC,CAAA;AAiBM,IAAM,cAAA,GAAiBA,EAAE,IAAA,CAAK;AAAA,EACnC,YAAA;AAAA,EACA,cAAA;AAAA,EACA,UAAA;AAAA,EACA,gBAAA;AAAA,EACA,SAAA;AAAA,EACA,QAAA;AAAA,EACA;AACF,CAAC,CAAA;AAaM,IAAMU,mBAAAA,GAAqBV,EAAE,MAAA,CAAO;AAAA;AAAA,EAEzC,EAAA,EAAIA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEb,MAAA,EAAQA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEjB,IAAA,EAAMA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEf,IAAA,EAAMA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA;AAAA,EAE1B,IAAA,EAAMA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA;AAAA,EAE1B,QAAA,EAAUS,uBAAAA;AAAA;AAAA,EAEV,MAAA,EAAQ,oBAAA;AAAA;AAAA,EAER,SAAA,EAAWT,EAAE,MAAA,EAAO;AAAA;AAAA,EAEpB,GAAA,EAAKA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEd,gBAAA,EAAkBA,EAAE,OAAA,EAAQ;AAAA;AAAA,EAE5B,eAAA,EAAiBA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA;AAAA,EAErC,UAAA,EAAYA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AACzB,CAAC,CAAA;AAgBM,IAAM,aAAA,GAAgBA,EAAE,MAAA,CAAO;AAAA;AAAA,EAEpC,IAAA,EAAM,iBAAA;AAAA;AAAA,EAEN,WAAA,EAAaA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEtB,gBAAA,EAAkBA,EAAE,OAAA,EAAQ;AAAA;AAAA,EAE5B,YAAA,EAAcA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA;AAAA,EAElC,GAAA,EAAKA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA;AAAA,EAEzB,QAAA,EAAUA,EAAE,OAAA;AACd,CAAC,CAAA;AAeM,IAAM,aAAA,GAAgBA,EAAE,MAAA,CAAO;AAAA;AAAA,EAEpC,IAAA,EAAMA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEf,MAAA,EAAQA,EAAE,IAAA,CAAK,CAAC,WAAW,aAAA,EAAe,SAAA,EAAW,SAAA,EAAW,SAAS,CAAC,CAAA;AAAA;AAAA,EAE1E,UAAA,EAAYA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA;AAAA,EAEhC,GAAA,EAAKA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEd,SAAA,EAAWA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA;AAAA,EAE/B,WAAA,EAAaA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAC1B,CAAC,CAAA;AAWM,IAAMW,eAAAA,GAAiBX,EAAE,MAAA,CAAO;AAAA;AAAA,EAErC,UAAA,EAAYA,EAAE,OAAA,EAAQ;AAAA;AAAA,EAEtB,UAAA,EAAYA,EAAE,OAAA,EAAQ;AAAA;AAAA,EAEtB,MAAA,EAAQA,CAAAA,CAAE,KAAA,CAAM,aAAa,CAAA;AAAA;AAAA,EAE7B,QAAA,EAAUA,CAAAA,CAAE,KAAA,CAAM,aAAa;AACjC,CAAC,CAAA;AAgBiCA,EAAE,MAAA,CAAO;AAAA;AAAA,EAEzC,QAAA,EAAUA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEnB,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEhB,OAAA,EAASA,EAAE,MAAA,EAAO;AAAA;AAAA,EAElB,MAAA,EAAQ,cAAA;AAAA;AAAA,EAER,EAAA,EAAIW,eAAAA;AAAA;AAAA,EAEJ,QAAA,EAAUX,EAAE,MAAA,CAAO;AAAA;AAAA,IAEjB,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA;AAAA,IAEhB,WAAA,EAAaA,EAAE,MAAA,EAAO;AAAA;AAAA,IAEtB,KAAA,EAAOA,CAAAA,CAAE,KAAA,CAAMU,mBAAkB;AAAA,GAClC,CAAA;AAAA;AAAA,EAED,QAAA,EAAUV,CAAAA,CAAE,KAAA,CAAM,aAAa,CAAA;AAAA;AAAA,EAE/B,aAAaA,CAAAA,CAAE,KAAA;AAAA,IACbA,EAAE,MAAA,CAAO;AAAA;AAAA,MAEP,MAAA,EAAQA,EAAE,MAAA,EAAO;AAAA;AAAA,MAEjB,QAAA,EAAUS,uBAAAA;AAAA;AAAA,MAEV,SAAA,EAAWT,EAAE,OAAA,EAAQ;AAAA;AAAA,MAErB,MAAA,EAAQA,EAAE,MAAA;AAAO,KAClB;AAAA,GACH;AAAA;AAAA,EAEA,OAAA,EAASA,EAAE,MAAA,EAAO;AAAA;AAAA,EAElB,SAAA,EAAWA,EAAE,MAAA;AACf,CAAC;AAeiCA,EAAE,MAAA,CAAO;AAAA;AAAA,EAEzC,OAAA,EAASA,EAAE,OAAA,EAAQ;AAAA;AAAA,EAEnB,MAAA,EAAQA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEjB,WAAA,EAAaA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEtB,KAAA,EAAOA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA;AAAA,EAE3B,SAASA,CAAAA,CACN,KAAA;AAAA,IACCA,EAAE,MAAA,CAAO;AAAA;AAAA,MAEP,IAAA,EAAMA,EAAE,MAAA,EAAO;AAAA;AAAA,MAEf,MAAMA,CAAAA,CAAE,IAAA,CAAK,CAAC,SAAA,EAAW,UAAA,EAAY,SAAS,CAAC;AAAA,KAChD;AAAA,IAEF,QAAA,EAAS;AAAA;AAAA,EAEZ,SAAA,EAAWA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AACxB,CAAC;AAemCA,EAAE,MAAA,CAAO;AAAA;AAAA,EAE3C,QAAA,EAAUA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEnB,OAAOA,CAAAA,CAAE,KAAA;AAAA,IACPA,EAAE,MAAA,CAAO;AAAA;AAAA,MAEP,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA;AAAA,MAEhB,MAAA,EAAQA,EAAE,MAAA,EAAO;AAAA;AAAA,MAEjB,WAAA,EAAaA,EAAE,MAAA,EAAO;AAAA;AAAA,MAEtB,SAAA,EAAWA,EAAE,OAAA,EAAQ;AAAA;AAAA,MAErB,iBAAA,EAAmBA,EAAE,MAAA,EAAO;AAAA;AAAA,MAE5B,YAAA,EAAcA,CAAAA,CAAE,KAAA,CAAMA,CAAAA,CAAE,QAAQ;AAAA,KACjC;AAAA,GACH;AAAA;AAAA,EAEA,sBAAA,EAAwBA,EAAE,MAAA,EAAO;AAAA;AAAA,EAEjC,yBAAA,EAA2BA,EAAE,OAAA,EAAQ;AAAA;AAAA,EAErC,uBAAA,EAAyBA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AACtC,CAAC;AC3PmCA,EAAE,MAAA,CAAO;AAAA,EAC3C,YAAA,EAAcA,EAAE,IAAA,CAAK,CAAC,MAAM,QAAQ,CAAC,CAAA,CAAE,OAAA,CAAQ,IAAI,CAAA;AAAA,EACnD,gBAAgBA,CAAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,QAAQ,GAAM,CAAA;AAAA,EACpD,GAAA,EAAKA,CAAAA,CAAE,MAAA,CAAOA,CAAAA,CAAE,MAAA,IAAUA,CAAAA,CAAE,MAAA,EAAQ,CAAA,CAAE,QAAA;AACxC,CAAC;AAKsCA,EAAE,MAAA,CAAO;AAAA,EAC9C,SAASA,CAAAA,CACN,MAAA,EAAO,CACP,GAAA,CAAI,CAAC,CAAA,CACL,KAAA;AAAA,IACC,mBAAA;AAAA,IACA;AAAA,GACF;AAAA,EACF,MAAMA,CAAAA,CACH,MAAA,EAAO,CACP,GAAA,CAAI,CAAC,CAAA,CACL,KAAA;AAAA,IACC,mBAAA;AAAA,IACA;AAAA,GACF;AAAA,EACF,KAAA,EAAOA,EAAE,MAAA,EAAO;AAAA,EAChB,SAASA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,GAAW,QAAA,EAAS;AAAA,EACxC,GAAA,EAAKA,CAAAA,CAAE,MAAA,CAAOA,CAAAA,CAAE,MAAA,IAAUA,CAAAA,CAAE,MAAA,EAAQ,CAAA,CAAE,QAAA;AACxC,CAAC;;;ACtFD,YAAA,EAAA;;;ACFO,IAAM,SAAA,GAA4B;AAAA,EACvC,EAAA,EAAI,MAAA;AAAA,EACJ,IAAA,EAAM,gBAAA;AAAA,EACN,IAAA,EAAM,WAAA;AAAA,EACN,WAAA,EAAa,oEAAA;AAAA,EACb,YAAA,EAAc,CAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BAAA,CAAA;AAAA,EAoBd,QAAA,EAAU;AAAA,IACR,EAAE,IAAA,EAAM,SAAA,EAAW,OAAA,EAAS,OAAA,EAAQ;AAAA,IACpC,EAAE,IAAA,EAAM,SAAA,EAAW,OAAA,EAAS,OAAA,EAAQ;AAAA,IACpC,EAAE,MAAM,QAAA;AAAS,GACnB;AAAA,EACA,YAAA,EAAc;AAAA,IACZ,kBAAA;AAAA,IACA,iBAAA;AAAA,IACA,gBAAA;AAAA,IACA,SAAA;AAAA,IACA;AAAA,GACF;AAAA,EACA,cAAA,EAAgB,IAAA;AAAA,EAChB,aAAA,EAAe,KAAA;AAAA,EACf,QAAA,EAAU,KAAA;AAAA,EACV,YAAA,EAAc,0BAAA;AAAA,EACd,WAAA,EAAa;AACf,CAAA;AAOO,IAAM,cAAA,GAAiC;AAAA,EAC5C,EAAA,EAAI,WAAA;AAAA,EACJ,IAAA,EAAM,qBAAA;AAAA,EACN,IAAA,EAAM,WAAA;AAAA,EACN,WAAA,EAAa,4DAAA;AAAA,EACb,YAAA,EAAc,CAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,yCAAA,CAAA;AAAA,EAoBd,QAAA,EAAU;AAAA,IACR,EAAE,IAAA,EAAM,UAAA,EAAY,IAAA,EAAM,cAAA,EAAe;AAAA;AAAA,IACzC;AAAA,MACE,IAAA,EAAM,OAAA;AAAA,MACN,MAAA,EAAQ,CAAC,qBAAA,EAAuB,0BAAA,EAA4B,qBAAqB;AAAA,KACnF;AAAA,IACA,EAAE,MAAM,QAAA;AAAS,GACnB;AAAA,EACA,cAAc,CAAC,WAAA,EAAa,cAAA,EAAgB,UAAA,EAAY,iBAAiB,cAAc,CAAA;AAAA,EACvF,cAAA,EAAgB,KAAA;AAAA,EAChB,aAAA,EAAe,KAAA;AAAA,EACf,QAAA,EAAU,IAAA;AAAA,EACV,YAAA,EAAc,0BAAA;AAAA,EACd,WAAA,EAAa;AACf,CAAA;AAOO,IAAM,YAAA,GAA+B;AAAA,EAC1C,EAAA,EAAI,SAAA;AAAA,EACJ,IAAA,EAAM,mBAAA;AAAA,EACN,IAAA,EAAM,WAAA;AAAA,EACN,WAAA,EAAa,2DAAA;AAAA,EACb,YAAA,EAAc,CAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAAA,CAAA;AAAA,EAuBd,QAAA,EAAU;AAAA,IACR,EAAE,IAAA,EAAM,UAAA,EAAY,IAAA,EAAM,WAAA,EAAY;AAAA;AAAA,IACtC,EAAE,MAAM,QAAA;AAAS,GACnB;AAAA,EACA,YAAA,EAAc;AAAA,IACZ,cAAA;AAAA,IACA,WAAA;AAAA,IACA,cAAA;AAAA,IACA,aAAA;AAAA,IACA,cAAA;AAAA,IACA,eAAA;AAAA,IACA;AAAA,GACF;AAAA,EACA,cAAA,EAAgB,IAAA;AAAA,EAChB,aAAA,EAAe,KAAA;AAAA,EACf,QAAA,EAAU,KAAA;AAAA,EACV,YAAA,EAAc,0BAAA;AAAA,EACd,WAAA,EAAa;AACf,CAAA;AAOO,IAAM,aAAA,GAAgC;AAAA,EAC3C,EAAA,EAAI,UAAA;AAAA,EACJ,IAAA,EAAM,oBAAA;AAAA,EACN,IAAA,EAAM,WAAA;AAAA,EACN,WAAA,EAAa,0CAAA;AAAA,EACb,YAAA,EAAc,CAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAAA,CAAA;AAAA,EAoBd,QAAA,EAAU;AAAA,IACR,EAAE,IAAA,EAAM,OAAA,EAAS,QAAQ,CAAC,qBAAA,EAAuB,0BAA0B,CAAA,EAAE;AAAA,IAC7E,EAAE,IAAA,EAAM,SAAA,EAAW,OAAA,EAAS,SAAA,EAAU;AAAA,IACtC,EAAE,MAAM,QAAA;AAAS,GACnB;AAAA,EACA,YAAA,EAAc,CAAC,aAAA,EAAe,WAAA,EAAa,cAAc,CAAA;AAAA,EACzD,cAAA,EAAgB,KAAA;AAAA,EAChB,aAAA,EAAe,KAAA;AAAA,EACf,QAAA,EAAU,KAAA;AAAA,EACV,YAAA,EAAc,0BAAA;AAAA,EACd,WAAA,EAAa;AACf,CAAA;AAOO,IAAM,UAAA,GAA6B;AAAA,EACxC,EAAA,EAAI,OAAA;AAAA,EACJ,IAAA,EAAM,iBAAA;AAAA,EACN,IAAA,EAAM,WAAA;AAAA,EACN,WAAA,EAAa,iCAAA;AAAA,EACb,YAAA,EAAc,CAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,uCAAA,CAAA;AAAA,EA2Bd,QAAA,EAAU;AAAA,IACR,EAAE,IAAA,EAAM,OAAA,EAAS,QAAQ,CAAC,qBAAA,EAAuB,wBAAwB,CAAA,EAAE;AAAA,IAC3E,EAAE,IAAA,EAAM,SAAA,EAAW,OAAA,EAAS,MAAA,EAAO;AAAA,IACnC,EAAE,MAAM,QAAA;AAAS,GACnB;AAAA,EACA,YAAA,EAAc,CAAC,QAAA,EAAU,WAAA,EAAa,gBAAgB,cAAc,CAAA;AAAA,EACpE,cAAA,EAAgB,IAAA;AAAA,EAChB,aAAA,EAAe,IAAA;AAAA,EACf,QAAA,EAAU,KAAA;AAAA,EACV,YAAA,EAAc,0BAAA;AAAA,EACd,WAAA,EAAa;AACf,CAAA;AAOO,IAAM,cAAA,GAAiC;AAAA,EAC5C,EAAA,EAAI,WAAA;AAAA,EACJ,IAAA,EAAM,qBAAA;AAAA,EACN,IAAA,EAAM,WAAA;AAAA,EACN,WAAA,EAAa,yCAAA;AAAA,EACb,YAAA,EAAc,CAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,qCAAA,CAAA;AAAA,EAuBd,QAAA,EAAU;AAAA,IACR,EAAE,IAAA,EAAM,SAAA,EAAW,OAAA,EAAS,SAAA,EAAU;AAAA,IACtC,EAAE,IAAA,EAAM,SAAA,EAAW,OAAA,EAAS,QAAA,EAAS;AAAA,IACrC,EAAE,IAAA,EAAM,SAAA,EAAW,OAAA,EAAS,WAAA,EAAY;AAAA,IACxC,EAAE,MAAM,QAAA;AAAS,GACnB;AAAA,EACA,cAAc,CAAC,gBAAA,EAAkB,cAAA,EAAgB,aAAA,EAAe,gBAAgB,eAAe,CAAA;AAAA,EAC/F,cAAA,EAAgB,IAAA;AAAA,EAChB,aAAA,EAAe,KAAA;AAAA,EACf,QAAA,EAAU,KAAA;AAAA,EACV,YAAA,EAAc,0BAAA;AAAA,EACd,WAAA,EAAa;AACf,CAAA;AAKO,IAAM,aAAA,GAAgD;AAAA,EAC3D,IAAA,EAAM,SAAA;AAAA,EACN,SAAA,EAAW,cAAA;AAAA,EACX,OAAA,EAAS,YAAA;AAAA,EACT,QAAA,EAAU,aAAA;AAAA,EACV,KAAA,EAAO,UAAA;AAAA,EACP,SAAA,EAAW;AACb,CAAA;AAKO,SAAS,eAAe,EAAA,EAAwC;AACrE,EAAA,OAAO,cAAc,EAAE,CAAA;AACzB;AAFgB,MAAA,CAAA,cAAA,EAAA,gBAAA,CAAA;AAOT,SAAS,iBAAA,GAA8B;AAC5C,EAAA,OAAO,MAAA,CAAO,KAAK,aAAa,CAAA;AAClC;AAFgB,MAAA,CAAA,iBAAA,EAAA,mBAAA,CAAA;;;ACzThB,aAAA,EAAA;AAcO,SAAS,eAAA,CAAgB,MAAsBJ,OAAAA,EAAqC;AACzF,EAAA,IAAI,CAACA,SAAQ,OAAO,IAAA;AAEpB,EAAA,MAAM,MAAA,GAAS,EAAE,GAAG,IAAA,EAAK;AAEzB,EAAA,IAAIA,QAAO,YAAA,EAAc;AACvB,IAAA,MAAA,CAAO,eAAeA,OAAAA,CAAO,YAAA;AAAA,EAC/B;AAEA,EAAA,IAAIA,QAAO,QAAA,EAAU;AACnB,IAAA,MAAA,CAAO,WAAWA,OAAAA,CAAO,QAAA;AAAA,EAC3B;AAEA,EAAA,IAAIA,QAAO,KAAA,EAAO;AAChB,IAAA,MAAA,CAAO,eAAeA,OAAAA,CAAO,KAAA;AAAA,EAC/B;AAGA,EAAA,IAAI,YAAA,GAAe,CAAC,GAAG,IAAA,CAAK,YAAY,CAAA;AAExC,EAAA,IAAIA,QAAO,sBAAA,EAAwB;AACjC,IAAA,YAAA,GAAe,CAAC,mBAAG,IAAI,GAAA,CAAI,CAAC,GAAG,YAAA,EAAc,GAAGA,OAAAA,CAAO,sBAAsB,CAAC,CAAC,CAAA;AAAA,EACjF;AAEA,EAAA,IAAIA,QAAO,mBAAA,EAAqB;AAC9B,IAAA,YAAA,GAAe,YAAA,CAAa,OAAO,CAAC,CAAA,KAAM,CAACA,OAAAA,CAAO,mBAAA,EAAqB,QAAA,CAAS,CAAC,CAAC,CAAA;AAAA,EACpF;AAEA,EAAA,MAAA,CAAO,YAAA,GAAe,YAAA;AAEtB,EAAA,OAAO,MAAA;AACT;AA/BgB,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAoCT,SAAS,gBAAA,CACd,QACA,WAAA,EAC4B;AAC5B,EAAA,MAAM,WAAA,GAAc,eAAe,MAAM,CAAA;AAEzC,EAAA,IAAI,CAAC,WAAA,EAAa;AAEhB,IAAA,OAAO,WAAA,EAAa,SAAS,MAAM,CAAA;AAAA,EACrC;AAGA,EAAA,MAAM,UAAA,GAAa,cAAc,MAA2B,CAAA;AAE5D,EAAA,IAAI,UAAA,EAAY,YAAY,KAAA,EAAO;AACjC,IAAA,OAAO,MAAA;AAAA,EACT;AAEA,EAAA,OAAO,eAAA,CAAgB,aAAa,UAAU,CAAA;AAChD;AAnBgB,MAAA,CAAA,gBAAA,EAAA,kBAAA,CAAA;AAwFhB,eAAsB,eAAA,CACpB,KAAA,EACA,KAAA,EACA,OAAA,EAC8B;AAC9B,EAAA,MAAM,IAAA,GAAO,eAAe,MAAM,CAAA;AAClC,EAAA,IAAI,CAAC,IAAA,EAAM;AACT,IAAA,OAAO,EAAE,OAAA,EAAS,KAAA,EAAO,KAAA,EAAO,qBAAA,EAAsB;AAAA,EACxD;AAEA,EAAA,IAAI;AAEF,IAAA,MAAM,QAAA,GAAW,IAAI,QAAA,EAAS;AAG9B,IAAA,IAAI,UAAA,GAAa,KAAA;AACjB,IAAA,IAAI,SAAS,YAAA,EAAc;AACzB,MAAA,UAAA,GAAa,UAAU,OAAA,CAAQ,YAAA,CAAa,MAAM,CAAA,EAAA,EAAK,OAAA,CAAQ,aAAa,KAAK;;AAAA,EAAO,OAAA,CAAQ,aAAa,IAAI;;AAAA,OAAA,EAAc,KAAK,CAAA,CAAA;AAAA,IACtI;AAEA,IAAA,MAAM,MAAA,GAAS,MAAM,QAAA,CAAS,WAAA,CAAY,UAAU,CAAA;AAEpD,IAAA,MAAM,WAAW,CAAA,cAAA,EAAiB,MAAA,CAAO,QAAQ,CAAA,iBAAA,EAAoB,OAAO,QAAQ;;AAAA,EAEtF,OAAO,OAAO;;AAAA,sBAAA,EAEQ,OAAO,eAAe;;AAAA,cAAA,EAE9B,IAAA,CAAK,KAAA,CAAM,MAAA,CAAO,UAAA,GAAa,GAAG,CAAC,CAAA,GAAA,CAAA;AAE/C,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT,QAAA;AAAA,MACA,IAAA,EAAM,MAAA;AAAA,MACN,OAAA,EAAS;AAAA,QACP,EAAE,IAAA,EAAM,cAAA,EAAgB,WAAA,EAAa,iCAAA,EAAmC,QAAQ,SAAA;AAAU;AAC5F,KACF;AAAA,EACF,SAAS,MAAA,EAAQ;AAEf,IAAA,MAAM,EAAE,IAAA,EAAK,GAAI,MAAMQ,YAAAA,CAAa;AAAA,MAClC,KAAA;AAAA,MACA,QAAQ,IAAA,CAAK,YAAA;AAAA,MACb,MAAA,EAAQ,KAAA;AAAA,MACR,WAAA,EAAa,KAAK,WAAA,IAAe;AAAA,KAClC,CAAA;AAED,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT,QAAA,EAAU,IAAA;AAAA,MACV,OAAA,EAAS;AAAA,QACP;AAAA,UACE,IAAA,EAAM,qBAAA;AAAA,UACN,WAAA,EAAa,+BAAA;AAAA,UACb,MAAA,EAAQ;AAAA;AACV;AACF,KACF;AAAA,EACF;AACF;AA3DsB,MAAA,CAAA,eAAA,EAAA,iBAAA,CAAA;AAgEf,SAAS,UAAU,WAAA,EAA6C;AACrE,EAAA,MAAM,QAA0B,EAAC;AAGjC,EAAA,KAAA,MAAW,CAAC,EAAA,EAAI,IAAI,KAAK,MAAA,CAAO,OAAA,CAAQ,aAAa,CAAA,EAAG;AACtD,IAAA,MAAMR,OAAAA,GAAS,cAAc,EAAuB,CAAA;AACpD,IAAA,IAAIA,OAAAA,EAAQ,YAAY,KAAA,EAAO;AAC7B,MAAA,KAAA,CAAM,IAAA,CAAK,eAAA,CAAgB,IAAA,EAAMA,OAAM,CAAC,CAAA;AAAA,IAC1C;AAAA,EACF;AAGA,EAAA,IAAI,aAAa,MAAA,EAAQ;AACvB,IAAA,KAAA,MAAW,IAAA,IAAQ,MAAA,CAAO,MAAA,CAAO,WAAA,CAAY,MAAM,CAAA,EAAG;AACpD,MAAA,KAAA,CAAM,KAAK,IAAI,CAAA;AAAA,IACjB;AAAA,EACF;AAEA,EAAA,OAAO,KAAA;AACT;AAnBgB,MAAA,CAAA,SAAA,EAAA,WAAA,CAAA;AAwBT,SAAS,iBAAA,CACd,SACA,WAAA,EAC4B;AAC5B,EAAA,MAAM,iBAAA,GAAoB,OAAA,CAAQ,WAAA,EAAY,CAAE,IAAA,EAAK;AAErD,EAAA,KAAA,MAAW,IAAA,IAAQ,SAAA,CAAU,WAAW,CAAA,EAAG;AACzC,IAAA,KAAA,MAAW,OAAA,IAAW,KAAK,QAAA,EAAU;AACnC,MAAA,IAAI,OAAA,CAAQ,SAAS,SAAA,EAAW;AAC9B,QAAA,IAAI,kBAAkB,UAAA,CAAW,OAAA,CAAQ,OAAA,CAAQ,WAAA,EAAa,CAAA,EAAG;AAC/D,UAAA,OAAO,IAAA;AAAA,QACT;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAEA,EAAA,OAAO,MAAA;AACT;AAjBgB,MAAA,CAAA,iBAAA,EAAA,mBAAA,CAAA;;;AC1LhB,YAAA,EAAA;AAOA,IAAMgB,QAAAA,GAAU,aAAA,CAAc,MAAA,CAAA,IAAA,CAAY,GAAG,CAAA;AAC7C,IAAM,GAAA,GAAMA,SAAQ,iBAAiB,CAAA;AAC9B,IAAM,UAAU,GAAA,CAAI,OAAA;;;AhBpB3B,IAAM,OAAA,GAAU,IAAI,OAAA,EAAQ;AAE5B,OAAA,CACG,KAAK,SAAS,CAAA,CACd,YAAY,8DAA8D,CAAA,CAC1E,QAAQ,OAAO,CAAA;AASlB,SAAS,gBAAA,CAAiB,OAAe,IAAA,EAAsB;AAC7D,EAAA,MAAM,MAAA,GAAS,MAAA,CAAO,QAAA,CAAS,KAAA,EAAO,EAAE,CAAA;AACxC,EAAA,IAAI,MAAA,CAAO,KAAA,CAAM,MAAM,CAAA,IAAK,UAAU,CAAA,EAAG;AACvC,IAAA,MAAM,IAAI,oBAAA,CAAqB,CAAA,EAAG,IAAI,CAAA,2BAAA,CAA6B,CAAA;AAAA,EACrE;AACA,EAAA,OAAO,MAAA;AACT;AANS,MAAA,CAAA,gBAAA,EAAA,kBAAA,CAAA;AAWT,SAASC,gBAAe,GAAA,EAAqB;AAC3C,EAAA,IAAI,CAAC,oBAAA,CAAqB,IAAA,CAAK,GAAG,CAAA,EAAG;AACnC,IAAA,MAAM,IAAI,qBAAqB,wBAAwB,CAAA;AAAA,EACzD;AACA,EAAA,IAAI,GAAA,CAAI,SAAS,GAAA,EAAK;AACpB,IAAA,MAAM,IAAI,qBAAqB,uCAAuC,CAAA;AAAA,EACxE;AACA,EAAA,OAAO,GAAA;AACT;AARS,MAAA,CAAAA,eAAAA,EAAA,gBAAA,CAAA;AAaT,SAAS,mBAAmB,MAAA,EAAwB;AAClD,EAAA,IAAI,CAAC,oBAAA,CAAqB,IAAA,CAAK,MAAM,CAAA,EAAG;AACtC,IAAA,MAAM,IAAI,qBAAqB,4BAA4B,CAAA;AAAA,EAC7D;AACA,EAAA,IAAI,MAAA,CAAO,SAAS,GAAA,EAAK;AACvB,IAAA,MAAM,IAAI,qBAAqB,2CAA2C,CAAA;AAAA,EAC5E;AACA,EAAA,OAAO,MAAA;AACT;AARS,MAAA,CAAA,kBAAA,EAAA,oBAAA,CAAA;AAcT,SAAS,MAAA,CAAO,MAAe,IAAA,EAAqB;AAClD,EAAA,IAAI,IAAA,EAAM;AACR,IAAA,OAAA,CAAQ,IAAI,IAAA,CAAK,SAAA,CAAU,IAAA,EAAM,IAAA,EAAM,CAAC,CAAC,CAAA;AAAA,EAC3C,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,IAAI,IAAI,CAAA;AAAA,EAClB;AACF;AANS,MAAA,CAAA,MAAA,EAAA,QAAA,CAAA;AAQT,SAAS,YAAY,KAAA,EAAsB;AACzC,EAAA,MAAM,MAAA,GAAS,KAAA,CAAM,MAAA,CAAO,MAAA,CAAO,EAAE,CAAA;AACrC,EAAA,MAAM,EAAA,GAAK,KAAA,CAAM,EAAA,CAAG,MAAA,CAAO,EAAE,CAAA;AAC7B,EAAA,MAAM,IAAA,GAAA,CAAQ,KAAA,CAAM,MAAA,EAAQ,UAAA,EAAY,KAAA,CAAM,GAAG,CAAA,CAAE,GAAA,EAAI,IAAK,GAAA,EAAK,MAAA,CAAO,EAAE,CAAA;AAC1E,EAAA,MAAM,QAAQ,KAAA,CAAM,IAAA,IAAQ,EAAA,EAAI,KAAA,CAAM,GAAG,EAAE,CAAA;AAC3C,EAAA,OAAO,GAAG,MAAM,CAAA,CAAA,EAAI,EAAE,CAAA,CAAA,EAAI,IAAI,IAAI,IAAI,CAAA,CAAA;AACxC;AANS,MAAA,CAAA,WAAA,EAAA,aAAA,CAAA;AAYT,IAAM,YAAY,OAAA,CACf,OAAA,CAAQ,QAAQ,CAAA,CAChB,YAAY,2CAA2C,CAAA;AAE1D,SAAA,CACG,OAAA,CAAQ,QAAQ,CAAA,CAChB,WAAA,CAAY,gCAAgC,CAAA,CAC5C,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,CAAC,IAAA,KAAS;AAChB,EAAA,MAAM,UAAU,eAAA,EAAgB;AAEhC,EAAA,IAAI,KAAK,IAAA,EAAM;AACb,IAAA,MAAA,CAAO,SAAS,IAAI,CAAA;AAAA,EACtB,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,IAAI,wBAAwB,CAAA;AACpC,IAAA,KAAA,MAAW,CAAC,GAAA,EAAK,IAAI,KAAK,MAAA,CAAO,OAAA,CAAQ,OAAO,CAAA,EAAG;AACjD,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,SAAA,GAAY,QAAA,GAAM,QAAA;AACtC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,EAAG,MAAM,CAAA,CAAA,EAAI,GAAA,CAAI,MAAA,CAAO,EAAE,CAAC,CAAA,CAAA,EAAI,IAAA,CAAK,MAAM,CAAA,CAAE,CAAA;AAAA,IAC1D;AAAA,EACF;AACF,CAAC,CAAA;AAEH,SAAA,CACG,OAAA,CAAQ,UAAU,CAAA,CAClB,WAAA,CAAY,wCAAwC,CAAA,CACpD,MAAA,CAAO,eAAA,EAAiB,uCAAuC,CAAA,CAC/D,MAAA,CAAO,CAAC,IAAA,KAAS;AAChB,EAAA,MAAM,IAAA,GAAO,IAAA,CAAK,IAAA,EAAM,KAAA,CAAM,GAAG,CAAA,CAAE,GAAA,CAAI,CAAC,CAAA,KAAc,CAAA,CAAE,IAAA,EAAM,CAAA;AAC9D,EAAA,MAAM,MAAA,GAAS,eAAe,IAAI,CAAA;AAElC,EAAA,IAAI,OAAO,OAAA,EAAS;AAClB,IAAA,OAAA,CAAQ,IAAI,0CAAqC,CAAA;AAAA,EACnD,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,MAAM,wBAAmB,CAAA;AACjC,IAAA,KAAA,MAAW,OAAA,IAAW,MAAA,CAAO,IAAA,IAAQ,EAAC,EAAG;AACvC,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,KAAA,EAAQ,OAAO,CAAA,CAAE,CAAA;AAAA,IACjC;AACA,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,SAAA,CACG,OAAA,CAAQ,UAAU,CAAA,CAClB,WAAA,CAAY,iDAAiD,CAAA,CAC7D,QAAA,CAAS,QAAA,EAAU,8BAA8B,CAAA,CACjD,MAAA,CAAO,CAAC,IAAA,KAAS;AAChB,EAAA,MAAM,GAAA,GAAM,WAAW,IAAI,CAAA;AAC3B,EAAA,MAAM,UAAU,eAAA,EAAgB;AAChC,EAAA,MAAMjB,OAAAA,GAAS,GAAA,GAAM,OAAA,CAAQ,GAAG,CAAA,GAAI,IAAA;AAEpC,EAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,IAAI,CAAA,CAAE,CAAA;AACjC,EAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,cAAA,EAAiB,GAAA,IAAO,SAAS,CAAA,CAAE,CAAA;AAC/C,EAAA,IAAIA,OAAAA,EAAQ;AACV,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,eAAA,EAAkBA,OAAAA,CAAO,MAAM,CAAA,CAAE,CAAA;AAC7C,IAAA,OAAA,CAAQ,IAAI,CAAA,WAAA,EAAcA,OAAAA,CAAO,SAAA,GAAY,YAAA,GAAU,WAAM,CAAA,CAAE,CAAA;AAAA,EACjE,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,IAAI,oCAAoC,CAAA;AAAA,EAClD;AACF,CAAC,CAAA;AAMH,IAAM,WAAW,OAAA,CAAQ,OAAA,CAAQ,OAAO,CAAA,CAAE,YAAY,0CAA0C,CAAA;AAEhG,QAAA,CACG,OAAA,CAAQ,MAAM,CAAA,CACd,WAAA,CAAY,iBAAiB,CAAA,CAC7B,MAAA,CAAO,aAAa,0BAA0B,CAAA,CAC9C,OAAO,mBAAA,EAAqB,0DAA0D,EACtF,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,OAAO,IAAA,KAAS;AACtB,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,IAAI,MAAA;AAEJ,IAAA,IAAI,KAAK,OAAA,EAAS;AAChB,MAAA,MAAA,GAAS,MAAM,MAAM,OAAA,EAAQ;AAAA,IAC/B,CAAA,MAAA,IAAW,KAAK,MAAA,EAAQ;AACtB,MAAA,MAAA,GAAS,MAAM,KAAA,CAAM,YAAA,CAAa,IAAA,CAAK,MAAA,CAAO,aAAa,CAAA;AAAA,IAC7D,CAAA,MAAO;AACL,MAAA,MAAA,GAAS,MAAM,MAAM,IAAA,EAAK;AAAA,IAC5B;AAEA,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,MAAA,CAAO,MAAM,IAAI,CAAA;AAAA,IAC1B,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,IAAI,wBAAwB,CAAA;AACpC,MAAA,OAAA,CAAQ,IAAI,CAAA,EAAG,QAAA,CAAS,MAAA,CAAO,EAAE,CAAC,CAAA,CAAA,EAAI,IAAA,CAAK,MAAA,CAAO,EAAE,CAAC,CAAA,CAAA,EAAI,MAAA,CAAO,MAAA,CAAO,EAAE,CAAC,CAAA,KAAA,CAAO,CAAA;AACjF,MAAA,OAAA,CAAQ,GAAA,CAAI,GAAA,CAAI,MAAA,CAAO,GAAG,CAAC,CAAA;AAC3B,MAAA,KAAA,MAAW,KAAA,IAAS,MAAA,CAAO,IAAA,IAAQ,EAAC,EAAG;AACrC,QAAA,OAAA,CAAQ,GAAA,CAAI,WAAA,CAAY,KAAK,CAAC,CAAA;AAAA,MAChC;AACA,MAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,OAAA,EAAY,MAAA,CAAO,IAAA,EAAM,MAAA,IAAU,CAAC,CAAA,OAAA,CAAS,CAAA;AAAA,IAC3D;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,2BAAA,EAAwB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC9E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,OAAA,CAAQ,OAAO,CAAA,CACf,WAAA,CAAY,6BAA6B,CAAA,CACzC,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,OAAO,IAAA,KAAS;AACtB,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,MAAM,MAAA,GAAS,MAAM,KAAA,CAAM,YAAA,EAAa;AAExC,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,MAAA,CAAO,MAAM,IAAI,CAAA;AAAA,IAC1B,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,IAAI,kCAAkC,CAAA;AAC9C,MAAA,KAAA,MAAW,IAAA,IAAQ,MAAA,CAAO,IAAA,IAAQ,EAAC,EAAG;AACpC,QAAA,MAAM,UAAA,GAAa,IAAA,CAAK,SAAA,GAAY,WAAA,GAAO,WAAA;AAC3C,QAAA,OAAA,CAAQ,GAAA,CAAI,GAAG,UAAU,CAAA,CAAA,EAAI,KAAK,QAAQ,CAAA,EAAA,EAAK,IAAA,CAAK,aAAa,CAAA,CAAA,CAAG,CAAA;AAAA,MACtE;AACA,MAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,OAAA,EAAY,MAAA,CAAO,IAAA,EAAM,MAAA,IAAU,CAAC,CAAA,aAAA,CAAe,CAAA;AAAA,IACjE;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,qCAAA,EAAkC,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AACxF,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,QAAQ,KAAK,CAAA,CACb,WAAA,CAAY,kCAAkC,EAC9C,QAAA,CAAS,YAAA,EAAc,UAAU,CAAA,CACjC,OAAO,QAAA,EAAU,gBAAgB,EACjC,MAAA,CAAO,OAAO,SAAS,IAAA,KAAS;AAC/B,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,MAAM,MAAA,GAAS,MAAM,KAAA,CAAM,MAAA,CAAO,OAAO,CAAA;AAEzC,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,QAAQ,MAAA,CAAO,IAAA;AACrB,IAAA,IAAI,CAAC,KAAA,EAAO;AACV,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,wBAAA,EAAsB,OAAO,CAAA,CAAE,CAAA;AAC7C,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,OAAO,IAAI,CAAA;AAAA,IACpB,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,IAAI,yBAAyB,CAAA;AACrC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,KAAA,CAAM,EAAE,CAAA,CAAE,CAAA;AACrC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,KAAA,CAAM,IAAA,IAAQ,WAAW,CAAA,CAAE,CAAA;AACtD,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,KAAA,CAAM,MAAM,CAAA,CAAE,CAAA;AACzC,MAAA,OAAA,CAAQ,IAAI,CAAA,YAAA,EAAe,KAAA,CAAM,MAAA,EAAQ,UAAA,IAAc,KAAK,CAAA,CAAE,CAAA;AAC9D,MAAA,OAAA,CAAQ,IAAI,CAAA,YAAA,EAAe,KAAA,CAAM,MAAA,EAAQ,GAAA,IAAO,KAAK,CAAA,CAAE,CAAA;AACvD,MAAA,IAAI,KAAA,CAAM,QAAQ,UAAA,EAAY;AAC5B,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,KAAA,CAAM,MAAA,CAAO,UAAU,CAAA,CAAE,CAAA;AAAA,MACtD;AACA,MAAA,IAAI,KAAA,CAAM,QAAQ,KAAA,EAAO;AACvB,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,KAAA,CAAM,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AAAA,MACjD;AACA,MAAA,IAAI,KAAA,CAAM,QAAQ,GAAA,EAAK;AACrB,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,KAAA,CAAM,MAAA,CAAO,GAAG,CAAA,CAAE,CAAA;AAAA,MAC/C;AACA,MAAA,IAAI,MAAM,SAAA,EAAW;AACnB,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,KAAA,CAAM,SAAS,CAAA,CAAE,CAAA;AAAA,MAC9C;AACA,MAAA,IAAI,MAAM,OAAA,EAAS;AACjB,QAAA,OAAA,CAAQ,GAAA,CAAI;AAAA;AAAA,EAAe,KAAA,CAAM,OAAO,CAAA,CAAE,CAAA;AAAA,MAC5C;AACA,MAAA,IAAI,MAAM,KAAA,EAAO;AACf,QAAA,OAAA,CAAQ,GAAA,CAAI;AAAA;AAAA,EAAe,KAAA,CAAM,KAAK,CAAA,CAAE,CAAA;AAAA,MAC1C;AAAA,IACF;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,6BAAA,EAA0B,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAChF,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,OAAA,CAAQ,cAAc,CAAA,CACtB,WAAA,CAAY,uCAAuC,CAAA,CACnD,QAAA,CAAS,cAAc,UAAU,CAAA,CACjC,OAAO,QAAA,EAAU,gBAAgB,EACjC,MAAA,CAAO,qBAAA,EAAuB,cAAc,CAAA,CAC5C,MAAA,CAAO,OAAO,OAAA,EAAS,IAAA,KAAS;AAC/B,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,MAAM,MAAA,GAAS,MAAM,KAAA,CAAM,YAAA,CAAa,OAAO,CAAA;AAE/C,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,OAAO,MAAA,CAAO,IAAA;AACpB,IAAA,IAAI,CAAC,IAAA,EAAM;AACT,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,yCAAA,EAAuC,OAAO,CAAA,CAAE,CAAA;AAC9D,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,IAAI,KAAK,MAAA,EAAQ;AACf,MAAAkB,aAAAA,CAAc,KAAK,MAAA,EAAQ,IAAA,CAAK,UAAU,IAAA,EAAM,IAAA,EAAM,CAAC,CAAC,CAAA;AACxD,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,6BAAA,EAA2B,IAAA,CAAK,MAAM,CAAA,CAAE,CAAA;AACpD,MAAA;AAAA,IACF;AAEA,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,MAAM,IAAI,CAAA;AAAA,IACnB,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,kBAAA,EAAqB,IAAA,CAAK,aAAa,CAAA;AAAA,CAAkB,CAAA;AACrE,MAAA,KAAA,MAAW,GAAA,IAAO,IAAA,CAAK,QAAA,IAAY,EAAC,EAAG;AACrC,QAAA,MAAM,IAAA,GAAO,GAAA,CAAI,IAAA,KAAS,cAAA,GAAiB,gBAAA,GAAY,qBAAA;AACvD,QAAA,MAAM,OAAO,GAAA,CAAI,SAAA,GAAY,CAAA,EAAA,EAAK,GAAA,CAAI,SAAS,CAAA,CAAA,CAAA,GAAM,EAAA;AACrD,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,EAAG,IAAI,CAAA,EAAG,IAAI,CAAA,CAAA,CAAG,CAAA;AAC7B,QAAA,OAAA,CAAQ,GAAA,CAAI,IAAI,IAAI,CAAA;AACpB,QAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,EAAK,GAAA,CAAI,MAAA,CAAO,EAAE,CAAC;AAAA,CAAI,CAAA;AAAA,MACrC;AAAA,IACF;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,oCAAA,EAAiC,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AACvF,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,QAAQ,OAAO,CAAA,CACf,YAAY,mBAAmB,CAAA,CAC/B,SAAS,QAAA,EAAU,8CAA8C,EACjE,QAAA,CAAS,QAAA,EAAU,kBAAkB,CAAA,CACrC,MAAA,CAAO,eAAe,+BAAA,EAAiC,MAAM,EAC7D,MAAA,CAAO,WAAA,EAAa,wDAAwD,CAAA,CAC5E,MAAA,CAAO,gBAAgB,wBAAwB,CAAA,CAC/C,OAAO,iBAAA,EAAmB,kCAAkC,EAC5D,MAAA,CAAO,UAAA,EAAY,iDAAiD,CAAA,CACpE,MAAA,CAAO,UAAU,gBAAgB,CAAA,CACjC,OAAO,OAAO,IAAA,EAAM,MAAM,IAAA,KAAS;AAClC,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,MAAM,WAAW,gBAAA,EAAiB;AAKlC,IAAA,MAAM,eACJ,IAAA,CAAK,MAAA,KAAW,SAAY,IAAA,CAAK,MAAA,GAAU,SAAS,YAAA,IAAgB,KAAA;AACtE,IAAA,MAAM,qBAAA,GAAwB,IAAA,CAAK,KAAA,IAAS,QAAA,CAAS,qBAAA,IAAyB,KAAA;AAE9E,IAAA,MAAM,MAAA,GAAS,MAAM,KAAA,CAAM,KAAA,CAAM;AAAA,MAC/B,UAAA,EAAY,IAAA;AAAA,MACZ,IAAA;AAAA,MACA,KAAK,IAAA,CAAK,GAAA;AAAA,MACV,MAAA,EAAQ;AAAA,QACN,YAAA;AAAA,QACA,YAAY,IAAA,CAAK,MAAA;AAAA,QACjB;AAAA;AACF,KACD,CAAA;AAED,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,MAAA,CAAO,MAAM,IAAI,CAAA;AAAA,IAC1B,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,IAAI,yBAAyB,CAAA;AACrC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,QAAA,EAAW,MAAA,CAAO,IAAA,EAAM,EAAE,CAAA,CAAE,CAAA;AACxC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,QAAA,EAAW,MAAA,CAAO,IAAA,EAAM,MAAM,CAAA,CAAE,CAAA;AAC5C,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,QAAA,EAAW,IAAI,CAAA,CAAE,CAAA;AAC7B,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,QAAA,EAAW,IAAA,CAAK,GAAG,CAAA,CAAE,CAAA;AACjC,MAAA,IAAI,KAAK,MAAA,EAAQ,OAAA,CAAQ,IAAI,CAAA,QAAA,EAAW,IAAA,CAAK,MAAM,CAAA,CAAE,CAAA;AACrD,MAAA,IAAI,YAAA,EAAc,OAAA,CAAQ,GAAA,CAAI,CAAA,gBAAA,CAAkB,CAAA;AAAA,IAClD;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,sBAAA,EAAmB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AACzE,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,QAAQ,UAAU,CAAA,CAClB,WAAA,CAAY,iCAAiC,EAC7C,QAAA,CAAS,YAAA,EAAc,UAAU,CAAA,CACjC,SAAS,WAAA,EAAa,iBAAiB,EACvC,MAAA,CAAO,OAAO,SAAS,OAAA,KAAY;AAClC,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,MAAM,MAAA,GAAS,MAAM,KAAA,CAAM,QAAA,CAAS,SAAS,OAAO,CAAA;AAEpD,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,yBAAA,EAAuB,OAAO,CAAA,CAAE,CAAA;AAAA,EAC9C,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,yBAAA,EAAsB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC5E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,OAAA,CAAQ,QAAQ,CAAA,CAChB,WAAA,CAAY,8BAA8B,CAAA,CAC1C,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,OAAO,IAAA,KAAS;AACtB,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,MAAM,MAAA,GAAS,MAAM,KAAA,CAAM,UAAA,EAAW;AAEtC,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,MAAA,CAAO,MAAM,IAAI,CAAA;AAAA,IAC1B,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,IAAI,mCAAmC,CAAA;AAC/C,MAAA,KAAA,MAAW,KAAA,IAAS,MAAA,CAAO,IAAA,IAAQ,EAAC,EAAG;AACrC,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,IAAA,EAAO,KAAK,CAAA,CAAE,CAAA;AAAA,MAC5B;AAAA,IACF;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,+BAAA,EAA4B,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAClF,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,OAAA,CAAQ,SAAS,CAAA,CACjB,WAAA,CAAY,mBAAmB,CAAA,CAC/B,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,OAAO,IAAA,KAAS;AACtB,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,MAAM,MAAA,GAAS,MAAM,KAAA,CAAM,OAAA,EAAQ;AAEnC,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,MAAA,CAAO,MAAM,IAAI,CAAA;AAAA,IAC1B,CAAA,MAAA,IAAW,OAAO,IAAA,EAAM;AACtB,MAAA,MAAM,IAAI,MAAA,CAAO,IAAA;AACjB,MAAA,IAAI,CAAC,CAAA,IAAK,KAAA,CAAM,OAAA,CAAQ,CAAC,CAAA,EAAG;AAC1B,QAAA,OAAA,CAAQ,MAAM,6BAAwB,CAAA;AACtC,QAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,MAChB;AACA,MAAA,OAAA,CAAQ,IAAI,yBAAyB,CAAA;AACrC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,WAAA,EAAc,CAAA,CAAE,KAAK,CAAA,CAAE,CAAA;AACnC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,WAAA,EAAc,CAAA,CAAE,OAAO,CAAA,CAAE,CAAA;AACrC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,WAAA,EAAc,CAAA,CAAE,SAAS,CAAA,CAAE,CAAA;AACvC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,WAAA,EAAc,CAAA,CAAE,MAAM,CAAA,CAAE,CAAA;AAAA,IACtC;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,wBAAA,EAAqB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC3E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,OAAA,CAAQ,YAAY,CAAA,CACpB,WAAA,CAAY,qCAAqC,CAAA,CACjD,SAAA;AAAA,EACC,IAAI,MAAA,CAAO,eAAA,EAAiB,wBAAwB,CAAA,CAAE,SAAA;AAAA,IAAU,CAAC,CAAA,KAC/D,gBAAA,CAAiB,CAAA,EAAG,MAAM;AAAA;AAE9B,CAAA,CACC,cAAA,CAAe,uBAAuB,gCAAgC,CAAA,CACtE,OAAO,iBAAA,EAAmB,6BAAA,EAA+B,OAAO,CAAA,CAChE,MAAA,CAAO,kBAAkB,4BAAA,EAA8B,OAAO,EAC9D,MAAA,CAAO,gBAAA,EAAkB,wCAAwC,EAAE,CAAA,CACnE,MAAA,CAAO,OAAO,IAAA,KAAS;AACtB,EAAA,IAAI;AACF,IAAA,IAAI,CAAC,KAAK,EAAA,EAAI;AACZ,MAAA,OAAA,CAAQ,MAAM,yBAAoB,CAAA;AAClC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,QAAA,GAAW,MAAA,CAAO,QAAA,CAAS,IAAA,CAAK,UAAU,EAAE,CAAA;AAClD,IAAA,MAAM,OAAA,GAAU,MAAA,CAAO,QAAA,CAAS,IAAA,CAAK,SAAS,EAAE,CAAA;AAEhD,IAAA,IAAI,MAAA,CAAO,KAAA,CAAM,QAAQ,CAAA,IAAK,YAAY,CAAA,EAAG;AAC3C,MAAA,OAAA,CAAQ,MAAM,8CAAyC,CAAA;AACvD,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AACA,IAAA,IAAI,MAAA,CAAO,KAAA,CAAM,OAAO,CAAA,IAAK,WAAW,CAAA,EAAG;AACzC,MAAA,OAAA,CAAQ,MAAM,6CAAwC,CAAA;AACtD,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AAExB,IAAA,MAAM,MAAM,UAAA,CAAW;AAAA,MACrB,gBAAgB,IAAA,CAAK,EAAA;AAAA,MACrB,MAAM,IAAA,CAAK,IAAA;AAAA,MACX,gBAAA,EAAkB,QAAA;AAAA,MAClB,eAAA,EAAiB,OAAA;AAAA,MACjB,QAAA,EAAU,IAAA,CAAK,MAAA,GAAS,IAAA,CAAK,MAAA,CAAO,KAAA,CAAM,GAAG,CAAA,CAAE,MAAA,CAAO,OAAO,CAAA,GAAI;AAAC,KACnE,CAAA;AAAA,EACH,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,2BAAA,EAAwB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC9E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAMH,IAAM,YAAY,OAAA,CAAQ,OAAA,CAAQ,QAAQ,CAAA,CAAE,YAAY,gCAAgC,CAAA;AAExF,SAAA,CACG,QAAQ,QAAQ,CAAA,CAChB,WAAA,CAAY,qCAAqC,EACjD,MAAA,CAAO,mBAAA,EAAqB,kEAAkE,CAAA,CAC9F,OAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,OAAO,IAAA,KAAS;AAEtB,EAAA,MAAM,gBAAA,GAAwF;AAAA,IAC5F,SAAA,EAAW;AAAA,MACT;AAAA,QACE,EAAA,EAAI,0BAAA;AAAA,QACJ,IAAA,EAAM,iBAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA;AAAA,QACE,EAAA,EAAI,wBAAA;AAAA,QACJ,IAAA,EAAM,eAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA;AAAA,QACE,EAAA,EAAI,4BAAA;AAAA,QACJ,IAAA,EAAM,mBAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA;AAAA,QACE,EAAA,EAAI,0BAAA;AAAA,QACJ,IAAA,EAAM,iBAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA;AAAA,QACE,EAAA,EAAI,2BAAA;AAAA,QACJ,IAAA,EAAM,kBAAA;AAAA,QACN,WAAA,EAAa;AAAA;AACf,KACF;AAAA,IACA,MAAA,EAAQ;AAAA,MACN,EAAE,EAAA,EAAI,QAAA,EAAU,IAAA,EAAM,QAAA,EAAU,aAAa,mCAAA,EAAoC;AAAA,MACjF,EAAE,EAAA,EAAI,aAAA,EAAe,IAAA,EAAM,aAAA,EAAe,aAAa,qBAAA,EAAsB;AAAA,MAC7E,EAAE,EAAA,EAAI,aAAA,EAAe,IAAA,EAAM,aAAA,EAAe,aAAa,mBAAA,EAAoB;AAAA,MAC3E,EAAE,EAAA,EAAI,OAAA,EAAS,IAAA,EAAM,OAAA,EAAS,aAAa,gBAAA,EAAiB;AAAA,MAC5D,EAAE,EAAA,EAAI,eAAA,EAAiB,IAAA,EAAM,eAAA,EAAiB,aAAa,sBAAA,EAAuB;AAAA,MAClF,EAAE,EAAA,EAAI,IAAA,EAAM,IAAA,EAAM,IAAA,EAAM,aAAa,oBAAA,EAAqB;AAAA,MAC1D,EAAE,EAAA,EAAI,SAAA,EAAW,IAAA,EAAM,SAAA,EAAW,aAAa,gBAAA;AAAiB,KAClE;AAAA,IACA,MAAA,EAAQ;AAAA,MACN;AAAA,QACE,EAAA,EAAI,gBAAA;AAAA,QACJ,IAAA,EAAM,gBAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA;AAAA,QACE,EAAA,EAAI,kBAAA;AAAA,QACJ,IAAA,EAAM,kBAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA;AAAA,QACE,EAAA,EAAI,qBAAA;AAAA,QACJ,IAAA,EAAM,qBAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA;AAAA,QACE,EAAA,EAAI,gBAAA;AAAA,QACJ,IAAA,EAAM,gBAAA;AAAA,QACN,WAAA,EAAa;AAAA;AACf,KACF;AAAA,IACA,OAAA,EAAS;AAAA,MACP;AAAA,QACE,EAAA,EAAI,sBAAA;AAAA,QACJ,IAAA,EAAM,eAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA,EAAE,EAAA,EAAI,uBAAA,EAAyB,IAAA,EAAM,gBAAA,EAAkB,aAAa,UAAA,EAAW;AAAA,MAC/E;AAAA,QACE,EAAA,EAAI,sBAAA;AAAA,QACJ,IAAA,EAAM,eAAA;AAAA,QACN,WAAA,EAAa;AAAA,OACf;AAAA,MACA,EAAE,EAAA,EAAI,kBAAA,EAAoB,IAAA,EAAM,WAAA,EAAa,aAAa,gBAAA,EAAiB;AAAA,MAC3E,EAAE,EAAA,EAAI,oBAAA,EAAsB,IAAA,EAAM,eAAA,EAAiB,aAAa,iBAAA;AAAkB,KACpF;AAAA,IACA,KAAA,EAAO;AAAA,MACL,EAAE,EAAA,EAAI,QAAA,EAAU,IAAA,EAAM,QAAA,EAAU,aAAa,gCAAA,EAAiC;AAAA,MAC9E,EAAE,EAAA,EAAI,OAAA,EAAS,IAAA,EAAM,OAAA,EAAS,aAAa,gCAAA,EAAiC;AAAA,MAC5E;AAAA,QACE,EAAA,EAAI,cAAA;AAAA,QACJ,IAAA,EAAM,eAAA;AAAA,QACN,WAAA,EAAa;AAAA;AACf;AACF,GACF;AAEA,EAAA,MAAM,SAAA,GAAY,KAAK,QAAA,GAAW,CAAC,KAAK,QAAQ,CAAA,GAAI,MAAA,CAAO,IAAA,CAAK,gBAAgB,CAAA;AAEhF,EAAA,IAAI,KAAK,IAAA,EAAM;AACb,IAAA,MAAM,SAAS,SAAA,CAAU,MAAA;AAAA,MACvB,CAAC,KAAK,CAAA,KAAM;AACV,QAAA,IAAI,gBAAA,CAAiB,CAAC,CAAA,EAAG;AACvB,UAAA,GAAA,CAAI,CAAC,CAAA,GAAI,gBAAA,CAAiB,CAAC,CAAA;AAAA,QAC7B;AACA,QAAA,OAAO,GAAA;AAAA,MACT,CAAA;AAAA,MACA;AAAC,KACH;AACA,IAAA,MAAA,CAAO,QAAQ,IAAI,CAAA;AACnB,IAAA;AAAA,EACF;AAEA,EAAA,OAAA,CAAQ,IAAI,0CAA0C,CAAA;AAEtD,EAAA,KAAA,MAAW,YAAY,SAAA,EAAW;AAChC,IAAA,MAAM,MAAA,GAAS,iBAAiB,QAAQ,CAAA;AACxC,IAAA,IAAI,CAAC,MAAA,EAAQ;AACX,MAAA,OAAA,CAAQ,GAAA,CAAI,qBAAqB,QAAQ;AAAA,CAAI,CAAA;AAC7C,MAAA;AAAA,IACF;AAEA,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,UAAA,EAAM,QAAA,CAAS,WAAA,EAAa,CAAA,CAAE,CAAA;AAC1C,IAAA,OAAA,CAAQ,GAAA,CAAI,GAAA,CAAI,MAAA,CAAO,EAAE,CAAC,CAAA;AAC1B,IAAA,KAAA,MAAW,SAAS,MAAA,EAAQ;AAC1B,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,EAAA,EAAK,KAAA,CAAM,EAAA,CAAG,MAAA,CAAO,EAAE,CAAC,CAAA,CAAA,EAAI,KAAA,CAAM,WAAW,CAAA,CAAE,CAAA;AAAA,IAC7D;AACA,IAAA,OAAA,CAAQ,GAAA,EAAI;AAAA,EACd;AAEA,EAAA,OAAA,CAAQ,IAAI,6CAAsC,CAAA;AAClD,EAAA,OAAA,CAAQ,GAAA;AAAA,IACN;AAAA,GACF;AACA,EAAA,OAAA,CAAQ,GAAA,EAAI;AACZ,EAAA,OAAA,CAAQ,IAAI,+DAAwD,CAAA;AACpE,EAAA,OAAA,CAAQ,IAAI,sEAAsE,CAAA;AAClF,EAAA,OAAA,CAAQ,IAAI,uDAAuD,CAAA;AACnE,EAAA,OAAA,CAAQ,IAAI,mEAAmE,CAAA;AAC/E,EAAA,OAAA,CAAQ,IAAI,+DAA+D,CAAA;AAC7E,CAAC,CAAA;AAEH,SAAA,CACG,QAAQ,OAAO,CAAA,CACf,YAAY,+BAA+B,CAAA,CAC3C,SAAS,SAAA,EAAW,iCAAiC,EACrD,MAAA,CAAO,iBAAA,EAAmB,uBAAuB,eAAA,EAAiB,EAClE,MAAA,CAAO,OAAO,OAAO,IAAA,KAAS;AAC7B,EAAA,IAAI,IAAA,GAAO,KAAA;AACX,EAAA,IAAI,UAAU,GAAA,EAAK;AACjB,IAAA,IAAA,GAAO,EAAA;AACP,IAAA,OAAA,CAAQ,KAAA,CAAM,YAAY,MAAM,CAAA;AAChC,IAAA,WAAA,MAAiB,KAAA,IAAS,QAAQ,KAAA,EAAO;AACvC,MAAA,IAAA,IAAQ,KAAA;AAAA,IACV;AAAA,EACF;AAEA,EAAA,IAAI;AACF,IAAA,MAAM,WAAW,IAAI,QAAA,CAAW,EAAE,KAAA,EAAO,IAAA,CAAK,OAAO,CAAA;AACrD,IAAA,MAAM,MAAA,GAAS,MAAM,QAAA,CAAS,WAAA,CAAY,IAAI,CAAA;AAE9C,IAAA,OAAA,CAAQ,IAAI,2BAA2B,CAAA;AACvC,IAAA,OAAA,CAAQ,IAAI,CAAA,YAAA,EAAe,MAAA,CAAO,QAAA,CAAS,WAAA,EAAa,CAAA,CAAE,CAAA;AAC1D,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,MAAA,CAAO,QAAQ,CAAA,CAAE,CAAA;AAC5C,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,MAAA,CAAO,OAAO,CAAA,CAAE,CAAA;AAC3C,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,MAAA,CAAO,eAAe,CAAA,CAAE,CAAA;AACnD,IAAA,OAAA,CAAQ,GAAA,CAAI,gBAAgB,MAAA,CAAO,UAAA,GAAa,KAAK,OAAA,CAAQ,CAAC,CAAC,CAAA,CAAA,CAAG,CAAA;AAAA,EACpE,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,uBAAA,EAAoB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC1E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,SAAA,CACG,OAAA,CAAQ,QAAQ,CAAA,CAChB,WAAA,CAAY,oCAAoC,EAChD,MAAA,CAAO,cAAA,EAAgB,mBAAA,EAAqB,MAAM,CAAA,CAClD,MAAA,CAAO,gBAAgB,mBAAA,EAAqB,MAAM,CAAA,CAClD,MAAA,CAAO,iBAAA,EAAmB,qBAAA,EAAuB,iBAAiB,CAAA,CAClE,MAAA,CAAO,OAAO,IAAA,KAAS;AACtB,EAAA,IAAI;AAEF,IAAA,MAAM,OAAA,GAAUD,eAAAA,CAAe,IAAA,CAAK,IAAI,CAAA;AACxC,IAAA,MAAM,OAAA,GAAUA,eAAAA,CAAe,IAAA,CAAK,IAAI,CAAA;AAGxC,IAAA,MAAM,UAAA,GAAa,eAAe,CAAC,MAAA,EAAQ,GAAG,OAAO,CAAA,GAAA,EAAM,OAAO,CAAA,CAAE,CAAC,CAAA;AAErE,IAAA,IAAI,CAAC,WAAW,OAAA,EAAS;AACvB,MAAA,OAAA,CAAQ,KAAA,CAAM,yBAAA,EAAsB,UAAA,CAAW,MAAA,IAAU,eAAe,CAAA;AACxE,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,OAAO,UAAA,CAAW,MAAA;AAExB,IAAA,IAAI,CAAC,IAAA,CAAK,IAAA,EAAK,EAAG;AAChB,MAAA,OAAA,CAAQ,IAAI,sBAAsB,CAAA;AAClC,MAAA;AAAA,IACF;AAEA,IAAA,MAAM,WAAW,IAAI,QAAA,CAAW,EAAE,KAAA,EAAO,IAAA,CAAK,OAAO,CAAA;AAErD,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,yBAAA,EAAqB,OAAO,CAAA,GAAA,EAAM,OAAO,CAAA,GAAA,CAAK,CAAA;AAE1D,IAAA,MAAM,MAAA,GAAS,MAAM,QAAA,CAAS,UAAA,CAAW,IAAI,CAAA;AAE7C,IAAA,OAAA,CAAQ,IAAI,yBAAyB,CAAA;AACrC,IAAA,OAAA,CAAQ,IAAI,CAAA,gBAAA,EAAmB,MAAA,CAAO,YAAA,GAAe,YAAA,GAAU,WAAM,CAAA,CAAE,CAAA;AAEvE,IAAA,IAAI,MAAA,CAAO,aAAA,CAAc,MAAA,GAAS,CAAA,EAAG;AACnC,MAAA,OAAA,CAAQ,IAAI,6BAAsB,CAAA;AAClC,MAAA,KAAA,MAAW,OAAA,IAAW,OAAO,aAAA,EAAe;AAC1C,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,KAAA,EAAQ,OAAO,CAAA,CAAE,CAAA;AAAA,MAC/B;AAAA,IACF;AAEA,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,kBAAA,EAAgB,MAAA,CAAO,MAAA,CAAO,MAAM,CAAA,EAAA,CAAI,CAAA;AACpD,IAAA,KAAA,MAAW,KAAA,IAAS,OAAO,MAAA,EAAQ;AACjC,MAAA,MAAM,IAAA,GACJ,KAAA,CAAM,QAAA,KAAa,UAAA,GACf,WAAA,GACA,KAAA,CAAM,QAAA,KAAa,MAAA,GACjB,WAAA,GACA,KAAA,CAAM,QAAA,KAAa,QAAA,GACjB,WAAA,GACA,QAAA;AACV,MAAA,OAAA,CAAQ,GAAA;AAAA,QACN,CAAA,GAAA,EAAM,IAAI,CAAA,EAAA,EAAK,KAAA,CAAM,QAAQ,CAAA,EAAA,EAAK,KAAA,CAAM,IAAI,CAAA,EAAG,MAAM,IAAA,GAAO,CAAA,CAAA,EAAI,KAAA,CAAM,IAAI,KAAK,EAAE,CAAA;AAAA,OACnF;AACA,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,MAAA,EAAS,KAAA,CAAM,WAAW,CAAA,CAAE,CAAA;AAAA,IAC1C;AAEA,IAAA,OAAA,CAAQ,IAAI,iCAA0B,CAAA;AACtC,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,GAAA,EAAM,MAAA,CAAO,iBAAiB,CAAA,CAAE,CAAA;AAAA,EAC9C,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,uBAAA,EAAoB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC1E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,SAAA,CACG,OAAA,CAAQ,IAAI,CAAA,CACZ,WAAA,CAAY,mCAAmC,CAAA,CAC/C,QAAA,CAAS,aAAA,EAAe,qBAAA,EAAuB,CAAC,CAAA,KAAM,gBAAA,CAAiB,CAAA,EAAG,WAAW,CAAC,CAAA,CACtF,MAAA,CAAO,qBAAA,EAAuB,iCAAiC,CAAA,CAC/D,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,OAAO,QAAA,EAAU,IAAA,KAAS;AAChC,EAAA,IAAI;AACF,IAAA,MAAM,EAAE,MAAA,EAAAE,OAAAA,EAAO,GAAI,MAAM,OAAA,CAAA,OAAA,EAAA,CAAA,IAAA,CAAA,OAAA,WAAA,EAAA,EAAA,cAAA,CAAA,CAAA;AACzB,IAAA,MAAM,MAAM,SAAA,EAAU;AACtB,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,IAAA,IAAQ,GAAA,CAAI,iBAAA;AAE9B,IAAA,IAAI,CAAC,IAAA,EAAM;AACT,MAAA,OAAA,CAAQ,MAAM,+EAA0E,CAAA;AACxF,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,KAAA,GAAQ,gBAAgB,IAAI,CAAA;AAClC,IAAA,IAAI,CAAC,KAAA,EAAO;AACV,MAAA,OAAA,CAAQ,KAAA;AAAA,QACN,0CAAqC,IAAI,CAAA,iEAAA;AAAA,OAC3C;AACA,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,MAAA,GAAS,IAAIA,OAAAA,CAAO;AAAA,MACxB,MAAA,EAAQ;AAAA,QACN,KAAA;AAAA,QACA;AAAA,OACF;AAAA,MACA,QAAA,EAAU;AAAA,QACR,gBAAA,EAAkB,QAAQ,GAAA;AAAI;AAChC,KACD,CAAA;AAED,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,uBAAA,EAAmB,QAAQ,CAAA,IAAA,EAAO,IAAI,CAAA,GAAA,CAAK,CAAA;AACvD,IAAA,MAAM,MAAA,GAAS,MAAM,MAAA,CAAO,OAAA,CAAQ,QAAQ,CAAA;AAE5C,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,QAAQ,IAAI,CAAA;AAAA,IACrB,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,GAAA,CAAI,MAAA,CAAO,kBAAA,CAAmB,MAAM,CAAC,CAAA;AAAA,IAC/C;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,0BAAA,EAAuB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC7E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,SAAA,CACG,OAAA,CAAQ,KAAK,CAAA,CACb,WAAA,CAAY,gDAAgD,CAAA,CAC5D,QAAA,CAAS,aAAA,EAAe,kBAAA,EAAoB,CAAC,CAAA,KAAM,gBAAA,CAAiB,CAAA,EAAG,WAAW,CAAC,CAAA,CACnF,MAAA,CAAO,qBAAA,EAAuB,iCAAiC,CAAA,CAC/D,MAAA,CAAO,uBAAA,EAAyB,gBAAA,EAAkB,GAAG,CAAA,CACrD,MAAA,CAAO,OAAO,QAAA,EAAU,IAAA,KAAS;AAChC,EAAA,IAAI;AACF,IAAA,MAAM,EAAE,MAAA,EAAAA,OAAAA,EAAO,GAAI,MAAM,OAAA,CAAA,OAAA,EAAA,CAAA,IAAA,CAAA,OAAA,WAAA,EAAA,EAAA,cAAA,CAAA,CAAA;AACzB,IAAA,MAAM,MAAM,SAAA,EAAU;AACtB,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,IAAA,IAAQ,GAAA,CAAI,iBAAA;AAE9B,IAAA,IAAI,CAAC,IAAA,EAAM;AACT,MAAA,OAAA,CAAQ,MAAM,+EAA0E,CAAA;AACxF,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,KAAA,GAAQ,gBAAgB,IAAI,CAAA;AAClC,IAAA,IAAI,CAAC,KAAA,EAAO;AACV,MAAA,OAAA,CAAQ,KAAA;AAAA,QACN,0CAAqC,IAAI,CAAA,iEAAA;AAAA,OAC3C;AACA,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,MAAA,GAAS,IAAIA,OAAAA,CAAO;AAAA,MACxB,MAAA,EAAQ;AAAA,QACN,KAAA;AAAA,QACA;AAAA,OACF;AAAA,MACA,QAAA,EAAU;AAAA,QACR,gBAAA,EAAkB,QAAQ,GAAA;AAAI;AAChC,KACD,CAAA;AAED,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,4CAAA,EAAwC,QAAQ,CAAA,IAAA,EAAO,IAAI,CAAA,GAAA,CAAK,CAAA;AAE5E,IAAA,MAAM,MAAA,GAAS,MAAM,MAAA,CAAO,aAAA,CAAc,QAAA,EAAU;AAAA,MAClD,aAAA,EAAe,MAAA,CAAO,QAAA,CAAS,IAAA,CAAK,YAAY,EAAE,CAAA;AAAA,MAClD,UAAA,kBAAY,MAAA,CAAA,CAAC,CAAA,EAAG,CAAA,KAAM;AACpB,QAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,UAAA,EAAe,CAAC,CAAA,WAAA,EAAc,CAAA,CAAE,MAAM,CAAA,CAAE,CAAA;AACpD,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,sBAAA,EAAyB,CAAA,CAAE,QAAA,CAAS,WAAW,CAAA,CAAE,CAAA;AAC7D,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,UAAA,EAAa,CAAA,CAAE,QAAA,CAAS,MAAM,CAAA,CAAE,CAAA;AAAA,MAC9C,CAAA,EAJY,YAAA;AAAA,KAKb,CAAA;AAED,IAAA,OAAA,CAAQ,IAAI,gCAAgC,CAAA;AAC5C,IAAA,OAAA,CAAQ,IAAI,CAAA,SAAA,EAAY,MAAA,CAAO,OAAA,GAAU,QAAA,GAAM,QAAG,CAAA,CAAE,CAAA;AACpD,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,MAAA,CAAO,UAAU,CAAA,CAAE,CAAA;AAC9C,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,cAAA,EAAiB,MAAA,CAAO,WAAA,CAAY,MAAM,CAAA,CAAE,CAAA;AAExD,IAAA,IAAI,MAAA,CAAO,UAAA,CAAW,MAAA,GAAS,CAAA,EAAG;AAChC,MAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,eAAA,EAAoB,MAAA,CAAO,UAAA,CAAW,MAAM,CAAA,EAAA,CAAI,CAAA;AAC5D,MAAA,KAAA,MAAW,MAAA,IAAU,OAAO,UAAA,EAAY;AACtC,QAAA,OAAA,CAAQ,GAAA;AAAA,UACN,CAAA,GAAA,EAAM,MAAA,CAAO,OAAA,GAAU,QAAA,GAAM,QAAG,KAAK,MAAA,CAAO,MAAM,CAAA,EAAA,EAAK,MAAA,CAAO,WAAW,CAAA;AAAA,SAC3E;AAAA,MACF;AAAA,IACF;AAEA,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,8BAAA,EAA2B,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AACjF,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,SAAA,CACG,OAAA,CAAQ,SAAS,CAAA,CACjB,WAAA,CAAY,4BAA4B,CAAA,CACxC,QAAA,CAAS,YAAA,EAAc,qBAAqB,CAAA,CAC5C,MAAA,CAAO,qBAAA,EAAuB,oBAAoB,CAAA,CAClD,MAAA,CAAO,iBAAA,EAAmB,6CAA6C,CAAA,CACvE,MAAA,CAAO,WAAA,EAAa,mCAAmC,EACvD,MAAA,CAAO,iBAAA,EAAmB,qBAAA,EAAuB,eAAA,EAAiB,CAAA,CAClE,MAAA,CAAO,OAAO,SAAS,IAAA,KAAS;AAC/B,EAAA,IAAI;AACF,IAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,IAAA,MAAM,WAAW,IAAI,QAAA,CAAW,EAAE,KAAA,EAAO,IAAA,CAAK,OAAO,CAAA;AAErD,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,oCAAA,EAAgC,OAAO,CAAA,GAAA,CAAK,CAAA;AACxD,IAAA,MAAM,IAAA,GAAO,MAAM,KAAA,CAAM,YAAA,CAAa,OAAO,CAAA;AAE7C,IAAA,IAAI,CAAC,IAAA,CAAK,OAAA,IAAW,CAAC,KAAK,IAAA,EAAM;AAC/B,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,IAAA,CAAK,KAAK,CAAA,CAAE,CAAA;AAC/B,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,OAAA,CAAQ,IAAI,CAAA,oBAAA,EAAgB,IAAA,CAAK,KAAK,QAAA,EAAU,MAAA,IAAU,CAAC,CAAA,YAAA,CAAc,CAAA;AAEzE,IAAA,MAAM,QAAA,GAAW,MAAM,QAAA,CAAS,mBAAA,CAAoB,KAAK,IAAI,CAAA;AAE7D,IAAA,OAAA,CAAQ,IAAI,8BAA8B,CAAA;AAC1C,IAAA,OAAA,CAAQ,GAAA,CAAI,SAAS,OAAO,CAAA;AAE5B,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,kBAAA,EAAkB,QAAA,CAAS,cAAA,CAAe,MAAM,CAAA,CAAE,CAAA;AAC9D,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,uBAAA,EAAmB,QAAA,CAAS,gBAAA,CAAiB,MAAM,CAAA,CAAE,CAAA;AACjE,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,uBAAA,EAAgB,QAAA,CAAS,QAAA,CAAS,MAAM,CAAA,CAAE,CAAA;AAEtD,IAAA,IAAI,KAAK,MAAA,EAAQ;AACf,MAAA,MAAM,MAAA,GAAS,MAAM,QAAA,CAAS,cAAA,CAAe,KAAK,IAAI,CAAA;AACtD,MAAAD,aAAAA,CAAc,IAAA,CAAK,MAAA,EAAQ,MAAM,CAAA;AACjC,MAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,0BAAA,EAAwB,IAAA,CAAK,MAAM,CAAA,CAAE,CAAA;AAAA,IACnD;AAEA,IAAA,IAAI,IAAA,CAAK,YAAA,IAAgB,IAAA,CAAK,MAAA,EAAQ;AACpC,MAAA,OAAA,CAAQ,IAAI,uCAAgC,CAAA;AAC5C,MAAA,MAAM,MAAA,GAAS,MAAM,QAAA,CAAS,wBAAA,CAAyB,QAAA,EAAU;AAAA,QAC/D,QAAQ,IAAA,CAAK;AAAA,OACd,CAAA;AACD,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,QAAA,EAAW,MAAA,CAAO,MAAM,CAAA,OAAA,CAAS,CAAA;AAAA,IAC/C;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,yBAAA,EAAsB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC5E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAMH,IAAM,WAAW,OAAA,CAAQ,OAAA,CAAQ,OAAO,CAAA,CAAE,YAAY,gCAAgC,CAAA;AAEtF,QAAA,CACG,OAAA,CAAQ,MAAM,CAAA,CACd,WAAA,CAAY,sBAAsB,CAAA,CAClC,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,CAAC,IAAA,KAAS;AAChB,EAAA,MAAM,QAAQ,SAAA,EAAU;AAExB,EAAA,IAAI,KAAK,IAAA,EAAM;AACb,IAAA,MAAA,CAAO,OAAO,IAAI,CAAA;AAAA,EACpB,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,IAAI,2BAA2B,CAAA;AACvC,IAAA,KAAA,MAAW,QAAQ,KAAA,EAAO;AACxB,MAAA,MAAM,WAAW,IAAA,CAAK,QAAA,CACnB,MAAA,CAAO,CAAC,MAAM,CAAA,CAAE,IAAA,KAAS,SAAS,CAAA,CAClC,IAAI,CAAC,CAAA,KAAO,EAA0B,OAAO,CAAA,CAC7C,KAAK,IAAI,CAAA;AAEZ,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,EAAG,IAAA,CAAK,IAAI,CAAA,CAAA,EAAI,KAAK,IAAI,CAAA,EAAA,EAAK,IAAA,CAAK,EAAE,CAAA,CAAA,CAAG,CAAA;AACpD,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,GAAA,EAAM,IAAA,CAAK,WAAW,CAAA,CAAE,CAAA;AACpC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,aAAA,EAAgB,QAAA,IAAY,aAAa,CAAA,CAAE,CAAA;AACvD,MAAA,OAAA,CAAQ,GAAA;AAAA,QACN,oBAAoB,IAAA,CAAK,YAAA,CAAa,KAAA,CAAM,CAAA,EAAG,CAAC,CAAA,CAAE,IAAA,CAAK,IAAI,CAAC,GAAG,IAAA,CAAK,YAAA,CAAa,MAAA,GAAS,CAAA,GAAI,QAAQ,EAAE,CAAA;AAAA,OAC1G;AACA,MAAA,OAAA,CAAQ,GAAA,EAAI;AAAA,IACd;AAAA,EACF;AACF,CAAC,CAAA;AAEH,QAAA,CACG,QAAQ,MAAM,CAAA,CACd,WAAA,CAAY,wCAAwC,EACpD,QAAA,CAAS,WAAA,EAAa,gEAAgE,CAAA,CACtF,OAAO,QAAA,EAAU,gBAAgB,EACjC,MAAA,CAAO,CAAC,QAAQ,IAAA,KAAS;AACxB,EAAA,MAAM,IAAA,GAAO,iBAAiB,MAAM,CAAA;AAEpC,EAAA,IAAI,CAAC,IAAA,EAAM;AACT,IAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,uBAAA,EAAqB,MAAM,CAAA,CAAE,CAAA;AAC3C,IAAA,OAAA,CAAQ,MAAM,CAAA,iBAAA,EAAoB,iBAAA,GAAoB,IAAA,CAAK,IAAI,CAAC,CAAA,CAAE,CAAA;AAClE,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AAEA,EAAA,IAAI,KAAK,IAAA,EAAM;AACb,IAAA,MAAA,CAAO,MAAM,IAAI,CAAA;AAAA,EACnB,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,EAAK,IAAA,CAAK,IAAI,CAAA,CAAA,EAAI,IAAA,CAAK,IAAI;AAAA,CAAI,CAAA;AAC3C,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,IAAA,EAAO,IAAA,CAAK,EAAE,CAAA,CAAE,CAAA;AAC5B,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,aAAA,EAAgB,IAAA,CAAK,WAAW,CAAA,CAAE,CAAA;AAC9C,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,aAAA,CAAiB,CAAA;AAC7B,IAAA,KAAA,MAAW,GAAA,IAAO,KAAK,YAAA,EAAc;AACnC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,SAAA,EAAO,GAAG,CAAA,CAAE,CAAA;AAAA,IAC1B;AACA,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,SAAA,CAAa,CAAA;AACzB,IAAA,KAAA,MAAW,OAAA,IAAW,KAAK,QAAA,EAAU;AACnC,MAAA,IAAI,OAAA,CAAQ,SAAS,SAAA,EAAW;AAC9B,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,qBAAA,EAAkB,OAAA,CAAgC,OAAO,CAAA,CAAE,CAAA;AAAA,MACzE,CAAA,MAAA,IAAW,OAAA,CAAQ,IAAA,KAAS,UAAA,EAAY;AACtC,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,mBAAA,EAAkB,OAAA,CAA6B,IAAI,CAAA,CAAE,CAAA;AAAA,MACnE,CAAA,MAAA,IAAW,OAAA,CAAQ,IAAA,KAAS,OAAA,EAAS;AACnC,QAAA,OAAA,CAAQ,IAAI,CAAA,oBAAA,EAAiB,OAAA,CAAiC,OAAO,IAAA,CAAK,IAAI,CAAC,CAAA,CAAE,CAAA;AAAA,MACnF,CAAA,MAAO;AACL,QAAA,OAAA,CAAQ,IAAI,CAAA,wBAAA,CAAc,CAAA;AAAA,MAC5B;AAAA,IACF;AACA,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,YAAA,CAAgB,CAAA;AAC5B,IAAA,OAAA,CAAQ,IAAI,CAAA,oBAAA,EAAuB,IAAA,CAAK,cAAA,GAAiB,QAAA,GAAM,QAAG,CAAA,CAAE,CAAA;AACpE,IAAA,OAAA,CAAQ,IAAI,CAAA,mBAAA,EAAsB,IAAA,CAAK,aAAA,GAAgB,QAAA,GAAM,QAAG,CAAA,CAAE,CAAA;AAClE,IAAA,OAAA,CAAQ,IAAI,CAAA,iBAAA,EAAoB,IAAA,CAAK,QAAA,GAAW,QAAA,GAAM,QAAG,CAAA,CAAE,CAAA;AAC3D,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,eAAA,EAAoB,IAAA,CAAK,YAAA,IAAgB,kBAAkB,CAAA,CAAE,CAAA;AACzE,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,aAAA,EAAgB,IAAA,CAAK,WAAA,IAAe,GAAG,CAAA,CAAE,CAAA;AACrD,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,gCAAA,CAAoC,CAAA;AAChD,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,EAAA,EAAK,IAAA,CAAK,YAAA,CAAa,KAAA,CAAM,CAAA,EAAG,GAAG,CAAA,CAAE,OAAA,CAAQ,KAAA,EAAO,MAAM,CAAC,CAAA,GAAA,CAAK,CAAA;AAAA,EAC9E;AACF,CAAC,CAAA;AAEH,QAAA,CACG,OAAA,CAAQ,MAAM,CAAA,CACd,WAAA,CAAY,sBAAsB,EAClC,QAAA,CAAS,SAAA,EAAW,qBAAqB,CAAA,CACzC,MAAA,CAAO,qBAAA,EAAuB,oBAAoB,CAAA,CAClD,MAAA,CAAO,kBAAA,EAAoB,0BAA0B,CAAA,CACrD,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,OAAO,KAAA,EAAO,IAAA,KAAS;AAC7B,EAAA,IAAI;AACF,IAAA,MAAM,EAAE,iBAAA,EAAAE,kBAAAA,EAAkB,GAAI,MAAM,OAAA,CAAA,OAAA,EAAA,CAAA,IAAA,CAAA,OAAA,cAAA,EAAA,EAAA,iBAAA,CAAA,CAAA;AACpC,IAAA,MAAM,EAAE,eAAA,EAAAC,gBAAAA,EAAiB,eAAA,EAAAC,gBAAAA,KAAoB,MAAM,OAAA,CAAA,OAAA,EAAA,CAAA,IAAA,CAAA,OAAA,WAAA,EAAA,EAAA,cAAA,CAAA,CAAA;AAEnD,IAAA,MAAM,eAAeD,gBAAAA,EAAgB;AACrC,IAAA,MAAM,SAASC,gBAAAA,EAAgB;AAE/B,IAAA,IAAI,CAAC,MAAA,EAAQ;AACX,MAAA,OAAA,CAAQ,KAAA;AAAA,QACN;AAAA,OACF;AACA,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,aAAa,MAAMF,kBAAAA,CAAkB,YAAA,CAAa,QAAA,IAAY,aAAa,MAAM,CAAA;AACvF,IAAA,MAAM,KAAA,GAAQ,UAAA,CAAW,YAAA,CAAa,KAAA,IAAS,0BAA0B,CAAA;AAEzE,IAAA,OAAA,CAAQ,IAAI,iCAA0B,CAAA;AAEtC,IAAA,MAAM,MAAA,GAAS,MAAM,eAAA,CAAgB,KAAA,EAAO,KAA8C,CAAA;AAE1F,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,QAAQ,IAAI,CAAA;AAAA,IACrB,CAAA,MAAO;AACL,MAAA,IAAI,MAAA,CAAO,OAAA,IAAW,MAAA,CAAO,QAAA,EAAU;AACrC,QAAA,OAAA,CAAQ,IAAI,8BAAuB,CAAA;AACnC,QAAA,OAAA,CAAQ,GAAA,CAAI,OAAO,QAAQ,CAAA;AAAA,MAC7B,CAAA,MAAO;AACL,QAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAK,MAAA,CAAO,KAAA,IAAS,eAAe,CAAA,CAAE,CAAA;AACpD,QAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,MAChB;AAAA,IACF;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,qBAAA,EAAkB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AACxE,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,QAAA,CACG,OAAA,CAAQ,OAAO,CAAA,CACf,WAAA,CAAY,2CAA2C,CAAA,CACvD,QAAA,CAAS,WAAA,EAAa,wCAAwC,CAAA,CAC9D,MAAA,CAAO,CAAC,OAAA,KAAY;AACnB,EAAA,MAAM,IAAA,GAAO,kBAAkB,OAAO,CAAA;AAEtC,EAAA,IAAI,IAAA,EAAM;AACR,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,gBAAA,EAAc,IAAA,CAAK,IAAI,CAAA,CAAA,EAAI,KAAK,IAAI,CAAA,EAAA,EAAK,IAAA,CAAK,EAAE,CAAA,CAAA,CAAG,CAAA;AAC/D,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,GAAA,EAAM,IAAA,CAAK,WAAW,CAAA,CAAE,CAAA;AAAA,EACtC,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,gCAAA,EAA8B,OAAO,CAAA,CAAE,CAAA;AACnD,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,2BAAA,CAA+B,CAAA;AAC3C,IAAA,KAAA,MAAW,CAAA,IAAK,MAAA,CAAO,MAAA,CAAO,aAAa,CAAA,EAAG;AAC5C,MAAA,KAAA,MAAW,OAAA,IAAW,EAAE,QAAA,EAAU;AAChC,QAAA,IAAI,OAAA,CAAQ,SAAS,SAAA,EAAW;AAC9B,UAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,EAAA,EAAM,OAAA,CAAgC,OAAO,CAAA,QAAA,EAAM,EAAE,IAAI,CAAA,CAAA,EAAI,CAAA,CAAE,IAAI,CAAA,CAAE,CAAA;AAAA,QACnF;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF,CAAC,CAAA;AAMH,IAAM,aAAa,OAAA,CAAQ,OAAA,CAAQ,SAAS,CAAA,CAAE,YAAY,kCAAkC,CAAA;AAE5F,UAAA,CACG,OAAA,CAAQ,UAAU,CAAA,CAClB,WAAA,CAAY,qCAAqC,CAAA,CACjD,QAAA,CAAS,kBAAA,EAAoB,6BAA6B,CAAA,CAC1D,SAAA;AAAA,EACC,IAAI,MAAA,CAAO,eAAA,EAAiB,wBAAwB,CAAA,CAAE,SAAA;AAAA,IAAU,CAAC,CAAA,KAC/D,gBAAA,CAAiB,CAAA,EAAG,MAAM;AAAA;AAE9B,CAAA,CACC,cAAA,CAAe,mBAAmB,0BAA0B,CAAA,CAC5D,eAAe,cAAA,EAAgB,8BAA8B,EAC7D,MAAA,CAAO,aAAA,EAAe,yBAAyB,MAAM,CAAA,CACrD,OAAO,iBAAA,EAAmB,qCAAA,EAAuC,EAAE,CAAA,CACnE,MAAA,CAAO,OAAO,aAAA,EAAe,IAAA,KAAS;AACrC,EAAA,IAAI;AACF,IAAA,IAAI,CAAC,KAAK,EAAA,EAAI;AACZ,MAAA,OAAA,CAAQ,MAAM,yBAAoB,CAAA;AAClC,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,MAAM,OAAA,GAAU,IAAI,cAAA,EAAe;AAEnC,IAAA,OAAA,CAAQ,IAAI,sDAA+C,CAAA;AAE3D,IAAA,MAAM,MAAA,GAAS,MAAM,OAAA,CAAQ,eAAA,CAAgB,aAAA,EAAe;AAAA,MAC1D,YAAY,IAAA,CAAK,IAAA;AAAA,MACjB,KAAK,IAAA,CAAK,GAAA;AAAA,MACV,WAAW,IAAA,CAAK,EAAA;AAAA,MAChB,aAAA,EAAe,kBAAA,CAAmB,IAAA,CAAK,MAAM,CAAA;AAAA,MAC7C,KAAA,EAAO,IAAA,CAAK,KAAA,GAAQ,IAAA,CAAK,MAAM,KAAA,CAAM,GAAG,CAAA,CAAE,GAAA,CAAI,CAAC,CAAA,KAAc,CAAA,CAAE,IAAA,EAAM,IAAI;AAAC,KAC3E,CAAA;AAED,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,uBAAA,EAAqB,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AACjD,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,wBAAA,CAAuB,CAAA;AACnC,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,cAAA,EAAiB,MAAA,CAAO,WAAW,CAAA,CAAE,CAAA;AACjD,IAAA,OAAA,CAAQ,IAAI,CAAA,YAAA,EAAe,MAAA,CAAO,gBAAA,GAAmB,KAAA,GAAQ,SAAS,CAAA,CAAE,CAAA;AAAA,EAC1E,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,wBAAA,EAAqB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC3E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,UAAA,CACG,OAAA,CAAQ,SAAS,CAAA,CACjB,WAAA,CAAY,mCAAmC,CAAA,CAC/C,QAAA,CAAS,kBAAA,EAAoB,sBAAsB,CAAA,CACnD,MAAA,CAAO,OAAO,aAAA,KAAkB;AAC/B,EAAA,IAAI;AACF,IAAA,MAAM,OAAA,GAAU,IAAI,cAAA,EAAe;AACnC,IAAA,MAAM,WAAA,GAAc,OAAA,CAAQ,GAAA,CAAI,eAAA,IAAmB,iBAAA;AAEnD,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,2CAAA,EAAuC,aAAa,CAAA,GAAA,CAAK,CAAA;AACrE,IAAA,MAAM,OAAA,CAAQ,qBAAA,CAAsB,WAAA,EAAa,aAAa,CAAA;AAC9D,IAAA,OAAA,CAAQ,IAAI,iCAA4B,CAAA;AAAA,EAC1C,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,wBAAA,EAAqB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC3E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,UAAA,CACG,OAAA,CAAQ,UAAU,CAAA,CAClB,WAAA,CAAY,oCAAoC,CAAA,CAChD,QAAA,CAAS,kBAAA,EAAoB,sBAAsB,CAAA,CACnD,QAAA,CAAS,aAAA,EAAe,uBAAA,EAAyB,CAAC,CAAA,KAAM,gBAAA,CAAiB,CAAA,EAAG,WAAW,CAAC,CAAA,CACxF,QAAA,CAAS,cAAA,EAAgB,wBAAwB,kBAAkB,CAAA,CACnE,MAAA,CAAO,SAAA,EAAW,sBAAsB,CAAA,CACxC,MAAA,CAAO,QAAA,EAAU,mBAAmB,CAAA,CACpC,SAAA;AAAA,EACC,IAAI,MAAA,CAAO,yBAAA,EAA2B,cAAc,CAAA,CACjD,OAAA,CAAQ,CAAC,OAAA,EAAS,QAAA,EAAU,QAAQ,CAAC,CAAA,CACrC,QAAQ,QAAQ;AACrB,CAAA,CACC,MAAA,CAAO,OAAO,aAAA,EAAe,QAAA,EAAU,WAAW,IAAA,KAAS;AAC1D,EAAA,IAAI;AACF,IAAA,MAAM,OAAA,GAAU,IAAI,cAAA,EAAe;AAEnC,IAAA,OAAA,CAAQ,IAAI,6CAAsC,CAAA;AAElD,IAAA,MAAM,SAAS,MAAM,OAAA,CAAQ,QAAA,CAAS,aAAA,EAAe,UAAU,SAAA,EAAW;AAAA,MACxE,OAAO,IAAA,CAAK,KAAA;AAAA,MACZ,MAAM,IAAA,CAAK,IAAA;AAAA,MACX,aAAa,IAAA,CAAK,WAAA;AAAA,MAClB,YAAA,EAAc;AAAA,KACf,CAAA;AAED,IAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,MAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,wBAAA,EAAsB,MAAA,CAAO,KAAK,CAAA,CAAE,CAAA;AAClD,MAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,IAChB;AAEA,IAAA,OAAA,CAAQ,IAAI,2BAAsB,CAAA;AAAA,EACpC,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,yBAAA,EAAsB,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AAC5E,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAMH,IAAM,aAAa,OAAA,CAAQ,OAAA,CAAQ,SAAS,CAAA,CAAE,YAAY,uCAAuC,CAAA;AAEjG,UAAA,CACG,OAAA,CAAQ,KAAK,CAAA,CACb,WAAA,CAAY,8BAA8B,CAAA,CAC1C,QAAA,CAAS,UAAA,EAAY,2BAA2B,CAAA,CAChD,MAAA,CAAO,oBAAoB,kCAAA,EAAoC,QAAQ,EACvE,MAAA,CAAO,oBAAA,EAAsB,gCAAgC,OAAA,CAAQ,GAAA,EAAK,CAAA,CAC1E,MAAA,CAAO,iBAAA,EAAmB,oBAAoB,kBAAkB,CAAA,CAChE,OAAO,qBAAA,EAAuB,oBAAA,EAAsB,KAAK,CAAA,CACzD,MAAA,CAAO,eAAA,EAAiB,oBAAA,EAAsB,MAAM,CAAA,CACpD,OAAO,cAAA,EAAgB,+CAA+C,EACtE,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,OAAO,MAAA,EAAQ,IAAA,KAAS;AAC9B,EAAA,IAAI;AACF,IAAA,MAAM,EAAE,eAAA,EAAAG,gBAAAA,EAAgB,GAAI,MAAM,OAAA,CAAA,OAAA,EAAA,CAAA,IAAA,CAAA,OAAA,YAAA,EAAA,EAAA,eAAA,CAAA,CAAA;AAClC,IAAA,MAAM,QAAA,GAAW,IAAIA,gBAAAA,EAAgB;AAGrC,IAAA,MAAM,MAA8B,EAAC;AACrC,IAAA,IAAI,KAAK,GAAA,EAAK;AACZ,MAAA,KAAA,MAAW,IAAA,IAAQ,IAAA,CAAK,GAAA,CAAI,KAAA,CAAM,GAAG,CAAA,EAAG;AACtC,QAAA,MAAM,CAAC,GAAA,EAAK,KAAK,CAAA,GAAI,IAAA,CAAK,MAAM,GAAG,CAAA;AACnC,QAAA,IAAI,OAAO,KAAA,EAAO;AAChB,UAAA,GAAA,CAAI,GAAA,CAAI,IAAA,EAAM,CAAA,GAAI,MAAM,IAAA,EAAK;AAAA,QAC/B;AAAA,MACF;AAAA,IACF;AAEA,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,kBAAA,EAAc,IAAA,CAAK,OAAO,CAAA,oBAAA,CAAsB,CAAA;AAE5D,IAAA,MAAM,MAAA,GAAS,MAAM,QAAA,CAAS,OAAA,CAAQ;AAAA,MACpC,SAAS,IAAA,CAAK,OAAA;AAAA,MACd,WAAW,IAAA,CAAK,SAAA;AAAA,MAChB,WAAW,IAAA,CAAK,MAAA;AAAA,MAChB,MAAA;AAAA,MACA,SAAS,MAAA,CAAO,QAAA,CAAS,IAAA,CAAK,OAAA,EAAS,EAAE,CAAA,GAAI,GAAA;AAAA;AAAA,MAC7C,MAAA,EAAQ,MAAA,CAAO,QAAA,CAAS,IAAA,CAAK,QAAQ,EAAE,CAAA;AAAA,MACvC;AAAA,KACD,CAAA;AAED,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,QAAQ,IAAI,CAAA;AAAA,IACrB,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,IAAI,4BAA4B,CAAA;AACxC,MAAA,OAAA,CAAQ,IAAI,CAAA,SAAA,EAAY,MAAA,CAAO,OAAA,GAAU,QAAA,GAAM,QAAG,CAAA,CAAE,CAAA;AACpD,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,UAAA,EAAa,MAAA,CAAO,QAAQ,CAAA,EAAA,CAAI,CAAA;AAC5C,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,WAAA,EAAc,MAAA,CAAO,QAAQ,CAAA,CAAE,CAAA;AAE3C,MAAA,IAAI,OAAO,MAAA,EAAQ;AACjB,QAAA,OAAA,CAAQ,IAAI,qBAAc,CAAA;AAC1B,QAAA,OAAA,CAAQ,GAAA,CAAI,OAAO,MAAM,CAAA;AAAA,MAC3B;AAEA,MAAA,IAAI,OAAO,KAAA,EAAO;AAChB,QAAA,OAAA,CAAQ,IAAI,iBAAY,CAAA;AACxB,QAAA,OAAA,CAAQ,GAAA,CAAI,OAAO,KAAK,CAAA;AAAA,MAC1B;AAAA,IACF;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,kCAAA,EAA+B,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AACrF,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAEH,UAAA,CACG,OAAA,CAAQ,OAAO,CAAA,CACf,WAAA,CAAY,2CAA2C,CAAA,CACvD,QAAA,CAAS,gBAAgB,yBAAyB,CAAA,CAClD,OAAO,kBAAA,EAAoB,kCAAA,EAAoC,QAAQ,CAAA,CACvE,MAAA,CAAO,sBAAsB,8BAAA,EAAgC,OAAA,CAAQ,KAAK,CAAA,CAC1E,OAAO,iBAAA,EAAmB,uBAAA,EAAyB,kBAAkB,CAAA,CACrE,MAAA,CAAO,uBAAuB,oBAAA,EAAsB,KAAK,EACzD,MAAA,CAAO,eAAA,EAAiB,sBAAsB,MAAM,CAAA,CACpD,OAAO,QAAA,EAAU,gBAAgB,EACjC,MAAA,CAAO,OAAO,SAAS,IAAA,KAAS;AAC/B,EAAA,IAAI;AACF,IAAA,MAAM,EAAE,eAAA,EAAAA,gBAAAA,EAAgB,GAAI,MAAM,OAAA,CAAA,OAAA,EAAA,CAAA,IAAA,CAAA,OAAA,YAAA,EAAA,EAAA,eAAA,CAAA,CAAA;AAClC,IAAA,MAAM,QAAA,GAAW,IAAIA,gBAAAA,EAAgB;AAErC,IAAA,MAAM,OAAA,GAAU,OAAA,CAAQ,GAAA,CAAI,CAAC,QAAgB,KAAA,MAAmB;AAAA,MAC9D,SAAS,IAAA,CAAK,OAAA;AAAA,MACd,WAAW,IAAA,CAAK,SAAA;AAAA,MAChB,WAAW,CAAA,EAAG,IAAA,CAAK,MAAM,CAAA,OAAA,EAAU,QAAQ,CAAC,CAAA,CAAA;AAAA,MAC5C,MAAA;AAAA,MACA,SAAS,MAAA,CAAO,QAAA,CAAS,IAAA,CAAK,OAAA,EAAS,EAAE,CAAA,GAAI,GAAA;AAAA,MAC7C,MAAA,EAAQ,MAAA,CAAO,QAAA,CAAS,IAAA,CAAK,QAAQ,EAAE;AAAA,KACzC,CAAE,CAAA;AAEF,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,kBAAA,EAAc,OAAA,CAAQ,MAAM,CAAA,gCAAA,CAAkC,CAAA;AAE1E,IAAA,MAAM,OAAA,GAAU,MAAM,QAAA,CAAS,YAAA,CAAa,OAAO,CAAA;AAEnD,IAAA,IAAI,KAAK,IAAA,EAAM;AACb,MAAA,MAAA,CAAO,SAAS,IAAI,CAAA;AAAA,IACtB,CAAA,MAAO;AACL,MAAA,OAAA,CAAQ,IAAI,2BAA2B,CAAA;AACvC,MAAA,OAAA,CAAQ,OAAA,CAAQ,CAAC,MAAA,EAAQ,KAAA,KAAU;AACjC,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,MAAA,EAAS,KAAA,GAAQ,CAAC,CAAA,CAAA,CAAG,CAAA;AACjC,QAAA,OAAA,CAAQ,IAAI,CAAA,WAAA,EAAc,MAAA,CAAO,OAAA,GAAU,QAAA,GAAM,QAAG,CAAA,CAAE,CAAA;AACtD,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,YAAA,EAAe,MAAA,CAAO,QAAQ,CAAA,EAAA,CAAI,CAAA;AAC9C,QAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,aAAA,EAAgB,MAAA,CAAO,QAAQ,CAAA,CAAE,CAAA;AAC7C,QAAA,OAAA,CAAQ,GAAA,EAAI;AAAA,MACd,CAAC,CAAA;AAED,MAAA,MAAM,aAAa,OAAA,CAAQ,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,CAAE,OAAO,CAAA,CAAE,MAAA;AACpD,MAAA,OAAA,CAAQ,IAAI,CAAA,SAAA,EAAY,UAAU,CAAA,CAAA,EAAI,OAAA,CAAQ,MAAM,CAAA,8BAAA,CAAgC,CAAA;AAAA,IACtF;AAAA,EACF,SAAS,GAAA,EAAK;AACZ,IAAA,OAAA,CAAQ,MAAM,gCAAA,EAA6B,GAAA,YAAe,KAAA,GAAQ,GAAA,CAAI,UAAU,GAAG,CAAA;AACnF,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AACF,CAAC,CAAA;AAMH,OAAA,CACG,OAAA,CAAQ,QAAQ,CAAA,CAChB,WAAA,CAAY,4BAA4B,CAAA,CACxC,MAAA,CAAO,QAAA,EAAU,gBAAgB,CAAA,CACjC,MAAA,CAAO,CAAC,IAAA,KAAS;AAChB,EAAA,MAAM,MAAM,SAAA,EAAU;AACtB,EAAA,MAAM,UAAA,GAAa;AAAA,IACjB,cAAc,eAAA,EAAgB;AAAA,IAC9B,gBAAgB,iBAAA,EAAkB;AAAA,IAClC,QAAQ,eAAA,EAAgB;AAAA,IACxB,iBAAA,EAAmB,IAAI,iBAAA,IAAqB,WAAA;AAAA,IAC5C,cAAA,EAAgB,IAAI,cAAA,IAAkB,WAAA;AAAA,IACtC,UAAU,GAAA,CAAI;AAAA,GAChB;AAEA,EAAA,IAAI,KAAK,IAAA,EAAM;AACb,IAAA,MAAA,CAAO,YAAY,IAAI,CAAA;AAAA,EACzB,CAAA,MAAO;AACL,IAAA,OAAA,CAAQ,IAAI,yBAAyB,CAAA;AACrC,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,eAAA,EAAkB,UAAA,CAAW,YAAY,CAAA,CAAE,CAAA;AACvD,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,oBAAA,EAAuB,UAAA,CAAW,iBAAiB,CAAA,CAAE,CAAA;AACjE,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,iBAAA,EAAoB,UAAA,CAAW,cAAc,CAAA,CAAE,CAAA;AAC3D,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,WAAA,EAAc,UAAA,CAAW,QAAQ,CAAA,CAAE,CAAA;AAC/C,IAAA,OAAA,CAAQ,GAAA;AAAA,MACN,CAAA,iBAAA,EAAoB,UAAA,CAAW,cAAA,CAAe,MAAA,GAAS,CAAA,GAAI,WAAW,cAAA,CAAe,IAAA,CAAK,IAAI,CAAA,GAAI,2CAA2C,CAAA;AAAA,KAC/I;AACA,IAAA,OAAA,CAAQ,IAAI,iBAAiB,CAAA;AAC7B,IAAA,KAAA,MAAW,CAAC,KAAK,IAAI,CAAA,IAAK,OAAO,OAAA,CAAQ,UAAA,CAAW,MAAM,CAAA,EAAG;AAC3D,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,SAAA,GAAY,QAAA,GAAM,QAAA;AACtC,MAAA,OAAA,CAAQ,GAAA,CAAI,KAAK,MAAM,CAAA,CAAA,EAAI,GAAG,CAAA,EAAA,EAAK,IAAA,CAAK,MAAM,CAAA,CAAE,CAAA;AAAA,IAClD;AAAA,EACF;AACF,CAAC,CAAA;AAEH,OAAA,CACG,QAAQ,MAAM,CAAA,CACd,WAAA,CAAY,0BAA0B,EACtC,MAAA,CAAO,SAAA,EAAW,gCAAgC,CAAA,CAClD,OAAO,mBAAA,EAAqB,wCAAwC,CAAA,CACpE,MAAA,CAAO,OAAO,IAAA,KAAS;AACtB,EAAA,MAAMC,WAAAA,GAAa,qBAAA;AAEnB,EAAA,IAAIf,UAAAA,CAAWe,WAAU,CAAA,IAAK,CAAC,KAAK,KAAA,EAAO;AACzC,IAAA,OAAA,CAAQ,KAAA,CAAM,CAAA,OAAA,EAAKA,WAAU,CAAA,0CAAA,CAA4C,CAAA;AACzE,IAAA,OAAA,CAAQ,KAAK,CAAC,CAAA;AAAA,EAChB;AAEA,EAAA,MAAM,aAAA,GAAgB,OAAA,CAAQ,MAAA,CAAO,KAAA,IAAS,CAAC,IAAA,CAAK,cAAA;AAIpD,EAAA,MAAM,gBAAuE,EAAC;AAC9E,EAAA,MAAM,gBAAA,GAAmB,gCAAA;AACzB,EAAA,KAAA,MAAW,MAAA,IAAU,MAAA,CAAO,IAAA,CAAK,OAAA,CAAQ,GAAG,CAAA,EAAG;AAC7C,IAAA,MAAM,KAAA,GAAQ,MAAA,CAAO,KAAA,CAAM,gBAAgB,CAAA;AAC3C,IAAA,IAAI,QAAQ,CAAC,CAAA,IAAK,OAAA,CAAQ,GAAA,CAAI,MAAM,CAAA,EAAG;AAErC,MAAA,MAAM,OAAA,GAAU,MAAM,CAAC,CAAA,CAAE,aAAY,CAAE,OAAA,CAAQ,MAAM,GAAG,CAAA;AAExD,MAAA,IAAI,OAAA,CAAQ,MAAA,GAAS,CAAA,IAAK,OAAA,CAAQ,UAAU,EAAA,EAAI;AAC9C,QAAA,aAAA,CAAc,OAAO,CAAA,GAAI,EAAE,IAAA,EAAM,OAAA,EAAS,aAAa,MAAA,EAAO;AAAA,MAChE;AAAA,IACF;AAAA,EACF;AAGA,EAAA,MAAM,cAAA,GAAiB,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,YAAA;AACrC,EAAA,MAAM,YAAA,GAAe,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,cAAA;AACnC,EAAA,MAAM,eAAA,GAAkB,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,iBAAA;AACtC,EAAA,MAAM,YAAA,GAAe,CAAC,CAAC,OAAA,CAAQ,GAAA,CAAI,cAAA;AAGnC,EAAA,MAAMxB,OAAAA,GAAkC;AAAA,IACtC,MAAA,EAAQ;AAAA,MACN,aAAA,EAAe,OAAO,IAAA,CAAK,aAAa,EAAE,MAAA,GAAS,CAAA,GAAI,gBAAgB,EAAC;AAAA,MACxE,kBAAA,EAAoB,iBAAiB,cAAA,GAAiB,cAAA;AAAA,MACtD,mBAAA,EAAqB,iBAAiB,cAAA,GAAiB;AAAA,KACzD;AAAA,IACA,QAAA,EAAU,MAAA;AAAA,IACV,KAAA,EAAO;AAAA,MACL,YAAA,EAAc;AAAA,KAChB;AAAA,IACA,MAAA,EAAQ;AAAA,MACN,QAAA,EAAU,eAAA,GAAkB,WAAA,GAAc,YAAA,GAAe,QAAA,GAAW;AAAA;AAAA;AAEtE,GACF;AAGA,EAAA,IAAI,aAAA,EAAe;AACjB,IAAA,MAAM,EAAE,KAAA,EAAO,OAAA,EAAS,QAAO,GAAI,MAAM,OAAO,mBAAmB,CAAA;AAGnE,IAAA,MAAM,UAAA,GAAa,MAAM,KAAA,CAAM;AAAA,MAC7B,OAAA,EAAS,kDAAA;AAAA,MACT,OAAA,EAAS;AAAA,KACV,CAAA;AACD,IAAA,IAAI,UAAA,EAAY;AACd,MAAAA,QAAO,iBAAA,GAAoB,UAAA;AAAA,IAC7B;AAGA,IAAA,MAAM,MAAA,GAAS,MAAM,OAAA,CAAQ;AAAA,MAC3B,OAAA,EAAS,uCAAA;AAAA,MACT,OAAA,EAAS;AAAA,KACV,CAAA;AACD,IAACA,OAAAA,CAAO,MAAkC,YAAA,GAAe,MAAA;AAGzD,IAAA,OAAA,CAAQ,IAAI,uCAAgC,CAAA;AAG5C,IAAA,MAAM,QAAA,GAAW,MAAM,MAAA,CAAO;AAAA,MAC5B,OAAA,EAAS,oCAAA;AAAA,MACT,OAAA,EAAS;AAAA,QACP;AAAA,UACE,KAAA,EAAO,WAAA;AAAA,UACP,IAAA,EAAM,CAAA,kBAAA,EAAqB,eAAA,GAAkB,sBAAA,GAAoB,EAAE,CAAA;AAAA,SACrE;AAAA,QACA;AAAA,UACE,KAAA,EAAO,QAAA;AAAA,UACP,IAAA,EAAM,CAAA,YAAA,EAAe,YAAA,GAAe,sBAAA,GAAoB,EAAE,CAAA;AAAA,SAC5D;AAAA,QACA,EAAE,KAAA,EAAO,QAAA,EAAU,IAAA,EAAM,oBAAA,EAAqB;AAAA,QAC9C,EAAE,KAAA,EAAO,SAAA,EAAW,IAAA,EAAM,SAAA,EAAU;AAAA,QACpC,EAAE,KAAA,EAAO,OAAA,EAAS,IAAA,EAAM,cAAA;AAAe,OACzC;AAAA,MACA,OAAA,EAAS,eAAA,GAAkB,WAAA,GAAc,YAAA,GAAe,QAAA,GAAW;AAAA,KACpE,CAAA;AACD,IAACA,OAAAA,CAAO,OAAmC,QAAA,GAAW,QAAA;AAGtD,IAAA,MAAM,WAAA,GAAc,MAAM,MAAA,CAAO;AAAA,MAC/B,OAAA,EAAS,+CAAA;AAAA,MACT,OAAA,EAAS;AAAA,QACP;AAAA,UACE,KAAA,EAAO,aAAA;AAAA,UACP,IAAA,EACE,wDAAA,IACC,YAAA,GAAe,SAAA,GAAO,eAAA;AAAA,SAC3B;AAAA,QACA,EAAE,KAAA,EAAO,QAAA,EAAU,IAAA,EAAM,2BAAA,EAA4B;AAAA,QACrD,EAAE,KAAA,EAAO,QAAA,EAAU,IAAA,EAAM,yBAAA,EAA0B;AAAA,QACnD,EAAE,KAAA,EAAO,MAAA,EAAQ,IAAA,EAAM,4CAAA;AAA6C;AACtE,KACD,CAAA;AAED,IAAA,IAAI,aAAA;AAEJ,IAAA,IAAI,sBAAA,GAAyB,KAAA;AAE7B,IAAA,IAAI,gBAAgB,aAAA,EAAe;AACjC,MAAA,IAAI,CAAC,YAAA,EAAc;AACjB,QAAA,OAAA,CAAQ,IAAI,wEAA8D,CAAA;AAC1E,QAAA,sBAAA,GAAyB,IAAA;AAAA,MAC3B,CAAA,MAAO;AACL,QAAA,IAAI;AACF,UAAA,OAAA,CAAQ,IAAI,+CAAwC,CAAA;AACpD,UAAA,MAAM,KAAA,GAAQ,IAAI,KAAA,EAAM;AACxB,UAAA,MAAM,YAAA,GAAe,MAAM,KAAA,CAAM,UAAA,EAAW;AAE5C,UAAA,IAAI,aAAa,OAAA,IAAW,YAAA,CAAa,QAAQ,YAAA,CAAa,IAAA,CAAK,SAAS,CAAA,EAAG;AAC7E,YAAA,aAAA,GAAgB,MAAM,MAAA,CAAO;AAAA,cAC3B,OAAA,EAAS,iBAAA;AAAA,cACT,OAAA,EAAS,YAAA,CAAa,IAAA,CAAK,GAAA,CAAI,CAAC,CAAA,MAAO,EAAE,KAAA,EAAO,CAAA,EAAG,IAAA,EAAM,CAAA,EAAE,CAAE;AAAA,aAC9D,CAAA;AAAA,UACH,CAAA,MAAO;AACL,YAAA,OAAA,CAAQ,IAAI,sEAA4D,CAAA;AACxE,YAAA,sBAAA,GAAyB,IAAA;AAAA,UAC3B;AAAA,QACF,SAAS,GAAA,EAAK;AACZ,UAAA,OAAA,CAAQ,IAAI,CAAA,qCAAA,EAA8B,GAAA,YAAe,QAAQ,GAAA,CAAI,OAAA,GAAU,GAAG,CAAA,CAAE,CAAA;AACpF,UAAA,sBAAA,GAAyB,IAAA;AAAA,QAC3B;AAAA,MACF;AAAA,IACF;AAEA,IAAA,IAAI,CAAC,aAAA,KAAkB,WAAA,KAAgB,QAAA,IAAY,sBAAA,CAAA,EAAyB;AAC1E,MAAA,MAAM,YAAA,GAAkE;AAAA,QACtE,SAAA,EAAW;AAAA,UACT;AAAA,YACE,KAAA,EAAO,0BAAA;AAAA,YACP,IAAA,EAAM;AAAA,WACR;AAAA,UACA,EAAE,KAAA,EAAO,wBAAA,EAA0B,IAAA,EAAM,8BAAA,EAA+B;AAAA,UACxE,EAAE,KAAA,EAAO,4BAAA,EAA8B,IAAA,EAAM,mBAAA,EAAoB;AAAA,UACjE,EAAE,KAAA,EAAO,2BAAA,EAA6B,IAAA,EAAM,4BAAA;AAA6B,SAC3E;AAAA,QACA,MAAA,EAAQ;AAAA,UACN,EAAE,KAAA,EAAO,QAAA,EAAU,IAAA,EAAM,sBAAA,EAAuB;AAAA,UAChD,EAAE,KAAA,EAAO,aAAA,EAAe,IAAA,EAAM,aAAA,EAAc;AAAA,UAC5C,EAAE,KAAA,EAAO,OAAA,EAAS,IAAA,EAAM,OAAA,EAAQ;AAAA,UAChC,EAAE,KAAA,EAAO,eAAA,EAAiB,IAAA,EAAM,yBAAA;AAA0B,SAC5D;AAAA,QACA,MAAA,EAAQ;AAAA,UACN,EAAE,KAAA,EAAO,gBAAA,EAAkB,IAAA,EAAM,8BAAA,EAA+B;AAAA,UAChE,EAAE,KAAA,EAAO,kBAAA,EAAoB,IAAA,EAAM,4BAAA,EAA6B;AAAA,UAChE,EAAE,KAAA,EAAO,gBAAA,EAAkB,IAAA,EAAM,gBAAA;AAAiB,SACpD;AAAA,QACA,OAAA,EAAS;AAAA,UACP,EAAE,KAAA,EAAO,sBAAA,EAAwB,IAAA,EAAM,6BAAA,EAA8B;AAAA,UACrE,EAAE,KAAA,EAAO,uBAAA,EAAyB,IAAA,EAAM,gBAAA,EAAiB;AAAA,UACzD,EAAE,KAAA,EAAO,sBAAA,EAAwB,IAAA,EAAM,yBAAA;AAA0B,SACnE;AAAA,QACA,KAAA,EAAO;AAAA,UACL,EAAE,KAAA,EAAO,QAAA,EAAU,IAAA,EAAM,0BAAA,EAA2B;AAAA,UACpD,EAAE,KAAA,EAAO,OAAA,EAAS,IAAA,EAAM,yBAAA;AAA0B;AACpD,OACF;AAEA,MAAA,MAAM,aAAA,GAAgB,YAAA,CAAa,SAAA,IAAa,EAAC;AACjD,MAAA,MAAM,cAAA,GAAiB,YAAA,CAAa,QAAkB,CAAA,IAAK,aAAA;AAC3D,MAAA,aAAA,GAAgB,MAAM,MAAA,CAAO;AAAA,QAC3B,OAAA,EAAS,UAAU,QAAQ,CAAA,OAAA,CAAA;AAAA,QAC3B,OAAA,EAAS;AAAA,OACV,CAAA;AAAA,IACH;AAEA,IAAA,IAAI,CAAC,aAAA,IAAiB,WAAA,KAAgB,QAAA,EAAU;AAC9C,MAAA,aAAA,GAAgB,MAAM,KAAA,CAAM;AAAA,QAC1B,OAAA,EAAS,iBAAA;AAAA,QACT,OAAA,EAAS,QAAA,KAAa,WAAA,GAAc,0BAAA,GAA6B;AAAA,OAClE,CAAA;AAAA,IACH;AAEA,IAAA,IAAI,aAAA,EAAe;AACjB,MAACA,OAAAA,CAAO,OAAmC,KAAA,GAAQ,aAAA;AAAA,IACrD;AAIA,IAAA,OAAA,CAAQ,IAAI,mCAA4B,CAAA;AACxC,IAAA,MAAM,MAAA,GAAS,MAAM,OAAA,CAAQ;AAAA,MAC3B,OAAA,EAAS,2CAAA;AAAA,MACT,OAAA,EAAS;AAAA,KACV,CAAA;AAED,IAAA,IAAI,MAAA,EAAQ;AACV,MAAA,IAAI,MAAA,GAAS,IAAA;AACb,MAAA,OAAO,MAAA,EAAQ;AACb,QAAA,MAAM,UAAU,MAAM,KAAA,CAAM,EAAE,OAAA,EAAS,sBAAsB,CAAA;AAC7D,QAAA,MAAM,QAAA,GAAW,MAAM,KAAA,CAAM;AAAA,UAC3B,OAAA,EAAS,4BAA4B,OAAO,CAAA,CAAA,CAAA;AAAA,UAC5C,OAAA,EAAS,UAAU,OAAA,CAAQ,WAAA,GAAc,OAAA,CAAQ,IAAA,EAAM,GAAG,CAAC,CAAA,MAAA;AAAA,SAC5D,CAAA;AACD,QAACA,OAAAA,CAAO,OAAmC,aAAA,GAAgB;AAAA,UACzD,GAAKA,QAAO,MAAA,CAAmC,aAAA;AAAA,UAC/C,CAAC,OAAO,GAAG,EAAE,IAAA,EAAM,OAAA,EAAS,aAAa,QAAA;AAAS,SACpD;AACA,QAAA,MAAA,GAAS,MAAM,OAAA,CAAQ;AAAA,UACrB,OAAA,EAAS,2BAAA;AAAA,UACT,OAAA,EAAS;AAAA,SACV,CAAA;AAAA,MACH;AAAA,IACF;AAAA,EACF,CAAA,MAAO;AAEL,IAACA,QAAO,MAAA,CAAmC,KAAA,GAAQ,eAAA,GAC/C,0BAAA,GACA,eACE,QAAA,GACA,0BAAA;AAAA,EACR;AAEA,EAAAkB,aAAAA,CAAcM,aAAY,CAAA,EAAG,IAAA,CAAK,UAAUxB,OAAAA,EAAQ,IAAA,EAAM,CAAC,CAAC;AAAA,CAAI,CAAA;AAChE,EAAA,OAAA,CAAQ,GAAA,CAAI;AAAA,eAAA,EAAewB,WAAU,CAAA,CAAE,CAAA;AAGvC,EAAA,MAAM,SAASxB,OAAAA,CAAO,MAAA;AACtB,EAAA,OAAA,CAAQ,IAAI,oCAA6B,CAAA;AACzC,EAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,aAAA,EAAgB,MAAA,CAAO,QAAQ,CAAA,CAAE,CAAA;AAC7C,EAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,UAAA,EAAa,MAAA,CAAO,KAAA,IAAS,2BAA2B,CAAA,CAAE,CAAA;AACtE,EAAA,IAAIA,QAAO,iBAAA,EAAmB;AAC5B,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,iBAAA,EAAoBA,OAAAA,CAAO,iBAAiB,CAAA,CAAE,CAAA;AAAA,EAC5D;AACA,EAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,oBAAA,EAAwBA,OAAAA,CAAO,KAAA,CAAkC,YAAY,CAAA,CAAE,CAAA;AAC7F,CAAC,CAAA;AAOH,UAAA,EAAW;AAGX,OAAA,CAAQ,KAAA,EAAM","file":"cli.js","sourcesContent":["/**\n * Intelligent Token Management for Multi-Organization GitHub Access\n *\n * This module provides automatic token switching based on repository organization.\n * ALL configuration is user-provided - no hardcoded organizations or tokens.\n *\n * Configuration methods (in priority order):\n * 1. Programmatic: setTokenConfig() / addOrganization()\n * 2. Config file: agentic.config.json with \"tokens\" section\n * 3. Environment variables: AGENTIC_ORG_<NAME>_TOKEN pattern\n *\n * @example Config file (agentic.config.json):\n * ```json\n * {\n *   \"tokens\": {\n *     \"organizations\": {\n *       \"MyOrg\": { \"name\": \"MyOrg\", \"tokenEnvVar\": \"GITHUB_MYORG_TOKEN\" },\n *       \"AnotherOrg\": { \"name\": \"AnotherOrg\", \"tokenEnvVar\": \"ANOTHER_TOKEN\" }\n *     },\n *     \"defaultTokenEnvVar\": \"GITHUB_TOKEN\",\n *     \"prReviewTokenEnvVar\": \"GITHUB_TOKEN\"\n *   }\n * }\n * ```\n *\n * @example Environment variables:\n * ```bash\n * # Define org-to-token mappings\n * export AGENTIC_ORG_MYORG_TOKEN=GITHUB_MYORG_TOKEN\n * export AGENTIC_ORG_ANOTHER_TOKEN=ANOTHER_ORG_PAT\n *\n * # Override defaults\n * export AGENTIC_DEFAULT_TOKEN=GITHUB_TOKEN\n * export AGENTIC_PR_REVIEW_TOKEN=GITHUB_TOKEN\n * ```\n */\n\nimport type { OrganizationConfig, Result, TokenConfig } from './types.js';\n\n// ============================================\n// Configuration State (NO HARDCODED VALUES)\n// ============================================\n\n/**\n * Default token configuration - uses standard GITHUB_TOKEN\n * Users MUST configure their own organizations\n */\nconst DEFAULT_CONFIG: TokenConfig = {\n  organizations: {}, // Empty by default - users configure their own\n  defaultTokenEnvVar: 'GITHUB_TOKEN',\n  prReviewTokenEnvVar: 'GITHUB_TOKEN',\n};\n\nlet currentConfig: TokenConfig = { ...DEFAULT_CONFIG };\n\n// ============================================\n// Environment Configuration Loading\n// ============================================\n\n/**\n * Load organization configs from environment variables\n *\n * Pattern: AGENTIC_ORG_<NAME>_TOKEN=<TOKEN_ENV_VAR_NAME>\n *\n * @example\n * AGENTIC_ORG_MYCOMPANY_TOKEN=GITHUB_MYCOMPANY_TOKEN\n * This maps \"mycompany\" org to use the value from GITHUB_MYCOMPANY_TOKEN env var\n */\nfunction loadEnvConfig(): void {\n  const orgPattern = /^AGENTIC_ORG_([A-Z0-9_]+)_TOKEN$/;\n\n  for (const [key, value] of Object.entries(process.env)) {\n    const match = key.match(orgPattern);\n    if (match?.[1] && value) {\n      // Convert UPPER_CASE to kebab-case for org name\n      const orgName = match[1].toLowerCase().replace(/_/g, '-');\n      if (!currentConfig.organizations[orgName]) {\n        currentConfig.organizations[orgName] = {\n          name: orgName,\n          tokenEnvVar: value,\n        };\n      }\n    }\n  }\n\n  // Override PR review token if specified\n  if (process.env.AGENTIC_PR_REVIEW_TOKEN) {\n    currentConfig.prReviewTokenEnvVar = process.env.AGENTIC_PR_REVIEW_TOKEN;\n  }\n\n  // Override default token if specified\n  if (process.env.AGENTIC_DEFAULT_TOKEN) {\n    currentConfig.defaultTokenEnvVar = process.env.AGENTIC_DEFAULT_TOKEN;\n  }\n}\n\n// Load env config on module initialization\nloadEnvConfig();\n\n// ============================================\n// Public Configuration API\n// ============================================\n\n/**\n * Get the current token configuration\n */\nexport function getTokenConfig(): TokenConfig {\n  return { ...currentConfig };\n}\n\n/**\n * Update the token configuration\n *\n * @example\n * setTokenConfig({\n *   organizations: {\n *     \"my-org\": { name: \"my-org\", tokenEnvVar: \"MY_ORG_TOKEN\" }\n *   },\n *   prReviewTokenEnvVar: \"PR_REVIEW_TOKEN\"\n * });\n */\nexport function setTokenConfig(config: Partial<TokenConfig>): void {\n  currentConfig = {\n    ...currentConfig,\n    ...config,\n    organizations: {\n      ...currentConfig.organizations,\n      ...config.organizations,\n    },\n  };\n}\n\n/**\n * Reset configuration to defaults (useful for testing)\n */\nexport function resetTokenConfig(): void {\n  currentConfig = { ...DEFAULT_CONFIG, organizations: {} };\n  loadEnvConfig();\n}\n\n/**\n * Add or update an organization configuration\n *\n * @example\n * addOrganization({\n *   name: \"my-company\",\n *   tokenEnvVar: \"GITHUB_MYCOMPANY_TOKEN\",\n *   defaultBranch: \"main\",\n *   isEnterprise: true\n * });\n */\nexport function addOrganization(org: OrganizationConfig): void {\n  currentConfig.organizations[org.name] = org;\n}\n\n/**\n * Remove an organization configuration\n */\nexport function removeOrganization(orgName: string): void {\n  delete currentConfig.organizations[orgName];\n}\n\n// ============================================\n// Organization Extraction\n// ============================================\n\n/**\n * Extract organization name from a repository URL or full name\n * Uses a safe regex pattern to prevent ReDoS attacks\n *\n * @example\n * extractOrg(\"https://github.com/my-org/my-repo\") // \"my-org\"\n * extractOrg(\"my-org/my-repo\") // \"my-org\"\n * extractOrg(\"git@github.com:my-org/my-repo.git\") // \"my-org\"\n */\nexport function extractOrg(repoUrl: string): string | null {\n  // Handle full GitHub URLs - safe pattern with character class restriction\n  const urlMatch = repoUrl.match(/github\\.com[/:]([a-zA-Z0-9_.-]+)/);\n  if (urlMatch?.[1]) {\n    return urlMatch[1];\n  }\n\n  // Handle owner/repo format\n  const shortMatch = repoUrl.match(/^([a-zA-Z0-9_.-]+)\\//);\n  if (shortMatch?.[1]) {\n    return shortMatch[1];\n  }\n\n  return null;\n}\n\n// ============================================\n// Token Resolution\n// ============================================\n\n/**\n * Get the token environment variable name for a given organization\n * Returns the default if org is not configured\n *\n * @param org - Organization name (case-insensitive)\n */\nexport function getTokenEnvVar(org: string): string {\n  // Try exact match first\n  const config = currentConfig.organizations[org];\n  if (config?.tokenEnvVar) {\n    return config.tokenEnvVar;\n  }\n\n  // Try case-insensitive match\n  const lowerOrg = org.toLowerCase();\n  for (const [key, value] of Object.entries(currentConfig.organizations)) {\n    if (key.toLowerCase() === lowerOrg && value.tokenEnvVar) {\n      return value.tokenEnvVar;\n    }\n  }\n\n  return currentConfig.defaultTokenEnvVar;\n}\n\n/**\n * Get the actual token value for an organization\n *\n * @param org - Organization name\n * @returns Token value or undefined if not set\n */\nexport function getTokenForOrg(org: string): string | undefined {\n  const envVar = getTokenEnvVar(org);\n  return process.env[envVar];\n}\n\n/**\n * Get the token for a repository URL\n * Automatically extracts the organization and returns the appropriate token\n *\n * @param repoUrl - Repository URL or owner/repo format\n * @returns Token value or undefined if not set\n *\n * @example\n * // If configured: addOrganization({ name: \"myorg\", tokenEnvVar: \"MYORG_TOKEN\" })\n * getTokenForRepo(\"https://github.com/myorg/my-repo\")\n * // Returns value of MYORG_TOKEN\n */\nexport function getTokenForRepo(repoUrl: string): string | undefined {\n  const org = extractOrg(repoUrl);\n  if (!org) {\n    return process.env[currentConfig.defaultTokenEnvVar];\n  }\n  return getTokenForOrg(org);\n}\n\n/**\n * Get the token that should be used for PR reviews\n * Ensures a consistent identity across all PR interactions\n *\n * @returns Token value or undefined if not set\n */\nexport function getPRReviewToken(): string | undefined {\n  return process.env[currentConfig.prReviewTokenEnvVar];\n}\n\n/**\n * Get the PR review token environment variable name\n */\nexport function getPRReviewTokenEnvVar(): string {\n  return currentConfig.prReviewTokenEnvVar;\n}\n\n// ============================================\n// Validation\n// ============================================\n\n/**\n * Validate that required tokens are available\n *\n * @param orgs - Organization names to validate (optional, validates all configured if not specified)\n * @returns Validation result with any missing tokens\n */\nexport function validateTokens(orgs?: string[]): Result<string[]> {\n  const missing: string[] = [];\n  const orgsToCheck = orgs ?? Object.keys(currentConfig.organizations);\n\n  for (const org of orgsToCheck) {\n    const token = getTokenForOrg(org);\n    if (!token) {\n      const envVar = getTokenEnvVar(org);\n      missing.push(`${org}: ${envVar} not set`);\n    }\n  }\n\n  // Check PR review token\n  if (!getPRReviewToken()) {\n    missing.push(`PR Review: ${currentConfig.prReviewTokenEnvVar} not set`);\n  }\n\n  // Check default token\n  if (!process.env[currentConfig.defaultTokenEnvVar]) {\n    missing.push(`Default: ${currentConfig.defaultTokenEnvVar} not set`);\n  }\n\n  return {\n    success: missing.length === 0,\n    data: missing,\n    error: missing.length > 0 ? `Missing tokens: ${missing.join(', ')}` : undefined,\n  };\n}\n\n// ============================================\n// Organization Configuration Access\n// ============================================\n\n/**\n * Get organization configuration (case-insensitive)\n */\nexport function getOrgConfig(org: string): OrganizationConfig | undefined {\n  // Try exact match first\n  if (currentConfig.organizations[org]) {\n    return currentConfig.organizations[org];\n  }\n\n  // Try case-insensitive match\n  const lowerOrg = org.toLowerCase();\n  for (const [key, value] of Object.entries(currentConfig.organizations)) {\n    if (key.toLowerCase() === lowerOrg) {\n      return value;\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Get all configured organizations\n */\nexport function getConfiguredOrgs(): string[] {\n  return Object.keys(currentConfig.organizations);\n}\n\n/**\n * Check if an organization is configured (case-insensitive)\n */\nexport function isOrgConfigured(org: string): boolean {\n  if (org in currentConfig.organizations) {\n    return true;\n  }\n\n  const lowerOrg = org.toLowerCase();\n  for (const key of Object.keys(currentConfig.organizations)) {\n    if (key.toLowerCase() === lowerOrg) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// ============================================\n// Environment Helpers for Subprocesses\n// ============================================\n\n/**\n * Create environment variables object for a subprocess targeting a specific org\n * Useful when spawning child processes that need the correct GitHub token\n *\n * @param repoUrl - Repository URL to get token for\n * @returns Object with GH_TOKEN and GITHUB_TOKEN set\n *\n * @example\n * import { spawnSync } from 'node:child_process';\n * const proc = spawnSync('gh', ['pr', 'list'], {\n *   env: { ...process.env, ...getEnvForRepo(\"owner/repo\") }\n * });\n */\nexport function getEnvForRepo(repoUrl: string): Record<string, string> {\n  const token = getTokenForRepo(repoUrl);\n  if (!token) {\n    return {};\n  }\n  return {\n    GH_TOKEN: token,\n    GITHUB_TOKEN: token,\n  };\n}\n\n/**\n * Create environment variables for PR review operations\n * Uses the configured PR review identity\n *\n * @returns Object with GH_TOKEN and GITHUB_TOKEN set for PR review\n */\nexport function getEnvForPRReview(): Record<string, string> {\n  const token = getPRReviewToken();\n  if (!token) {\n    return {};\n  }\n  return {\n    GH_TOKEN: token,\n    GITHUB_TOKEN: token,\n  };\n}\n\n// ============================================\n// Convenience Utilities\n// ============================================\n\n/**\n * Check if we have a valid token for an organization\n */\nexport function hasTokenForOrg(org: string): boolean {\n  return !!getTokenForOrg(org);\n}\n\n/**\n * Check if we have a valid token for a repository\n */\nexport function hasTokenForRepo(repoUrl: string): boolean {\n  return !!getTokenForRepo(repoUrl);\n}\n\n/**\n * Get a summary of token availability for debugging/display\n */\nexport function getTokenSummary(): Record<\n  string,\n  { envVar: string; available: boolean; configured: boolean }\n> {\n  const summary: Record<string, { envVar: string; available: boolean; configured: boolean }> = {};\n\n  for (const org of getConfiguredOrgs()) {\n    const envVar = getTokenEnvVar(org);\n    summary[org] = {\n      envVar,\n      available: !!process.env[envVar],\n      configured: true,\n    };\n  }\n\n  summary._default = {\n    envVar: currentConfig.defaultTokenEnvVar,\n    available: !!process.env[currentConfig.defaultTokenEnvVar],\n    configured: true,\n  };\n\n  summary._pr_review = {\n    envVar: currentConfig.prReviewTokenEnvVar,\n    available: !!getPRReviewToken(),\n    configured: true,\n  };\n\n  return summary;\n}\n","/**\n * Typed error classes for agentic-control\n */\n\nexport enum SandboxErrorCode {\n  CONTAINER_CREATE_FAILED = 'CONTAINER_CREATE_FAILED',\n  CONTAINER_START_FAILED = 'CONTAINER_START_FAILED',\n  EXECUTION_TIMEOUT = 'EXECUTION_TIMEOUT',\n  MEMORY_LIMIT_EXCEEDED = 'MEMORY_LIMIT_EXCEEDED',\n  WORKSPACE_MOUNT_FAILED = 'WORKSPACE_MOUNT_FAILED',\n  OUTPUT_EXTRACTION_FAILED = 'OUTPUT_EXTRACTION_FAILED',\n  RUNTIME_NOT_FOUND = 'RUNTIME_NOT_FOUND',\n}\n\nexport class SandboxError extends Error {\n  constructor(\n    message: string,\n    public code: SandboxErrorCode,\n    public containerId?: string,\n    public override cause?: Error\n  ) {\n    super(message);\n    this.name = 'SandboxError';\n  }\n}\n\nexport enum DockerErrorCode {\n  BUILD_FAILED = 'BUILD_FAILED',\n  PUSH_FAILED = 'PUSH_FAILED',\n  PLATFORM_NOT_SUPPORTED = 'PLATFORM_NOT_SUPPORTED',\n  REGISTRY_AUTH_FAILED = 'REGISTRY_AUTH_FAILED',\n}\n\nexport class DockerBuildError extends Error {\n  constructor(\n    message: string,\n    public code: DockerErrorCode,\n    public dockerfile?: string,\n    public override cause?: Error\n  ) {\n    super(message);\n    this.name = 'DockerBuildError';\n  }\n}\n\nexport enum ConfigErrorCode {\n  INVALID_SCHEMA = 'INVALID_SCHEMA',\n  MISSING_REQUIRED_FIELD = 'MISSING_REQUIRED_FIELD',\n  INVALID_VALUE = 'INVALID_VALUE',\n  FILE_NOT_FOUND = 'FILE_NOT_FOUND',\n}\n\nexport class ConfigurationError extends Error {\n  constructor(\n    message: string,\n    public code: ConfigErrorCode,\n    public field?: string,\n    public override cause?: Error\n  ) {\n    super(message);\n    this.name = 'ConfigurationError';\n  }\n}\n","/**\n * Configuration validation using Zod schemas\n */\n\nimport { z } from 'zod';\nimport { ConfigErrorCode, ConfigurationError } from './errors.js';\n\n// ============================================\n// Base Schemas\n// ============================================\n\nconst TokenOrgSchema = z.object({\n  name: z.string().min(1).max(39),\n  tokenEnvVar: z.string().min(1),\n});\n\nconst TokenConfigSchema = z.object({\n  organizations: z.record(z.string(), TokenOrgSchema).optional(),\n  defaultTokenEnvVar: z.string().optional(),\n  prReviewTokenEnvVar: z.string().optional(),\n});\n\nconst FleetConfigSchema = z.object({\n  autoCreatePr: z.boolean().optional(),\n  openAsCursorGithubApp: z.boolean().optional(),\n  skipReviewerRequest: z.boolean().optional(),\n});\n\nconst TriageConfigSchema = z.object({\n  provider: z.enum(['anthropic', 'openai', 'google', 'mistral', 'azure']).optional(),\n  model: z.string().optional(),\n  apiKeyEnvVar: z.string().optional(),\n});\n\nconst MCPServerConfigSchema = z.object({\n  enabled: z.boolean().optional(),\n  tokenEnvVar: z.string().optional(),\n  tokenEnvVarFallbacks: z.array(z.string()).optional(),\n  mode: z.enum(['stdio', 'proxy']).optional(),\n  command: z.string().optional(),\n  args: z.array(z.string()).optional(),\n  proxyUrl: z.string().url().optional(),\n});\n\nconst MCPConfigSchema = z\n  .object({\n    cursor: MCPServerConfigSchema.optional(),\n    github: MCPServerConfigSchema.optional(),\n    context7: MCPServerConfigSchema.optional(),\n    '21st-magic': MCPServerConfigSchema.optional(),\n  })\n  .catchall(MCPServerConfigSchema);\n\nconst CursorConfigSchema = z.object({\n  apiKeyEnvVar: z.string().optional(),\n  baseUrl: z.string().url().optional(),\n});\n\n// ============================================\n// Main Configuration Schema\n// ============================================\n\nexport const AgenticConfigSchema = z.object({\n  tokens: TokenConfigSchema.optional(),\n  defaultRepository: z.string().optional(),\n  coordinationPr: z.number().int().positive().optional(),\n  logLevel: z.enum(['debug', 'info', 'warn', 'error']).optional(),\n  verbose: z.boolean().optional(),\n  cursor: CursorConfigSchema.optional(),\n  fleet: FleetConfigSchema.optional(),\n  triage: TriageConfigSchema.optional(),\n  mcp: MCPConfigSchema.optional(),\n});\n\n// ============================================\n// Validation Functions\n// ============================================\n\n/**\n * Validate configuration object against schema\n */\nexport function validateConfig(config: unknown): void {\n  try {\n    AgenticConfigSchema.parse(config);\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      const firstIssue = error.issues[0];\n      if (firstIssue) {\n        const field = firstIssue.path.join('.');\n        const message = `Invalid configuration at '${field}': ${firstIssue.message}`;\n        throw new ConfigurationError(message, ConfigErrorCode.INVALID_SCHEMA, field);\n      }\n      throw new ConfigurationError('Invalid configuration', ConfigErrorCode.INVALID_SCHEMA);\n    }\n    throw error;\n  }\n}\n\n/**\n * Validate environment variable exists and is not empty\n */\nexport function validateEnvVar(envVar: string, description?: string): string {\n  const value = process.env[envVar];\n\n  if (!value || value.trim() === '') {\n    const desc = description ?? envVar;\n    throw new ConfigurationError(\n      `Missing required environment variable: ${envVar}. Please set ${desc} to continue.`,\n      ConfigErrorCode.MISSING_REQUIRED_FIELD,\n      envVar\n    );\n  }\n\n  return value.trim();\n}\n\n/**\n * Validate environment variable with clear error message\n */\nexport function validateEnvVarWithMessage(envVar: string, purpose: string): string {\n  const value = process.env[envVar];\n\n  if (!value || value.trim() === '') {\n    throw new ConfigurationError(\n      `${purpose} requires ${envVar} environment variable. Please set it and try again.`,\n      ConfigErrorCode.MISSING_REQUIRED_FIELD,\n      envVar\n    );\n  }\n\n  return value.trim();\n}\n\n/**\n * Validate repository format (owner/repo)\n */\nexport function validateRepository(repo: string): void {\n  const repoPattern = /^[a-zA-Z0-9._-]+\\/[a-zA-Z0-9._-]+$/;\n\n  if (!repoPattern.test(repo)) {\n    throw new ConfigurationError(\n      `Invalid repository format: ${repo}. Expected format: owner/repo`,\n      ConfigErrorCode.INVALID_VALUE,\n      'repository'\n    );\n  }\n}\n\n/**\n * Validate git reference format\n */\nexport function validateGitRef(ref: string): void {\n  if (!/^[a-zA-Z0-9._/-]+$/.test(ref)) {\n    throw new ConfigurationError(\n      `Invalid git reference format: ${ref}`,\n      ConfigErrorCode.INVALID_VALUE,\n      'gitRef'\n    );\n  }\n\n  if (ref.length > 200) {\n    throw new ConfigurationError(\n      `Git reference too long: ${ref} (max 200 characters)`,\n      ConfigErrorCode.INVALID_VALUE,\n      'gitRef'\n    );\n  }\n}\n\n/**\n * Validate positive integer\n */\nexport function validatePositiveInt(value: string, field: string): number {\n  const parsed = Number.parseInt(value, 10);\n\n  if (Number.isNaN(parsed) || parsed <= 0) {\n    throw new ConfigurationError(\n      `${field} must be a positive integer, got: ${value}`,\n      ConfigErrorCode.INVALID_VALUE,\n      field\n    );\n  }\n\n  return parsed;\n}\n","/**\n * Configuration Management for agentic-control\n *\n * Uses cosmiconfig for standard config file discovery and loading.\n * Searches for configuration in:\n *   - agentic.config.json\n *   - agentic.config.js\n *   - agentic.config.cjs\n *   - .agenticrc\n *   - .agenticrc.json\n *   - package.json \"agentic\" key\n *\n * Priority: CLI args > env vars > config file > defaults\n *\n * @example Config file (agentic.config.json):\n * ```json\n * {\n *   \"tokens\": {\n *     \"organizations\": {\n *       \"my-org\": { \"name\": \"my-org\", \"tokenEnvVar\": \"MY_ORG_TOKEN\" }\n *     }\n *   },\n *   \"defaultModel\": \"claude-sonnet-4-20250514\",\n *   \"fleet\": {\n *     \"autoCreatePr\": true\n *   }\n * }\n * ```\n */\n\nimport { cosmiconfigSync } from 'cosmiconfig';\nimport { setTokenConfig } from './tokens.js';\nimport type { TokenConfig } from './types.js';\nimport { validateConfig } from './validation.js';\n\n// ============================================\n// Configuration Types\n// ============================================\n\nexport interface FleetConfig {\n  /** Auto-create PR when agent completes */\n  autoCreatePr?: boolean;\n  /** Open PR as Cursor GitHub App */\n  openAsCursorGithubApp?: boolean;\n  /** Skip adding user as reviewer */\n  skipReviewerRequest?: boolean;\n}\n\nexport interface TriageConfig {\n  /** AI provider: anthropic, openai, google, mistral, azure */\n  provider?: string;\n  /** Model ID for the provider */\n  model?: string;\n  /** API key environment variable name */\n  apiKeyEnvVar?: string;\n}\n\nexport interface MCPServerConfig {\n  /** Whether this MCP server is enabled */\n  enabled?: boolean;\n  /** Environment variable name for the API key/token */\n  tokenEnvVar?: string;\n  /** Fallback env vars to try if primary not found */\n  tokenEnvVarFallbacks?: string[];\n  /** Transport mode: stdio or proxy */\n  mode?: 'stdio' | 'proxy';\n  /** Command to run for stdio transport */\n  command?: string;\n  /** Arguments for the command */\n  args?: string[];\n  /** Proxy URL for proxy mode */\n  proxyUrl?: string;\n}\n\nexport interface MCPConfig {\n  /** Cursor Background Agent MCP */\n  cursor?: MCPServerConfig;\n  /** GitHub MCP */\n  github?: MCPServerConfig;\n  /** Context7 documentation MCP */\n  context7?: MCPServerConfig;\n  /** 21st.dev Magic MCP */\n  '21st-magic'?: MCPServerConfig;\n  /** Custom MCP servers */\n  [key: string]: MCPServerConfig | undefined;\n}\n\nexport interface RoleConfig {\n  /** Enable/disable the role */\n  enabled?: boolean;\n  /** Override the system prompt */\n  systemPrompt?: string;\n  /** Model override */\n  model?: string;\n}\n\nexport interface RolesConfig {\n  /** Sage role configuration */\n  sage?: RoleConfig;\n  /** Harvester role configuration */\n  harvester?: RoleConfig;\n  /** Curator role configuration */\n  curator?: RoleConfig;\n  /** Reviewer role configuration */\n  reviewer?: RoleConfig;\n  /** Fixer role configuration */\n  fixer?: RoleConfig;\n  /** Delegator role configuration */\n  delegator?: RoleConfig;\n}\n\nexport interface AgenticConfig {\n  /** Token configuration for multi-org access */\n  tokens?: Partial<TokenConfig>;\n\n  /** Default repository for fleet operations */\n  defaultRepository?: string;\n\n  /** Coordination PR number for fleet communication */\n  coordinationPr?: number;\n\n  /** Log level */\n  logLevel?: 'debug' | 'info' | 'warn' | 'error';\n\n  /** Whether to enable verbose output */\n  verbose?: boolean;\n\n  /** Cursor API configuration */\n  cursor?: {\n    /** API key environment variable name */\n    apiKeyEnvVar?: string;\n    /** Base URL for Cursor API */\n    baseUrl?: string;\n  };\n\n  /** Fleet default options */\n  fleet?: FleetConfig;\n\n  /** Triage (AI analysis) configuration */\n  triage?: TriageConfig;\n\n  /** MCP server configuration */\n  mcp?: MCPConfig;\n\n  /** Roles configuration */\n  roles?: RolesConfig;\n}\n\n// ============================================\n// Cosmiconfig Setup\n// ============================================\n\nconst MODULE_NAME = 'agentic';\n\n// Security: Only allow JSON config files to prevent code execution\n// JavaScript config files could execute arbitrary code during require()\nconst explorer = cosmiconfigSync(MODULE_NAME, {\n  searchPlaces: ['package.json', 'agentic.config.json', '.agenticrc', '.agenticrc.json'],\n  // Security: Disable loaders that execute code\n  loaders: {\n    '.json': (_filepath: string, content: string) => JSON.parse(content),\n  },\n});\n\n// ============================================\n// Configuration State\n// ============================================\n\nlet config: AgenticConfig = {};\nlet configLoaded = false;\nlet configPath: string | null = null;\n\n// ============================================\n// Environment Variable Loading\n// ============================================\n\nfunction loadEnvConfig(): Partial<AgenticConfig> {\n  const envConfig: Partial<AgenticConfig> = {};\n\n  // Build triage config from environment variables\n  const triageFromEnv: Partial<TriageConfig> = {};\n  if (process.env.AGENTIC_MODEL) {\n    triageFromEnv.model = process.env.AGENTIC_MODEL;\n  }\n  if (process.env.AGENTIC_PROVIDER) {\n    triageFromEnv.provider = process.env.AGENTIC_PROVIDER;\n  }\n  if (Object.keys(triageFromEnv).length > 0) {\n    envConfig.triage = triageFromEnv;\n  }\n\n  if (process.env.AGENTIC_REPOSITORY) {\n    envConfig.defaultRepository = process.env.AGENTIC_REPOSITORY;\n  }\n\n  if (process.env.AGENTIC_COORDINATION_PR) {\n    const parsed = Number.parseInt(process.env.AGENTIC_COORDINATION_PR, 10);\n    if (!Number.isNaN(parsed) && parsed > 0) {\n      envConfig.coordinationPr = parsed;\n    }\n  }\n\n  if (process.env.AGENTIC_LOG_LEVEL) {\n    const level = process.env.AGENTIC_LOG_LEVEL.toLowerCase();\n    if (['debug', 'info', 'warn', 'error'].includes(level)) {\n      envConfig.logLevel = level as AgenticConfig['logLevel'];\n    }\n  }\n\n  if (process.env.AGENTIC_VERBOSE === 'true' || process.env.AGENTIC_VERBOSE === '1') {\n    envConfig.verbose = true;\n  }\n\n  return envConfig;\n}\n\n// ============================================\n// Configuration Loading\n// ============================================\n\n/**\n * Deep merge configuration objects\n */\nfunction mergeConfig(base: AgenticConfig, overrides: Partial<AgenticConfig>): AgenticConfig {\n  const result = { ...base };\n\n  for (const [key, value] of Object.entries(overrides)) {\n    if (value === undefined) continue;\n\n    if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n      const baseValue = (base as Record<string, unknown>)[key];\n      // Only spread baseValue if it's a non-null object\n      const baseObj =\n        typeof baseValue === 'object' && baseValue !== null && !Array.isArray(baseValue)\n          ? baseValue\n          : {};\n      (result as Record<string, unknown>)[key] = {\n        ...baseObj,\n        ...value,\n      };\n    } else {\n      (result as Record<string, unknown>)[key] = value;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Initialize configuration from all sources\n * Priority: programmatic overrides > env vars > config file\n */\nexport function initConfig(overrides?: Partial<AgenticConfig>): AgenticConfig {\n  // Search for config file using cosmiconfig\n  const result = explorer.search();\n\n  if (result && !result.isEmpty) {\n    // Validate configuration before using it\n    validateConfig(result.config);\n    config = result.config as AgenticConfig;\n    configPath = result.filepath;\n  } else {\n    config = {};\n    configPath = null;\n  }\n\n  // Merge environment variables\n  const envConfig = loadEnvConfig();\n  config = mergeConfig(config, envConfig);\n\n  // Apply programmatic overrides\n  if (overrides) {\n    config = mergeConfig(config, overrides);\n  }\n\n  // Validate final configuration\n  validateConfig(config);\n\n  // Apply token configuration\n  if (config.tokens) {\n    setTokenConfig(config.tokens);\n  }\n\n  configLoaded = true;\n  return config;\n}\n\n/**\n * Load config from a specific file path\n */\nexport function loadConfigFromPath(filepath: string): AgenticConfig {\n  const result = explorer.load(filepath);\n\n  if (result && !result.isEmpty) {\n    // Validate configuration before using it\n    validateConfig(result.config);\n    config = result.config as AgenticConfig;\n    configPath = result.filepath;\n\n    if (config.tokens) {\n      setTokenConfig(config.tokens);\n    }\n\n    configLoaded = true;\n    return config;\n  }\n\n  throw new Error(`Failed to load config from ${filepath}`);\n}\n\n// ============================================\n// Public API\n// ============================================\n\n/**\n * Get the current configuration\n */\nexport function getConfig(): AgenticConfig {\n  if (!configLoaded) {\n    initConfig();\n  }\n  return { ...config };\n}\n\n/**\n * Get path to loaded config file\n */\nexport function getConfigPath(): string | null {\n  return configPath;\n}\n\n/**\n * Update configuration at runtime\n */\nexport function setConfig(updates: Partial<AgenticConfig>): void {\n  config = mergeConfig(config, updates);\n\n  if (updates.tokens) {\n    setTokenConfig(updates.tokens);\n  }\n}\n\n/**\n * Reset configuration (useful for testing)\n */\nexport function resetConfig(): void {\n  config = {};\n  configLoaded = false;\n  configPath = null;\n}\n\n/**\n * Get a specific configuration value\n */\nexport function getConfigValue<K extends keyof AgenticConfig>(key: K): AgenticConfig[K] {\n  if (!configLoaded) {\n    initConfig();\n  }\n  return config[key];\n}\n\n/**\n * Check if verbose mode is enabled\n */\nexport function isVerbose(): boolean {\n  return config.verbose ?? false;\n}\n\n/**\n * Get triage configuration\n */\nexport function getTriageConfig(): TriageConfig {\n  if (!configLoaded) {\n    initConfig();\n  }\n  return (\n    config.triage ?? {\n      provider: 'anthropic',\n      model: 'claude-sonnet-4-20250514',\n      apiKeyEnvVar: 'ANTHROPIC_API_KEY',\n    }\n  );\n}\n\n/**\n * Get the default model for triage operations\n * @deprecated Use getTriageConfig() instead\n */\nexport function getDefaultModel(): string {\n  return getTriageConfig().model ?? 'claude-sonnet-4-20250514';\n}\n\n/**\n * Get fleet defaults\n */\nexport function getFleetDefaults(): FleetConfig {\n  if (!configLoaded) {\n    initConfig();\n  }\n  return config.fleet ?? {};\n}\n\n/**\n * Get the log level\n */\nexport function getLogLevel(): string {\n  return config.logLevel ?? 'info';\n}\n\n/**\n * Get Cursor API key from configured environment variable\n */\nexport function getCursorApiKey(): string | undefined {\n  const envVar = config.cursor?.apiKeyEnvVar ?? 'CURSOR_API_KEY';\n  return process.env[envVar];\n}\n\n/**\n * Get default API key env var for a provider\n */\nexport function getDefaultApiKeyEnvVar(provider?: string): string {\n  switch (provider) {\n    case 'openai':\n      return 'OPENAI_API_KEY';\n    case 'google':\n      return 'GOOGLE_API_KEY';\n    case 'mistral':\n      return 'MISTRAL_API_KEY';\n    case 'azure':\n      return 'AZURE_API_KEY';\n    case 'ollama':\n      return 'OLLAMA_API_KEY';\n    default:\n      return 'ANTHROPIC_API_KEY';\n  }\n}\n\n/**\n * Get triage API key from configured environment variable\n * @param providerOverride - Optional provider to use instead of config value\n */\nexport function getTriageApiKey(providerOverride?: string): string | undefined {\n  const triageConfig = getTriageConfig();\n  const provider = providerOverride ?? triageConfig.provider;\n  const envVar = triageConfig.apiKeyEnvVar ?? getDefaultApiKeyEnvVar(provider);\n  return process.env[envVar];\n}\n\n// ============================================\n// Logging Utilities\n// ============================================\n\nconst LOG_LEVELS = {\n  debug: 0,\n  info: 1,\n  warn: 2,\n  error: 3,\n};\n\nfunction shouldLog(level: keyof typeof LOG_LEVELS): boolean {\n  const currentLevel = LOG_LEVELS[getLogLevel() as keyof typeof LOG_LEVELS] ?? 1;\n  return LOG_LEVELS[level] >= currentLevel;\n}\n\nexport const log = {\n  debug: (...args: unknown[]): void => {\n    if (shouldLog('debug')) {\n      console.debug('[agentic:debug]', ...args);\n    }\n  },\n  info: (...args: unknown[]): void => {\n    if (shouldLog('info')) {\n      console.log('[agentic:info]', ...args);\n    }\n  },\n  warn: (...args: unknown[]): void => {\n    if (shouldLog('warn')) {\n      console.warn('[agentic:warn]', ...args);\n    }\n  },\n  error: (...args: unknown[]): void => {\n    if (shouldLog('error')) {\n      console.error('[agentic:error]', ...args);\n    }\n  },\n};\n","/**\n * Security utilities for safe error reporting and token sanitization\n */\n\n/**\n * Sanitize error messages to remove sensitive tokens\n */\nexport function sanitizeError(error: string | Error): string {\n  const message = error instanceof Error ? error.message : error;\n\n  // Patterns for common token formats\n  const tokenPatterns = [\n    // GitHub tokens: ghp_, gho_, ghu_, ghs_, ghr_\n    /gh[pous]_[A-Za-z0-9_]{36,}/g,\n    // GitHub fine-grained tokens: github_pat_\n    /github_pat_[A-Za-z0-9_]{82}/g,\n    // Anthropic API keys: sk-ant-\n    /sk-ant-[A-Za-z0-9_-]{95,}/g,\n    // OpenAI API keys: sk-\n    /sk-[A-Za-z0-9]{48,}/g,\n    // Generic API key patterns\n    /[A-Za-z0-9_-]{32,}/g,\n  ];\n\n  let sanitized = message;\n\n  for (const pattern of tokenPatterns) {\n    sanitized = sanitized.replace(pattern, '[REDACTED_TOKEN]');\n  }\n\n  return sanitized;\n}\n\n/**\n * Sanitize environment variables from error messages\n */\nexport function sanitizeEnvironment(\n  env: Record<string, string | undefined>\n): Record<string, string> {\n  const sanitized: Record<string, string> = {};\n\n  for (const [key, value] of Object.entries(env)) {\n    if (value === undefined) {\n      sanitized[key] = 'undefined';\n    } else if (\n      key.toLowerCase().includes('token') ||\n      key.toLowerCase().includes('key') ||\n      key.toLowerCase().includes('secret')\n    ) {\n      sanitized[key] = value ? '[REDACTED]' : '(not set)';\n    } else {\n      sanitized[key] = value;\n    }\n  }\n\n  return sanitized;\n}\n\n/**\n * Create a safe error for logging that removes sensitive information\n */\nexport function createSafeError(message: string, originalError?: Error): Error {\n  const sanitizedMessage = sanitizeError(message);\n  const error = new Error(sanitizedMessage);\n\n  if (originalError) {\n    error.cause = new Error(sanitizeError(originalError.message));\n    error.stack = originalError.stack ? sanitizeError(originalError.stack) : undefined;\n  }\n\n  return error;\n}\n\n/**\n * Safe console logging that sanitizes output\n */\nexport const safeConsole = {\n  log: (message: string, ...args: unknown[]) => {\n    console.log(\n      sanitizeError(message),\n      ...args.map((arg) => (typeof arg === 'string' ? sanitizeError(arg) : arg))\n    );\n  },\n\n  error: (message: string, ...args: unknown[]) => {\n    console.error(\n      sanitizeError(message),\n      ...args.map((arg) => (typeof arg === 'string' ? sanitizeError(arg) : arg))\n    );\n  },\n\n  warn: (message: string, ...args: unknown[]) => {\n    console.warn(\n      sanitizeError(message),\n      ...args.map((arg) => (typeof arg === 'string' ? sanitizeError(arg) : arg))\n    );\n  },\n};\n","/**\n * Safe subprocess execution utilities\n */\n\nimport { type SpawnOptions, type SpawnSyncOptions, spawn, spawnSync } from 'node:child_process';\nimport { sanitizeError } from './security.js';\n\n// ============================================\n// Safe Execution Functions\n// ============================================\n\n/**\n * Safely execute a command with array-based arguments (no shell interpolation)\n */\nexport function safeSpawnSync(\n  command: string,\n  args: string[] = [],\n  options: SpawnSyncOptions = {}\n): { success: boolean; stdout: string; stderr: string; code: number | null } {\n  // Validate inputs\n  if (typeof command !== 'string' || command.trim() === '') {\n    throw new Error('Command must be a non-empty string');\n  }\n\n  if (!Array.isArray(args)) {\n    throw new Error('Arguments must be an array');\n  }\n\n  // Ensure we don't use shell\n  const safeOptions: SpawnSyncOptions = {\n    ...options,\n    shell: false, // Explicitly disable shell to prevent injection\n    encoding: 'utf-8',\n  };\n\n  try {\n    const result = spawnSync(command, args, safeOptions);\n\n    return {\n      success: result.status === 0,\n      stdout: result.stdout?.toString() ?? '',\n      stderr: result.stderr?.toString() ?? '',\n      code: result.status,\n    };\n  } catch (error) {\n    const sanitizedError = sanitizeError(error instanceof Error ? error.message : String(error));\n    throw new Error(`Command execution failed: ${sanitizedError}`);\n  }\n}\n\n/**\n * Safely execute a command asynchronously with array-based arguments\n */\nexport function safeSpawn(\n  command: string,\n  args: string[] = [],\n  options: SpawnOptions = {}\n): Promise<{ success: boolean; stdout: string; stderr: string; code: number | null }> {\n  return new Promise((resolve, reject) => {\n    // Validate inputs\n    if (typeof command !== 'string' || command.trim() === '') {\n      reject(new Error('Command must be a non-empty string'));\n      return;\n    }\n\n    if (!Array.isArray(args)) {\n      reject(new Error('Arguments must be an array'));\n      return;\n    }\n\n    // Ensure we don't use shell\n    const safeOptions: SpawnOptions = {\n      ...options,\n      shell: false, // Explicitly disable shell to prevent injection\n    };\n\n    const child = spawn(command, args, safeOptions);\n\n    let stdout = '';\n    let stderr = '';\n\n    child.stdout?.on('data', (data) => {\n      stdout += data.toString();\n    });\n\n    child.stderr?.on('data', (data) => {\n      stderr += data.toString();\n    });\n\n    child.on('close', (code) => {\n      resolve({\n        success: code === 0,\n        stdout,\n        stderr,\n        code,\n      });\n    });\n\n    child.on('error', (error) => {\n      const sanitizedError = sanitizeError(error.message);\n      reject(new Error(`Command execution failed: ${sanitizedError}`));\n    });\n  });\n}\n\n/**\n * Validate command arguments to prevent injection\n */\nexport function validateCommandArgs(args: string[]): void {\n  for (const arg of args) {\n    if (typeof arg !== 'string') {\n      throw new Error('All command arguments must be strings');\n    }\n\n    // Check for potentially dangerous characters that could be used for injection\n    if (arg.includes('\\n') || arg.includes('\\r')) {\n      throw new Error('Command arguments cannot contain newline characters');\n    }\n\n    // Check for null bytes (common injection technique)\n    if (arg.includes('\\0')) {\n      throw new Error('Command arguments cannot contain null bytes');\n    }\n  }\n}\n\n/**\n * Safely execute git commands with validation\n */\nexport function safeGitCommand(args: string[], options: SpawnSyncOptions = {}) {\n  // Validate git arguments\n  validateCommandArgs(args);\n\n  // Additional git-specific validation\n  const allowedGitCommands = [\n    'diff',\n    'log',\n    'show',\n    'status',\n    'branch',\n    'remote',\n    'config',\n    'rev-parse',\n    'ls-remote',\n    'fetch',\n    'pull',\n    'push',\n    'clone',\n    'checkout',\n    'merge',\n    'rebase',\n    'commit',\n    'add',\n    'reset',\n  ];\n\n  const firstArg = args[0];\n  if (!firstArg || !allowedGitCommands.includes(firstArg)) {\n    throw new Error(`Git command not allowed: ${firstArg ?? '(empty)'}`);\n  }\n\n  return safeSpawnSync('git', args, options);\n}\n\n/**\n * Safely execute docker commands with validation\n */\nexport function safeDockerCommand(args: string[], options: SpawnSyncOptions = {}) {\n  // Validate docker arguments\n  validateCommandArgs(args);\n\n  // Additional docker-specific validation\n  const allowedDockerCommands = [\n    'build',\n    'run',\n    'exec',\n    'ps',\n    'images',\n    'pull',\n    'push',\n    'start',\n    'stop',\n    'restart',\n    'rm',\n    'rmi',\n    'logs',\n    'inspect',\n    'create',\n    'cp',\n    'stats',\n    'top',\n    'version',\n    'info',\n  ];\n\n  const firstArg = args[0];\n  if (!firstArg || !allowedDockerCommands.includes(firstArg)) {\n    throw new Error(`Docker command not allowed: ${firstArg ?? '(empty)'}`);\n  }\n\n  return safeSpawnSync('docker', args, options);\n}\n","/**\n * GitHubClient - Unified GitHub API client\n *\n * Provides GitHub API operations with:\n * - Intelligent token switching based on organization\n * - Consistent identity for PR reviews\n * - CI status and feedback collection\n * - Safe git operations (no shell injection)\n *\n * This consolidates the former token-aware client and triage client.\n */\n\nimport { spawnSync } from 'node:child_process';\nimport { Octokit } from '@octokit/rest';\nimport { log } from '../core/config.js';\nimport { extractOrg, getPRReviewToken, getTokenForRepo } from '../core/tokens.js';\nimport type { PRComment, PullRequest, Repository, Result } from '../core/types.js';\nimport type {\n  CICheck,\n  CIStatus,\n  FeedbackItem,\n  FeedbackSeverity,\n  FeedbackStatus,\n} from '../triage/types.js';\n\n// ============================================\n// Octokit Cache (one per token)\n// ============================================\n\nconst octokitCache = new Map<string, Octokit>();\n\nfunction getOctokit(token: string): Octokit {\n  let octokit = octokitCache.get(token);\n  if (!octokit) {\n    octokit = new Octokit({ auth: token });\n    octokitCache.set(token, octokit);\n  }\n  return octokit;\n}\n\n// ============================================\n// Configuration\n// ============================================\n\nexport interface GitHubClientConfig {\n  /** Token for authentication */\n  token?: string;\n  /** Repository owner */\n  owner?: string;\n  /** Repository name */\n  repo?: string;\n}\n\n// ============================================\n// GitHub Client Class\n// ============================================\n\nexport class GitHubClient {\n  private token: string | null;\n  private owner: string | null;\n  private repo: string | null;\n\n  /**\n   * Create a new GitHubClient.\n   *\n   * Can be used in two modes:\n   * 1. With explicit config: new GitHubClient({ token, owner, repo })\n   * 2. Token-aware mode: new GitHubClient() - uses token based on repo\n   */\n  constructor(config: GitHubClientConfig = {}) {\n    this.token = config.token ?? null;\n    this.owner = config.owner ?? null;\n    this.repo = config.repo ?? null;\n  }\n\n  // ============================================\n  // Token Management (Static Methods)\n  // ============================================\n\n  /**\n   * Get an Octokit instance for a repository.\n   * Automatically selects the correct token based on org.\n   */\n  static forRepo(repoUrl: string): Octokit | null {\n    const token = getTokenForRepo(repoUrl);\n    if (!token) {\n      log.warn(`No token available for repo: ${repoUrl}`);\n      return null;\n    }\n    return getOctokit(token);\n  }\n\n  /**\n   * Get an Octokit instance for PR review operations.\n   * Always uses the consistent PR review identity.\n   */\n  static forPRReview(): Octokit | null {\n    const token = getPRReviewToken();\n    if (!token) {\n      log.warn('No PR review token available');\n      return null;\n    }\n    return getOctokit(token);\n  }\n\n  // ============================================\n  // Instance Helpers\n  // ============================================\n\n  private getOctokitInstance(): Octokit {\n    if (this.token) {\n      return getOctokit(this.token);\n    }\n    if (this.owner && this.repo) {\n      const octokit = GitHubClient.forRepo(`${this.owner}/${this.repo}`);\n      if (!octokit) {\n        throw new Error(`No token available for ${this.owner}/${this.repo}`);\n      }\n      return octokit;\n    }\n    throw new Error('GitHubClient requires either token or owner/repo');\n  }\n\n  private ensureRepo(): { owner: string; repo: string } {\n    if (!this.owner || !this.repo) {\n      throw new Error('owner and repo are required for this operation');\n    }\n    return { owner: this.owner, repo: this.repo };\n  }\n\n  // ============================================\n  // Repository Operations (Static)\n  // ============================================\n\n  /**\n   * Get repository information\n   */\n  static async getRepo(owner: string, repo: string): Promise<Result<Repository>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      const { data } = await octokit.repos.get({ owner, repo });\n      return {\n        success: true,\n        data: {\n          owner: data.owner.login,\n          name: data.name,\n          fullName: data.full_name,\n          defaultBranch: data.default_branch,\n          isPrivate: data.private,\n          url: data.html_url,\n        },\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * List repositories for an organization\n   */\n  static async listOrgRepos(\n    org: string,\n    options?: {\n      type?: 'all' | 'public' | 'private' | 'forks' | 'sources' | 'member';\n      perPage?: number;\n    }\n  ): Promise<Result<Repository[]>> {\n    const octokit = GitHubClient.forRepo(`${org}/any`);\n    if (!octokit) {\n      return { success: false, error: `No token available for org: ${org}` };\n    }\n\n    try {\n      const { data } = await octokit.repos.listForOrg({\n        org,\n        type: options?.type ?? 'all',\n        per_page: options?.perPage ?? 100,\n      });\n\n      return {\n        success: true,\n        data: data.map((r) => ({\n          owner: r.owner.login,\n          name: r.name,\n          fullName: r.full_name,\n          defaultBranch: r.default_branch ?? 'main',\n          isPrivate: r.private,\n          url: r.html_url,\n        })),\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  // ============================================\n  // Pull Request Operations\n  // ============================================\n\n  /**\n   * Get pull request information (static version)\n   */\n  static async getPRStatic(\n    owner: string,\n    repo: string,\n    prNumber: number\n  ): Promise<Result<PullRequest>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      const { data } = await octokit.pulls.get({ owner, repo, pull_number: prNumber });\n      return {\n        success: true,\n        data: {\n          number: data.number,\n          title: data.title,\n          body: data.body ?? undefined,\n          state: data.state as 'open' | 'closed',\n          draft: data.draft ?? false,\n          url: data.html_url,\n          headBranch: data.head.ref,\n          baseBranch: data.base.ref,\n          author: data.user?.login ?? 'unknown',\n        },\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Get pull request (instance version with full data)\n   */\n  async getPR(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.get({\n      owner,\n      repo,\n      pull_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * Get files changed in a PR\n   */\n  async getPRFiles(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.listFiles({\n      owner,\n      repo,\n      pull_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * Create a pull request\n   */\n  static async createPR(\n    owner: string,\n    repo: string,\n    options: {\n      title: string;\n      body?: string;\n      head: string;\n      base: string;\n      draft?: boolean;\n    }\n  ): Promise<Result<PullRequest>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      const { data } = await octokit.pulls.create({\n        owner,\n        repo,\n        title: options.title,\n        body: options.body,\n        head: options.head,\n        base: options.base,\n        draft: options.draft,\n      });\n\n      return {\n        success: true,\n        data: {\n          number: data.number,\n          title: data.title,\n          body: data.body ?? undefined,\n          state: data.state as 'open' | 'closed',\n          draft: data.draft ?? false,\n          url: data.html_url,\n          headBranch: data.head.ref,\n          baseBranch: data.base.ref,\n          author: data.user?.login ?? 'unknown',\n        },\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Merge a pull request\n   */\n  static async mergePRStatic(\n    owner: string,\n    repo: string,\n    prNumber: number,\n    options?: {\n      mergeMethod?: 'merge' | 'squash' | 'rebase';\n      commitTitle?: string;\n      commitMessage?: string;\n    }\n  ): Promise<Result<void>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      await octokit.pulls.merge({\n        owner,\n        repo,\n        pull_number: prNumber,\n        merge_method: options?.mergeMethod ?? 'squash',\n        commit_title: options?.commitTitle,\n        commit_message: options?.commitMessage,\n      });\n\n      return { success: true };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Merge a pull request (instance version)\n   */\n  async mergePR(prNumber: number, method: 'merge' | 'squash' | 'rebase' = 'squash') {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.merge({\n      owner,\n      repo,\n      pull_number: prNumber,\n      merge_method: method,\n    });\n    return data;\n  }\n\n  // ============================================\n  // Reviews and Comments\n  // ============================================\n\n  /**\n   * Get reviews on a PR\n   */\n  async getReviews(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.listReviews({\n      owner,\n      repo,\n      pull_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * Get review comments on a PR\n   */\n  async getReviewComments(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.listReviewComments({\n      owner,\n      repo,\n      pull_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * Get issue comments on a PR\n   */\n  async getIssueComments(prNumber: number) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.issues.listComments({\n      owner,\n      repo,\n      issue_number: prNumber,\n    });\n    return data;\n  }\n\n  /**\n   * List PR comments (static version)\n   */\n  static async listPRComments(\n    owner: string,\n    repo: string,\n    prNumber: number\n  ): Promise<Result<PRComment[]>> {\n    const octokit = GitHubClient.forRepo(`${owner}/${repo}`);\n    if (!octokit) {\n      return { success: false, error: 'No token available for this repository' };\n    }\n\n    try {\n      const { data } = await octokit.issues.listComments({\n        owner,\n        repo,\n        issue_number: prNumber,\n        per_page: 100,\n      });\n\n      return {\n        success: true,\n        data: data.map((c) => ({\n          id: c.id,\n          body: c.body ?? '',\n          author: c.user?.login ?? 'unknown',\n          createdAt: c.created_at,\n          updatedAt: c.updated_at,\n        })),\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Post a PR comment (ALWAYS uses PR review identity)\n   */\n  static async postPRComment(\n    owner: string,\n    repo: string,\n    prNumber: number,\n    body: string\n  ): Promise<Result<PRComment>> {\n    const octokit = GitHubClient.forPRReview();\n    if (!octokit) {\n      return { success: false, error: 'No PR review token available' };\n    }\n\n    try {\n      const { data } = await octokit.issues.createComment({\n        owner,\n        repo,\n        issue_number: prNumber,\n        body,\n      });\n\n      return {\n        success: true,\n        data: {\n          id: data.id,\n          body: data.body ?? '',\n          author: data.user?.login ?? 'unknown',\n          createdAt: data.created_at,\n          updatedAt: data.updated_at,\n        },\n      };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  /**\n   * Post a comment (instance version)\n   */\n  async postComment(prNumber: number, body: string) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.issues.createComment({\n      owner,\n      repo,\n      issue_number: prNumber,\n      body,\n    });\n    return data;\n  }\n\n  /**\n   * Reply to a review comment\n   */\n  async replyToComment(prNumber: number, commentId: number, body: string) {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n    const { data } = await octokit.pulls.createReplyForReviewComment({\n      owner,\n      repo,\n      pull_number: prNumber,\n      comment_id: commentId,\n      body,\n    });\n    return data;\n  }\n\n  /**\n   * Request a review on a PR (ALWAYS uses PR review identity)\n   */\n  static async requestReview(\n    owner: string,\n    repo: string,\n    prNumber: number,\n    reviewers: string[]\n  ): Promise<Result<void>> {\n    const octokit = GitHubClient.forPRReview();\n    if (!octokit) {\n      return { success: false, error: 'No PR review token available' };\n    }\n\n    try {\n      await octokit.pulls.requestReviewers({\n        owner,\n        repo,\n        pull_number: prNumber,\n        reviewers,\n      });\n\n      return { success: true };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  // ============================================\n  // CI Status\n  // ============================================\n\n  /**\n   * Get CI status for a PR\n   */\n  async getCIStatus(prNumber: number): Promise<CIStatus> {\n    const { owner, repo } = this.ensureRepo();\n    const octokit = this.getOctokitInstance();\n\n    const pr = await this.getPR(prNumber);\n    const ref = pr.head.sha;\n\n    const { data: checkRuns } = await octokit.checks.listForRef({\n      owner,\n      repo,\n      ref,\n    });\n\n    const checks: CICheck[] = checkRuns.check_runs.map((run) => ({\n      name: run.name,\n      status: this.mapCheckStatus(run.status, run.conclusion),\n      conclusion: run.conclusion,\n      url: run.html_url ?? '',\n      startedAt: run.started_at,\n      completedAt: run.completed_at,\n    }));\n\n    const failures = checks.filter((c) => c.status === 'failure');\n    const pending = checks.filter((c) => c.status === 'pending' || c.status === 'in_progress');\n\n    return {\n      allPassing: failures.length === 0 && pending.length === 0,\n      anyPending: pending.length > 0,\n      checks,\n      failures,\n    };\n  }\n\n  private mapCheckStatus(status: string, conclusion: string | null): CICheck['status'] {\n    if (status === 'queued' || status === 'pending') return 'pending';\n    if (status === 'in_progress') return 'in_progress';\n    if (conclusion === 'success') return 'success';\n    if (conclusion === 'failure' || conclusion === 'timed_out') return 'failure';\n    if (conclusion === 'skipped' || conclusion === 'cancelled') return 'skipped';\n    return 'pending';\n  }\n\n  // ============================================\n  // Feedback Collection\n  // ============================================\n\n  /**\n   * Collect all feedback on a PR\n   */\n  async collectFeedback(prNumber: number): Promise<FeedbackItem[]> {\n    const [reviewComments, reviews] = await Promise.all([\n      this.getReviewComments(prNumber),\n      this.getReviews(prNumber),\n    ]);\n\n    const feedbackItems: FeedbackItem[] = [];\n\n    // Process inline review comments\n    for (const comment of reviewComments) {\n      const severity = this.inferSeverity(comment.body);\n      feedbackItems.push({\n        id: `comment-${comment.id}`,\n        author: comment.user?.login ?? 'unknown',\n        body: comment.body,\n        path: comment.path,\n        line: comment.line ?? comment.original_line ?? null,\n        severity,\n        status: this.inferStatus(comment),\n        createdAt: comment.created_at,\n        url: comment.html_url,\n        isAutoResolvable: this.isAutoResolvable(comment.body, severity),\n        suggestedAction: this.extractSuggestion(comment.body),\n        resolution: null,\n      });\n    }\n\n    // Process review bodies (summary comments)\n    for (const review of reviews) {\n      if (!review.body || review.body.trim() === '') continue;\n\n      const severity = this.inferSeverity(review.body);\n      feedbackItems.push({\n        id: `review-${review.id}`,\n        author: review.user?.login ?? 'unknown',\n        body: review.body,\n        path: null,\n        line: null,\n        severity,\n        status: 'addressed', // Review summaries are informational\n        createdAt: review.submitted_at ?? new Date().toISOString(),\n        url: review.html_url,\n        isAutoResolvable: false,\n        suggestedAction: null,\n        resolution: null,\n      });\n    }\n\n    return feedbackItems;\n  }\n\n  private inferSeverity(body: string): FeedbackSeverity {\n    const lower = body.toLowerCase();\n\n    if (body.includes('') || body.includes(':stop_sign:') || lower.includes('critical')) {\n      return 'critical';\n    }\n    if (body.includes('medium-priority') || lower.includes('high severity')) {\n      return 'high';\n    }\n    if (body.includes('medium') || lower.includes('should')) {\n      return 'medium';\n    }\n    if (body.includes('nitpick') || body.includes('nit:') || lower.includes('consider')) {\n      return 'low';\n    }\n    if (body.includes('info') || body.includes('note:')) {\n      return 'info';\n    }\n\n    if (lower.includes('error') || lower.includes('bug') || lower.includes('fix')) {\n      return 'high';\n    }\n\n    return 'medium';\n  }\n\n  private inferStatus(comment: { body: string; in_reply_to_id?: number }): FeedbackStatus {\n    if (comment.in_reply_to_id) {\n      return 'addressed';\n    }\n    return 'unaddressed';\n  }\n\n  private isAutoResolvable(body: string, severity: FeedbackSeverity): boolean {\n    if (body.includes('```suggestion')) return true;\n    if (severity === 'low' || severity === 'info') return true;\n\n    const lower = body.toLowerCase();\n    if (lower.includes('formatting') || lower.includes('typo') || lower.includes('spelling')) {\n      return true;\n    }\n\n    return false;\n  }\n\n  private extractSuggestion(body: string): string | null {\n    const suggestionMatch = body.match(/```suggestion\\n([\\s\\S]*?)```/);\n    const suggestion = suggestionMatch?.[1];\n    if (suggestion !== undefined) {\n      return suggestion.trim();\n    }\n    return null;\n  }\n}\n\n// ============================================\n// Safe Git Operations\n// ============================================\n\n/**\n * Clone a repository with appropriate token.\n * Uses spawnSync for safe command execution (no shell injection).\n */\nexport function cloneRepo(repoUrl: string, destPath: string): Result<void> {\n  const token = getTokenForRepo(repoUrl);\n  if (!token) {\n    return { success: false, error: `No token available for repo: ${repoUrl}` };\n  }\n\n  let cloneUrl = repoUrl;\n  if (cloneUrl.startsWith('https://github.com/')) {\n    cloneUrl = cloneUrl.replace('https://github.com/', `https://oauth2:${token}@github.com/`);\n  } else if (!cloneUrl.includes('@') && !cloneUrl.startsWith('https://')) {\n    const org = extractOrg(repoUrl);\n    const repoName = repoUrl.replace(`${org}/`, '');\n    cloneUrl = `https://oauth2:${token}@github.com/${org}/${repoName}.git`;\n  }\n\n  const proc = spawnSync('git', ['clone', cloneUrl, destPath], {\n    encoding: 'utf-8',\n    stdio: 'pipe',\n    timeout: 120000,\n  });\n\n  if (proc.error) {\n    return { success: false, error: `Git clone error: ${proc.error.message}` };\n  }\n\n  if (proc.status !== 0) {\n    const errorOutput = (proc.stderr || 'Unknown error').replace(\n      /oauth2:[^@]+@/g,\n      'oauth2:[REDACTED]@'\n    );\n    return { success: false, error: `Git clone failed: ${errorOutput}` };\n  }\n\n  return { success: true };\n}\n\n/**\n * Validate a git ref/branch name to prevent injection\n */\nexport function isValidGitRef(ref: string): boolean {\n  return /^[a-zA-Z0-9._/-]+$/.test(ref) && ref.length <= 200;\n}\n\n/**\n * Validate owner/repo format\n */\nexport function isValidRepoFormat(repo: string): boolean {\n  return /^[a-zA-Z0-9._-]+\\/[a-zA-Z0-9._-]+$/.test(repo) && repo.length <= 200;\n}\n\n// ============================================\n// Configuration Type Export\n// ============================================\n\nexport type { GitHubClientConfig as GitHubConfig };\n","/**\n * AI Provider Loading - Shared provider utilities\n *\n * Supports multiple AI providers via Vercel AI SDK:\n * - anthropic (@ai-sdk/anthropic)\n * - openai (@ai-sdk/openai)\n * - google (@ai-sdk/google)\n * - mistral (@ai-sdk/mistral)\n * - azure (@ai-sdk/azure)\n * - ollama (ai-sdk-ollama) - for Ollama Cloud and local Ollama\n *\n * Install the provider you need:\n *   pnpm add @ai-sdk/anthropic\n *   pnpm add ai-sdk-ollama  # for Ollama support\n */\n\nimport { getDefaultApiKeyEnvVar, getTriageConfig } from './config.js';\n\n// ============================================\n// Types\n// ============================================\n\nexport type ProviderFactory = (config: { apiKey: string }) => unknown;\nexport type ModelFactory = (model: string) => unknown;\n\nexport type SupportedProvider = 'anthropic' | 'openai' | 'google' | 'mistral' | 'azure' | 'ollama';\n\nexport interface ProviderConfig {\n  package: string;\n  factory: string;\n}\n\n// ============================================\n// Provider Configuration\n// ============================================\n\n/**\n * Security: Explicit allowlist of supported providers and their packages.\n * Dynamic imports are only allowed for these pre-defined packages.\n */\nexport const PROVIDER_CONFIG: Record<SupportedProvider, ProviderConfig> = {\n  anthropic: { package: '@ai-sdk/anthropic', factory: 'createAnthropic' },\n  openai: { package: '@ai-sdk/openai', factory: 'createOpenAI' },\n  google: { package: '@ai-sdk/google', factory: 'createGoogleGenerativeAI' },\n  mistral: { package: '@ai-sdk/mistral', factory: 'createMistral' },\n  azure: { package: '@ai-sdk/azure', factory: 'createAzure' },\n  ollama: { package: 'ai-sdk-ollama', factory: 'createOllama' },\n} as const;\n\n/**\n * Ollama-specific configuration\n */\nexport const OLLAMA_CONFIG = {\n  /** Default model for Ollama Cloud (qwen3-coder has excellent tool support) */\n  defaultModel: 'qwen3-coder:480b-cloud',\n  /** Ollama Cloud API URL (SDK appends /api paths automatically) */\n  cloudHost: 'https://ollama.com',\n  /** Local Ollama API URL (SDK appends /api paths automatically) */\n  localHost: 'http://localhost:11434',\n  /** Enable reliable object generation with automatic JSON repair (v3.0.0+) */\n  reliableObjectGeneration: true,\n  /** Object generation options for better reliability */\n  objectGenerationOptions: {\n    /** Enable automatic JSON repair for malformed outputs */\n    enableTextRepair: true,\n    /** Maximum retries for object generation */\n    maxRetries: 3,\n  },\n} as const;\n\n/**\n * Check if a provider name is valid\n */\nexport function isValidProvider(name: string): name is SupportedProvider {\n  return name in PROVIDER_CONFIG;\n}\n\n/**\n * Get list of supported provider names\n */\nexport function getSupportedProviders(): SupportedProvider[] {\n  return Object.keys(PROVIDER_CONFIG) as SupportedProvider[];\n}\n\n// ============================================\n// Provider Loading\n// ============================================\n\n/**\n * Load an AI provider dynamically.\n *\n * @param providerName - Name of the provider (anthropic, openai, etc.)\n * @param apiKey - API key for the provider\n * @returns A function that creates a model instance\n * @throws Error if provider is unknown or package not installed\n */\nexport async function loadProvider(providerName: string, apiKey: string): Promise<ModelFactory> {\n  // Security: Validate provider name against explicit allowlist\n  if (!isValidProvider(providerName)) {\n    throw new Error(\n      `Unknown provider: ${providerName}\\n` +\n        `Supported providers: ${getSupportedProviders().join(', ')}`\n    );\n  }\n\n  const config = PROVIDER_CONFIG[providerName];\n\n  try {\n    // Security: Only import from pre-defined allowlist - no user input in import path\n    let module: Record<string, unknown>;\n    switch (providerName) {\n      case 'anthropic':\n        module = await import('@ai-sdk/anthropic');\n        break;\n      case 'openai':\n        module = await import('@ai-sdk/openai');\n        break;\n      case 'google':\n        module = await import('@ai-sdk/google');\n        break;\n      case 'mistral':\n        module = await import('@ai-sdk/mistral');\n        break;\n      case 'azure':\n        module = await import('@ai-sdk/azure');\n        break;\n      case 'ollama':\n        module = await import('ai-sdk-ollama');\n        break;\n      default:\n        // This should never happen due to isValidProvider check above\n        throw new Error(`Provider ${providerName} not implemented`);\n    }\n\n    const factory = module[config.factory] as ProviderFactory;\n\n    if (typeof factory !== 'function') {\n      throw new Error(`Factory ${config.factory} not found in ${config.package}`);\n    }\n\n    // Ollama provider has different config structure (ai-sdk-ollama v3.0.0+)\n    if (providerName === 'ollama') {\n      // Determine host URL based on API key presence\n      const host =\n        process.env.OLLAMA_HOST || (apiKey ? OLLAMA_CONFIG.cloudHost : OLLAMA_CONFIG.localHost);\n      // Normalize URL to remove any trailing slashes or /api path (SDK appends /api automatically)\n      const normalizedHost = host.replace(/\\/api\\/?$/, '').replace(/\\/$/, '');\n\n      // ai-sdk-ollama v3.0.0+ configuration with reliable object generation\n      type OllamaProviderFactory = (config: {\n        baseURL: string;\n        headers?: { Authorization: string };\n      }) => unknown;\n\n      // Model factory type with v3 options\n      type OllamaModelFactory = (\n        model: string,\n        options?: {\n          structuredOutputs?: boolean;\n          reliableObjectGeneration?: boolean;\n          objectGenerationOptions?: {\n            enableTextRepair?: boolean;\n            maxRetries?: number;\n          };\n        }\n      ) => unknown;\n\n      const provider = (factory as unknown as OllamaProviderFactory)({\n        baseURL: normalizedHost,\n        headers: apiKey ? { Authorization: `Bearer ${apiKey}` } : undefined,\n      });\n\n      // Return a model factory that applies reliability settings by default\n      return (model: string) =>\n        (provider as OllamaModelFactory)(model, {\n          // Enable reliable object generation with automatic JSON repair\n          reliableObjectGeneration: OLLAMA_CONFIG.reliableObjectGeneration,\n          objectGenerationOptions: OLLAMA_CONFIG.objectGenerationOptions,\n        });\n    }\n\n    const provider = factory({ apiKey });\n    return (model: string) => (provider as ModelFactory)(model);\n  } catch (err) {\n    if ((err as NodeJS.ErrnoException).code === 'ERR_MODULE_NOT_FOUND') {\n      throw new Error(\n        `Provider package not installed: ${config.package}\\n` +\n          `Install it with: pnpm add ${config.package}`\n      );\n    }\n    throw err;\n  }\n}\n\n// ============================================\n// Provider Instance Management\n// ============================================\n\n/**\n * Cached provider instances to avoid re-loading\n */\nconst providerCache = new Map<string, ModelFactory>();\n\n/**\n * Get or create a cached provider instance.\n *\n * @param providerName - Name of the provider\n * @param apiKey - API key for the provider\n * @returns A function that creates a model instance\n */\nexport async function getOrLoadProvider(\n  providerName: string,\n  apiKey: string\n): Promise<ModelFactory> {\n  const cacheKey = `${providerName}:${apiKey.slice(0, 8)}`;\n\n  let provider = providerCache.get(cacheKey);\n  if (!provider) {\n    provider = await loadProvider(providerName, apiKey);\n    providerCache.set(cacheKey, provider);\n  }\n\n  return provider;\n}\n\n/**\n * Clear the provider cache (useful for testing)\n */\nexport function clearProviderCache(): void {\n  providerCache.clear();\n}\n\n// ============================================\n// Configuration Helpers\n// ============================================\n\nexport interface ProviderOptions {\n  /** AI provider: anthropic, openai, google, mistral, azure, ollama */\n  provider?: string;\n  /** Model to use */\n  model?: string;\n  /** API key (defaults to provider-specific env var) */\n  apiKey?: string;\n}\n\n/**\n * Resolve provider options with defaults from config.\n *\n * @param options - User-provided options\n * @returns Resolved provider name, model, and API key\n * @throws Error if API key is not available\n */\nexport function resolveProviderOptions(options: ProviderOptions = {}): {\n  providerName: string;\n  model: string;\n  apiKey: string;\n} {\n  const triageConfig = getTriageConfig();\n\n  const providerName = options.provider ?? triageConfig.provider ?? 'anthropic';\n  const model = options.model ?? triageConfig.model ?? 'claude-sonnet-4-20250514';\n\n  // Determine the correct API key\n  const effectiveProvider = options.provider ?? triageConfig.provider ?? 'anthropic';\n  const envVarName =\n    options.provider && options.provider !== triageConfig.provider\n      ? getDefaultApiKeyEnvVar(effectiveProvider)\n      : (triageConfig.apiKeyEnvVar ?? getDefaultApiKeyEnvVar(effectiveProvider));\n\n  const apiKey = options.apiKey ?? process.env[envVarName] ?? '';\n\n  if (!apiKey) {\n    const hint = getDefaultApiKeyEnvVar(effectiveProvider);\n    throw new Error(\n      `API key required for ${providerName} provider.\\n` +\n        `Set ${hint} environment variable or pass apiKey option.`\n    );\n  }\n\n  return { providerName, model, apiKey };\n}\n","/**\n * Analyzer - Unified AI-powered analysis\n *\n * Combines conversation analysis, PR triage, and code review into one class.\n * Supports multiple AI providers via Vercel AI SDK.\n *\n * This consolidates the former AIAnalyzer and PRAnalyzer classes.\n */\n\nimport { spawnSync } from 'node:child_process';\nimport { generateObject, generateText } from 'ai';\nimport { z } from 'zod';\nimport { getConfig, log } from '../core/config.js';\nimport {\n  getOrLoadProvider,\n  type ModelFactory,\n  type ProviderOptions,\n  resolveProviderOptions,\n} from '../core/providers.js';\nimport { getEnvForPRReview } from '../core/tokens.js';\nimport type {\n  AnalysisResult,\n  CodeReviewResult,\n  Conversation,\n  ConversationMessage,\n  Blocker as CoreBlocker,\n  TriageResult as CoreTriageResult,\n  ReviewImprovement,\n  ReviewIssue,\n  Task,\n} from '../core/types.js';\nimport type { Blocker, CIStatus, FeedbackItem, PRStatus, TriageResult } from './types.js';\n\n// ============================================\n// Schemas for Structured AI Output\n// ============================================\n\nconst TaskAnalysisSchema = z.object({\n  completedTasks: z.array(\n    z.object({\n      id: z.string(),\n      title: z.string(),\n      description: z.string().optional(),\n      priority: z.enum(['critical', 'high', 'medium', 'low', 'info']),\n      category: z.enum([\n        'bug',\n        'feature',\n        'security',\n        'performance',\n        'documentation',\n        'infrastructure',\n        'dependency',\n        'ci',\n        'other',\n      ]),\n      status: z.literal('completed'),\n      evidence: z.string().optional(),\n      prNumber: z.number().nullable().optional(),\n    })\n  ),\n  outstandingTasks: z.array(\n    z.object({\n      id: z.string(),\n      title: z.string(),\n      description: z.string().optional(),\n      priority: z.enum(['critical', 'high', 'medium', 'low', 'info']),\n      category: z.enum([\n        'bug',\n        'feature',\n        'security',\n        'performance',\n        'documentation',\n        'infrastructure',\n        'dependency',\n        'ci',\n        'other',\n      ]),\n      status: z.enum(['pending', 'in_progress', 'blocked']),\n      blockers: z.array(z.string()).optional(),\n      suggestedLabels: z.array(z.string()).optional(),\n    })\n  ),\n  blockers: z.array(\n    z.object({\n      issue: z.string(),\n      severity: z.enum(['critical', 'high', 'medium', 'low', 'info']),\n      suggestedResolution: z.string().optional(),\n    })\n  ),\n  summary: z.string(),\n  recommendations: z.array(z.string()),\n});\n\nconst CodeReviewSchema = z.object({\n  issues: z.array(\n    z.object({\n      file: z.string(),\n      line: z.number().optional(),\n      severity: z.enum(['critical', 'high', 'medium', 'low', 'info']),\n      category: z.enum([\n        'bug',\n        'security',\n        'performance',\n        'style',\n        'logic',\n        'documentation',\n        'test',\n        'other',\n      ]),\n      description: z.string(),\n      suggestedFix: z.string().optional(),\n    })\n  ),\n  improvements: z.array(\n    z.object({\n      area: z.string(),\n      suggestion: z.string(),\n      effort: z.enum(['low', 'medium', 'high']),\n    })\n  ),\n  overallAssessment: z.string(),\n  readyToMerge: z.boolean(),\n  mergeBlockers: z.array(z.string()),\n});\n\nconst QuickTriageSchema = z.object({\n  priority: z.enum(['critical', 'high', 'medium', 'low', 'info']),\n  category: z.enum([\n    'bug',\n    'feature',\n    'security',\n    'performance',\n    'documentation',\n    'infrastructure',\n    'dependency',\n    'ci',\n    'other',\n  ]),\n  summary: z.string(),\n  suggestedAction: z.string(),\n  confidence: z.number().min(0).max(1),\n});\n\n// ============================================\n// Types\n// ============================================\n\nexport interface AnalyzerOptions extends ProviderOptions {\n  /** Repository for GitHub operations (required for issue creation) */\n  repo?: string;\n}\n\n/**\n * Interface for GitHub client - allows dependency injection\n */\nexport interface GitHubClientInterface {\n  getPR(prNumber: number): Promise<{\n    html_url: string;\n    title: string;\n    merged: boolean;\n    state: string;\n    mergeable: boolean | null;\n    mergeable_state: string;\n  }>;\n  getCIStatus(prNumber: number): Promise<CIStatus>;\n  collectFeedback(prNumber: number): Promise<FeedbackItem[]>;\n  getPRFiles(prNumber: number): Promise<Array<{ filename: string }>>;\n}\n\n// ============================================\n// Analyzer Class\n// ============================================\n\nexport class Analyzer {\n  private providerName: string;\n  private model: string;\n  private apiKey: string;\n  private repo: string | undefined;\n  private providerFn: ModelFactory | null = null;\n\n  constructor(options: AnalyzerOptions = {}) {\n    const resolved = resolveProviderOptions(options);\n    this.providerName = resolved.providerName;\n    this.model = resolved.model;\n    this.apiKey = resolved.apiKey;\n    this.repo = options.repo ?? getConfig().defaultRepository;\n  }\n\n  private async getModel(): Promise<unknown> {\n    if (!this.providerFn) {\n      this.providerFn = await getOrLoadProvider(this.providerName, this.apiKey);\n    }\n    return this.providerFn(this.model);\n  }\n\n  /**\n   * Set the repository for GitHub operations\n   */\n  setRepo(repo: string): void {\n    this.repo = repo;\n  }\n\n  // ============================================\n  // Conversation Analysis\n  // ============================================\n\n  /**\n   * Analyze a conversation to extract completed/outstanding tasks\n   */\n  async analyzeConversation(conversation: Conversation): Promise<AnalysisResult> {\n    const messages = conversation.messages || [];\n    const conversationText = this.prepareConversationText(messages);\n\n    const { object } = await generateObject({\n      model: (await this.getModel()) as Parameters<typeof generateObject>[0]['model'],\n      schema: TaskAnalysisSchema,\n      prompt: `Analyze this agent conversation and extract:\n1. COMPLETED TASKS - What was actually finished and merged/deployed\n2. OUTSTANDING TASKS - What remains to be done\n3. BLOCKERS - Any issues preventing progress\n4. SUMMARY - Brief overall assessment\n5. RECOMMENDATIONS - What should be done next\n\nBe thorough and specific. Reference PR numbers, file paths, and specific changes where possible.\nGenerate unique IDs for tasks (e.g., task-001, task-002).\n\nCONVERSATION:\n${conversationText}`,\n    });\n\n    // Map to our types\n    const completedTasks: Task[] = object.completedTasks.map((t) => ({\n      id: t.id,\n      title: t.title,\n      description: t.description,\n      priority: t.priority,\n      category: t.category,\n      status: 'completed' as const,\n    }));\n\n    const outstandingTasks: Task[] = object.outstandingTasks.map((t) => ({\n      id: t.id,\n      title: t.title,\n      description: t.description,\n      priority: t.priority,\n      category: t.category,\n      status: t.status === 'blocked' ? ('blocked' as const) : ('pending' as const),\n      blockers: t.blockers,\n    }));\n\n    const blockers: CoreBlocker[] = object.blockers.map((b) => ({\n      issue: b.issue,\n      severity: b.severity,\n      suggestedResolution: b.suggestedResolution,\n    }));\n\n    return {\n      summary: object.summary,\n      completedTasks,\n      outstandingTasks,\n      blockers,\n      recommendations: object.recommendations,\n    };\n  }\n\n  // ============================================\n  // Code Review\n  // ============================================\n\n  /**\n   * Review code changes and identify issues\n   */\n  async reviewCode(diff: string, context?: string): Promise<CodeReviewResult> {\n    const { object } = await generateObject({\n      model: (await this.getModel()) as Parameters<typeof generateObject>[0]['model'],\n      schema: CodeReviewSchema,\n      prompt: `Review this code diff and identify:\n1. ISSUES - Security, bugs, performance problems\n2. IMPROVEMENTS - Suggestions for better code\n3. OVERALL ASSESSMENT - Is this ready to merge?\n\nBe specific about file paths and line numbers.\nFocus on real issues, not style nitpicks.\n\n${context ? `CONTEXT:\\n${context}\\n\\n` : ''}DIFF:\n${diff}`,\n    });\n\n    const issues: ReviewIssue[] = object.issues.map((i) => ({\n      file: i.file,\n      line: i.line,\n      severity: i.severity,\n      category: i.category,\n      description: i.description,\n      suggestedFix: i.suggestedFix,\n    }));\n\n    const improvements: ReviewImprovement[] = object.improvements.map((i) => ({\n      area: i.area,\n      suggestion: i.suggestion,\n      effort: i.effort,\n    }));\n\n    return {\n      readyToMerge: object.readyToMerge,\n      mergeBlockers: object.mergeBlockers,\n      issues,\n      improvements,\n      overallAssessment: object.overallAssessment,\n    };\n  }\n\n  // ============================================\n  // Quick Triage\n  // ============================================\n\n  /**\n   * Quick triage - fast assessment of what needs attention\n   */\n  async quickTriage(input: string): Promise<CoreTriageResult> {\n    const { object } = await generateObject({\n      model: (await this.getModel()) as Parameters<typeof generateObject>[0]['model'],\n      schema: QuickTriageSchema,\n      prompt: `Quickly triage this input and determine:\n1. Priority level (critical/high/medium/low/info)\n2. Category (bug, feature, documentation, infrastructure, etc.)\n3. Brief summary\n4. Suggested immediate action\n5. Confidence level (0-1)\n\nINPUT:\n${input}`,\n    });\n\n    return {\n      priority: object.priority,\n      category: object.category,\n      summary: object.summary,\n      suggestedAction: object.suggestedAction,\n      confidence: object.confidence,\n    };\n  }\n\n  // ============================================\n  // PR Analysis\n  // ============================================\n\n  /**\n   * Analyze a Pull Request for triage\n   */\n  async analyzePR(github: GitHubClientInterface, prNumber: number): Promise<TriageResult> {\n    // Gather all data\n    const [pr, ci, feedback] = await Promise.all([\n      github.getPR(prNumber),\n      github.getCIStatus(prNumber),\n      github.collectFeedback(prNumber),\n    ]);\n\n    // Analyze feedback for unaddressed items\n    const analyzedFeedback = await this.analyzeFeedback(feedback);\n    const unaddressedFeedback = analyzedFeedback.filter((f) => f.status === 'unaddressed');\n\n    // Identify blockers\n    const blockers = await this.identifyBlockers(pr, ci, unaddressedFeedback);\n\n    // Determine status\n    const status = this.determineStatus(pr, ci, blockers, unaddressedFeedback);\n\n    // Generate next actions\n    const nextActions = this.generateNextActions(status, blockers, unaddressedFeedback);\n\n    // Generate summary\n    const summary = await this.generatePRSummary(pr, ci, blockers, unaddressedFeedback);\n\n    return {\n      prNumber,\n      prUrl: pr.html_url,\n      prTitle: pr.title,\n      status,\n      ci,\n      feedback: {\n        total: feedback.length,\n        unaddressed: unaddressedFeedback.length,\n        items: analyzedFeedback,\n      },\n      blockers,\n      nextActions,\n      summary,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Generate a response for feedback (fix or justification)\n   */\n  async generateFeedbackResponse(\n    feedback: FeedbackItem,\n    context: { prTitle: string; files: string[] }\n  ): Promise<{ type: 'fix' | 'justification'; content: string }> {\n    const { object } = await generateObject({\n      model: (await this.getModel()) as Parameters<typeof generateObject>[0]['model'],\n      schema: z.object({\n        type: z.enum(['fix', 'justification']),\n        content: z.string(),\n        reasoning: z.string(),\n      }),\n      prompt: `Determine how to address this PR feedback.\n\nPR: ${context.prTitle}\nFiles changed: ${context.files.join(', ')}\n\nFeedback from ${feedback.author}:\n${feedback.body}\n\n${feedback.path ? `File: ${feedback.path}` : ''}\n${feedback.line ? `Line: ${feedback.line}` : ''}\n\nOptions:\n1. \"fix\" - Generate code/text to fix the issue\n2. \"justification\" - Explain why this feedback should not be implemented\n\nChoose \"fix\" if:\n- There's a clear suggestion to implement\n- The issue is valid and should be fixed\n- It's a straightforward change\n\nChoose \"justification\" if:\n- The feedback is a false positive\n- It conflicts with project conventions\n- It's out of scope for this PR\n\nProvide the content (code fix or justification text) and your reasoning.`,\n    });\n\n    return {\n      type: object.type,\n      content: object.content,\n    };\n  }\n\n  // ============================================\n  // Issue Creation\n  // ============================================\n\n  /**\n   * Create GitHub issues from analysis.\n   * Always uses PR review token for consistent identity.\n   */\n  async createIssuesFromAnalysis(\n    analysis: AnalysisResult,\n    options?: {\n      dryRun?: boolean;\n      labels?: string[];\n      assignCopilot?: boolean;\n      repo?: string;\n    }\n  ): Promise<string[]> {\n    const repo = options?.repo ?? this.repo;\n    if (!repo) {\n      throw new Error(\n        'Repository is required for issue creation. Set via:\\n' +\n          \"  - Analyzer constructor: new Analyzer({ repo: 'owner/repo' })\\n\" +\n          '  - setRepo() method\\n' +\n          \"  - createIssuesFromAnalysis() options: { repo: 'owner/repo' }\\n\" +\n          '  - Config file: defaultRepository in agentic.config.json'\n      );\n    }\n\n    const createdIssues: string[] = [];\n    const env = { ...process.env, ...getEnvForPRReview() };\n\n    for (const task of analysis.outstandingTasks) {\n      const labels: string[] = [...(options?.labels || [])];\n\n      if (options?.assignCopilot !== false) {\n        labels.push('copilot');\n      }\n\n      if (task.priority === 'critical' || task.priority === 'high') {\n        labels.push(`priority:${task.priority}`);\n      }\n\n      const body = `## Summary\n${task.description || task.title}\n\n## Priority\n\\`${task.priority.toUpperCase()}\\`\n\n${task.blockers?.length ? `## Blocked By\\n${task.blockers.join('\\n')}\\n` : ''}\n\n## Acceptance Criteria\n- [ ] Implementation complete\n- [ ] Tests added/updated\n- [ ] Documentation updated if needed\n- [ ] CI passes\n\n## Context for AI Agents\nThis issue was auto-generated from agent session analysis.\n- Follow your project's contribution guidelines\n- Versioning is typically managed automatically  avoid manual version bumps\n\n---\n*Generated by agentic-control Analyzer*`;\n\n      if (options?.dryRun) {\n        log.info(`[DRY RUN] Would create issue: ${task.title}`);\n        createdIssues.push(`[DRY RUN] ${task.title}`);\n        continue;\n      }\n\n      try {\n        // Build args array safely - no shell interpolation\n        const args = ['issue', 'create', '--repo', repo, '--title', task.title, '--body-file', '-'];\n\n        // Add labels if any\n        if (labels.length > 0) {\n          args.push('--label', labels.join(','));\n        }\n\n        // Use spawnSync for safe command execution (no shell injection)\n        const proc = spawnSync('gh', args, {\n          input: body,\n          encoding: 'utf-8',\n          env,\n          maxBuffer: 10 * 1024 * 1024, // 10MB\n        });\n\n        if (proc.error) {\n          throw proc.error;\n        }\n\n        if (proc.status !== 0) {\n          throw new Error(proc.stderr || 'gh issue create failed');\n        }\n\n        const result = proc.stdout.trim();\n        createdIssues.push(result);\n        log.info(` Created issue: ${result}`);\n      } catch (err) {\n        log.error(` Failed to create issue: ${task.title}`, err);\n      }\n    }\n\n    return createdIssues;\n  }\n\n  // ============================================\n  // Report Generation\n  // ============================================\n\n  /**\n   * Generate a comprehensive assessment report\n   */\n  async generateReport(conversation: Conversation): Promise<string> {\n    const analysis = await this.analyzeConversation(conversation);\n\n    return `# Agent Session Assessment Report\n\n## Summary\n${analysis.summary}\n\n## Completed Tasks (${analysis.completedTasks.length})\n${analysis.completedTasks\n  .map(\n    (t) => `\n###  ${t.title}\n${t.description || ''}\n`\n  )\n  .join('\\n')}\n\n## Outstanding Tasks (${analysis.outstandingTasks.length})\n${analysis.outstandingTasks\n  .map(\n    (t) => `\n###  ${t.title}\n**Priority**: ${t.priority}\n${t.description || ''}\n${t.blockers?.length ? `**Blocked By**: ${t.blockers.join(', ')}` : ''}\n`\n  )\n  .join('\\n')}\n\n## Blockers (${analysis.blockers.length})\n${analysis.blockers\n  .map(\n    (b) => `\n###  ${b.issue}\n**Severity**: ${b.severity}\n**Suggested Resolution**: ${b.suggestedResolution || 'None provided'}\n`\n  )\n  .join('\\n')}\n\n## Recommendations\n${analysis.recommendations.map((r) => `- ${r}`).join('\\n')}\n\n---\n*Generated by agentic-control Analyzer using ${this.providerName}/${this.model}*\n*Timestamp: ${new Date().toISOString()}*\n`;\n  }\n\n  // ============================================\n  // Private Helper Methods\n  // ============================================\n\n  private prepareConversationText(messages: ConversationMessage[], maxTokens = 100000): string {\n    const maxChars = maxTokens * 4;\n    const APPROX_CHARS_PER_MESSAGE = 500;\n\n    let text = messages\n      .map((m, i) => {\n        const role = m.type === 'user_message' ? 'USER' : 'ASSISTANT';\n        return `[${i + 1}] ${role}:\\n${m.text}\\n`;\n      })\n      .join('\\n---\\n');\n\n    if (text.length > maxChars) {\n      const firstPart = text.slice(0, Math.floor(maxChars * 0.2));\n      const lastPart = text.slice(-Math.floor(maxChars * 0.8));\n      const truncatedChars = text.length - (firstPart.length + lastPart.length);\n      const estimatedMessages = Math.ceil(truncatedChars / APPROX_CHARS_PER_MESSAGE);\n      text = `${firstPart}\\n\\n[... approximately ${estimatedMessages} messages truncated (${truncatedChars} chars) ...]\\n\\n${lastPart}`;\n    }\n\n    return text;\n  }\n\n  private async analyzeFeedback(feedback: FeedbackItem[]): Promise<FeedbackItem[]> {\n    if (feedback.length === 0) return [];\n\n    const { object } = await generateObject({\n      model: (await this.getModel()) as Parameters<typeof generateObject>[0]['model'],\n      schema: z.object({\n        items: z.array(\n          z.object({\n            id: z.string(),\n            status: z.enum(['unaddressed', 'addressed', 'dismissed', 'wont_fix']),\n            isAutoResolvable: z.boolean(),\n            suggestedAction: z.string().nullable(),\n          })\n        ),\n      }),\n      prompt: `Analyze these PR feedback items and determine their status.\n\nFeedback items:\n${feedback\n  .map(\n    (f) => `\nID: ${f.id}\nAuthor: ${f.author}\nSeverity: ${f.severity}\nPath: ${f.path ?? 'general'}\nBody: ${f.body}\n---`\n  )\n  .join('\\n')}\n\nFor each item:\n1. Determine if it's addressed (has been fixed/responded to), unaddressed (needs action), dismissed (explicitly dismissed with reason), or wont_fix\n2. Determine if it can be auto-resolved (has suggestion block, is simple fix, etc.)\n3. Suggest the action needed if unaddressed\n\nReturn analysis for each item by ID.`,\n    });\n\n    return feedback.map((item) => {\n      const analysis = object.items.find((a) => a.id === item.id);\n      if (analysis) {\n        return {\n          ...item,\n          status: analysis.status,\n          isAutoResolvable: analysis.isAutoResolvable,\n          suggestedAction: analysis.suggestedAction,\n        };\n      }\n      return item;\n    });\n  }\n\n  private async identifyBlockers(\n    pr: { mergeable: boolean | null; mergeable_state: string },\n    ci: CIStatus,\n    unaddressedFeedback: FeedbackItem[]\n  ): Promise<Blocker[]> {\n    const blockers: Blocker[] = [];\n\n    // CI failures\n    for (const failure of ci.failures) {\n      blockers.push({\n        type: 'ci_failure',\n        description: `CI check \"${failure.name}\" failed`,\n        isAutoResolvable: true,\n        suggestedFix: `Analyze failure logs at ${failure.url} and fix the issue`,\n        url: failure.url,\n        resolved: false,\n      });\n    }\n\n    // Unaddressed critical/high feedback\n    const criticalFeedback = unaddressedFeedback.filter(\n      (f) => f.severity === 'critical' || f.severity === 'high'\n    );\n    if (criticalFeedback.length > 0) {\n      blockers.push({\n        type: 'review_feedback',\n        description: `${criticalFeedback.length} critical/high severity feedback items unaddressed`,\n        isAutoResolvable: criticalFeedback.some((f) => f.isAutoResolvable),\n        suggestedFix: 'Address each feedback item with a fix or justified response',\n        url: null,\n        resolved: false,\n      });\n    }\n\n    // Merge conflicts\n    if (pr.mergeable === false && pr.mergeable_state === 'dirty') {\n      blockers.push({\n        type: 'merge_conflict',\n        description: 'PR has merge conflicts that must be resolved',\n        isAutoResolvable: false,\n        suggestedFix: 'Rebase or merge main branch and resolve conflicts',\n        url: null,\n        resolved: false,\n      });\n    }\n\n    // Branch protection\n    if (pr.mergeable_state === 'blocked') {\n      blockers.push({\n        type: 'branch_protection',\n        description: 'Branch protection rules prevent merge',\n        isAutoResolvable: false,\n        suggestedFix: 'Ensure all required checks pass and approvals are obtained',\n        url: null,\n        resolved: false,\n      });\n    }\n\n    return blockers;\n  }\n\n  private determineStatus(\n    pr: { merged: boolean; state: string },\n    ci: CIStatus,\n    blockers: Blocker[],\n    unaddressedFeedback: FeedbackItem[]\n  ): PRStatus {\n    if (pr.merged) return 'merged';\n    if (pr.state === 'closed') return 'closed';\n\n    const hardBlockers = blockers.filter((b) => !b.isAutoResolvable);\n    if (hardBlockers.length > 0) return 'blocked';\n\n    if (ci.anyPending) return 'needs_ci';\n\n    if (ci.failures.length > 0 || unaddressedFeedback.length > 0) {\n      return 'needs_work';\n    }\n\n    if (ci.allPassing && unaddressedFeedback.length === 0) {\n      return 'ready_to_merge';\n    }\n\n    return 'needs_review';\n  }\n\n  private generateNextActions(\n    status: PRStatus,\n    blockers: Blocker[],\n    unaddressedFeedback: FeedbackItem[]\n  ): TriageResult['nextActions'] {\n    const actions: TriageResult['nextActions'] = [];\n\n    if (status === 'needs_work') {\n      const ciBlockers = blockers.filter((b) => b.type === 'ci_failure');\n      for (const blocker of ciBlockers) {\n        actions.push({\n          action: `Fix CI failure: ${blocker.description}`,\n          priority: 'critical',\n          automated: true,\n          reason: 'CI must pass before merge',\n        });\n      }\n\n      for (const feedback of unaddressedFeedback) {\n        actions.push({\n          action: feedback.isAutoResolvable\n            ? `Auto-fix: ${feedback.suggestedAction ?? feedback.body.slice(0, 100)}`\n            : `Address feedback from ${feedback.author}: ${feedback.body.slice(0, 100)}`,\n          priority: feedback.severity,\n          automated: feedback.isAutoResolvable,\n          reason: `${feedback.severity} severity feedback requires resolution`,\n        });\n      }\n    }\n\n    if (status === 'needs_review') {\n      actions.push({\n        action: 'Request AI reviews: /gemini review, /q review',\n        priority: 'high',\n        automated: true,\n        reason: 'AI review required before merge',\n      });\n    }\n\n    if (status === 'ready_to_merge') {\n      actions.push({\n        action: 'Merge PR',\n        priority: 'high',\n        automated: false,\n        reason: 'All checks pass and feedback addressed',\n      });\n    }\n\n    return actions;\n  }\n\n  private async generatePRSummary(\n    pr: { title: string },\n    ci: CIStatus,\n    blockers: Blocker[],\n    unaddressedFeedback: FeedbackItem[]\n  ): Promise<string> {\n    const { text } = await generateText({\n      model: (await this.getModel()) as Parameters<typeof generateText>[0]['model'],\n      prompt: `Generate a concise summary of this PR's triage status.\n\nPR: ${pr.title}\nCI: ${ci.allPassing ? ' All passing' : ci.anyPending ? ' Pending' : ` ${ci.failures.length} failures`}\nBlockers: ${blockers.length > 0 ? blockers.map((b) => b.description).join(', ') : 'None'}\nUnaddressed feedback: ${unaddressedFeedback.length} items\n\nWrite 2-3 sentences summarizing the current state and what needs to happen next.`,\n    });\n\n    return text;\n  }\n}\n\n// ============================================\n// Legacy Aliases for backwards compatibility\n// ============================================\n\n/** @deprecated Use Analyzer instead */\nexport { Analyzer as AIAnalyzer };\nexport type { AnalyzerOptions as AIAnalyzerOptions };\n","/**\n * Docker container lifecycle management\n */\n\nimport { randomUUID } from 'node:crypto';\nimport { safeDockerCommand, safeSpawn } from '../core/subprocess.js';\nimport type { ContainerConfig, ContainerResult } from './types.js';\n\nexport class ContainerManager {\n  async create(config: ContainerConfig): Promise<string> {\n    const containerId = `agentic-sandbox-${randomUUID().slice(0, 8)}`;\n\n    const dockerArgs = [\n      'create',\n      '--name',\n      containerId,\n      '--rm',\n      '--workdir',\n      '/workspace',\n      '-v',\n      `${config.workspace}:/workspace:ro`,\n      '-v',\n      `${config.outputDir}:/output`,\n    ];\n\n    // Add memory limit if specified\n    if (config.memory) {\n      dockerArgs.push('-m', `${config.memory}m`);\n    }\n\n    // Add environment variables\n    if (config.env) {\n      for (const [key, value] of Object.entries(config.env)) {\n        dockerArgs.push('-e', `${key}=${value}`);\n      }\n    }\n\n    // Use the appropriate image based on runtime\n    const image = this.getImageForRuntime(config.runtime);\n    dockerArgs.push(image);\n\n    const result = safeDockerCommand(dockerArgs);\n    if (!result.success) {\n      throw new Error(`Failed to create container: ${result.stderr}`);\n    }\n\n    return containerId;\n  }\n\n  async start(containerId: string): Promise<void> {\n    const result = safeDockerCommand(['start', containerId]);\n    if (!result.success) {\n      throw new Error(`Failed to start container ${containerId}: ${result.stderr}`);\n    }\n  }\n\n  async stop(containerId: string): Promise<void> {\n    const result = safeDockerCommand(['stop', containerId]);\n    if (!result.success) {\n      // Container might already be stopped, which is fine\n      console.warn(`Warning: Could not stop container ${containerId}: ${result.stderr}`);\n    }\n  }\n\n  async remove(containerId: string): Promise<void> {\n    const result = safeDockerCommand(['rm', '-f', containerId]);\n    if (!result.success) {\n      // Container might already be removed, which is fine\n      console.warn(`Warning: Could not remove container ${containerId}: ${result.stderr}`);\n    }\n  }\n\n  async exec(containerId: string, command: string[]): Promise<ContainerResult> {\n    const startTime = Date.now();\n\n    const dockerArgs = ['exec', containerId, ...command];\n\n    try {\n      const result = await safeSpawn('docker', dockerArgs);\n      const duration = Date.now() - startTime;\n\n      return {\n        success: result.success,\n        output: result.stdout,\n        error: result.stderr,\n        exitCode: result.code || 0,\n        duration,\n      };\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        exitCode: 1,\n        duration,\n      };\n    }\n  }\n\n  async logs(containerId: string): Promise<string> {\n    const result = safeDockerCommand(['logs', containerId]);\n    if (!result.success) {\n      throw new Error(`Failed to get logs for container ${containerId}: ${result.stderr}`);\n    }\n    return result.stdout;\n  }\n\n  private getImageForRuntime(runtime: string): string {\n    switch (runtime) {\n      case 'claude':\n      case 'cursor':\n        return 'jbcom/agentic-control:latest';\n      case 'custom':\n        return 'jbcom/agentic-control:latest';\n      default:\n        return 'jbcom/agentic-control:latest';\n    }\n  }\n}\n","/**\n * Claude runtime adapter for sandbox execution\n */\n\nimport type { AgentOutput, RuntimeAdapter, RuntimeOptions } from '../types.js';\n\nexport class ClaudeRuntime implements RuntimeAdapter {\n  readonly name = 'claude';\n  readonly image = 'jbcom/agentic-control:latest';\n\n  prepareCommand(prompt: string, options: RuntimeOptions): string[] {\n    const command = ['npx', '@anthropic-ai/claude-agent-sdk', 'query', '--prompt', prompt];\n\n    if (options.timeout) {\n      command.push('--timeout', options.timeout.toString());\n    }\n\n    return command;\n  }\n\n  parseOutput(stdout: string, stderr: string): AgentOutput {\n    try {\n      // Try to parse as JSON first\n      const parsed = JSON.parse(stdout);\n      return {\n        result: parsed.result || stdout,\n        files: parsed.files || [],\n        error: stderr || parsed.error,\n      };\n    } catch {\n      // Fallback to plain text\n      return {\n        result: stdout,\n        files: [],\n        error: stderr,\n      };\n    }\n  }\n\n  async validateEnvironment(): Promise<boolean> {\n    return !!process.env.ANTHROPIC_API_KEY;\n  }\n}\n","/**\n * Cursor runtime adapter for sandbox execution\n */\n\nimport type { AgentOutput, RuntimeAdapter, RuntimeOptions } from '../types.js';\n\nexport class CursorRuntime implements RuntimeAdapter {\n  readonly name = 'cursor';\n  readonly image = 'jbcom/agentic-control:latest';\n\n  prepareCommand(prompt: string, options: RuntimeOptions): string[] {\n    const command = ['cursor-agent', 'run', '--task', prompt];\n\n    if (options.timeout) {\n      command.push('--timeout', options.timeout.toString());\n    }\n\n    return command;\n  }\n\n  parseOutput(stdout: string, stderr: string): AgentOutput {\n    try {\n      // Try to parse as JSON first\n      const parsed = JSON.parse(stdout);\n      return {\n        result: parsed.result || stdout,\n        files: parsed.files || [],\n        error: stderr || parsed.error,\n      };\n    } catch {\n      // Fallback to plain text\n      return {\n        result: stdout,\n        files: [],\n        error: stderr,\n      };\n    }\n  }\n\n  async validateEnvironment(): Promise<boolean> {\n    return !!process.env.CURSOR_API_KEY;\n  }\n}\n","/**\n * Runtime adapters for different AI agent types\n */\n\nexport { ClaudeRuntime } from './claude.js';\nexport { CursorRuntime } from './cursor.js';\n","/**\n * Main sandbox executor for running AI agents in containers\n */\n\nimport { ContainerManager } from './container.js';\nimport { ClaudeRuntime, CursorRuntime } from './runtime/index.js';\nimport type { ContainerResult, RuntimeAdapter, SandboxOptions } from './types.js';\n\nexport class SandboxExecutor {\n  private containerManager: ContainerManager;\n  private runtimes: Map<string, RuntimeAdapter>;\n\n  constructor() {\n    this.containerManager = new ContainerManager();\n    this.runtimes = new Map<string, RuntimeAdapter>([\n      ['claude', new ClaudeRuntime()],\n      ['cursor', new CursorRuntime()],\n    ]);\n  }\n\n  async execute(options: SandboxOptions): Promise<ContainerResult> {\n    const runtime = this.runtimes.get(options.runtime);\n    if (!runtime) {\n      throw new Error(`Unknown runtime: ${options.runtime}`);\n    }\n\n    // Validate environment\n    const isValid = await runtime.validateEnvironment();\n    if (!isValid) {\n      throw new Error(`Environment validation failed for runtime: ${options.runtime}`);\n    }\n\n    const containerId = await this.containerManager.create({\n      runtime: options.runtime,\n      workspace: options.workspace,\n      outputDir: options.outputDir,\n      memory: options.memory,\n      timeout: options.timeout,\n      env: options.env,\n    });\n\n    try {\n      await this.containerManager.start(containerId);\n      const command = runtime.prepareCommand(options.prompt, {\n        timeout: options.timeout,\n        memory: options.memory,\n        env: options.env,\n      });\n\n      const result = await this.containerManager.exec(containerId, command);\n\n      // Parse the output using the runtime adapter\n      if (result.success && result.output) {\n        const parsed = runtime.parseOutput(result.output, result.error || '');\n        return {\n          ...result,\n          output: JSON.stringify(parsed),\n        };\n      }\n\n      return result;\n    } finally {\n      await this.containerManager.stop(containerId);\n      await this.containerManager.remove(containerId);\n    }\n  }\n\n  async executeFleet(options: SandboxOptions[]): Promise<ContainerResult[]> {\n    // Execute all sandboxes in parallel\n    const promises = options.map((option) => this.execute(option));\n    return Promise.all(promises);\n  }\n}\n","/**\n * Sandbox execution module for running AI agents in isolated Docker containers\n */\n\nexport { ContainerManager } from './container.js';\nexport { SandboxExecutor } from './executor.js';\nexport { ClaudeRuntime, CursorRuntime } from './runtime/index.js';\nexport type {\n  AgentOutput,\n  ContainerConfig,\n  ContainerResult,\n  RuntimeAdapter,\n  RuntimeOptions,\n  SandboxOptions,\n} from './types.js';\n","import { existsSync } from 'node:fs';\nimport { writeFile } from 'node:fs/promises';\nimport { anthropic } from '@ai-sdk/anthropic';\nimport { generateText } from 'ai';\nimport { type SimpleGit, simpleGit } from 'simple-git';\nimport type { GitHubClient } from '../github/client.js';\nimport type { ActionResult, Blocker, FeedbackItem, TriageResult } from './types.js';\n\nexport interface ResolverConfig {\n  workingDirectory: string;\n  dryRun?: boolean;\n}\n\nexport class Resolver {\n  private model = anthropic('claude-sonnet-4-20250514');\n  private config: ResolverConfig;\n  private git: SimpleGit;\n\n  constructor(config: ResolverConfig) {\n    this.config = config;\n    this.git = simpleGit(config.workingDirectory);\n  }\n\n  // ==========================================================================\n  // Main Resolution Methods\n  // ==========================================================================\n\n  async resolveBlockers(github: GitHubClient, triage: TriageResult): Promise<ActionResult[]> {\n    const results: ActionResult[] = [];\n\n    for (const blocker of triage.blockers) {\n      if (!blocker.isAutoResolvable) {\n        results.push({\n          success: false,\n          action: `Resolve ${blocker.type}`,\n          description: blocker.description,\n          error: 'Blocker requires human intervention',\n          changes: null,\n          commitSha: null,\n        });\n        continue;\n      }\n\n      const result = await this.resolveBlocker(github, triage.prNumber, blocker);\n      results.push(result);\n    }\n\n    return results;\n  }\n\n  async resolveFeedback(github: GitHubClient, triage: TriageResult): Promise<ActionResult[]> {\n    const results: ActionResult[] = [];\n    const unaddressed = triage.feedback.items.filter((f) => f.status === 'unaddressed');\n\n    for (const feedback of unaddressed) {\n      const result = await this.resolveFeedbackItem(github, triage.prNumber, feedback, {\n        prTitle: triage.prTitle,\n      });\n      results.push(result);\n    }\n\n    return results;\n  }\n\n  // ==========================================================================\n  // Blocker Resolution\n  // ==========================================================================\n\n  private async resolveBlocker(\n    github: GitHubClient,\n    prNumber: number,\n    blocker: Blocker\n  ): Promise<ActionResult> {\n    switch (blocker.type) {\n      case 'ci_failure':\n        return this.fixCIFailure(github, prNumber, blocker);\n      case 'review_feedback':\n        // This is handled by resolveFeedback\n        return {\n          success: true,\n          action: 'Resolve review feedback',\n          description: 'Handled by feedback resolver',\n          error: null,\n          changes: null,\n          commitSha: null,\n        };\n      default:\n        return {\n          success: false,\n          action: `Resolve ${blocker.type}`,\n          description: blocker.description,\n          error: `Cannot auto-resolve blocker type: ${blocker.type}`,\n          changes: null,\n          commitSha: null,\n        };\n    }\n  }\n\n  private async fixCIFailure(\n    github: GitHubClient,\n    prNumber: number,\n    blocker: Blocker\n  ): Promise<ActionResult> {\n    try {\n      // Get failure details\n      const ciUrl = blocker.url;\n      if (!ciUrl) {\n        return {\n          success: false,\n          action: 'Fix CI failure',\n          description: blocker.description,\n          error: 'No CI URL available to analyze',\n          changes: null,\n          commitSha: null,\n        };\n      }\n\n      // Use AI to analyze the failure and generate a fix\n      const { text: analysis } = await generateText({\n        model: this.model,\n        prompt: `Analyze this CI failure and suggest a fix.\n\nCI Failure: ${blocker.description}\nURL: ${ciUrl}\n\nBased on common CI failure patterns, what is likely wrong and how should it be fixed?\nBe specific about which files to change and what changes to make.`,\n      });\n\n      // For now, we'll report the analysis rather than auto-applying\n      // Full implementation would use bash/textEditor tools to apply fixes\n      await github.postComment(\n        prNumber,\n        `## CI Failure Analysis\\n\\n${analysis}\\n\\n_Auto-generated by ai-triage_`\n      );\n\n      return {\n        success: true,\n        action: 'Analyze CI failure',\n        description: `Posted analysis for: ${blocker.description}`,\n        error: null,\n        changes: null,\n        commitSha: null,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        action: 'Fix CI failure',\n        description: blocker.description,\n        error: error instanceof Error ? error.message : String(error),\n        changes: null,\n        commitSha: null,\n      };\n    }\n  }\n\n  // ==========================================================================\n  // Feedback Resolution\n  // ==========================================================================\n\n  private async resolveFeedbackItem(\n    github: GitHubClient,\n    prNumber: number,\n    feedback: FeedbackItem,\n    context: { prTitle: string }\n  ): Promise<ActionResult> {\n    try {\n      // Check if there's a suggestion block we can apply directly\n      if (feedback.suggestedAction && feedback.path) {\n        return this.applySuggestion(github, prNumber, feedback);\n      }\n\n      // Generate a response (fix or justification)\n      const response = await this.generateResponse(feedback, context);\n\n      if (response.type === 'fix' && feedback.path) {\n        // Apply the fix to the file\n        return this.applyFix(github, prNumber, feedback, response.content);\n      } else {\n        // Post a justification comment\n        return this.postJustification(github, prNumber, feedback, response.content);\n      }\n    } catch (error) {\n      return {\n        success: false,\n        action: `Address feedback ${feedback.id}`,\n        description: feedback.body.slice(0, 100),\n        error: error instanceof Error ? error.message : String(error),\n        changes: null,\n        commitSha: null,\n      };\n    }\n  }\n\n  private async applySuggestion(\n    _github: GitHubClient,\n    _prNumber: number,\n    feedback: FeedbackItem\n  ): Promise<ActionResult> {\n    if (!feedback.path || !feedback.suggestedAction) {\n      return {\n        success: false,\n        action: 'Apply suggestion',\n        description: 'Missing path or suggestion',\n        error: 'Cannot apply suggestion without file path and content',\n        changes: null,\n        commitSha: null,\n      };\n    }\n\n    const filePath = `${this.config.workingDirectory}/${feedback.path}`;\n\n    if (!existsSync(filePath)) {\n      return {\n        success: false,\n        action: 'Apply suggestion',\n        description: `File not found: ${feedback.path}`,\n        error: 'Target file does not exist',\n        changes: null,\n        commitSha: null,\n      };\n    }\n\n    if (this.config.dryRun) {\n      return {\n        success: true,\n        action: 'Apply suggestion (dry run)',\n        description: `Would apply suggestion to ${feedback.path}`,\n        error: null,\n        changes: [{ file: feedback.path, type: 'modified' }],\n        commitSha: null,\n      };\n    }\n\n    // Read file, apply suggestion, write back\n    // This is simplified - full implementation would handle line-specific changes\n    // Apply the suggestion by replacing the file content with the suggestedAction\n    const newContent = feedback.suggestedAction;\n\n    await writeFile(filePath, newContent, 'utf-8');\n\n    return {\n      success: true,\n      action: 'Apply suggestion',\n      description: `Applied suggestion to ${feedback.path}`,\n      error: null,\n      changes: [{ file: feedback.path, type: 'modified' }],\n      commitSha: null,\n    };\n  }\n\n  private async generateResponse(\n    feedback: FeedbackItem,\n    context: { prTitle: string }\n  ): Promise<{ type: 'fix' | 'justification'; content: string }> {\n    const { text } = await generateText({\n      model: this.model,\n      prompt: `Determine how to respond to this PR feedback.\n\nPR: ${context.prTitle}\n\nFeedback from ${feedback.author} (${feedback.severity} severity):\n${feedback.body}\n\n${feedback.path ? `File: ${feedback.path}` : ''}\n\nShould this be fixed or justified? If fixed, what's the fix? If justified, what's the reasoning?\n\nRespond in this format:\nTYPE: fix OR justification\nCONTENT: <the fix code or justification text>`,\n    });\n\n    const typeMatch = text.match(/TYPE:\\s*(fix|justification)/i);\n    const contentMatch = text.match(/CONTENT:\\s*([\\s\\S]+)/i);\n\n    return {\n      type: (typeMatch?.[1]?.toLowerCase() as 'fix' | 'justification') ?? 'justification',\n      content: contentMatch?.[1]?.trim() ?? text,\n    };\n  }\n\n  private async applyFix(\n    github: GitHubClient,\n    prNumber: number,\n    feedback: FeedbackItem,\n    fix: string\n  ): Promise<ActionResult> {\n    if (!feedback.path) {\n      return {\n        success: false,\n        action: 'Apply fix',\n        description: 'No file path for fix',\n        error: 'Cannot apply fix without target file',\n        changes: null,\n        commitSha: null,\n      };\n    }\n\n    if (this.config.dryRun) {\n      return {\n        success: true,\n        action: 'Apply fix (dry run)',\n        description: `Would apply fix to ${feedback.path}`,\n        error: null,\n        changes: [{ file: feedback.path, type: 'modified' }],\n        commitSha: null,\n      };\n    }\n\n    // Apply the fix - post as comment for human review\n    try {\n      // For now, post the fix as a comment for human review\n      await github.postComment(\n        prNumber,\n        `## Suggested Fix for ${feedback.path}\\n\\n\\`\\`\\`\\n${fix}\\n\\`\\`\\`\\n\\n_Responding to feedback from ${feedback.author}_`\n      );\n\n      return {\n        success: true,\n        action: 'Suggest fix',\n        description: `Posted fix suggestion for ${feedback.path}`,\n        error: null,\n        changes: null,\n        commitSha: null,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        action: 'Apply fix',\n        description: `Failed to apply fix to ${feedback.path}`,\n        error: error instanceof Error ? error.message : String(error),\n        changes: null,\n        commitSha: null,\n      };\n    }\n  }\n\n  private async postJustification(\n    github: GitHubClient,\n    prNumber: number,\n    feedback: FeedbackItem,\n    justification: string\n  ): Promise<ActionResult> {\n    try {\n      // Extract comment ID if possible\n      const commentIdMatch = feedback.id.match(/comment-(\\d+)/);\n      const commentId = commentIdMatch?.[1];\n      if (commentId) {\n        await github.replyToComment(prNumber, Number.parseInt(commentId, 10), justification);\n      } else {\n        await github.postComment(prNumber, `Re: ${feedback.author}'s feedback\\n\\n${justification}`);\n      }\n\n      return {\n        success: true,\n        action: 'Post justification',\n        description: `Responded to ${feedback.author}'s feedback`,\n        error: null,\n        changes: null,\n        commitSha: null,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        action: 'Post justification',\n        description: `Failed to respond to ${feedback.author}`,\n        error: error instanceof Error ? error.message : String(error),\n        changes: null,\n        commitSha: null,\n      };\n    }\n  }\n\n  // ==========================================================================\n  // Git Operations\n  // ==========================================================================\n\n  async commitAndPush(message: string): Promise<ActionResult> {\n    if (this.config.dryRun) {\n      return {\n        success: true,\n        action: 'Commit and push (dry run)',\n        description: `Would commit: ${message}`,\n        error: null,\n        changes: null,\n        commitSha: null,\n      };\n    }\n\n    try {\n      // Use simple-git for safe git operations (no shell injection)\n      await this.git.add('-A');\n      await this.git.commit(message);\n      const commitSha = await this.git.revparse(['HEAD']);\n      await this.git.push();\n\n      return {\n        success: true,\n        action: 'Commit and push',\n        description: message,\n        error: null,\n        changes: null,\n        commitSha: commitSha.trim(),\n      };\n    } catch (error) {\n      return {\n        success: false,\n        action: 'Commit and push',\n        description: message,\n        error: error instanceof Error ? error.message : String(error),\n        changes: null,\n        commitSha: null,\n      };\n    }\n  }\n\n  /**\n   * Get current git status\n   */\n  async getStatus(): Promise<{ modified: string[]; staged: string[]; untracked: string[] }> {\n    const status = await this.git.status();\n    return {\n      modified: status.modified,\n      staged: status.staged,\n      untracked: status.not_added,\n    };\n  }\n\n  /**\n   * Get diff for files\n   */\n  async getDiff(staged = false): Promise<string> {\n    if (staged) {\n      return this.git.diff(['--cached']);\n    }\n    return this.git.diff();\n  }\n}\n","import { GitHubClient, type GitHubConfig } from '../github/client.js';\nimport { Analyzer } from './analyzer.js';\nimport { Resolver, type ResolverConfig } from './resolver.js';\nimport type { ActionResult, ResolutionPlan, TriageResult } from './types.js';\n\nexport interface TriageConfig {\n  github: GitHubConfig;\n  resolver: ResolverConfig;\n}\n\nexport class Triage {\n  private github: GitHubClient;\n  private analyzer: Analyzer;\n  private resolver: Resolver;\n\n  constructor(config: TriageConfig) {\n    this.github = new GitHubClient(config.github);\n    this.analyzer = new Analyzer();\n    this.resolver = new Resolver(config.resolver);\n  }\n\n  // ==========================================================================\n  // Analysis\n  // ==========================================================================\n\n  /**\n   * Analyze a PR and return its current triage status\n   */\n  async analyze(prNumber: number): Promise<TriageResult> {\n    return this.analyzer.analyzePR(this.github, prNumber);\n  }\n\n  // ==========================================================================\n  // Resolution\n  // ==========================================================================\n\n  /**\n   * Resolve all auto-resolvable blockers and feedback\n   */\n  async resolve(prNumber: number): Promise<{\n    triage: TriageResult;\n    actions: ActionResult[];\n  }> {\n    const triage = await this.analyze(prNumber);\n    const actions: ActionResult[] = [];\n\n    // Resolve blockers first\n    const blockerResults = await this.resolver.resolveBlockers(this.github, triage);\n    actions.push(...blockerResults);\n\n    // Then resolve feedback\n    const feedbackResults = await this.resolver.resolveFeedback(this.github, triage);\n    actions.push(...feedbackResults);\n\n    // Re-analyze after resolution\n    const updatedTriage = await this.analyze(prNumber);\n\n    return {\n      triage: updatedTriage,\n      actions,\n    };\n  }\n\n  /**\n   * Generate a plan for resolving all issues without executing\n   */\n  async plan(prNumber: number): Promise<ResolutionPlan> {\n    const triage = await this.analyze(prNumber);\n    const steps: ResolutionPlan['steps'] = [];\n    let order = 1;\n\n    // CI failures first\n    for (const blocker of triage.blockers.filter((b) => b.type === 'ci_failure')) {\n      steps.push({\n        order: order++,\n        action: 'Fix CI failure',\n        description: blocker.description,\n        automated: blocker.isAutoResolvable,\n        estimatedDuration: '5-10 minutes',\n        dependencies: [],\n      });\n    }\n\n    // Then feedback\n    const feedbackStep = order;\n    const unaddressed = triage.feedback.items.filter((f) => f.status === 'unaddressed');\n    if (unaddressed.length > 0) {\n      steps.push({\n        order: order++,\n        action: 'Address feedback',\n        description: `${unaddressed.length} feedback items to address`,\n        automated: unaddressed.every((f) => f.isAutoResolvable),\n        estimatedDuration: `${unaddressed.length * 2}-${unaddressed.length * 5} minutes`,\n        dependencies: steps.filter((s) => s.action === 'Fix CI failure').map((s) => s.order),\n      });\n    }\n\n    // Request re-review if needed\n    if (steps.length > 0) {\n      steps.push({\n        order: order++,\n        action: 'Request re-review',\n        description: 'Request AI reviewers to re-review changes',\n        automated: true,\n        estimatedDuration: '1-5 minutes',\n        dependencies: [feedbackStep],\n      });\n    }\n\n    // Wait for CI\n    steps.push({\n      order: order++,\n      action: 'Wait for CI',\n      description: 'Wait for all CI checks to complete',\n      automated: true,\n      estimatedDuration: '5-15 minutes',\n      dependencies: steps.map((s) => s.order),\n    });\n\n    // Final merge\n    steps.push({\n      order: order++,\n      action: 'Merge PR',\n      description: 'Merge the PR once all checks pass',\n      automated: false, // Requires explicit approval\n      estimatedDuration: '1 minute',\n      dependencies: [order - 1],\n    });\n\n    const hasHumanStep = steps.some((s) => !s.automated);\n\n    return {\n      prNumber,\n      steps,\n      estimatedTotalDuration: '15-30 minutes',\n      requiresHumanIntervention: hasHumanStep,\n      humanInterventionReason: hasHumanStep ? 'Some steps require manual review or approval' : null,\n    };\n  }\n\n  // ==========================================================================\n  // Workflows\n  // ==========================================================================\n\n  /**\n   * Run the full workflow until PR is ready to merge\n   */\n  async runUntilReady(\n    prNumber: number,\n    options: {\n      maxIterations?: number;\n      onProgress?: (triage: TriageResult, iteration: number) => void;\n    } = {}\n  ): Promise<{\n    success: boolean;\n    finalTriage: TriageResult;\n    iterations: number;\n    allActions: ActionResult[];\n  }> {\n    const maxIterations = options.maxIterations ?? 10;\n    const allActions: ActionResult[] = [];\n    let iteration = 0;\n\n    while (iteration < maxIterations) {\n      iteration++;\n\n      const triage = await this.analyze(prNumber);\n      options.onProgress?.(triage, iteration);\n\n      if (triage.status === 'ready_to_merge') {\n        return {\n          success: true,\n          finalTriage: triage,\n          iterations: iteration,\n          allActions,\n        };\n      }\n\n      if (triage.status === 'blocked') {\n        return {\n          success: false,\n          finalTriage: triage,\n          iterations: iteration,\n          allActions,\n        };\n      }\n\n      if (triage.status === 'needs_ci') {\n        // Wait for CI to complete\n        await this.waitForCI(prNumber);\n        continue;\n      }\n\n      // Resolve what we can\n      const { actions } = await this.resolve(prNumber);\n      allActions.push(...actions);\n\n      // If no actions were successful, we're stuck\n      const successfulActions = actions.filter((a) => a.success);\n      if (successfulActions.length === 0) {\n        return {\n          success: false,\n          finalTriage: triage,\n          iterations: iteration,\n          allActions,\n        };\n      }\n\n      // Commit any changes\n      const hasChanges = actions.some((a) => a.changes && a.changes.length > 0);\n      if (hasChanges) {\n        await this.resolver.commitAndPush(`fix: address feedback (iteration ${iteration})`);\n      }\n\n      // Small delay before next iteration\n      await new Promise((resolve) => setTimeout(resolve, 5000));\n    }\n\n    const finalTriage = await this.analyze(prNumber);\n    return {\n      success: finalTriage.status === 'ready_to_merge',\n      finalTriage,\n      iterations: iteration,\n      allActions,\n    };\n  }\n\n  private async waitForCI(prNumber: number, timeoutMs = 600000): Promise<void> {\n    const startTime = Date.now();\n    const pollInterval = 30000; // 30 seconds\n\n    while (Date.now() - startTime < timeoutMs) {\n      const ci = await this.github.getCIStatus(prNumber);\n      if (!ci.anyPending) {\n        return;\n      }\n      await new Promise((resolve) => setTimeout(resolve, pollInterval));\n    }\n\n    throw new Error('CI timeout exceeded');\n  }\n\n  // ==========================================================================\n  // Review Requests\n  // ==========================================================================\n\n  async requestReviews(prNumber: number): Promise<void> {\n    // Post review request commands as comments\n    const reviewCommands = ['/gemini review', '/q review'];\n    for (const command of reviewCommands) {\n      await this.github.postComment(prNumber, command);\n    }\n  }\n\n  // ==========================================================================\n  // Reporting\n  // ==========================================================================\n\n  formatTriageReport(triage: TriageResult): string {\n    const lines: string[] = [];\n\n    lines.push(`# Triage Report: PR #${triage.prNumber}`);\n    lines.push('');\n    lines.push(`**Title:** ${triage.prTitle}`);\n    lines.push(`**Status:** ${triage.status}`);\n    lines.push(`**URL:** ${triage.prUrl}`);\n    lines.push('');\n\n    lines.push('## CI Status');\n    lines.push(triage.ci.allPassing ? ' All checks passing' : '');\n    lines.push(triage.ci.anyPending ? ' Checks pending' : '');\n    if (triage.ci.failures.length > 0) {\n      lines.push(` ${triage.ci.failures.length} failing checks:`);\n      for (const failure of triage.ci.failures) {\n        lines.push(`  - ${failure.name}: ${failure.url}`);\n      }\n    }\n    lines.push('');\n\n    lines.push('## Feedback');\n    lines.push(`Total: ${triage.feedback.total} | Unaddressed: ${triage.feedback.unaddressed}`);\n    if (triage.feedback.unaddressed > 0) {\n      lines.push('');\n      lines.push('### Unaddressed Items:');\n      for (const item of triage.feedback.items.filter((f) => f.status === 'unaddressed')) {\n        lines.push(`- **${item.severity}** from ${item.author}: ${item.body.slice(0, 100)}...`);\n        if (item.isAutoResolvable) {\n          lines.push(`  -  Auto-resolvable`);\n        }\n      }\n    }\n    lines.push('');\n\n    lines.push('## Blockers');\n    if (triage.blockers.length === 0) {\n      lines.push('None');\n    } else {\n      for (const blocker of triage.blockers) {\n        lines.push(`- **${blocker.type}**: ${blocker.description}`);\n        lines.push(`  - Auto-resolvable: ${blocker.isAutoResolvable ? 'Yes' : 'No'}`);\n      }\n    }\n    lines.push('');\n\n    lines.push('## Next Actions');\n    for (const action of triage.nextActions) {\n      const icon = action.automated ? '' : '';\n      lines.push(`${icon} [${action.priority}] ${action.action}`);\n    }\n    lines.push('');\n\n    lines.push('## Summary');\n    lines.push(triage.summary);\n    lines.push('');\n\n    lines.push(`_Generated: ${triage.timestamp}_`);\n\n    return lines.join('\\n');\n  }\n}\n","#!/usr/bin/env node\n\n/**\n * agentic-control CLI\n *\n * Unified command-line interface for AI agent fleet management,\n * triage, and orchestration across multiple GitHub organizations.\n *\n * All configuration is user-provided - no hardcoded values.\n */\n\nimport { existsSync, writeFileSync } from 'node:fs';\nimport { Command, InvalidArgumentError, Option } from 'commander';\nimport { getConfig, getDefaultModel, getFleetDefaults, initConfig } from './core/config.js';\nimport { safeGitCommand } from './core/subprocess.js';\nimport {\n  extractOrg,\n  getConfiguredOrgs,\n  getTokenForRepo,\n  getTokenSummary,\n  validateTokens,\n} from './core/tokens.js';\nimport type { Agent, Result } from './core/types.js';\nimport { Fleet } from './fleet/index.js';\nimport { HandoffManager } from './handoff/index.js';\nimport { VERSION } from './index.js';\nimport {\n  DEFAULT_ROLES,\n  executeSageRole,\n  findRoleByTrigger,\n  getDefaultRoleIds,\n  getEffectiveRole,\n  listRoles,\n} from './roles/index.js';\nimport { AIAnalyzer } from './triage/index.js';\n\nconst program = new Command();\n\nprogram\n  .name('agentic')\n  .description('Unified AI agent fleet management, triage, and orchestration')\n  .version(VERSION);\n\n// ============================================\n// CLI Argument Validators\n// ============================================\n\n/**\n * Parse and validate an integer argument\n */\nfunction parsePositiveInt(value: string, name: string): number {\n  const parsed = Number.parseInt(value, 10);\n  if (Number.isNaN(parsed) || parsed <= 0) {\n    throw new InvalidArgumentError(`${name} must be a positive integer`);\n  }\n  return parsed;\n}\n\n/**\n * Validate git ref format (alphanumeric, hyphens, underscores, slashes, dots)\n */\nfunction validateGitRef(ref: string): string {\n  if (!/^[a-zA-Z0-9._/-]+$/.test(ref)) {\n    throw new InvalidArgumentError('Invalid git ref format');\n  }\n  if (ref.length > 200) {\n    throw new InvalidArgumentError('Git ref too long (max 200 characters)');\n  }\n  return ref;\n}\n\n/**\n * Validate branch name\n */\nfunction validateBranchName(branch: string): string {\n  if (!/^[a-zA-Z0-9._/-]+$/.test(branch)) {\n    throw new InvalidArgumentError('Invalid branch name format');\n  }\n  if (branch.length > 200) {\n    throw new InvalidArgumentError('Branch name too long (max 200 characters)');\n  }\n  return branch;\n}\n\n// ============================================\n// Helper Functions\n// ============================================\n\nfunction output(data: unknown, json: boolean): void {\n  if (json) {\n    console.log(JSON.stringify(data, null, 2));\n  } else {\n    console.log(data);\n  }\n}\n\nfunction formatAgent(agent: Agent): string {\n  const status = agent.status.padEnd(10);\n  const id = agent.id.padEnd(40);\n  const repo = (agent.source?.repository?.split('/').pop() ?? '?').padEnd(25);\n  const name = (agent.name ?? '').slice(0, 40);\n  return `${status} ${id} ${repo} ${name}`;\n}\n\n// ============================================\n// Token Commands\n// ============================================\n\nconst tokensCmd = program\n  .command('tokens')\n  .description('Manage GitHub tokens for multi-org access');\n\ntokensCmd\n  .command('status')\n  .description('Show token availability status')\n  .option('--json', 'Output as JSON')\n  .action((opts) => {\n    const summary = getTokenSummary();\n\n    if (opts.json) {\n      output(summary, true);\n    } else {\n      console.log('=== Token Status ===\\n');\n      for (const [org, info] of Object.entries(summary)) {\n        const status = info.available ? '' : '';\n        console.log(`${status} ${org.padEnd(15)} ${info.envVar}`);\n      }\n    }\n  });\n\ntokensCmd\n  .command('validate')\n  .description('Validate required tokens are available')\n  .option('--orgs <orgs>', 'Comma-separated org names to validate')\n  .action((opts) => {\n    const orgs = opts.orgs?.split(',').map((s: string) => s.trim());\n    const result = validateTokens(orgs);\n\n    if (result.success) {\n      console.log(' All required tokens are available');\n    } else {\n      console.error(' Missing tokens:');\n      for (const missing of result.data ?? []) {\n        console.error(`   - ${missing}`);\n      }\n      process.exit(1);\n    }\n  });\n\ntokensCmd\n  .command('for-repo')\n  .description('Show which token would be used for a repository')\n  .argument('<repo>', 'Repository URL or owner/repo')\n  .action((repo) => {\n    const org = extractOrg(repo);\n    const summary = getTokenSummary();\n    const config = org ? summary[org] : null;\n\n    console.log(`Repository: ${repo}`);\n    console.log(`Organization: ${org ?? 'unknown'}`);\n    if (config) {\n      console.log(`Token Env Var: ${config.envVar}`);\n      console.log(`Available: ${config.available ? ' Yes' : ' No'}`);\n    } else {\n      console.log('Using default token (GITHUB_TOKEN)');\n    }\n  });\n\n// ============================================\n// Fleet Commands\n// ============================================\n\nconst fleetCmd = program.command('fleet').description('Cursor Background Agent fleet management');\n\nfleetCmd\n  .command('list')\n  .description('List all agents')\n  .option('--running', 'Show only running agents')\n  .option('--status <status>', 'Filter by status (RUNNING, COMPLETED, FAILED, CANCELLED)')\n  .option('--json', 'Output as JSON')\n  .action(async (opts) => {\n    try {\n      const fleet = new Fleet();\n      let result: Result<Agent[]>;\n\n      if (opts.running) {\n        result = await fleet.running();\n      } else if (opts.status) {\n        result = await fleet.listByStatus(opts.status.toUpperCase());\n      } else {\n        result = await fleet.list();\n      }\n\n      if (!result.success) {\n        console.error(` ${result.error}`);\n        process.exit(1);\n      }\n\n      if (opts.json) {\n        output(result.data, true);\n      } else {\n        console.log('=== Fleet Status ===\\n');\n        console.log(`${'STATUS'.padEnd(10)} ${'ID'.padEnd(40)} ${'REPO'.padEnd(25)} NAME`);\n        console.log('-'.repeat(100));\n        for (const agent of result.data ?? []) {\n          console.log(formatAgent(agent));\n        }\n        console.log(`\\nTotal: ${result.data?.length ?? 0} agents`);\n      }\n    } catch (err) {\n      console.error(' Fleet list failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nfleetCmd\n  .command('repos')\n  .description('List available repositories')\n  .option('--json', 'Output as JSON')\n  .action(async (opts) => {\n    try {\n      const fleet = new Fleet();\n      const result = await fleet.repositories();\n\n      if (!result.success) {\n        console.error(` ${result.error}`);\n        process.exit(1);\n      }\n\n      if (opts.json) {\n        output(result.data, true);\n      } else {\n        console.log('=== Available Repositories ===\\n');\n        for (const repo of result.data ?? []) {\n          const visibility = repo.isPrivate ? '' : '';\n          console.log(`${visibility} ${repo.fullName} (${repo.defaultBranch})`);\n        }\n        console.log(`\\nTotal: ${result.data?.length ?? 0} repositories`);\n      }\n    } catch (err) {\n      console.error(' Failed to list repositories:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nfleetCmd\n  .command('get')\n  .description('Get details for a specific agent')\n  .argument('<agent-id>', 'Agent ID')\n  .option('--json', 'Output as JSON')\n  .action(async (agentId, opts) => {\n    try {\n      const fleet = new Fleet();\n      const result = await fleet.status(agentId);\n\n      if (!result.success) {\n        console.error(` ${result.error}`);\n        process.exit(1);\n      }\n\n      const agent = result.data;\n      if (!agent) {\n        console.error(` Agent not found: ${agentId}`);\n        process.exit(1);\n      }\n\n      if (opts.json) {\n        output(agent, true);\n      } else {\n        console.log('=== Agent Details ===\\n');\n        console.log(`ID:         ${agent.id}`);\n        console.log(`Name:       ${agent.name ?? '(unnamed)'}`);\n        console.log(`Status:     ${agent.status}`);\n        console.log(`Repository: ${agent.source?.repository ?? 'N/A'}`);\n        console.log(`Ref:        ${agent.source?.ref ?? 'N/A'}`);\n        if (agent.target?.branchName) {\n          console.log(`Branch:     ${agent.target.branchName}`);\n        }\n        if (agent.target?.prUrl) {\n          console.log(`PR:         ${agent.target.prUrl}`);\n        }\n        if (agent.target?.url) {\n          console.log(`URL:        ${agent.target.url}`);\n        }\n        if (agent.createdAt) {\n          console.log(`Created:    ${agent.createdAt}`);\n        }\n        if (agent.summary) {\n          console.log(`\\nSummary:\\n${agent.summary}`);\n        }\n        if (agent.error) {\n          console.log(`\\n Error:\\n${agent.error}`);\n        }\n      }\n    } catch (err) {\n      console.error(' Failed to get agent:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nfleetCmd\n  .command('conversation')\n  .description('Get conversation history for an agent')\n  .argument('<agent-id>', 'Agent ID')\n  .option('--json', 'Output as JSON')\n  .option('-o, --output <path>', 'Save to file')\n  .action(async (agentId, opts) => {\n    try {\n      const fleet = new Fleet();\n      const result = await fleet.conversation(agentId);\n\n      if (!result.success) {\n        console.error(` ${result.error}`);\n        process.exit(1);\n      }\n\n      const conv = result.data;\n      if (!conv) {\n        console.error(` Conversation not found for agent: ${agentId}`);\n        process.exit(1);\n      }\n\n      if (opts.output) {\n        writeFileSync(opts.output, JSON.stringify(conv, null, 2));\n        console.log(` Saved conversation to ${opts.output}`);\n        return;\n      }\n\n      if (opts.json) {\n        output(conv, true);\n      } else {\n        console.log(`=== Conversation (${conv.totalMessages} messages) ===\\n`);\n        for (const msg of conv.messages ?? []) {\n          const role = msg.type === 'user_message' ? ' USER' : ' ASSISTANT';\n          const time = msg.timestamp ? ` (${msg.timestamp})` : '';\n          console.log(`${role}${time}:`);\n          console.log(msg.text);\n          console.log(`\\n${'-'.repeat(60)}\\n`);\n        }\n      }\n    } catch (err) {\n      console.error(' Failed to get conversation:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nfleetCmd\n  .command('spawn')\n  .description('Spawn a new agent')\n  .argument('<repo>', 'Repository URL (https://github.com/org/repo)')\n  .argument('<task>', 'Task description')\n  .option('--ref <ref>', 'Git ref (branch, tag, commit)', 'main')\n  .option('--auto-pr', 'Auto-create PR when agent completes (or set in config)')\n  .option('--no-auto-pr', 'Disable auto-create PR')\n  .option('--branch <name>', 'Custom branch name for the agent')\n  .option('--as-app', 'Open PR as Cursor GitHub App (or set in config)')\n  .option('--json', 'Output as JSON')\n  .action(async (repo, task, opts) => {\n    try {\n      const fleet = new Fleet();\n      const defaults = getFleetDefaults();\n\n      // Merge CLI options with config defaults\n      // Note: Commander sets opts.autoPr to false for --no-auto-pr, true for --auto-pr, undefined for neither\n      // We need to check if it was explicitly set (not undefined) before falling back to defaults\n      const autoCreatePr =\n        opts.autoPr !== undefined ? opts.autoPr : (defaults.autoCreatePr ?? false);\n      const openAsCursorGithubApp = opts.asApp ?? defaults.openAsCursorGithubApp ?? false;\n\n      const result = await fleet.spawn({\n        repository: repo,\n        task,\n        ref: opts.ref,\n        target: {\n          autoCreatePr,\n          branchName: opts.branch,\n          openAsCursorGithubApp,\n        },\n      });\n\n      if (!result.success) {\n        console.error(` ${result.error}`);\n        process.exit(1);\n      }\n\n      if (opts.json) {\n        output(result.data, true);\n      } else {\n        console.log('=== Agent Spawned ===\\n');\n        console.log(`ID:     ${result.data?.id}`);\n        console.log(`Status: ${result.data?.status}`);\n        console.log(`Repo:   ${repo}`);\n        console.log(`Ref:    ${opts.ref}`);\n        if (opts.branch) console.log(`Branch: ${opts.branch}`);\n        if (autoCreatePr) console.log(`Auto PR: enabled`);\n      }\n    } catch (err) {\n      console.error(' Spawn failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nfleetCmd\n  .command('followup')\n  .description('Send follow-up message to agent')\n  .argument('<agent-id>', 'Agent ID')\n  .argument('<message>', 'Message to send')\n  .action(async (agentId, message) => {\n    try {\n      const fleet = new Fleet();\n      const result = await fleet.followup(agentId, message);\n\n      if (!result.success) {\n        console.error(` ${result.error}`);\n        process.exit(1);\n      }\n\n      console.log(` Follow-up sent to ${agentId}`);\n    } catch (err) {\n      console.error(' Followup failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nfleetCmd\n  .command('models')\n  .description('List available Cursor models')\n  .option('--json', 'Output as JSON')\n  .action(async (opts) => {\n    try {\n      const fleet = new Fleet();\n      const result = await fleet.listModels();\n\n      if (!result.success) {\n        console.error(` ${result.error}`);\n        process.exit(1);\n      }\n\n      if (opts.json) {\n        output(result.data, true);\n      } else {\n        console.log('=== Available Cursor Models ===\\n');\n        for (const model of result.data ?? []) {\n          console.log(`  - ${model}`);\n        }\n      }\n    } catch (err) {\n      console.error(' Failed to list models:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nfleetCmd\n  .command('summary')\n  .description('Get fleet summary')\n  .option('--json', 'Output as JSON')\n  .action(async (opts) => {\n    try {\n      const fleet = new Fleet();\n      const result = await fleet.summary();\n\n      if (!result.success) {\n        console.error(` ${result.error}`);\n        process.exit(1);\n      }\n\n      if (opts.json) {\n        output(result.data, true);\n      } else if (result.data) {\n        const s = result.data;\n        if (!s || Array.isArray(s)) {\n          console.error(' Invalid summary data');\n          process.exit(1);\n        }\n        console.log('=== Fleet Summary ===\\n');\n        console.log(`Total:     ${s.total}`);\n        console.log(`Running:   ${s.running}`);\n        console.log(`Completed: ${s.completed}`);\n        console.log(`Failed:    ${s.failed}`);\n      }\n    } catch (err) {\n      console.error(' Summary failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nfleetCmd\n  .command('coordinate')\n  .description('Run bidirectional fleet coordinator')\n  .addOption(\n    new Option('--pr <number>', 'Coordination PR number').argParser((v) =>\n      parsePositiveInt(v, '--pr')\n    )\n  )\n  .requiredOption('--repo <owner/name>', 'Repository (owner/repo format)')\n  .option('--outbound <ms>', 'Outbound poll interval (ms)', '60000')\n  .option('--inbound <ms>', 'Inbound poll interval (ms)', '15000')\n  .option('--agents <ids>', 'Comma-separated agent IDs to monitor', '')\n  .action(async (opts) => {\n    try {\n      if (!opts.pr) {\n        console.error(' --pr is required');\n        process.exit(1);\n      }\n\n      const outbound = Number.parseInt(opts.outbound, 10);\n      const inbound = Number.parseInt(opts.inbound, 10);\n\n      if (Number.isNaN(outbound) || outbound <= 0) {\n        console.error(' --outbound must be a positive integer');\n        process.exit(1);\n      }\n      if (Number.isNaN(inbound) || inbound <= 0) {\n        console.error(' --inbound must be a positive integer');\n        process.exit(1);\n      }\n\n      const fleet = new Fleet();\n\n      await fleet.coordinate({\n        coordinationPr: opts.pr,\n        repo: opts.repo,\n        outboundInterval: outbound,\n        inboundInterval: inbound,\n        agentIds: opts.agents ? opts.agents.split(',').filter(Boolean) : [],\n      });\n    } catch (err) {\n      console.error(' Coordinate failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\n// ============================================\n// Triage Commands\n// ============================================\n\nconst triageCmd = program.command('triage').description('AI-powered triage and analysis');\n\ntriageCmd\n  .command('models')\n  .description('List available AI models for triage')\n  .option('--provider <name>', 'Provider to list models for (anthropic, openai, google, mistral)')\n  .option('--json', 'Output as JSON')\n  .action(async (opts) => {\n    // Common models by provider\n    const modelsByProvider: Record<string, { id: string; name: string; description: string }[]> = {\n      anthropic: [\n        {\n          id: 'claude-sonnet-4-20250514',\n          name: 'Claude Sonnet 4',\n          description: 'Balanced performance (recommended)',\n        },\n        {\n          id: 'claude-opus-4-20250514',\n          name: 'Claude Opus 4',\n          description: 'Most capable, complex reasoning',\n        },\n        {\n          id: 'claude-sonnet-4-5-20250929',\n          name: 'Claude Sonnet 4.5',\n          description: 'Latest Sonnet release',\n        },\n        {\n          id: 'claude-opus-4-5-20251101',\n          name: 'Claude Opus 4.5',\n          description: 'Latest Opus release',\n        },\n        {\n          id: 'claude-haiku-4-5-20251001',\n          name: 'Claude Haiku 4.5',\n          description: 'Fastest, lightweight tasks',\n        },\n      ],\n      openai: [\n        { id: 'gpt-4o', name: 'GPT-4o', description: 'Flagship multimodal (recommended)' },\n        { id: 'gpt-4o-mini', name: 'GPT-4o Mini', description: 'Fast and affordable' },\n        { id: 'gpt-4-turbo', name: 'GPT-4 Turbo', description: 'Previous flagship' },\n        { id: 'gpt-4', name: 'GPT-4', description: 'Original GPT-4' },\n        { id: 'gpt-3.5-turbo', name: 'GPT-3.5 Turbo', description: 'Fast, cost-effective' },\n        { id: 'o1', name: 'o1', description: 'Advanced reasoning' },\n        { id: 'o1-mini', name: 'o1-mini', description: 'Fast reasoning' },\n      ],\n      google: [\n        {\n          id: 'gemini-1.5-pro',\n          name: 'Gemini 1.5 Pro',\n          description: 'Most capable (recommended)',\n        },\n        {\n          id: 'gemini-1.5-flash',\n          name: 'Gemini 1.5 Flash',\n          description: 'Fast and efficient',\n        },\n        {\n          id: 'gemini-1.5-flash-8b',\n          name: 'Gemini 1.5 Flash 8B',\n          description: 'Lightweight, high volume',\n        },\n        {\n          id: 'gemini-1.0-pro',\n          name: 'Gemini 1.0 Pro',\n          description: 'Previous generation',\n        },\n      ],\n      mistral: [\n        {\n          id: 'mistral-large-latest',\n          name: 'Mistral Large',\n          description: 'Most capable (recommended)',\n        },\n        { id: 'mistral-medium-latest', name: 'Mistral Medium', description: 'Balanced' },\n        {\n          id: 'mistral-small-latest',\n          name: 'Mistral Small',\n          description: 'Fast and efficient',\n        },\n        { id: 'codestral-latest', name: 'Codestral', description: 'Code-optimized' },\n        { id: 'open-mixtral-8x22b', name: 'Mixtral 8x22B', description: 'Open-weight MoE' },\n      ],\n      azure: [\n        { id: 'gpt-4o', name: 'GPT-4o', description: 'Use your Azure deployment name' },\n        { id: 'gpt-4', name: 'GPT-4', description: 'Use your Azure deployment name' },\n        {\n          id: 'gpt-35-turbo',\n          name: 'GPT-3.5 Turbo',\n          description: 'Use your Azure deployment name',\n        },\n      ],\n    };\n\n    const providers = opts.provider ? [opts.provider] : Object.keys(modelsByProvider);\n\n    if (opts.json) {\n      const result = providers.reduce(\n        (acc, p) => {\n          if (modelsByProvider[p]) {\n            acc[p] = modelsByProvider[p];\n          }\n          return acc;\n        },\n        {} as Record<string, typeof modelsByProvider.anthropic>\n      );\n      output(result, true);\n      return;\n    }\n\n    console.log('=== Available AI Models for Triage ===\\n');\n\n    for (const provider of providers) {\n      const models = modelsByProvider[provider];\n      if (!models) {\n        console.log(`Unknown provider: ${provider}\\n`);\n        continue;\n      }\n\n      console.log(` ${provider.toUpperCase()}`);\n      console.log('-'.repeat(60));\n      for (const model of models) {\n        console.log(`  ${model.id.padEnd(30)} ${model.description}`);\n      }\n      console.log();\n    }\n\n    console.log(' Configure in agentic.config.json:');\n    console.log(\n      '   { \"triage\": { \"provider\": \"anthropic\", \"model\": \"claude-sonnet-4-20250514\" } }'\n    );\n    console.log();\n    console.log(' For live model lists, check provider documentation:');\n    console.log('   Anthropic: https://docs.anthropic.com/en/docs/about-claude/models');\n    console.log('   OpenAI:    https://platform.openai.com/docs/models');\n    console.log('   Google:    https://ai.google.dev/gemini-api/docs/models/gemini');\n    console.log('   Mistral:   https://docs.mistral.ai/getting-started/models/');\n  });\n\ntriageCmd\n  .command('quick')\n  .description('Quick AI triage of text input')\n  .argument('<input>', 'Text to triage (or - for stdin)')\n  .option('--model <model>', 'Claude model to use', getDefaultModel())\n  .action(async (input, opts) => {\n    let text = input;\n    if (input === '-') {\n      text = '';\n      process.stdin.setEncoding('utf8');\n      for await (const chunk of process.stdin) {\n        text += chunk;\n      }\n    }\n\n    try {\n      const analyzer = new AIAnalyzer({ model: opts.model });\n      const result = await analyzer.quickTriage(text);\n\n      console.log('\\n=== Triage Result ===\\n');\n      console.log(`Priority:   ${result.priority.toUpperCase()}`);\n      console.log(`Category:   ${result.category}`);\n      console.log(`Summary:    ${result.summary}`);\n      console.log(`Action:     ${result.suggestedAction}`);\n      console.log(`Confidence: ${(result.confidence * 100).toFixed(0)}%`);\n    } catch (err) {\n      console.error(' Triage failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\ntriageCmd\n  .command('review')\n  .description('AI-powered code review of git diff')\n  .option('--base <ref>', 'Base ref for diff', 'main')\n  .option('--head <ref>', 'Head ref for diff', 'HEAD')\n  .option('--model <model>', 'Claude model to use', getDefaultModel())\n  .action(async (opts) => {\n    try {\n      // Validate git refs to prevent command injection\n      const baseRef = validateGitRef(opts.base);\n      const headRef = validateGitRef(opts.head);\n\n      // Use safe git command to execute git diff\n      const diffResult = safeGitCommand(['diff', `${baseRef}...${headRef}`]);\n\n      if (!diffResult.success) {\n        console.error(' git diff failed:', diffResult.stderr || 'Unknown error');\n        process.exit(1);\n      }\n\n      const diff = diffResult.stdout;\n\n      if (!diff.trim()) {\n        console.log('No changes to review');\n        return;\n      }\n\n      const analyzer = new AIAnalyzer({ model: opts.model });\n\n      console.log(` Reviewing diff ${baseRef}...${headRef}...`);\n\n      const review = await analyzer.reviewCode(diff);\n\n      console.log('\\n=== Code Review ===\\n');\n      console.log(`Ready to merge: ${review.readyToMerge ? ' YES' : ' NO'}`);\n\n      if (review.mergeBlockers.length > 0) {\n        console.log('\\n Merge Blockers:');\n        for (const blocker of review.mergeBlockers) {\n          console.log(`   - ${blocker}`);\n        }\n      }\n\n      console.log(`\\n Issues (${review.issues.length}):`);\n      for (const issue of review.issues) {\n        const icon =\n          issue.severity === 'critical'\n            ? ''\n            : issue.severity === 'high'\n              ? ''\n              : issue.severity === 'medium'\n                ? ''\n                : '';\n        console.log(\n          `   ${icon} [${issue.category}] ${issue.file}${issue.line ? `:${issue.line}` : ''}`\n        );\n        console.log(`      ${issue.description}`);\n      }\n\n      console.log('\\n Overall Assessment:');\n      console.log(`   ${review.overallAssessment}`);\n    } catch (err) {\n      console.error(' Review failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\ntriageCmd\n  .command('pr')\n  .description('AI-powered PR triage and analysis')\n  .argument('<pr-number>', 'PR number to triage', (v) => parsePositiveInt(v, 'pr-number'))\n  .option('--repo <owner/repo>', 'Repository (defaults to config)')\n  .option('--json', 'Output as JSON')\n  .action(async (prNumber, opts) => {\n    try {\n      const { Triage } = await import('./triage/triage.js');\n      const cfg = getConfig();\n      const repo = opts.repo || cfg.defaultRepository;\n\n      if (!repo) {\n        console.error(' Repository is required. Use --repo or set defaultRepository in config.');\n        process.exit(1);\n      }\n\n      const token = getTokenForRepo(repo);\n      if (!token) {\n        console.error(\n          ` Token not found for repository \"${repo}\". Check your configuration or GITHUB_TOKEN environment variable.`\n        );\n        process.exit(1);\n      }\n\n      const triage = new Triage({\n        github: {\n          token,\n          repo,\n        },\n        resolver: {\n          workingDirectory: process.cwd(),\n        },\n      });\n\n      console.log(` Triaging PR #${prNumber} in ${repo}...`);\n      const result = await triage.analyze(prNumber);\n\n      if (opts.json) {\n        output(result, true);\n      } else {\n        console.log(triage.formatTriageReport(result));\n      }\n    } catch (err) {\n      console.error(' PR triage failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\ntriageCmd\n  .command('fix')\n  .description('Automatically resolve issues in a Pull Request')\n  .argument('<pr-number>', 'PR number to fix', (v) => parsePositiveInt(v, 'pr-number'))\n  .option('--repo <owner/repo>', 'Repository (defaults to config)')\n  .option('--iterations <number>', 'Max iterations', '5')\n  .action(async (prNumber, opts) => {\n    try {\n      const { Triage } = await import('./triage/triage.js');\n      const cfg = getConfig();\n      const repo = opts.repo || cfg.defaultRepository;\n\n      if (!repo) {\n        console.error(' Repository is required. Use --repo or set defaultRepository in config.');\n        process.exit(1);\n      }\n\n      const token = getTokenForRepo(repo);\n      if (!token) {\n        console.error(\n          ` Token not found for repository \"${repo}\". Check your configuration or GITHUB_TOKEN environment variable.`\n        );\n        process.exit(1);\n      }\n\n      const triage = new Triage({\n        github: {\n          token,\n          repo,\n        },\n        resolver: {\n          workingDirectory: process.cwd(),\n        },\n      });\n\n      console.log(` Starting CI/PR resolution for PR #${prNumber} in ${repo}...`);\n\n      const result = await triage.runUntilReady(prNumber, {\n        maxIterations: Number.parseInt(opts.iterations, 10),\n        onProgress: (t, i) => {\n          console.log(`\\nIteration ${i}: Status = ${t.status}`);\n          console.log(`Unaddressed feedback: ${t.feedback.unaddressed}`);\n          console.log(`Blockers: ${t.blockers.length}`);\n        },\n      });\n\n      console.log('\\n=== Resolution Summary ===\\n');\n      console.log(`Success: ${result.success ? '' : ''}`);\n      console.log(`Iterations: ${result.iterations}`);\n      console.log(`Final Status: ${result.finalTriage.status}`);\n\n      if (result.allActions.length > 0) {\n        console.log(`\\nActions Taken (${result.allActions.length}):`);\n        for (const action of result.allActions) {\n          console.log(\n            `- [${action.success ? '' : ''}] ${action.action}: ${action.description}`\n          );\n        }\n      }\n\n      if (!result.success) {\n        process.exit(1);\n      }\n    } catch (err) {\n      console.error(' PR resolution failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\ntriageCmd\n  .command('analyze')\n  .description('Analyze agent conversation')\n  .argument('<agent-id>', 'Agent ID to analyze')\n  .option('-o, --output <path>', 'Output report path')\n  .option('--create-issues', 'Create GitHub issues from outstanding tasks')\n  .option('--dry-run', 'Show what issues would be created')\n  .option('--model <model>', 'Claude model to use', getDefaultModel())\n  .action(async (agentId, opts) => {\n    try {\n      const fleet = new Fleet();\n      const analyzer = new AIAnalyzer({ model: opts.model });\n\n      console.log(` Fetching conversation for ${agentId}...`);\n      const conv = await fleet.conversation(agentId);\n\n      if (!conv.success || !conv.data) {\n        console.error(` ${conv.error}`);\n        process.exit(1);\n      }\n\n      console.log(` Analyzing ${conv.data.messages?.length ?? 0} messages...`);\n\n      const analysis = await analyzer.analyzeConversation(conv.data);\n\n      console.log('\\n=== Analysis Summary ===\\n');\n      console.log(analysis.summary);\n\n      console.log(`\\n Completed: ${analysis.completedTasks.length}`);\n      console.log(` Outstanding: ${analysis.outstandingTasks.length}`);\n      console.log(` Blockers: ${analysis.blockers.length}`);\n\n      if (opts.output) {\n        const report = await analyzer.generateReport(conv.data);\n        writeFileSync(opts.output, report);\n        console.log(`\\n Report saved to ${opts.output}`);\n      }\n\n      if (opts.createIssues || opts.dryRun) {\n        console.log('\\n Creating GitHub Issues...');\n        const issues = await analyzer.createIssuesFromAnalysis(analysis, {\n          dryRun: opts.dryRun,\n        });\n        console.log(`Created ${issues.length} issues`);\n      }\n    } catch (err) {\n      console.error(' Analysis failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\n// ============================================\n// Roles Commands\n// ============================================\n\nconst rolesCmd = program.command('roles').description('Configurable AI agent personas');\n\nrolesCmd\n  .command('list')\n  .description('List available roles')\n  .option('--json', 'Output as JSON')\n  .action((opts) => {\n    const roles = listRoles();\n\n    if (opts.json) {\n      output(roles, true);\n    } else {\n      console.log('=== Available Roles ===\\n');\n      for (const role of roles) {\n        const triggers = role.triggers\n          .filter((t) => t.type === 'comment')\n          .map((t) => (t as { pattern: string }).pattern)\n          .join(', ');\n\n        console.log(`${role.icon} ${role.name} (${role.id})`);\n        console.log(`   ${role.description}`);\n        console.log(`   Triggers: ${triggers || 'manual only'}`);\n        console.log(\n          `   Capabilities: ${role.capabilities.slice(0, 3).join(', ')}${role.capabilities.length > 3 ? '...' : ''}`\n        );\n        console.log();\n      }\n    }\n  });\n\nrolesCmd\n  .command('info')\n  .description('Show detailed information about a role')\n  .argument('<role-id>', 'Role ID (sage, harvester, curator, reviewer, fixer, delegator)')\n  .option('--json', 'Output as JSON')\n  .action((roleId, opts) => {\n    const role = getEffectiveRole(roleId);\n\n    if (!role) {\n      console.error(` Role not found: ${roleId}`);\n      console.error(`Available roles: ${getDefaultRoleIds().join(', ')}`);\n      process.exit(1);\n    }\n\n    if (opts.json) {\n      output(role, true);\n    } else {\n      console.log(`\\n${role.icon} ${role.name}\\n`);\n      console.log(`ID: ${role.id}`);\n      console.log(`Description: ${role.description}`);\n      console.log(`\\nCapabilities:`);\n      for (const cap of role.capabilities) {\n        console.log(`   ${cap}`);\n      }\n      console.log(`\\nTriggers:`);\n      for (const trigger of role.triggers) {\n        if (trigger.type === 'comment') {\n          console.log(`   Comment: ${(trigger as { pattern: string }).pattern}`);\n        } else if (trigger.type === 'schedule') {\n          console.log(`   Schedule: ${(trigger as { cron: string }).cron}`);\n        } else if (trigger.type === 'event') {\n          console.log(`   Events: ${(trigger as { events: string[] }).events.join(', ')}`);\n        } else {\n          console.log(`   Manual`);\n        }\n      }\n      console.log(`\\nPermissions:`);\n      console.log(`  Can spawn agents: ${role.canSpawnAgents ? '' : ''}`);\n      console.log(`  Can modify repo: ${role.canModifyRepo ? '' : ''}`);\n      console.log(`  Can merge PRs: ${role.canMerge ? '' : ''}`);\n      console.log(`\\nDefault Model: ${role.defaultModel || 'provider default'}`);\n      console.log(`Temperature: ${role.temperature ?? 0.3}`);\n      console.log(`\\nSystem Prompt (first 500 chars):`);\n      console.log(`  ${role.systemPrompt.slice(0, 500).replace(/\\n/g, '\\n  ')}...`);\n    }\n  });\n\nrolesCmd\n  .command('sage')\n  .description('Run the Sage advisor')\n  .argument('<query>', 'Question or request')\n  .option('--repo <owner/repo>', 'Repository context')\n  .option('--issue <number>', 'Issue number for context')\n  .option('--json', 'Output as JSON')\n  .action(async (query, opts) => {\n    try {\n      const { getOrLoadProvider } = await import('./core/providers.js');\n      const { getTriageConfig, getTriageApiKey } = await import('./core/config.js');\n\n      const triageConfig = getTriageConfig();\n      const apiKey = getTriageApiKey();\n\n      if (!apiKey) {\n        console.error(\n          ' No API key found. Set ANTHROPIC_API_KEY or configure in agentic.config.json'\n        );\n        process.exit(1);\n      }\n\n      const providerFn = await getOrLoadProvider(triageConfig.provider || 'anthropic', apiKey);\n      const model = providerFn(triageConfig.model || 'claude-sonnet-4-20250514');\n\n      console.log(' Sage is thinking...\\n');\n\n      const result = await executeSageRole(query, model as Parameters<typeof executeSageRole>[1]);\n\n      if (opts.json) {\n        output(result, true);\n      } else {\n        if (result.success && result.response) {\n          console.log('##  Sage Response\\n');\n          console.log(result.response);\n        } else {\n          console.error(` ${result.error || 'Unknown error'}`);\n          process.exit(1);\n        }\n      }\n    } catch (err) {\n      console.error(' Sage failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nrolesCmd\n  .command('match')\n  .description('Find which role matches a trigger pattern')\n  .argument('<pattern>', 'Trigger pattern (e.g., @sage, /cursor)')\n  .action((pattern) => {\n    const role = findRoleByTrigger(pattern);\n\n    if (role) {\n      console.log(` Matched: ${role.icon} ${role.name} (${role.id})`);\n      console.log(`   ${role.description}`);\n    } else {\n      console.log(` No role matches pattern: ${pattern}`);\n      console.log(`\\nAvailable trigger patterns:`);\n      for (const r of Object.values(DEFAULT_ROLES)) {\n        for (const trigger of r.triggers) {\n          if (trigger.type === 'comment') {\n            console.log(`  ${(trigger as { pattern: string }).pattern}  ${r.icon} ${r.name}`);\n          }\n        }\n      }\n    }\n  });\n\n// ============================================\n// Handoff Commands\n// ============================================\n\nconst handoffCmd = program.command('handoff').description('Station-to-station agent handoff');\n\nhandoffCmd\n  .command('initiate')\n  .description('Initiate handoff to successor agent')\n  .argument('<predecessor-id>', 'Your agent ID (predecessor)')\n  .addOption(\n    new Option('--pr <number>', 'Your current PR number').argParser((v) =>\n      parsePositiveInt(v, '--pr')\n    )\n  )\n  .requiredOption('--branch <name>', 'Your current branch name')\n  .requiredOption('--repo <url>', 'Repository URL for successor')\n  .option('--ref <ref>', 'Git ref for successor', 'main')\n  .option('--tasks <tasks>', 'Comma-separated tasks for successor', '')\n  .action(async (predecessorId, opts) => {\n    try {\n      if (!opts.pr) {\n        console.error(' --pr is required');\n        process.exit(1);\n      }\n\n      const manager = new HandoffManager();\n\n      console.log(' Initiating station-to-station handoff...\\n');\n\n      const result = await manager.initiateHandoff(predecessorId, {\n        repository: opts.repo,\n        ref: opts.ref,\n        currentPr: opts.pr,\n        currentBranch: validateBranchName(opts.branch),\n        tasks: opts.tasks ? opts.tasks.split(',').map((t: string) => t.trim()) : [],\n      });\n\n      if (!result.success) {\n        console.error(` Handoff failed: ${result.error}`);\n        process.exit(1);\n      }\n\n      console.log(`\\n Handoff initiated`);\n      console.log(`   Successor: ${result.successorId}`);\n      console.log(`   Healthy: ${result.successorHealthy ? 'Yes' : 'Pending'}`);\n    } catch (err) {\n      console.error(' Handoff failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nhandoffCmd\n  .command('confirm')\n  .description('Confirm health as successor agent')\n  .argument('<predecessor-id>', 'Predecessor agent ID')\n  .action(async (predecessorId) => {\n    try {\n      const manager = new HandoffManager();\n      const successorId = process.env.CURSOR_AGENT_ID || 'successor-agent';\n\n      console.log(` Confirming health to predecessor ${predecessorId}...`);\n      await manager.confirmHealthAndBegin(successorId, predecessorId);\n      console.log(' Health confirmation sent');\n    } catch (err) {\n      console.error(' Confirm failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nhandoffCmd\n  .command('takeover')\n  .description('Merge predecessor PR and take over')\n  .argument('<predecessor-id>', 'Predecessor agent ID')\n  .argument('<pr-number>', 'Predecessor PR number', (v) => parsePositiveInt(v, 'pr-number'))\n  .argument('<new-branch>', 'Your new branch name', validateBranchName)\n  .option('--admin', 'Use admin privileges')\n  .option('--auto', 'Enable auto-merge')\n  .addOption(\n    new Option('--merge-method <method>', 'Merge method')\n      .choices(['merge', 'squash', 'rebase'])\n      .default('squash')\n  )\n  .action(async (predecessorId, prNumber, newBranch, opts) => {\n    try {\n      const manager = new HandoffManager();\n\n      console.log(' Taking over from predecessor...\\n');\n\n      const result = await manager.takeover(predecessorId, prNumber, newBranch, {\n        admin: opts.admin,\n        auto: opts.auto,\n        mergeMethod: opts.mergeMethod,\n        deleteBranch: true,\n      });\n\n      if (!result.success) {\n        console.error(` Takeover failed: ${result.error}`);\n        process.exit(1);\n      }\n\n      console.log(' Takeover complete!');\n    } catch (err) {\n      console.error(' Takeover failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\n// ============================================\n// Sandbox Commands\n// ============================================\n\nconst sandboxCmd = program.command('sandbox').description('Local sandbox execution for AI agents');\n\nsandboxCmd\n  .command('run')\n  .description('Run an AI agent in a sandbox')\n  .argument('<prompt>', 'Task prompt for the agent')\n  .option('--runtime <type>', 'Runtime adapter (claude, cursor)', 'claude')\n  .option('--workspace <path>', 'Workspace directory to mount', process.cwd())\n  .option('--output <path>', 'Output directory', './sandbox-output')\n  .option('--timeout <seconds>', 'Timeout in seconds', '300')\n  .option('--memory <mb>', 'Memory limit in MB', '1024')\n  .option('--env <vars>', 'Environment variables (KEY=value,KEY2=value2)')\n  .option('--json', 'Output as JSON')\n  .action(async (prompt, opts) => {\n    try {\n      const { SandboxExecutor } = await import('./sandbox/index.js');\n      const executor = new SandboxExecutor();\n\n      // Parse environment variables\n      const env: Record<string, string> = {};\n      if (opts.env) {\n        for (const pair of opts.env.split(',')) {\n          const [key, value] = pair.split('=');\n          if (key && value) {\n            env[key.trim()] = value.trim();\n          }\n        }\n      }\n\n      console.log(` Running ${opts.runtime} agent in sandbox...`);\n\n      const result = await executor.execute({\n        runtime: opts.runtime,\n        workspace: opts.workspace,\n        outputDir: opts.output,\n        prompt,\n        timeout: Number.parseInt(opts.timeout, 10) * 1000, // Convert to milliseconds\n        memory: Number.parseInt(opts.memory, 10),\n        env,\n      });\n\n      if (opts.json) {\n        output(result, true);\n      } else {\n        console.log('\\n=== Sandbox Result ===\\n');\n        console.log(`Success: ${result.success ? '' : ''}`);\n        console.log(`Duration: ${result.duration}ms`);\n        console.log(`Exit Code: ${result.exitCode}`);\n\n        if (result.output) {\n          console.log('\\n Output:');\n          console.log(result.output);\n        }\n\n        if (result.error) {\n          console.log('\\n Error:');\n          console.log(result.error);\n        }\n      }\n    } catch (err) {\n      console.error(' Sandbox execution failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\nsandboxCmd\n  .command('fleet')\n  .description('Run multiple agents in parallel sandboxes')\n  .argument('<prompts...>', 'Task prompts for agents')\n  .option('--runtime <type>', 'Runtime adapter (claude, cursor)', 'claude')\n  .option('--workspace <path>', 'Workspace directory to mount', process.cwd())\n  .option('--output <path>', 'Base output directory', './sandbox-output')\n  .option('--timeout <seconds>', 'Timeout in seconds', '300')\n  .option('--memory <mb>', 'Memory limit in MB', '1024')\n  .option('--json', 'Output as JSON')\n  .action(async (prompts, opts) => {\n    try {\n      const { SandboxExecutor } = await import('./sandbox/index.js');\n      const executor = new SandboxExecutor();\n\n      const options = prompts.map((prompt: string, index: number) => ({\n        runtime: opts.runtime,\n        workspace: opts.workspace,\n        outputDir: `${opts.output}/agent-${index + 1}`,\n        prompt,\n        timeout: Number.parseInt(opts.timeout, 10) * 1000,\n        memory: Number.parseInt(opts.memory, 10),\n      }));\n\n      console.log(` Running ${prompts.length} agents in parallel sandboxes...`);\n\n      const results = await executor.executeFleet(options);\n\n      if (opts.json) {\n        output(results, true);\n      } else {\n        console.log('\\n=== Fleet Results ===\\n');\n        results.forEach((result, index) => {\n          console.log(`Agent ${index + 1}:`);\n          console.log(`  Success: ${result.success ? '' : ''}`);\n          console.log(`  Duration: ${result.duration}ms`);\n          console.log(`  Exit Code: ${result.exitCode}`);\n          console.log();\n        });\n\n        const successful = results.filter((r) => r.success).length;\n        console.log(`Summary: ${successful}/${results.length} agents completed successfully`);\n      }\n    } catch (err) {\n      console.error(' Fleet execution failed:', err instanceof Error ? err.message : err);\n      process.exit(1);\n    }\n  });\n\n// ============================================\n// Config Commands\n// ============================================\n\nprogram\n  .command('config')\n  .description('Show current configuration')\n  .option('--json', 'Output as JSON')\n  .action((opts) => {\n    const cfg = getConfig();\n    const configData = {\n      defaultModel: getDefaultModel(),\n      configuredOrgs: getConfiguredOrgs(),\n      tokens: getTokenSummary(),\n      defaultRepository: cfg.defaultRepository ?? '(not set)',\n      coordinationPr: cfg.coordinationPr ?? '(not set)',\n      logLevel: cfg.logLevel,\n    };\n\n    if (opts.json) {\n      output(configData, true);\n    } else {\n      console.log('=== Configuration ===\\n');\n      console.log(`Default Model: ${configData.defaultModel}`);\n      console.log(`Default Repository: ${configData.defaultRepository}`);\n      console.log(`Coordination PR: ${configData.coordinationPr}`);\n      console.log(`Log Level: ${configData.logLevel}`);\n      console.log(\n        `Configured Orgs: ${configData.configuredOrgs.length > 0 ? configData.configuredOrgs.join(', ') : '(none - configure in agentic.config.json)'}`\n      );\n      console.log('\\nToken Status:');\n      for (const [org, info] of Object.entries(configData.tokens)) {\n        const status = info.available ? '' : '';\n        console.log(`  ${status} ${org}: ${info.envVar}`);\n      }\n    }\n  });\n\nprogram\n  .command('init')\n  .description('Initialize configuration')\n  .option('--force', 'Overwrite existing config file')\n  .option('--non-interactive', 'Skip prompts, use detected values only')\n  .action(async (opts) => {\n    const configPath = 'agentic.config.json';\n\n    if (existsSync(configPath) && !opts.force) {\n      console.error(` ${configPath} already exists. Use --force to overwrite.`);\n      process.exit(1);\n    }\n\n    const isInteractive = process.stdout.isTTY && !opts.nonInteractive;\n\n    // Detect org-specific tokens (GITHUB_*_TOKEN pattern)\n    // Security: Only allow alphanumeric and underscore in org name extraction\n    const organizations: Record<string, { name: string; tokenEnvVar: string }> = {};\n    const SAFE_ORG_PATTERN = /^GITHUB_([A-Za-z0-9_]+)_TOKEN$/;\n    for (const envVar of Object.keys(process.env)) {\n      const match = envVar.match(SAFE_ORG_PATTERN);\n      if (match?.[1] && process.env[envVar]) {\n        // Normalize to lowercase, replace underscores with hyphens\n        const orgName = match[1].toLowerCase().replace(/_/g, '-');\n        // Additional validation: org names must be reasonable length\n        if (orgName.length > 0 && orgName.length <= 39) {\n          organizations[orgName] = { name: orgName, tokenEnvVar: envVar };\n        }\n      }\n    }\n\n    // Detect standard tokens\n    const hasGithubToken = !!process.env.GITHUB_TOKEN;\n    const hasCursorKey = !!process.env.CURSOR_API_KEY;\n    const hasAnthropicKey = !!process.env.ANTHROPIC_API_KEY;\n    const hasOpenAIKey = !!process.env.OPENAI_API_KEY;\n\n    // Build base config from detected values\n    const config: Record<string, unknown> = {\n      tokens: {\n        organizations: Object.keys(organizations).length > 0 ? organizations : {},\n        defaultTokenEnvVar: hasGithubToken ? 'GITHUB_TOKEN' : 'GITHUB_TOKEN',\n        prReviewTokenEnvVar: hasGithubToken ? 'GITHUB_TOKEN' : 'GITHUB_TOKEN',\n      },\n      logLevel: 'info',\n      fleet: {\n        autoCreatePr: false,\n      },\n      triage: {\n        provider: hasAnthropicKey ? 'anthropic' : hasOpenAIKey ? 'openai' : 'anthropic',\n        // model will be set below\n      },\n    };\n\n    // Interactive prompts for missing values\n    if (isInteractive) {\n      const { input, confirm, select } = await import('@inquirer/prompts');\n\n      // Ask for default repository if not detected\n      const repoAnswer = await input({\n        message: 'Default repository (owner/repo, or leave empty):',\n        default: '',\n      });\n      if (repoAnswer) {\n        config.defaultRepository = repoAnswer;\n      }\n\n      // Ask about fleet defaults\n      const autoPr = await confirm({\n        message: 'Auto-create PRs when agents complete?',\n        default: false,\n      });\n      (config.fleet as Record<string, unknown>).autoCreatePr = autoPr;\n\n      // === AI PROVIDER & MODEL SELECTION ===\n      console.log('\\n AI Triage Configuration\\n');\n\n      // Select provider\n      const provider = await select({\n        message: 'AI provider for triage operations:',\n        choices: [\n          {\n            value: 'anthropic',\n            name: `Anthropic (Claude)${hasAnthropicKey ? '  key detected' : ''}`,\n          },\n          {\n            value: 'openai',\n            name: `OpenAI (GPT)${hasOpenAIKey ? '  key detected' : ''}`,\n          },\n          { value: 'google', name: 'Google AI (Gemini)' },\n          { value: 'mistral', name: 'Mistral' },\n          { value: 'azure', name: 'Azure OpenAI' },\n        ],\n        default: hasAnthropicKey ? 'anthropic' : hasOpenAIKey ? 'openai' : 'anthropic',\n      });\n      (config.triage as Record<string, unknown>).provider = provider;\n\n      // Model selection\n      const modelChoice = await select({\n        message: 'How would you like to configure the AI model?',\n        choices: [\n          {\n            value: 'list-cursor',\n            name:\n              'List available Cursor models (requires CURSOR_API_KEY)' +\n              (hasCursorKey ? ' ' : ' '),\n          },\n          { value: 'common', name: 'Choose from common models' },\n          { value: 'manual', name: 'Enter model ID manually' },\n          { value: 'auto', name: \"Auto (no default - use provider's default)\" },\n        ],\n      });\n\n      let selectedModel: string | undefined;\n\n      let shouldFallbackToCommon = false;\n\n      if (modelChoice === 'list-cursor') {\n        if (!hasCursorKey) {\n          console.log('  CURSOR_API_KEY not found. Falling back to common models.');\n          shouldFallbackToCommon = true;\n        } else {\n          try {\n            console.log(' Fetching available Cursor models...');\n            const fleet = new Fleet();\n            const modelsResult = await fleet.listModels();\n\n            if (modelsResult.success && modelsResult.data && modelsResult.data.length > 0) {\n              selectedModel = await select({\n                message: 'Select a model:',\n                choices: modelsResult.data.map((m) => ({ value: m, name: m })),\n              });\n            } else {\n              console.log('  Could not fetch models. Falling back to common models.');\n              shouldFallbackToCommon = true;\n            }\n          } catch (err) {\n            console.log(`  Error fetching models: ${err instanceof Error ? err.message : err}`);\n            shouldFallbackToCommon = true;\n          }\n        }\n      }\n\n      if (!selectedModel && (modelChoice === 'common' || shouldFallbackToCommon)) {\n        const commonModels: Record<string, { value: string; name: string }[]> = {\n          anthropic: [\n            {\n              value: 'claude-sonnet-4-20250514',\n              name: 'Claude Sonnet 4 (recommended)',\n            },\n            { value: 'claude-opus-4-20250514', name: 'Claude Opus 4 (most capable)' },\n            { value: 'claude-sonnet-4-5-20250929', name: 'Claude Sonnet 4.5' },\n            { value: 'claude-haiku-4-5-20251001', name: 'Claude Haiku 4.5 (fastest)' },\n          ],\n          openai: [\n            { value: 'gpt-4o', name: 'GPT-4o (recommended)' },\n            { value: 'gpt-4-turbo', name: 'GPT-4 Turbo' },\n            { value: 'gpt-4', name: 'GPT-4' },\n            { value: 'gpt-3.5-turbo', name: 'GPT-3.5 Turbo (fastest)' },\n          ],\n          google: [\n            { value: 'gemini-1.5-pro', name: 'Gemini 1.5 Pro (recommended)' },\n            { value: 'gemini-1.5-flash', name: 'Gemini 1.5 Flash (fastest)' },\n            { value: 'gemini-1.0-pro', name: 'Gemini 1.0 Pro' },\n          ],\n          mistral: [\n            { value: 'mistral-large-latest', name: 'Mistral Large (recommended)' },\n            { value: 'mistral-medium-latest', name: 'Mistral Medium' },\n            { value: 'mistral-small-latest', name: 'Mistral Small (fastest)' },\n          ],\n          azure: [\n            { value: 'gpt-4o', name: 'GPT-4o (deployment name)' },\n            { value: 'gpt-4', name: 'GPT-4 (deployment name)' },\n          ],\n        };\n\n        const defaultModels = commonModels.anthropic ?? [];\n        const providerModels = commonModels[provider as string] ?? defaultModels;\n        selectedModel = await select({\n          message: `Select ${provider} model:`,\n          choices: providerModels,\n        });\n      }\n\n      if (!selectedModel && modelChoice === 'manual') {\n        selectedModel = await input({\n          message: 'Enter model ID:',\n          default: provider === 'anthropic' ? 'claude-sonnet-4-20250514' : 'gpt-4o',\n        });\n      }\n\n      if (selectedModel) {\n        (config.triage as Record<string, unknown>).model = selectedModel;\n      }\n      // If \"auto\" was selected, don't set a model - let the provider use its default\n\n      // Ask for additional orgs\n      console.log('\\n Organization Tokens\\n');\n      const addOrg = await confirm({\n        message: 'Add organization-specific token mappings?',\n        default: false,\n      });\n\n      if (addOrg) {\n        let adding = true;\n        while (adding) {\n          const orgName = await input({ message: 'Organization name:' });\n          const tokenVar = await input({\n            message: `Environment variable for ${orgName}:`,\n            default: `GITHUB_${orgName.toUpperCase().replace(/-/g, '_')}_TOKEN`,\n          });\n          (config.tokens as Record<string, unknown>).organizations = {\n            ...((config.tokens as Record<string, unknown>).organizations as object),\n            [orgName]: { name: orgName, tokenEnvVar: tokenVar },\n          };\n          adding = await confirm({\n            message: 'Add another organization?',\n            default: false,\n          });\n        }\n      }\n    } else {\n      // Non-interactive: set sensible defaults\n      (config.triage as Record<string, unknown>).model = hasAnthropicKey\n        ? 'claude-sonnet-4-20250514'\n        : hasOpenAIKey\n          ? 'gpt-4o'\n          : 'claude-sonnet-4-20250514';\n    }\n\n    writeFileSync(configPath, `${JSON.stringify(config, null, 2)}\\n`);\n    console.log(`\\n Created ${configPath}`);\n\n    // Show summary\n    const triage = config.triage as Record<string, unknown>;\n    console.log('\\n Configuration Summary:');\n    console.log(`   Provider: ${triage.provider}`);\n    console.log(`   Model: ${triage.model ?? '(auto - provider default)'}`);\n    if (config.defaultRepository) {\n      console.log(`   Default Repo: ${config.defaultRepository}`);\n    }\n    console.log(`   Auto-create PRs: ${(config.fleet as Record<string, unknown>).autoCreatePr}`);\n  });\n\n// ============================================\n// Parse and Run\n// ============================================\n\n// Initialize config\ninitConfig();\n\n// Parse CLI\nprogram.parse();\n","/**\n * CursorAPI - Direct HTTP client for Cursor Background Agent API\n *\n * Bypasses MCP for direct API access with better performance and reliability.\n * Adapted from cursor-fleet with enhanced error handling.\n */\n\nimport { log } from '../core/config.js';\nimport type { Agent, Conversation, Repository, Result } from '../core/types.js';\n\n/** Default API base URL - configurable for testing/staging */\nconst DEFAULT_BASE_URL = 'https://api.cursor.com/v0';\n\n/** Retryable HTTP status codes */\nconst RETRYABLE_STATUS_CODES = [429, 500, 502, 503, 504];\n\n/** Default maximum number of retries */\nconst DEFAULT_MAX_RETRIES = 3;\n\n/** Default initial retry delay in milliseconds */\nconst DEFAULT_RETRY_DELAY = 1000;\n\n/** Validation regex for agent IDs (alphanumeric with hyphens) */\nconst AGENT_ID_PATTERN = /^[a-zA-Z0-9-]+$/;\n\n/** Maximum prompt text length */\nconst MAX_PROMPT_LENGTH = 100000;\n\n/** Maximum repository name length */\nconst MAX_REPO_LENGTH = 200;\n\nexport interface CursorAPIOptions {\n  /** API key (defaults to CURSOR_API_KEY env var) */\n  apiKey?: string;\n  /** Request timeout in milliseconds (default: 60000) */\n  timeout?: number;\n  /** API base URL (default: https://api.cursor.com/v0) */\n  baseUrl?: string;\n  /** Maximum number of retries for transient errors (default: 3) */\n  maxRetries?: number;\n  /** Initial delay for exponential backoff in ms (default: 1000) */\n  retryDelay?: number;\n}\n\n/**\n * Validates an agent ID to prevent injection attacks\n */\nfunction validateAgentId(agentId: string): void {\n  if (!agentId || typeof agentId !== 'string') {\n    throw new Error('Agent ID is required and must be a string');\n  }\n  if (agentId.length > 100) {\n    throw new Error('Agent ID exceeds maximum length (100 characters)');\n  }\n  if (!AGENT_ID_PATTERN.test(agentId)) {\n    throw new Error('Agent ID contains invalid characters (only alphanumeric and hyphens allowed)');\n  }\n}\n\n/**\n * Validates prompt text\n */\nfunction validatePromptText(text: string): void {\n  if (!text || typeof text !== 'string') {\n    throw new Error('Prompt text is required and must be a string');\n  }\n  if (text.trim().length === 0) {\n    throw new Error('Prompt text cannot be empty');\n  }\n  if (text.length > MAX_PROMPT_LENGTH) {\n    throw new Error(`Prompt text exceeds maximum length (${MAX_PROMPT_LENGTH} characters)`);\n  }\n}\n\n/**\n * Validates repository name\n */\nfunction validateRepository(repository: string): void {\n  if (!repository || typeof repository !== 'string') {\n    throw new Error('Repository is required and must be a string');\n  }\n  if (repository.length > MAX_REPO_LENGTH) {\n    throw new Error(`Repository name exceeds maximum length (${MAX_REPO_LENGTH} characters)`);\n  }\n  // Basic format check: owner/repo or URL\n  if (!repository.includes('/')) {\n    throw new Error(\"Repository must be in format 'owner/repo' or a valid URL\");\n  }\n}\n\n/**\n * Validates webhook URL to prevent SSRF attacks\n * Only allows HTTPS URLs to external hosts\n */\nfunction validateWebhookUrl(url: string): void {\n  if (!url || typeof url !== 'string') {\n    throw new Error('Webhook URL is required and must be a string');\n  }\n\n  let parsed: URL;\n  try {\n    parsed = new URL(url);\n  } catch {\n    throw new Error('Webhook URL is not a valid URL');\n  }\n\n  // Security: Only allow HTTPS\n  if (parsed.protocol !== 'https:') {\n    throw new Error('Webhook URL must use HTTPS protocol');\n  }\n\n  // Security: Block internal/private IP ranges\n  const hostname = parsed.hostname.toLowerCase();\n  const blockedPatterns = [\n    /^localhost$/i,\n    /^127\\./,\n    /^10\\./,\n    /^172\\.(1[6-9]|2[0-9]|3[0-1])\\./,\n    /^192\\.168\\./,\n    /^169\\.254\\./,\n    /^0\\./,\n    /^\\[::1\\]$/,\n    /^\\[fc/i,\n    /^\\[fd/i,\n    /^\\[fe80:/i,\n    /^metadata\\./i,\n    /^internal\\./i,\n    /\\.local$/i,\n    /\\.internal$/i,\n  ];\n\n  for (const pattern of blockedPatterns) {\n    if (pattern.test(hostname)) {\n      throw new Error('Webhook URL cannot point to internal/private addresses');\n    }\n  }\n\n  // Security: Block common cloud metadata endpoints\n  if (hostname === '169.254.169.254' || hostname.includes('metadata.google')) {\n    throw new Error('Webhook URL cannot point to cloud metadata services');\n  }\n}\n\n/**\n * Sanitizes error messages to prevent sensitive data leakage\n */\nfunction sanitizeError(error: unknown): string {\n  const message = error instanceof Error ? error.message : String(error);\n  // Remove potential API keys, tokens, or sensitive patterns\n  return message\n    .replace(/Bearer\\s+[a-zA-Z0-9._-]+/gi, 'Bearer [REDACTED]')\n    .replace(/api[_-]?key[=:]\\s*[\"']?[a-zA-Z0-9._-]+[\"']?/gi, 'api_key=[REDACTED]')\n    .replace(/token[=:]\\s*[\"']?[a-zA-Z0-9._-]+[\"']?/gi, 'token=[REDACTED]');\n}\n\nexport class CursorAPI {\n  private readonly apiKey: string;\n  private readonly timeout: number;\n  private readonly baseUrl: string;\n  private readonly maxRetries: number;\n  private readonly retryDelay: number;\n\n  constructor(options: CursorAPIOptions = {}) {\n    // Check for API key in order: options, CURSOR_API_KEY\n    this.apiKey = options.apiKey ?? process.env.CURSOR_API_KEY ?? '';\n    this.timeout = options.timeout ?? 60000;\n    // Security: Only allow baseUrl via explicit programmatic configuration\n    // Do NOT allow env var override to prevent SSRF attacks\n    this.baseUrl = options.baseUrl ?? DEFAULT_BASE_URL;\n    this.maxRetries = options.maxRetries ?? DEFAULT_MAX_RETRIES;\n    this.retryDelay = options.retryDelay ?? DEFAULT_RETRY_DELAY;\n\n    if (!this.apiKey) {\n      throw new Error('CURSOR_API_KEY is required. Set it in environment or pass to constructor.');\n    }\n  }\n\n  /**\n   * Check if API key is available\n   */\n  static isAvailable(): boolean {\n    return !!process.env.CURSOR_API_KEY;\n  }\n\n  private async request<T>(\n    endpoint: string,\n    method: string = 'GET',\n    body?: object,\n    attempt: number = 0\n  ): Promise<Result<T>> {\n    const url = `${this.baseUrl}${endpoint}`;\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), this.timeout);\n\n    try {\n      const response = await fetch(url, {\n        method,\n        headers: {\n          Authorization: `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json',\n        },\n        body: body ? JSON.stringify(body) : undefined,\n        signal: controller.signal,\n      });\n\n      if (!response.ok) {\n        // Check if we should retry\n        if (attempt < this.maxRetries && RETRYABLE_STATUS_CODES.includes(response.status)) {\n          const delay = this.retryDelay * 2 ** attempt;\n          log.warn(\n            `API Error ${response.status} on ${method} ${endpoint}. Retrying in ${delay}ms... (Attempt ${attempt + 1}/${this.maxRetries})`\n          );\n          await new Promise((resolve) => setTimeout(resolve, delay));\n          return this.request<T>(endpoint, method, body, attempt + 1);\n        }\n\n        const errorText = await response.text();\n        let details: string;\n        try {\n          const parsed = JSON.parse(errorText);\n          details = parsed.message || parsed.error || 'Unknown API error';\n        } catch {\n          details = sanitizeError(errorText);\n        }\n\n        return {\n          success: false,\n          error: `API Error ${response.status}: ${details}`,\n        };\n      }\n\n      // Handle empty responses (e.g., 204 No Content)\n      const contentType = response.headers.get('content-type');\n      if (!contentType || !contentType.includes('application/json')) {\n        return { success: true, data: {} as T };\n      }\n\n      const text = await response.text();\n      if (!text || text.trim() === '') {\n        return { success: true, data: {} as T };\n      }\n\n      try {\n        const data = JSON.parse(text) as T;\n        return { success: true, data };\n      } catch {\n        return {\n          success: false,\n          error: 'Invalid JSON response from API',\n        };\n      }\n    } catch (error) {\n      if (error instanceof Error && error.name === 'AbortError') {\n        // Timeouts are also retryable\n        if (attempt < this.maxRetries) {\n          const delay = this.retryDelay * 2 ** attempt;\n          log.warn(\n            `Request timeout on ${method} ${endpoint}. Retrying in ${delay}ms... (Attempt ${attempt + 1}/${this.maxRetries})`\n          );\n          await new Promise((resolve) => setTimeout(resolve, delay));\n          return this.request<T>(endpoint, method, body, attempt + 1);\n        }\n        return { success: false, error: `Request timeout after ${this.timeout}ms` };\n      }\n\n      // Network errors (TypeError) or specific connection errors are also retryable\n      if (\n        attempt < this.maxRetries &&\n        (error instanceof TypeError ||\n          (error instanceof Error &&\n            (error.message.includes('network') ||\n              error.message.includes('fetch') ||\n              error.message.includes('connection'))))\n      ) {\n        const delay = this.retryDelay * 2 ** attempt;\n        log.warn(\n          `Network error on ${method} ${endpoint}: ${sanitizeError(error)}. Retrying in ${delay}ms... (Attempt ${attempt + 1}/${this.maxRetries})`\n        );\n        await new Promise((resolve) => setTimeout(resolve, delay));\n        return this.request<T>(endpoint, method, body, attempt + 1);\n      }\n\n      return { success: false, error: sanitizeError(error) };\n    } finally {\n      clearTimeout(timeoutId);\n    }\n  }\n\n  /**\n   * List all agents\n   */\n  async listAgents(): Promise<Result<Agent[]>> {\n    const result = await this.request<{ agents: Agent[]; nextCursor?: string }>('/agents');\n    if (!result.success) return { success: false, error: result.error };\n    return { success: true, data: result.data?.agents ?? [] };\n  }\n\n  /**\n   * Get status of a specific agent\n   */\n  async getAgentStatus(agentId: string): Promise<Result<Agent>> {\n    validateAgentId(agentId);\n    const encodedId = encodeURIComponent(agentId);\n    return this.request<Agent>(`/agents/${encodedId}`);\n  }\n\n  /**\n   * Get conversation history for an agent\n   */\n  async getAgentConversation(agentId: string): Promise<Result<Conversation>> {\n    validateAgentId(agentId);\n    const encodedId = encodeURIComponent(agentId);\n    return this.request<Conversation>(`/agents/${encodedId}/conversation`);\n  }\n\n  /**\n   * Launch a new agent\n   *\n   * API Spec: https://cursor.com/docs/cloud-agent/api/endpoints\n   */\n  async launchAgent(options: {\n    prompt: {\n      text: string;\n      images?: Array<{ data: string; dimension?: { width: number; height: number } }>;\n    };\n    source: {\n      repository: string;\n      ref?: string;\n    };\n    target?: {\n      autoCreatePr?: boolean;\n      branchName?: string;\n      openAsCursorGithubApp?: boolean;\n      skipReviewerRequest?: boolean;\n    };\n    webhook?: {\n      url: string;\n      secret?: string;\n    };\n  }): Promise<Result<Agent>> {\n    validatePromptText(options.prompt.text);\n    validateRepository(options.source.repository);\n\n    if (options.source.ref !== undefined) {\n      if (typeof options.source.ref !== 'string' || options.source.ref.length > 200) {\n        throw new Error('Invalid ref: must be a string under 200 characters');\n      }\n    }\n\n    // Security: Validate webhook URL to prevent SSRF\n    if (options.webhook?.url) {\n      validateWebhookUrl(options.webhook.url);\n    }\n\n    return this.request<Agent>('/agents', 'POST', options);\n  }\n\n  /**\n   * Send a follow-up message to an agent\n   */\n  async addFollowup(agentId: string, prompt: { text: string }): Promise<Result<void>> {\n    validateAgentId(agentId);\n    validatePromptText(prompt.text);\n    const encodedId = encodeURIComponent(agentId);\n    return this.request<void>(`/agents/${encodedId}/followup`, 'POST', { prompt });\n  }\n\n  /**\n   * List available repositories\n   */\n  async listRepositories(): Promise<Result<Repository[]>> {\n    const result = await this.request<{ repositories: Repository[] }>('/repositories');\n    if (!result.success) return { success: false, error: result.error };\n    return { success: true, data: result.data?.repositories ?? [] };\n  }\n\n  /**\n   * List available models\n   *\n   * API Spec: https://cursor.com/docs/cloud-agent/api/endpoints#list-models\n   */\n  async listModels(): Promise<Result<string[]>> {\n    const result = await this.request<{ models: string[] }>('/models');\n    if (!result.success) return { success: false, error: result.error };\n    return { success: true, data: result.data?.models ?? [] };\n  }\n}\n","/**\n * Fleet - High-level API for Cursor Background Agent management\n *\n * Provides a clean interface for:\n * - Listing and monitoring agents\n * - Spawning new agents with context and model specification\n * - Sending follow-up messages\n * - Archiving conversations\n * - Diamond pattern orchestration\n * - Token-aware GitHub coordination\n *\n * All configuration is user-provided - no hardcoded values.\n */\n\nimport { mkdir, writeFile } from 'node:fs/promises';\nimport { dirname, join } from 'node:path';\nimport { log } from '../core/config.js';\nimport { extractOrg } from '../core/tokens.js';\nimport type {\n  Agent,\n  AgentStatus,\n  Conversation,\n  DiamondConfig,\n  PRComment,\n  Repository,\n  Result,\n  SpawnOptions,\n} from '../core/types.js';\nimport { GitHubClient } from '../github/client.js';\nimport { CursorAPI, type CursorAPIOptions } from './cursor-api.js';\n\n// ============================================\n// Types\n// ============================================\n\nexport interface FleetConfig extends CursorAPIOptions {\n  /** Path to archive conversations (default: ./memory-bank/recovery) */\n  archivePath?: string;\n}\n\nexport interface CoordinationConfig {\n  /** PR number for coordination channel */\n  coordinationPr: number;\n  /** Repository in owner/repo format */\n  repo: string;\n  /** Outbound poll interval (ms) - check agents */\n  outboundInterval?: number;\n  /** Inbound poll interval (ms) - check PR comments */\n  inboundInterval?: number;\n  /** Agent IDs to monitor */\n  agentIds?: string[];\n}\n\nexport interface SpawnContext {\n  controlManagerId?: string;\n  controlCenter?: string;\n  relatedAgents?: string[];\n  metadata?: Record<string, unknown>;\n}\n\n// ============================================\n// Fleet Class\n// ============================================\n\n/**\n * Fleet management for Cursor Background Agents\n *\n * Provides high-level operations for managing AI agents across multiple\n * GitHub organizations with automatic token switching and coordination.\n *\n * @example\n * ```typescript\n * const fleet = new Fleet();\n *\n * // Spawn a new agent\n * const result = await fleet.spawn({\n *   repository: 'https://github.com/owner/repo',\n *   task: 'Fix the authentication bug',\n *   target: { autoCreatePr: true }\n * });\n *\n * // Monitor agent status\n * const status = await fleet.status(result.data.id);\n * ```\n */\nexport class Fleet {\n  private api: CursorAPI | null;\n  private archivePath: string;\n  private useDirectApi: boolean;\n\n  /**\n   * Create a new Fleet instance\n   *\n   * @param config - Fleet configuration options including API key and timeout\n   */\n  constructor(config: FleetConfig = {}) {\n    this.archivePath = config.archivePath ?? './memory-bank/recovery';\n\n    // Try to initialize CursorAPI for direct access\n    try {\n      this.api = new CursorAPI({\n        apiKey: config.apiKey,\n        timeout: config.timeout,\n        maxRetries: config.maxRetries,\n        retryDelay: config.retryDelay,\n      });\n      this.useDirectApi = true;\n    } catch {\n      // API key not available\n      this.api = null;\n      this.useDirectApi = false;\n      log.debug('CursorAPI not available, some operations will fail');\n    }\n  }\n\n  /**\n   * Check if direct API is available\n   */\n  isApiAvailable(): boolean {\n    return this.useDirectApi && this.api !== null;\n  }\n\n  // ============================================\n  // Agent Discovery\n  // ============================================\n\n  /**\n   * List all agents\n   */\n  async list(): Promise<Result<Agent[]>> {\n    if (!this.api) {\n      return { success: false, error: 'Cursor API not available' };\n    }\n    return this.api.listAgents();\n  }\n\n  /**\n   * List agents filtered by status\n   */\n  async listByStatus(status: AgentStatus): Promise<Result<Agent[]>> {\n    const result = await this.list();\n    if (!result.success) return result;\n    return {\n      success: true,\n      data: result.data?.filter((a) => a.status === status) ?? [],\n    };\n  }\n\n  /**\n   * Get running agents only\n   */\n  async running(): Promise<Result<Agent[]>> {\n    return this.listByStatus('RUNNING');\n  }\n\n  /**\n   * Find agent by ID\n   */\n  async find(agentId: string): Promise<Result<Agent | undefined>> {\n    const result = await this.list();\n    if (!result.success) return { success: false, error: result.error };\n    return { success: true, data: result.data?.find((a) => a.id === agentId) };\n  }\n\n  /**\n   * Get agent status\n   */\n  async status(agentId: string): Promise<Result<Agent>> {\n    if (!this.api) {\n      return { success: false, error: 'Cursor API not available' };\n    }\n    return this.api.getAgentStatus(agentId);\n  }\n\n  // ============================================\n  // Agent Spawning\n  // ============================================\n\n  /**\n   * Spawn a new agent\n   *\n   * API Spec: https://cursor.com/docs/cloud-agent/api/endpoints\n   *\n   * @param options - Spawn options including repository, task, ref, target, and webhook\n   */\n  async spawn(options: SpawnOptions & { context?: SpawnContext }): Promise<Result<Agent>> {\n    if (!this.api) {\n      return { success: false, error: 'Cursor API not available' };\n    }\n\n    const task = this.buildTaskWithContext(options.task, options.context);\n\n    log.info(`Spawning agent in ${options.repository}`);\n\n    return this.api.launchAgent({\n      prompt: { text: task },\n      source: {\n        repository: options.repository,\n        ref: options.ref ?? 'main',\n      },\n      target: options.target,\n      webhook: options.webhook,\n    });\n  }\n\n  /**\n   * Build task string with coordination context\n   */\n  private buildTaskWithContext(task: string, context?: SpawnContext): string {\n    if (!context) return task;\n\n    const lines = [task, '', '--- COORDINATION CONTEXT ---'];\n\n    if (context.controlManagerId) {\n      lines.push(`Control Manager Agent: ${context.controlManagerId}`);\n    }\n    if (context.controlCenter) {\n      lines.push(`Control Center: ${context.controlCenter}`);\n    }\n    if (context.relatedAgents?.length) {\n      lines.push(`Related Agents: ${context.relatedAgents.join(', ')}`);\n    }\n    if (context.metadata) {\n      lines.push(`Metadata: ${JSON.stringify(context.metadata)}`);\n    }\n    lines.push('Report progress via PR comments and addFollowup.');\n    lines.push('--- END CONTEXT ---');\n\n    return lines.join('\\n');\n  }\n\n  // ============================================\n  // Agent Communication\n  // ============================================\n\n  /**\n   * Send a follow-up message to an agent\n   */\n  async followup(agentId: string, message: string): Promise<Result<void>> {\n    if (!this.api) {\n      return { success: false, error: 'Cursor API not available' };\n    }\n    return this.api.addFollowup(agentId, { text: message });\n  }\n\n  /**\n   * Broadcast message to multiple agents\n   */\n  async broadcast(agentIds: string[], message: string): Promise<Map<string, Result<void>>> {\n    const results = new Map<string, Result<void>>();\n\n    await Promise.all(\n      agentIds.map(async (id) => {\n        results.set(id, await this.followup(id, message));\n      })\n    );\n\n    return results;\n  }\n\n  // ============================================\n  // Conversations\n  // ============================================\n\n  /**\n   * Get agent conversation\n   */\n  async conversation(agentId: string): Promise<Result<Conversation>> {\n    if (!this.api) {\n      return { success: false, error: 'Cursor API not available' };\n    }\n    return this.api.getAgentConversation(agentId);\n  }\n\n  /**\n   * Archive agent conversation to disk\n   */\n  async archive(agentId: string, outputPath?: string): Promise<Result<string>> {\n    const conv = await this.conversation(agentId);\n    if (!conv.success) return { success: false, error: conv.error };\n\n    const path = outputPath ?? join(this.archivePath, `conversation-${agentId}.json`);\n\n    try {\n      await mkdir(dirname(path), { recursive: true });\n      await writeFile(path, JSON.stringify(conv.data, null, 2));\n      return { success: true, data: path };\n    } catch (error) {\n      return { success: false, error: String(error) };\n    }\n  }\n\n  // ============================================\n  // Repositories\n  // ============================================\n\n  /**\n   * List available repositories\n   */\n  async repositories(): Promise<Result<Repository[]>> {\n    if (!this.api) {\n      return { success: false, error: 'Cursor API not available' };\n    }\n    return this.api.listRepositories();\n  }\n\n  /**\n   * List available Cursor models\n   */\n  async listModels(): Promise<Result<string[]>> {\n    if (!this.api) {\n      return { success: false, error: 'Cursor API not available' };\n    }\n    return this.api.listModels();\n  }\n\n  // ============================================\n  // Diamond Pattern Orchestration\n  // ============================================\n\n  /**\n   * Create a diamond pattern orchestration\n   */\n  async createDiamond(config: DiamondConfig): Promise<\n    Result<{\n      targetAgents: Agent[];\n      counterpartyAgent: Agent;\n    }>\n  > {\n    // Get my agent ID for context\n    const runningResult = await this.running();\n    const myId = runningResult.data?.[0]?.id ?? 'control-manager';\n\n    // Spawn target agents\n    const targetAgents: Agent[] = [];\n    for (const target of config.targetRepos) {\n      const result = await this.spawn({\n        ...target,\n        context: {\n          controlManagerId: myId,\n          controlCenter: config.controlCenter,\n        },\n      });\n      if (result.success && result.data) {\n        targetAgents.push(result.data);\n      }\n    }\n\n    // Spawn counterparty with knowledge of target agents\n    const counterpartyResult = await this.spawn({\n      ...config.counterparty,\n      context: {\n        controlManagerId: myId,\n        controlCenter: config.controlCenter,\n        relatedAgents: targetAgents.map((a) => a.id),\n        metadata: {\n          pattern: 'diamond',\n          targetRepos: config.targetRepos.map((t) => t.repository),\n        },\n      },\n    });\n\n    if (!counterpartyResult.success || !counterpartyResult.data) {\n      return {\n        success: false,\n        error: counterpartyResult.error ?? 'Failed to spawn counterparty',\n      };\n    }\n\n    // Notify target agents about counterparty\n    for (const agent of targetAgents) {\n      await this.followup(\n        agent.id,\n        `Counterparty agent spawned: ${counterpartyResult.data.id}\\n` +\n          `You may receive direct communication from this agent for coordination.`\n      );\n    }\n\n    return {\n      success: true,\n      data: {\n        targetAgents,\n        counterpartyAgent: counterpartyResult.data,\n      },\n    };\n  }\n\n  // ============================================\n  // Fleet Monitoring\n  // ============================================\n\n  /**\n   * Get fleet summary\n   */\n  async summary(): Promise<\n    Result<{\n      total: number;\n      running: number;\n      completed: number;\n      failed: number;\n      agents: Agent[];\n    }>\n  > {\n    const result = await this.list();\n    if (!result.success) return { success: false, error: result.error };\n\n    const agents = result.data ?? [];\n    return {\n      success: true,\n      data: {\n        total: agents.length,\n        running: agents.filter((a) => a.status === 'RUNNING').length,\n        completed: agents.filter((a) => a.status === 'COMPLETED' || a.status === 'FINISHED').length,\n        failed: agents.filter((a) => a.status === 'FAILED').length,\n        agents,\n      },\n    };\n  }\n\n  /**\n   * Wait for agent to complete\n   */\n  async waitFor(\n    agentId: string,\n    options?: {\n      timeout?: number;\n      pollInterval?: number;\n    }\n  ): Promise<Result<Agent>> {\n    const timeout = options?.timeout ?? 300000;\n    const pollInterval = options?.pollInterval ?? 10000;\n    const start = Date.now();\n\n    while (Date.now() - start < timeout) {\n      const result = await this.status(agentId);\n      if (!result.success) return result;\n\n      if (result.data?.status !== 'RUNNING') {\n        return result;\n      }\n\n      await new Promise((r) => setTimeout(r, pollInterval));\n    }\n\n    return { success: false, error: `Timeout waiting for agent ${agentId}` };\n  }\n\n  /**\n   * Monitor specific agents until all complete\n   */\n  async monitorAgents(\n    agentIds: string[],\n    options?: {\n      pollInterval?: number;\n      onProgress?: (status: Map<string, AgentStatus>) => void;\n    }\n  ): Promise<Map<string, Agent>> {\n    const pollInterval = options?.pollInterval ?? 15000;\n    const results = new Map<string, Agent>();\n    const pending = new Set(agentIds);\n    const nonTerminalStates = new Set<AgentStatus>(['RUNNING', 'PENDING']);\n\n    while (pending.size > 0) {\n      const statusMap = new Map<string, AgentStatus>();\n\n      for (const id of pending) {\n        const result = await this.status(id);\n        if (result.success && result.data) {\n          statusMap.set(id, result.data.status);\n\n          if (!nonTerminalStates.has(result.data.status)) {\n            results.set(id, result.data);\n            pending.delete(id);\n          }\n        }\n      }\n\n      options?.onProgress?.(statusMap);\n\n      if (pending.size > 0) {\n        await new Promise((r) => setTimeout(r, pollInterval));\n      }\n    }\n\n    return results;\n  }\n\n  // ============================================\n  // GitHub Coordination (Token-Aware, Using GitHubClient)\n  // ============================================\n\n  /**\n   * Run bidirectional coordination loop with intelligent token switching\n   */\n  async coordinate(config: CoordinationConfig): Promise<void> {\n    const outboundInterval = config.outboundInterval ?? 60000;\n    const inboundInterval = config.inboundInterval ?? 15000;\n    const agentIds = new Set(config.agentIds ?? []);\n    const processedCommentIds = new Set<number>();\n\n    // Parse repo into owner/name\n    const [owner, repo] = config.repo.split('/');\n    if (!owner || !repo) {\n      throw new Error(\"Invalid repo format. Expected 'owner/repo'\");\n    }\n\n    log.info('=== Fleet Coordinator Started ===');\n    log.info(`Coordination PR: #${config.coordinationPr}`);\n    log.info(`Monitoring ${agentIds.size} agents`);\n    log.info(`Using token for org: ${extractOrg(config.repo)}`);\n\n    // Run both loops concurrently\n    await Promise.all([\n      this.outboundLoop(config, agentIds, outboundInterval),\n      this.inboundLoop(config, owner, repo, agentIds, processedCommentIds, inboundInterval),\n    ]);\n  }\n\n  private async outboundLoop(\n    config: CoordinationConfig,\n    agentIds: Set<string>,\n    interval: number\n  ): Promise<void> {\n    while (true) {\n      try {\n        log.debug(`[OUTBOUND] Checking ${agentIds.size} agents...`);\n\n        for (const agentId of [...agentIds]) {\n          const result = await this.status(agentId);\n\n          if (!result.success || !result.data) {\n            log.warn(`${agentId.slice(0, 12)}: Unable to fetch status`);\n            continue;\n          }\n\n          const agent = result.data;\n\n          if (agent.status === 'RUNNING') {\n            const message = [\n              ' STATUS CHECK from Fleet Coordinator',\n              '',\n              'Report progress by commenting on the coordination PR:',\n              `https://github.com/${config.repo}/pull/${config.coordinationPr}`,\n            ].join('\\n');\n\n            await this.followup(agentId, message);\n          } else {\n            agentIds.delete(agentId);\n          }\n        }\n      } catch (err) {\n        log.error('[OUTBOUND ERROR]', err);\n      }\n\n      await new Promise((r) => setTimeout(r, interval));\n    }\n  }\n\n  private async inboundLoop(\n    config: CoordinationConfig,\n    owner: string,\n    repo: string,\n    agentIds: Set<string>,\n    processedIds: Set<number>,\n    interval: number\n  ): Promise<void> {\n    while (true) {\n      try {\n        // Use GitHubClient for safe API calls (no shell injection)\n        const commentsResult = await GitHubClient.listPRComments(\n          owner,\n          repo,\n          config.coordinationPr\n        );\n\n        if (!commentsResult.success || !commentsResult.data) {\n          log.warn('[INBOUND] Failed to fetch comments:', commentsResult.error);\n          await new Promise((r) => setTimeout(r, interval));\n          continue;\n        }\n\n        for (const comment of commentsResult.data) {\n          if (processedIds.has(comment.id)) continue;\n\n          if (comment.body.includes('@cursor')) {\n            log.info(`[INBOUND] New @cursor mention from ${comment.author}`);\n            await this.processCoordinationComment(owner, repo, config, agentIds, comment);\n          }\n\n          processedIds.add(comment.id);\n        }\n      } catch (err) {\n        log.error('[INBOUND ERROR]', err);\n      }\n\n      await new Promise((r) => setTimeout(r, interval));\n    }\n  }\n\n  private async processCoordinationComment(\n    owner: string,\n    repo: string,\n    config: CoordinationConfig,\n    agentIds: Set<string>,\n    comment: PRComment\n  ): Promise<void> {\n    const body = comment.body;\n\n    if (body.includes(' DONE:')) {\n      const match = body.match(/ DONE:\\s*(bc-[\\w-]+)\\s*(.*)/);\n      const agentId = match?.[1];\n      const summary = match?.[2];\n      if (agentId && summary !== undefined) {\n        log.info(`Agent ${agentId} completed: ${summary}`);\n        agentIds.delete(agentId);\n\n        // Use GitHubClient for posting (uses PR review token)\n        await GitHubClient.postPRComment(\n          owner,\n          repo,\n          config.coordinationPr,\n          ` Acknowledged completion from ${agentId.slice(0, 12)}. Summary: ${summary}`\n        );\n      }\n    } else if (body.includes(' BLOCKED:')) {\n      const match = body.match(/ BLOCKED:\\s*(bc-[\\w-]+)\\s*(.*)/);\n      const agentId = match?.[1];\n      const issue = match?.[2];\n      if (agentId && issue !== undefined) {\n        log.warn(`Agent ${agentId} blocked: ${issue}`);\n\n        await GitHubClient.postPRComment(\n          owner,\n          repo,\n          config.coordinationPr,\n          ` Agent ${agentId.slice(0, 12)} blocked: ${issue}\\n\\nManual intervention may be required.`\n        );\n      }\n    }\n  }\n}\n","/**\n * Station-to-Station Handoff Protocol\n *\n * Enables seamless agent continuity:\n * 1. Current agent completes scope of work\n * 2. Spawns successor agent (not sub-agent - its own master)\n * 3. Successor confirms health via fleet tooling\n * 4. Successor retrieves predecessor's conversation\n * 5. Successor merges predecessor's PR\n * 6. Successor opens own PR and continues work\n *\n * All configuration is user-provided - no hardcoded values.\n */\n\nimport { spawnSync } from 'node:child_process';\nimport { randomUUID } from 'node:crypto';\nimport { existsSync, mkdirSync, writeFileSync } from 'node:fs';\nimport { join } from 'node:path';\nimport { getConfig, log } from '../core/config.js';\nimport { getEnvForRepo } from '../core/tokens.js';\nimport type { HandoffContext, HandoffOptions, HandoffResult, Result } from '../core/types.js';\nimport { CursorAPI } from '../fleet/cursor-api.js';\nimport { AIAnalyzer } from '../triage/analyzer.js';\n\n// ============================================\n// Types\n// ============================================\n\nexport type MergeMethod = 'merge' | 'squash' | 'rebase';\n\nexport interface TakeoverOptions {\n  admin?: boolean;\n  auto?: boolean;\n  mergeMethod?: MergeMethod;\n  deleteBranch?: boolean;\n}\n\n// ============================================\n// Validation Helpers\n// ============================================\n\n/**\n * Validate branch name to prevent injection\n */\nfunction isValidBranchName(branch: string): boolean {\n  return /^[a-zA-Z0-9._/-]+$/.test(branch) && branch.length <= 200;\n}\n\n// isValidGitRef is available from github/client.ts if needed\n\n// ============================================\n// Handoff Manager\n// ============================================\n\nexport class HandoffManager {\n  private api: CursorAPI | null;\n  private analyzer: AIAnalyzer | null;\n  private repo: string | undefined;\n\n  constructor(options?: { cursorApiKey?: string; anthropicKey?: string; repo?: string }) {\n    // Initialize Cursor API if available\n    try {\n      this.api = new CursorAPI({ apiKey: options?.cursorApiKey });\n    } catch {\n      this.api = null;\n      log.warn('Cursor API not available for handoff operations');\n    }\n\n    // Initialize AI Analyzer if available\n    try {\n      this.analyzer = new AIAnalyzer({ apiKey: options?.anthropicKey });\n    } catch {\n      this.analyzer = null;\n      log.warn('AI Analyzer not available for handoff analysis');\n    }\n\n    // No hardcoded default - repo must be explicitly configured\n    this.repo = options?.repo ?? getConfig().defaultRepository;\n  }\n\n  /**\n   * Set the repository for GitHub operations\n   */\n  setRepo(repo: string): void {\n    this.repo = repo;\n  }\n\n  /**\n   * Initiate handoff to successor agent\n   */\n  async initiateHandoff(predecessorId: string, options: HandoffOptions): Promise<HandoffResult> {\n    log.info('=== Station-to-Station Handoff Initiated ===');\n\n    if (!this.api) {\n      return { success: false, error: 'Cursor API not available' };\n    }\n\n    // 1. Analyze predecessor's conversation\n    log.info(' Analyzing predecessor conversation...');\n    const convResult = await this.api.getAgentConversation(predecessorId);\n    if (!convResult.success || !convResult.data) {\n      return { success: false, error: `Failed to get conversation: ${convResult.error}` };\n    }\n\n    let completedWork: string[] = [];\n    let outstandingTasks: string[] = options.tasks ?? [];\n    let decisions: string[] = [];\n\n    // Use AI analysis if available\n    if (this.analyzer) {\n      try {\n        const analysis = await this.analyzer.analyzeConversation(convResult.data);\n        completedWork = analysis.completedTasks.map((t) => t.title);\n        outstandingTasks = [\n          ...analysis.outstandingTasks.map((t) => `[${t.priority}] ${t.title}`),\n          ...outstandingTasks,\n        ];\n        decisions = analysis.recommendations;\n      } catch (err) {\n        log.warn('AI analysis failed, using minimal context:', err);\n      }\n    }\n\n    // 2. Build handoff context - use crypto.randomUUID() for unique IDs\n    const handoffContext: HandoffContext = {\n      predecessorId,\n      predecessorPr: options.currentPr,\n      predecessorBranch: options.currentBranch,\n      handoffTime: new Date().toISOString(),\n      completedWork: completedWork.map((w) => ({\n        id: `completed-${randomUUID()}`,\n        title: w,\n        description: w,\n        priority: 'medium' as const,\n        category: 'other' as const,\n        status: 'completed' as const,\n      })),\n      outstandingTasks: outstandingTasks.map((t) => ({\n        id: `task-${randomUUID()}`,\n        title: t,\n        description: t,\n        priority: 'medium' as const,\n        category: 'other' as const,\n        status: 'pending' as const,\n      })),\n      decisions,\n    };\n\n    // 3. Save handoff context\n    const handoffDir = join('.cursor', 'handoff', predecessorId);\n    if (!existsSync(handoffDir)) {\n      mkdirSync(handoffDir, { recursive: true });\n    }\n    writeFileSync(join(handoffDir, 'context.json'), JSON.stringify(handoffContext, null, 2));\n\n    // 4. Build successor prompt\n    const successorPrompt = this.buildSuccessorPrompt(handoffContext, options);\n\n    // 5. Spawn successor agent\n    log.info(' Spawning successor agent...');\n    const spawnResult = await this.api.launchAgent({\n      prompt: { text: successorPrompt },\n      source: {\n        repository: options.repository,\n        ref: options.ref ?? 'main',\n      },\n    });\n\n    if (!spawnResult.success || !spawnResult.data) {\n      return { success: false, error: `Failed to spawn successor: ${spawnResult.error}` };\n    }\n\n    const successorId = spawnResult.data.id;\n    log.info(` Successor spawned: ${successorId}`);\n\n    // 6. Wait for health check\n    log.info(' Waiting for successor health confirmation...');\n    const healthCheckResult = await this.waitForHealthCheck(\n      successorId,\n      options.healthCheckTimeout ?? 300000\n    );\n\n    return {\n      success: true,\n      successorId,\n      successorHealthy: healthCheckResult.healthy,\n    };\n  }\n\n  /**\n   * Called by successor to confirm health\n   */\n  async confirmHealthAndBegin(successorId: string, predecessorId: string): Promise<void> {\n    if (!this.api) {\n      throw new Error('Cursor API not available');\n    }\n\n    await this.api.addFollowup(predecessorId, {\n      text: ` HANDOFF CONFIRMED\n\nSuccessor agent ${successorId} is healthy and beginning work.\n\nI will now:\n1. Review your conversation history\n2. Merge your PR\n3. Open my own PR\n4. Continue the outstanding tasks\n\nYou can safely conclude your session.\n\n@cursor  HANDOFF: ${successorId} confirmed healthy`,\n    });\n  }\n\n  /**\n   * Called by successor to merge predecessor and take over\n   */\n  async takeover(\n    predecessorId: string,\n    predecessorPr: number,\n    newBranchName: string,\n    options?: TakeoverOptions\n  ): Promise<Result<void>> {\n    log.info('=== Successor Takeover ===');\n\n    if (!this.repo) {\n      return {\n        success: false,\n        error: 'Repository is required. Set via constructor options or setRepo()',\n      };\n    }\n\n    // Validate inputs to prevent injection\n    if (!isValidBranchName(newBranchName)) {\n      return { success: false, error: 'Invalid branch name format' };\n    }\n\n    if (options?.admin && options?.auto) {\n      return { success: false, error: 'Cannot use --admin and --auto simultaneously' };\n    }\n\n    // Use appropriate token for the repo\n    const env = { ...process.env, ...getEnvForRepo(this.repo) };\n\n    // 1. Merge predecessor's PR using spawnSync (no shell injection)\n    log.info(` Merging predecessor PR #${predecessorPr}...`);\n    try {\n      const mergeMethod = options?.mergeMethod ?? 'squash';\n      const deleteBranch = options?.deleteBranch !== false;\n\n      // Build args array safely\n      const mergeArgs = [\n        'pr',\n        'merge',\n        String(predecessorPr),\n        `--${mergeMethod}`,\n        '--repo',\n        this.repo,\n      ];\n\n      if (deleteBranch) {\n        mergeArgs.push('--delete-branch');\n      }\n\n      if (options?.admin) {\n        mergeArgs.push('--admin');\n      } else if (options?.auto) {\n        mergeArgs.push('--auto');\n      }\n\n      const mergeProc = spawnSync('gh', mergeArgs, { encoding: 'utf-8', env });\n      if (mergeProc.error || mergeProc.status !== 0) {\n        return {\n          success: false,\n          error: `Failed to merge PR: ${mergeProc.stderr || mergeProc.error}`,\n        };\n      }\n      log.info(' Predecessor PR merged');\n    } catch (err) {\n      return { success: false, error: `Failed to merge PR: ${err}` };\n    }\n\n    // 2. Pull latest main using spawnSync\n    log.info(' Pulling latest main...');\n    try {\n      // First checkout main\n      const checkoutMain = spawnSync('git', ['checkout', 'main'], { encoding: 'utf-8' });\n      if (checkoutMain.error || checkoutMain.status !== 0) {\n        return {\n          success: false,\n          error: `Failed to checkout main: ${checkoutMain.stderr || checkoutMain.error}`,\n        };\n      }\n\n      // Then pull\n      const pullProc = spawnSync('git', ['pull'], { encoding: 'utf-8' });\n      if (pullProc.error || pullProc.status !== 0) {\n        return {\n          success: false,\n          error: `Failed to pull main: ${pullProc.stderr || pullProc.error}`,\n        };\n      }\n    } catch (err) {\n      return { success: false, error: `Failed to pull main: ${err}` };\n    }\n\n    // 3. Create own branch using spawnSync (with validated branch name)\n    log.info(` Creating branch: ${newBranchName}...`);\n    try {\n      const branchProc = spawnSync('git', ['checkout', '-b', newBranchName], {\n        encoding: 'utf-8',\n      });\n      if (branchProc.error || branchProc.status !== 0) {\n        return {\n          success: false,\n          error: `Failed to create branch: ${branchProc.stderr || branchProc.error}`,\n        };\n      }\n    } catch (err) {\n      return { success: false, error: `Failed to create branch: ${err}` };\n    }\n\n    // 4. Notify predecessor\n    if (this.api) {\n      await this.api.addFollowup(predecessorId, {\n        text: ` TAKEOVER COMPLETE\n\nI have:\n1. Merged your PR #${predecessorPr}\n2. Created my own branch: ${newBranchName}\n3. Loaded your context\n\nYour session is now complete. Thank you!\n\n@cursor  DONE: ${predecessorId} successfully handed off`,\n      });\n    }\n\n    log.info(' Takeover complete');\n    return { success: true };\n  }\n\n  /**\n   * Build successor prompt\n   */\n  private buildSuccessorPrompt(context: HandoffContext, options: HandoffOptions): string {\n    return `# STATION-TO-STATION HANDOFF\n\nYou are a SUCCESSOR AGENT taking over from predecessor ${context.predecessorId}.\n\n## CRITICAL FIRST STEPS\n\n1. **IMMEDIATELY** send health confirmation:\n   \\`\\`\\`\n   agentic handoff confirm ${context.predecessorId}\n   \\`\\`\\`\n\n2. **LOAD** predecessor context from:\n   \\`.cursor/handoff/${context.predecessorId}/\\`\n\n3. **TAKEOVER** from predecessor:\n   \\`\\`\\`\n   agentic handoff takeover ${context.predecessorId} ${context.predecessorPr} successor/continue-work-$(date +%Y%m%d)\n   \\`\\`\\`\n\n4. **CREATE YOUR OWN HOLD-OPEN PR** and continue work.\n\n## PREDECESSOR SUMMARY\n\n### Completed Work\n${context.completedWork.map((t) => `- ${t.title}`).join('\\n')}\n\n### Outstanding Tasks (YOUR WORK)\n${context.outstandingTasks.map((t) => `- ${t.title}`).join('\\n')}\n\n### Recommendations\n${context.decisions.map((d) => `- ${d}`).join('\\n')}\n\n## IMPORTANT\n\n- You are NOT a sub-agent - you are an independent master agent\n- Predecessor PR #${context.predecessorPr} on branch \\`${context.predecessorBranch}\\`\n- Repository: ${options.repository}\n- Handoff time: ${context.handoffTime}\n\nBEGIN by sending health confirmation NOW.\n`;\n  }\n\n  /**\n   * Wait for health check from successor\n   */\n  private async waitForHealthCheck(\n    successorId: string,\n    timeout: number\n  ): Promise<{ healthy: boolean }> {\n    if (!this.api) {\n      return { healthy: false };\n    }\n\n    const start = Date.now();\n    const interval = 15000;\n\n    while (Date.now() - start < timeout) {\n      const status = await this.api.getAgentStatus(successorId);\n\n      if (status.success && status.data) {\n        if (status.data.status === 'RUNNING') {\n          const conv = await this.api.getAgentConversation(successorId);\n          if (conv.success && conv.data) {\n            const messages = conv.data.messages || [];\n            for (const msg of messages) {\n              if (msg.text?.includes('HANDOFF CONFIRMED')) {\n                return { healthy: true };\n              }\n            }\n          }\n        } else if (status.data.status === 'FAILED') {\n          return { healthy: false };\n        }\n      }\n\n      await new Promise((r) => setTimeout(r, interval));\n    }\n\n    return { healthy: false };\n  }\n}\n","/**\n * Core module for agentic-control\n *\n * Exports types, token management, configuration, and AI providers\n */\n\n// Configuration\nexport {\n  type AgenticConfig,\n  type FleetConfig,\n  getConfig,\n  getConfigPath,\n  getConfigValue,\n  getCursorApiKey,\n  getDefaultApiKeyEnvVar,\n  getDefaultModel,\n  getFleetDefaults,\n  getLogLevel,\n  getTriageApiKey,\n  getTriageConfig,\n  initConfig,\n  isVerbose,\n  loadConfigFromPath,\n  log,\n  resetConfig,\n  setConfig,\n  type TriageConfig,\n} from './config.js';\n// Typed errors\nexport {\n  ConfigErrorCode,\n  ConfigurationError,\n  DockerBuildError,\n  DockerErrorCode,\n  SandboxError,\n  SandboxErrorCode,\n} from './errors.js';\n// AI Provider loading\nexport {\n  clearProviderCache,\n  getOrLoadProvider,\n  getSupportedProviders,\n  isValidProvider,\n  loadProvider,\n  type ModelFactory,\n  PROVIDER_CONFIG,\n  type ProviderOptions,\n  resolveProviderOptions,\n  type SupportedProvider,\n} from './providers.js';\n// Security utilities\nexport { createSafeError, safeConsole, sanitizeEnvironment, sanitizeError } from './security.js';\n// Safe subprocess execution\nexport {\n  safeDockerCommand,\n  safeGitCommand,\n  safeSpawn,\n  safeSpawnSync,\n  validateCommandArgs,\n} from './subprocess.js';\n// Token management\nexport {\n  addOrganization,\n  extractOrg,\n  getConfiguredOrgs,\n  getEnvForPRReview,\n  getEnvForRepo,\n  getOrgConfig,\n  getPRReviewToken,\n  getPRReviewTokenEnvVar,\n  getTokenConfig,\n  getTokenEnvVar,\n  getTokenForOrg,\n  getTokenForRepo,\n  getTokenSummary,\n  hasTokenForOrg,\n  hasTokenForRepo,\n  setTokenConfig,\n  validateTokens,\n} from './tokens.js';\n// Types\nexport * from './types.js';\n// Configuration validation\nexport {\n  AgenticConfigSchema,\n  validateConfig,\n  validateEnvVar,\n  validateEnvVarWithMessage,\n  validateGitRef,\n  validatePositiveInt,\n  validateRepository,\n} from './validation.js';\n","/**\n * GitHub integration module for agentic-control\n *\n * Provides token-aware GitHub operations:\n * - Automatic token selection based on organization\n * - Consistent identity for PR reviews\n * - Repository and PR management\n */\n\nexport { cloneRepo, GitHubClient, isValidGitRef, isValidRepoFormat } from './client.js';\n","/**\n * GitHub Actions integration module\n *\n * Provides re-exports for use in GitHub Marketplace Actions:\n * - agentic-pr-review: AI-powered PR review\n * - agentic-ci-resolution: Automated CI failure resolution\n * - agentic-issue-triage: Intelligent issue triage\n * - agentic-orchestrator: Multi-agent coordination\n *\n * These exports are consumed by the composite actions in /actions directory\n */\n\n// Re-export core types and utilities\nexport type {\n  Agent,\n  AgentStatus,\n  Blocker,\n  OrganizationConfig,\n  SpawnOptions,\n  TokenConfig,\n  TriageResult,\n} from '../core/index.js';\n\nexport {\n  addOrganization,\n  getTokenForOrg,\n  getTokenForRepo,\n  safeSpawnSync,\n  setTokenConfig,\n} from '../core/index.js';\n// Re-export fleet management\nexport type { CoordinationConfig, FleetConfig } from '../fleet/index.js';\nexport { CursorAPI, type CursorAPIOptions, Fleet } from '../fleet/index.js';\n// Re-export GitHub operations\nexport { cloneRepo, GitHubClient, isValidGitRef, isValidRepoFormat } from '../github/index.js';\n// Re-export handoff protocols\nexport { HandoffManager, type TakeoverOptions } from '../handoff/index.js';\n// Re-export sandbox execution\nexport type { ContainerConfig, ContainerResult, SandboxOptions } from '../sandbox/index.js';\nexport { ContainerManager, SandboxExecutor } from '../sandbox/index.js';\n// Re-export AI triage\nexport { AIAnalyzer, type AIAnalyzerOptions } from '../triage/index.js';\n","/**\n * AI Triage module for agentic-control\n *\n * Unified AI-powered triage and analysis:\n * - Conversation analysis and task extraction\n * - PR triage with MCP integration\n * - Code review and issue creation\n * - GitHub operations\n * - Multi-provider AI support\n */\n\n// GitHub client (re-export from github module)\nexport { GitHubClient, type GitHubConfig } from '../github/client.js';\n// Agent - unified AI agent for all agentic tasks\nexport {\n  Agent,\n  type AgentConfig,\n  type AgentResult,\n  type AgentStep,\n  runSmartTask,\n  runTask,\n  type TaskAnalysis,\n  TaskAnalysisSchema,\n} from './agent.js';\n// Analyzer - unified AI analysis (conversations, PRs, code review)\n// Backwards compatibility alias\nexport {\n  AIAnalyzer, // Legacy alias\n  type AIAnalyzerOptions, // Legacy alias\n  Analyzer,\n  Analyzer as PRAnalyzer,\n  type AnalyzerOptions,\n} from './analyzer.js';\n// MCP client integration\nexport {\n  closeMCPClients,\n  getMCPTools,\n  initializeMCPClients,\n  MCP_ENV_VARS,\n  type MCPClientConfig,\n  type MCPClients,\n  mcpCredentials,\n} from './mcp-clients.js';\n\n// PR triage agent (specialized for PR workflows)\nexport { PRTriageAgent } from './pr-triage-agent.js';\n\n// Issue resolver\nexport { Resolver, type ResolverConfig } from './resolver.js';\n// Security utilities\nexport {\n  assessCommandSafety,\n  type PathValidationResult,\n  sanitizeFilename,\n  validatePath,\n} from './security.js';\n\n// Triage orchestrator\nexport { Triage, type TriageConfig } from './triage.js';\n\n// Types\nexport * from './types.js';\n","/**\n * MCP Client Integration - Config-driven\n *\n * Reads MCP server configuration from agentic.config.json.\n * Falls back to sensible defaults if not configured.\n */\n\nimport { experimental_createMCPClient as createMCPClient } from '@ai-sdk/mcp';\nimport { Experimental_StdioMCPTransport as StdioMCPTransport } from '@ai-sdk/mcp/mcp-stdio';\nimport type { ToolSet } from 'ai';\nimport { getConfig, type MCPConfig, type MCPServerConfig } from '../core/config.js';\n\n// \n// Default MCP Configuration (used if not in config file)\n// \n\nconst DEFAULT_MCP_CONFIG: MCPConfig = {\n  // \n  // Vendor Connectors (Python) - Jules, Cursor, GitHub, Slack, etc.\n  // Provides unified access to all vendor APIs via MCP.\n  // Install: pip install vendor-connectors[mcp]\n  // \n  'vendor-connectors': {\n    enabled: true,\n    tokenEnvVar: 'GOOGLE_JULES_API_KEY',\n    tokenEnvVarFallbacks: ['JULES_API_KEY', 'CURSOR_API_KEY'],\n    mode: 'stdio',\n    command: 'python',\n    args: ['-m', 'vendor_connectors.mcp'],\n  },\n  cursor: {\n    enabled: true,\n    tokenEnvVar: 'CURSOR_API_KEY',\n    tokenEnvVarFallbacks: ['COPILOT_MCP_CURSOR_API_KEY'],\n    mode: 'stdio',\n    command: 'npx',\n    args: ['-y', 'cursor-mcp-server'],\n  },\n  github: {\n    enabled: true,\n    tokenEnvVar: 'GITHUB_TOKEN',\n    tokenEnvVarFallbacks: ['GITHUB_JBCOM_TOKEN', 'COPILOT_MCP_GITHUB_TOKEN'],\n    mode: 'stdio',\n    command: 'npx',\n    args: ['-y', '@modelcontextprotocol/server-github'],\n  },\n  context7: {\n    enabled: true,\n    tokenEnvVar: 'CONTEXT7_API_KEY',\n    tokenEnvVarFallbacks: ['COPILOT_MCP_CONTEXT7_API_KEY'],\n    mode: 'stdio',\n    command: 'npx',\n    args: ['-y', '@anthropic/context7-mcp'],\n  },\n  '21st-magic': {\n    enabled: true,\n    tokenEnvVar: 'TWENTY_FIRST_API_KEY',\n    tokenEnvVarFallbacks: ['COPILOT_MCP_TWENTY_FIRST_API_KEY'],\n    mode: 'stdio',\n    command: 'npx',\n    args: ['-y', '@21st-dev/magic-mcp@latest'],\n  },\n};\n\n// \n// Helper Functions\n// \n\n/**\n * Resolve token from env vars with fallbacks\n */\nfunction resolveToken(serverConfig: MCPServerConfig): string | undefined {\n  // Try primary env var\n  if (serverConfig.tokenEnvVar) {\n    const token = process.env[serverConfig.tokenEnvVar];\n    if (token) return token;\n  }\n\n  // Try fallbacks\n  if (serverConfig.tokenEnvVarFallbacks) {\n    for (const envVar of serverConfig.tokenEnvVarFallbacks) {\n      const token = process.env[envVar];\n      if (token) return token;\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Get merged MCP config (user config + defaults)\n */\nfunction getMCPConfig(): MCPConfig {\n  const userConfig = getConfig().mcp ?? {};\n\n  // Merge user config with defaults\n  const merged: MCPConfig = {};\n\n  for (const [name, defaultServer] of Object.entries(DEFAULT_MCP_CONFIG)) {\n    const userServer = userConfig[name];\n    if (userServer === undefined) {\n      merged[name] = defaultServer;\n    } else {\n      merged[name] = { ...defaultServer, ...userServer };\n    }\n  }\n\n  // Add any custom servers from user config\n  for (const [name, server] of Object.entries(userConfig)) {\n    if (!(name in merged) && server) {\n      merged[name] = server;\n    }\n  }\n\n  return merged;\n}\n\n// \n// Exports for backward compatibility\n// \n\n/** @deprecated Use getMCPConfig() instead */\nexport const MCP_ENV_VARS = {\n  cursor: { name: 'CURSOR_API_KEY', sources: ['COPILOT_MCP_CURSOR_API_KEY', 'CURSOR_API_KEY'] },\n  github: {\n    name: 'GITHUB_TOKEN',\n    sources: ['COPILOT_MCP_GITHUB_TOKEN', 'GITHUB_JBCOM_TOKEN', 'GITHUB_TOKEN'],\n  },\n  context7: {\n    name: 'CONTEXT7_API_KEY',\n    sources: ['COPILOT_MCP_CONTEXT7_API_KEY', 'CONTEXT7_API_KEY'],\n    optional: true,\n  },\n} as const;\n\n/** @deprecated Use getMCPConfig() and resolveToken() instead */\nexport const mcpCredentials = {\n  get cursorApiKey() {\n    return resolveToken(getMCPConfig().cursor ?? {});\n  },\n  get githubToken() {\n    return resolveToken(getMCPConfig().github ?? {});\n  },\n  get context7ApiKey() {\n    return resolveToken(getMCPConfig().context7 ?? {});\n  },\n};\n\n// \n// Types\n// \n\nexport interface MCPClientConfig {\n  /** Override specific server configs */\n  cursor?: Partial<MCPServerConfig> & { apiKey?: string };\n  github?: Partial<MCPServerConfig> & { token?: string };\n  context7?: Partial<MCPServerConfig> & { apiKey?: string };\n  '21st-magic'?: Partial<MCPServerConfig> & { apiKey?: string };\n  /**\n   * Vendor Connectors MCP Server (Python)\n   * Provides unified access to Jules, Cursor, GitHub, Slack, Vault, Zoom, etc.\n   * Install: pip install vendor-connectors[mcp]\n   */\n  'vendor-connectors'?: Partial<MCPServerConfig> & {\n    julesApiKey?: string;\n    cursorApiKey?: string;\n    ollamaApiKey?: string;\n  };\n}\n\nexport interface MCPClients {\n  [name: string]: Awaited<ReturnType<typeof createMCPClient>> | undefined;\n}\n\n// \n// Main Functions\n// \n\n/**\n * Initialize MCP clients based on config\n */\nexport async function initializeMCPClients(overrides: MCPClientConfig = {}): Promise<MCPClients> {\n  const clients: MCPClients = {};\n  const mcpConfig = getMCPConfig();\n\n  for (const [name, serverConfig] of Object.entries(mcpConfig)) {\n    if (!serverConfig || serverConfig.enabled === false) continue;\n\n    // Apply overrides\n    const override = overrides[name as keyof MCPClientConfig];\n    const config = override ? { ...serverConfig, ...override } : serverConfig;\n\n    // Resolve token\n    let token = resolveToken(config);\n\n    // Check for legacy override format\n    if (override) {\n      if ('apiKey' in override && override.apiKey) token = override.apiKey;\n      if ('token' in override && override.token) token = override.token;\n    }\n\n    // Optional servers that can run without tokens\n    const optionalServers = ['context7', '21st-magic', 'vendor-connectors'];\n    if (!token && !optionalServers.includes(name)) {\n      // Skip non-optional servers without tokens\n      continue;\n    }\n\n    try {\n      if (config.mode === 'stdio' && config.command) {\n        const env: Record<string, string> = { ...(process.env as Record<string, string>) };\n\n        // Set token in environment for the command\n        if (token) {\n          if (name === 'cursor') env.CURSOR_API_KEY = token;\n          if (name === 'github') env.GITHUB_TOKEN = token;\n          if (name === 'context7') env.CONTEXT7_API_KEY = token;\n          if (name === '21st-magic') env.TWENTY_FIRST_API_KEY = token;\n        }\n\n        // vendor-connectors uses multiple tokens from env vars (outside token check per AI review)\n        if (name === 'vendor-connectors') {\n          const vcOverride = overrides['vendor-connectors'];\n          // Pass through all relevant API keys for vendor-connectors, respecting overrides\n          env.GOOGLE_JULES_API_KEY =\n            vcOverride?.julesApiKey ?? process.env.GOOGLE_JULES_API_KEY ?? '';\n          env.JULES_API_KEY =\n            vcOverride?.julesApiKey ??\n            process.env.JULES_API_KEY ??\n            process.env.GOOGLE_JULES_API_KEY ??\n            '';\n          env.CURSOR_API_KEY = vcOverride?.cursorApiKey ?? process.env.CURSOR_API_KEY ?? '';\n          env.OLLAMA_API_KEY = vcOverride?.ollamaApiKey ?? process.env.OLLAMA_API_KEY ?? '';\n        }\n\n        clients[name] = await createMCPClient({\n          transport: new StdioMCPTransport({\n            command: config.command,\n            args: config.args ?? [],\n            env,\n          }),\n        });\n      }\n      // TODO: Add proxy mode support when needed\n    } catch (err) {\n      console.warn(`Failed to initialize ${name} MCP client:`, err);\n    }\n  }\n\n  return clients;\n}\n\n/**\n * Get all tools from initialized MCP clients\n */\nexport async function getMCPTools(clients: MCPClients): Promise<ToolSet> {\n  const allTools: ToolSet = {};\n\n  for (const [name, client] of Object.entries(clients)) {\n    if (!client) continue;\n\n    try {\n      const { tools } = await client.tools();\n      if (tools) {\n        for (const [toolName, mcpTool] of Object.entries(tools)) {\n          // MCP tools need to be cast to AI SDK ToolSet format\n          allTools[`${name}_${toolName}`] = mcpTool as unknown as ToolSet[string];\n        }\n      }\n    } catch (err) {\n      console.warn(`Failed to get tools from ${name}:`, err);\n    }\n  }\n\n  return allTools;\n}\n\n/**\n * Close all MCP clients\n */\nexport async function closeMCPClients(clients: MCPClients): Promise<void> {\n  for (const [name, client] of Object.entries(clients)) {\n    if (!client) continue;\n\n    try {\n      await client.close();\n    } catch (err) {\n      console.warn(`Failed to close ${name} MCP client:`, err);\n    }\n  }\n}\n\n// NOTE: The listMCPPrompts and listMCPResources methods have been removed.\n// The current @ai-sdk/mcp MCPClient type does not expose these methods.\n// If you need to list prompts or resources, use the MCP server's native API directly\n// or wait for future @ai-sdk/mcp updates that may add this functionality.\n","/**\n * Agent - Unified AI-powered development agent\n *\n * A single, comprehensive agent that handles all agentic tasks:\n * - Code operations (bash, file editing, git)\n * - MCP integrations (Cursor, GitHub, Context7)\n * - Extended thinking/reasoning\n * - Web search\n * - Structured output\n * - Tool approval for sensitive operations\n *\n * This consolidates CodeAgent, EnhancedAgent, and UnifiedAgent into one class.\n */\n\nimport { execFileSync, execSync } from 'node:child_process';\nimport { existsSync, mkdirSync, readFileSync, unlinkSync, writeFileSync } from 'node:fs';\nimport { dirname } from 'node:path';\nimport { type AnthropicProviderOptions, anthropic } from '@ai-sdk/anthropic';\nimport { generateObject, generateText, stepCountIs, streamText, type ToolSet, tool } from 'ai';\nimport { z } from 'zod';\nimport {\n  closeMCPClients,\n  getMCPTools,\n  initializeMCPClients,\n  type MCPClientConfig,\n  type MCPClients,\n} from './mcp-clients.js';\nimport { assessCommandSafety, validatePath } from './security.js';\n\n// \n// Configuration Types\n// \n\nexport interface AgentConfig {\n  /** Working directory for file operations (sandbox root) */\n  workingDirectory?: string;\n  /** Maximum steps for multi-step tool calls */\n  maxSteps?: number;\n  /** MCP client configuration */\n  mcp?: MCPClientConfig;\n  /** Model to use */\n  model?: 'claude-sonnet-4-20250514' | 'claude-opus-4-20250514' | string;\n  /** Enable verbose logging */\n  verbose?: boolean;\n  /** Enable extended thinking/reasoning for complex tasks */\n  reasoning?: {\n    enabled: boolean;\n    /** Token budget for thinking (default: 12000) */\n    budgetTokens?: number;\n  };\n  /** Enable web search capability */\n  webSearch?: {\n    enabled: boolean;\n    /** Max number of searches per request */\n    maxUses?: number;\n    /** Allowed domains for search */\n    allowedDomains?: string[];\n    /** Blocked domains */\n    blockedDomains?: string[];\n  };\n  /** Tool approval settings */\n  approval?: {\n    /** Tools requiring approval before execution */\n    requireApproval?: string[];\n    /** Callback to handle approval requests */\n    onApprovalRequest?: (toolName: string, input: unknown) => Promise<boolean>;\n  };\n}\n\nexport interface AgentResult {\n  success: boolean;\n  result: string;\n  reasoning?: string;\n  steps: AgentStep[];\n  usage?: {\n    inputTokens: number;\n    outputTokens: number;\n    totalTokens: number;\n  };\n}\n\nexport interface AgentStep {\n  toolName: string;\n  input: unknown;\n  output: string;\n  timestamp: Date;\n  approved?: boolean;\n}\n\n// \n// Structured Output Schemas\n// \n\nexport const TaskAnalysisSchema = z.object({\n  complexity: z.enum(['simple', 'moderate', 'complex']).describe('Task complexity assessment'),\n  estimatedSteps: z.number().describe('Estimated number of steps to complete'),\n  requiresWebSearch: z.boolean().describe('Whether web search might help'),\n  requiresReasoning: z.boolean().describe('Whether extended thinking would help'),\n  subtasks: z.array(\n    z.object({\n      description: z.string(),\n      priority: z.enum(['critical', 'high', 'medium', 'low']),\n      tools: z.array(z.string()).describe('Tools likely needed'),\n    })\n  ),\n  risks: z.array(z.string()).describe('Potential risks or blockers'),\n});\n\nexport type TaskAnalysis = z.infer<typeof TaskAnalysisSchema>;\n\n// \n// Agent Class\n// \n\nexport class Agent {\n  private config: Required<Omit<AgentConfig, 'mcp' | 'reasoning' | 'webSearch' | 'approval'>> & {\n    mcp?: MCPClientConfig;\n    reasoning?: AgentConfig['reasoning'];\n    webSearch?: AgentConfig['webSearch'];\n    approval?: AgentConfig['approval'];\n  };\n  private mcpClients: MCPClients | null = null;\n  private initialized = false;\n  /** Promise-based lock to prevent concurrent initialization race conditions */\n  private initializationPromise: Promise<void> | null = null;\n\n  constructor(config: AgentConfig = {}) {\n    this.config = {\n      workingDirectory: config.workingDirectory ?? process.cwd(),\n      maxSteps: config.maxSteps ?? 25,\n      model: config.model ?? 'claude-sonnet-4-20250514',\n      verbose: config.verbose ?? false,\n      mcp: config.mcp,\n      reasoning: config.reasoning,\n      webSearch: config.webSearch,\n      approval: config.approval,\n    };\n  }\n\n  // \n  // Lifecycle\n  // \n\n  /**\n   * Initialize MCP clients and prepare the agent.\n   * Thread-safe: concurrent calls will wait for the same initialization to complete.\n   */\n  async initialize(): Promise<void> {\n    // Fast path: already initialized\n    if (this.initialized) return;\n\n    // If initialization is in progress, wait for it to complete\n    if (this.initializationPromise) {\n      return this.initializationPromise;\n    }\n\n    // Start initialization and store the promise so concurrent calls can wait\n    this.initializationPromise = this.doInitialize();\n\n    try {\n      await this.initializationPromise;\n    } catch (error) {\n      // Reset on failure so retry is possible\n      this.initializationPromise = null;\n      throw error;\n    }\n  }\n\n  /**\n   * Internal initialization logic - only called once due to promise lock\n   */\n  private async doInitialize(): Promise<void> {\n    this.log(' Initializing Agent...');\n\n    if (this.config.mcp) {\n      this.mcpClients = await initializeMCPClients(this.config.mcp);\n    }\n\n    this.initialized = true;\n    this.log(' Agent initialized');\n  }\n\n  /**\n   * Close all connections and clean up\n   */\n  async close(): Promise<void> {\n    if (this.mcpClients) {\n      await closeMCPClients(this.mcpClients);\n      this.mcpClients = null;\n    }\n    this.initialized = false;\n  }\n\n  // \n  // Core Execution Methods\n  // \n\n  /**\n   * Execute a task with full tool access\n   */\n  async execute(\n    task: string,\n    options?: {\n      enableReasoning?: boolean;\n      enableWebSearch?: boolean;\n    }\n  ): Promise<AgentResult> {\n    await this.initialize();\n\n    const steps: AgentStep[] = [];\n    const recordStep = (toolName: string, input: unknown, output: string, approved?: boolean) => {\n      steps.push({ toolName, input, output, timestamp: new Date(), approved });\n      if (this.config.verbose) {\n        console.log(\n          `   ${toolName}:`,\n          typeof input === 'string' ? input.slice(0, 100) : JSON.stringify(input).slice(0, 100)\n        );\n      }\n    };\n\n    // Build tool set\n    const tools = await this.buildToolSet(recordStep);\n\n    // Add web search if enabled\n    if ((options?.enableWebSearch ?? this.config.webSearch?.enabled) && this.config.webSearch) {\n      const webSearchTool = anthropic.tools.webSearch_20250305({\n        maxUses: this.config.webSearch.maxUses ?? 5,\n        allowedDomains: this.config.webSearch.allowedDomains,\n        blockedDomains: this.config.webSearch.blockedDomains,\n      });\n      (tools as Record<string, unknown>).web_search = webSearchTool;\n    }\n\n    // Build provider options\n    const providerOptions: { anthropic?: AnthropicProviderOptions } = {};\n\n    if ((options?.enableReasoning ?? this.config.reasoning?.enabled) && this.config.reasoning) {\n      providerOptions.anthropic = {\n        thinking: {\n          type: 'enabled',\n          budgetTokens: this.config.reasoning.budgetTokens ?? 12000,\n        },\n      };\n    }\n\n    try {\n      const result = await generateText({\n        model: anthropic(this.config.model),\n        tools,\n        stopWhen: stepCountIs(this.config.maxSteps),\n        system: this.getSystemPrompt(),\n        prompt: task,\n        providerOptions: Object.keys(providerOptions).length > 0 ? providerOptions : undefined,\n      });\n\n      return {\n        success: true,\n        result: result.text,\n        reasoning: result.reasoning?.map((r) => r.text).join('\\n'),\n        steps,\n        usage: result.usage\n          ? {\n              inputTokens: result.usage.inputTokens ?? 0,\n              outputTokens: result.usage.outputTokens ?? 0,\n              totalTokens: result.usage.totalTokens ?? 0,\n            }\n          : undefined,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        result: error instanceof Error ? error.message : String(error),\n        steps,\n      };\n    }\n  }\n\n  /**\n   * Execute a task with streaming output.\n   * Note: Currently only yields text chunks. Reasoning chunks are not yet supported\n   * by the streaming API even when extended thinking is enabled.\n   */\n  async *stream(task: string): AsyncGenerator<{ type: 'text'; content: string }> {\n    await this.initialize();\n\n    const steps: AgentStep[] = [];\n    const recordStep = (toolName: string, input: unknown, output: string) => {\n      steps.push({ toolName, input, output, timestamp: new Date() });\n    };\n\n    const tools = await this.buildToolSet(recordStep);\n\n    // Build provider options for reasoning\n    const providerOptions: { anthropic?: AnthropicProviderOptions } = {};\n    if (this.config.reasoning?.enabled) {\n      providerOptions.anthropic = {\n        thinking: {\n          type: 'enabled',\n          budgetTokens: this.config.reasoning.budgetTokens ?? 12000,\n        },\n      };\n    }\n\n    const result = streamText({\n      model: anthropic(this.config.model),\n      tools,\n      stopWhen: stepCountIs(this.config.maxSteps),\n      system: this.getSystemPrompt(),\n      prompt: task,\n      providerOptions: Object.keys(providerOptions).length > 0 ? providerOptions : undefined,\n    });\n\n    for await (const chunk of result.textStream) {\n      yield { type: 'text', content: chunk };\n    }\n  }\n\n  /**\n   * Execute with structured output - combine tool use with schema-constrained response\n   */\n  async executeWithOutput<T extends z.ZodTypeAny>(\n    task: string,\n    outputSchema: T\n  ): Promise<{\n    success: boolean;\n    output?: z.infer<T>;\n    error?: string;\n    steps: AgentStep[];\n    usage?: AgentResult['usage'];\n  }> {\n    await this.initialize();\n\n    const steps: AgentStep[] = [];\n    const recordStep = (toolName: string, input: unknown, output: string) => {\n      steps.push({ toolName, input, output, timestamp: new Date() });\n    };\n\n    const tools = await this.buildToolSet(recordStep);\n\n    try {\n      // First, use tools to gather information\n      const gatherResult = await generateText({\n        model: anthropic(this.config.model),\n        tools,\n        stopWhen: stepCountIs(Math.floor(this.config.maxSteps / 2)),\n        system: this.getSystemPrompt(),\n        prompt: task,\n      });\n\n      // Then, generate structured output\n      const structured = await generateObject({\n        model: anthropic(this.config.model),\n        schema: outputSchema,\n        prompt: `Based on this information, provide a structured response:\n\n${gatherResult.text}\n\nOriginal task: ${task}`,\n      });\n\n      return {\n        success: true,\n        output: structured.object as z.infer<T>,\n        steps,\n        usage: gatherResult.usage\n          ? {\n              inputTokens: gatherResult.usage.inputTokens ?? 0,\n              outputTokens: gatherResult.usage.outputTokens ?? 0,\n              totalTokens: gatherResult.usage.totalTokens ?? 0,\n            }\n          : undefined,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        steps,\n      };\n    }\n  }\n\n  // \n  // Task Analysis\n  // \n\n  /**\n   * Analyze a task before executing to determine optimal approach\n   */\n  async analyzeTask(task: string): Promise<TaskAnalysis> {\n    const analysis = await generateObject({\n      model: anthropic(this.config.model),\n      schema: TaskAnalysisSchema,\n      prompt: `Analyze this task and provide a structured assessment:\n\nTask: ${task}\n\nConsider:\n1. How complex is this task?\n2. How many steps might it take?\n3. Would web search help gather current information?\n4. Would extended thinking/reasoning help with complex logic?\n5. What are the subtasks and their priorities?\n6. What are potential risks or blockers?`,\n    });\n\n    return analysis.object;\n  }\n\n  // \n  // Convenience Methods\n  // \n\n  /**\n   * Fix a specific file based on feedback\n   */\n  async fixFile(\n    filePath: string,\n    feedback: string,\n    suggestion?: string\n  ): Promise<{\n    success: boolean;\n    result: string;\n    diff?: string;\n  }> {\n    const task = suggestion\n      ? `Fix the file ${filePath} based on this feedback:\n${feedback}\n\nApply this suggested change:\n${suggestion}`\n      : `Fix the file ${filePath} based on this feedback:\n${feedback}\n\nAnalyze the file, understand the issue, and make the appropriate fix.`;\n\n    const result = await this.execute(task);\n\n    // Get diff if we made changes\n    let diff: string | undefined;\n    if (result.success) {\n      try {\n        diff = execFileSync('git', ['diff', filePath], {\n          cwd: this.config.workingDirectory,\n          encoding: 'utf-8',\n        });\n      } catch {\n        // No diff available\n      }\n    }\n\n    return {\n      success: result.success,\n      result: result.result,\n      diff,\n    };\n  }\n\n  /**\n   * Run tests and fix failures\n   */\n  async fixTests(testCommand: string = 'npm test'): Promise<{\n    success: boolean;\n    result: string;\n    iterations: number;\n  }> {\n    const task = `Run the tests with \"${testCommand}\" and fix any failures.\n\nProcess:\n1. Run the test command\n2. If tests fail, analyze the failure\n3. Fix the code causing the failure\n4. Re-run tests\n5. Repeat until all tests pass or you've tried 5 times`;\n\n    const result = await this.execute(task);\n\n    // Count iterations from steps\n    const testRuns = result.steps.filter(\n      (s) =>\n        s.toolName === 'bash' &&\n        typeof s.input === 'object' &&\n        s.input !== null &&\n        'command' in s.input &&\n        String(s.input.command).includes('test')\n    ).length;\n\n    return {\n      success: result.success,\n      result: result.result,\n      iterations: testRuns,\n    };\n  }\n\n  /**\n   * Commit changes with a message\n   */\n  async commitChanges(message: string): Promise<{\n    success: boolean;\n    commitSha?: string;\n  }> {\n    const result = await this.execute(\n      `Stage all changes and commit with message: \"${message}\"\n      \nUse these commands:\n1. git add -A\n2. git commit -m \"${message}\"\n3. Output the commit SHA`\n    );\n\n    // Extract commit SHA from steps\n    const commitStep = result.steps.find(\n      (s) => s.toolName === 'bash' && s.output.includes('commit')\n    );\n\n    let commitSha: string | undefined;\n    if (commitStep) {\n      const shaMatch = commitStep.output.match(/\\[[\\w-]+ ([a-f0-9]+)\\]/);\n      if (shaMatch) {\n        commitSha = shaMatch[1];\n      }\n    }\n\n    return {\n      success: result.success,\n      commitSha,\n    };\n  }\n\n  // \n  // Tool Building\n  // \n\n  /**\n   * Build the complete tool set\n   */\n  private async buildToolSet(\n    recordStep: (name: string, input: unknown, output: string, approved?: boolean) => void\n  ): Promise<ToolSet> {\n    const requiresApproval = (toolName: string): boolean => {\n      return this.config.approval?.requireApproval?.includes(toolName) ?? false;\n    };\n\n    const checkApproval = async (toolName: string, input: unknown): Promise<boolean> => {\n      if (!requiresApproval(toolName)) return true;\n      if (!this.config.approval?.onApprovalRequest) return true;\n      return this.config.approval.onApprovalRequest(toolName, input);\n    };\n\n    // Bash tool with security checks\n    const bashTool = anthropic.tools.bash_20250124({\n      execute: async ({ command, restart }) => {\n        if (restart) {\n          recordStep('bash', { restart: true }, 'Shell restarted');\n          return 'Shell restarted';\n        }\n\n        // Assess command safety\n        const safety = assessCommandSafety(command);\n        const needsApproval = requiresApproval('bash') || !safety.safe;\n\n        if (needsApproval) {\n          const approved = await checkApproval('bash', { command, risks: safety.risks });\n          if (!approved) {\n            recordStep('bash', { command }, 'Command rejected by approval', false);\n            return 'Command rejected by approval policy';\n          }\n        }\n\n        try {\n          const output = execSync(command, {\n            cwd: this.config.workingDirectory,\n            encoding: 'utf-8',\n            maxBuffer: 10 * 1024 * 1024,\n            timeout: 120000,\n          });\n\n          recordStep('bash', { command }, output, true);\n          return output;\n        } catch (error) {\n          const errorMsg = error instanceof Error ? error.message : String(error);\n          recordStep('bash', { command }, `Error: ${errorMsg}`);\n          return `Error: ${errorMsg}`;\n        }\n      },\n    });\n\n    // Text editor tool with path validation\n    const textEditorTool = anthropic.tools.textEditor_20250124({\n      execute: async ({ command, path, file_text, insert_line, new_str, old_str, view_range }) => {\n        // Security: Validate path to prevent path traversal attacks\n        const pathValidation = validatePath(path, this.config.workingDirectory);\n        if (!pathValidation.valid) {\n          recordStep(\n            'str_replace_editor',\n            { command, path },\n            `Security Error: ${pathValidation.error}`\n          );\n          return `Security Error: ${pathValidation.error}`;\n        }\n        const fullPath = pathValidation.resolvedPath;\n\n        try {\n          let result: string;\n\n          switch (command) {\n            case 'view': {\n              if (!existsSync(fullPath)) {\n                result = `Error: File not found: ${path}`;\n              } else {\n                const content = readFileSync(fullPath, 'utf-8');\n                const lines = content.split('\\n');\n\n                const start = view_range?.[0];\n                const end = view_range?.[1];\n                if (start !== undefined && end !== undefined) {\n                  const selectedLines = lines.slice(start - 1, end);\n                  result = selectedLines.map((line, i) => `${start + i}: ${line}`).join('\\n');\n                } else {\n                  result = lines.map((line, i) => `${i + 1}: ${line}`).join('\\n');\n                }\n              }\n              break;\n            }\n\n            case 'create': {\n              if (!file_text) {\n                result = 'Error: file_text is required for create command';\n              } else {\n                const dir = dirname(fullPath);\n                if (!existsSync(dir)) mkdirSync(dir, { recursive: true });\n                writeFileSync(fullPath, file_text);\n                result = `Created file: ${path}`;\n              }\n              break;\n            }\n\n            case 'str_replace': {\n              if (!old_str || new_str === undefined) {\n                result = 'Error: old_str and new_str are required for str_replace';\n              } else if (!existsSync(fullPath)) {\n                result = `Error: File not found: ${path}`;\n              } else {\n                const content = readFileSync(fullPath, 'utf-8');\n                if (!content.includes(old_str)) {\n                  result = `Error: old_str not found in file`;\n                } else {\n                  const newContent = content.replace(old_str, new_str);\n                  writeFileSync(fullPath, newContent);\n                  result = `Replaced text in ${path}`;\n                }\n              }\n              break;\n            }\n\n            case 'insert': {\n              if (insert_line === undefined || new_str === undefined) {\n                result = 'Error: insert_line and new_str are required for insert';\n              } else if (!existsSync(fullPath)) {\n                result = `Error: File not found: ${path}`;\n              } else {\n                const content = readFileSync(fullPath, 'utf-8');\n                const lines = content.split('\\n');\n                lines.splice(insert_line, 0, new_str);\n                writeFileSync(fullPath, lines.join('\\n'));\n                result = `Inserted text at line ${insert_line} in ${path}`;\n              }\n              break;\n            }\n\n            default:\n              result = `Unknown command: ${command}`;\n          }\n\n          recordStep('str_replace_editor', { command, path }, result);\n          return result;\n        } catch (error) {\n          const errorMsg = error instanceof Error ? error.message : String(error);\n          recordStep('str_replace_editor', { command, path }, `Error: ${errorMsg}`);\n          return `Error: ${errorMsg}`;\n        }\n      },\n    });\n\n    const tools: ToolSet = {\n      bash: bashTool,\n      str_replace_editor: textEditorTool,\n    } as ToolSet;\n\n    // Git status tool\n    tools.git_status = tool({\n      description: 'Get current git status including branch, staged files, and modified files',\n      inputSchema: z.object({}),\n      execute: async () => {\n        try {\n          const status = execSync('git status --porcelain -b', {\n            cwd: this.config.workingDirectory,\n            encoding: 'utf-8',\n          });\n          recordStep('git_status', {}, status);\n          return status;\n        } catch (error) {\n          const msg = error instanceof Error ? error.message : String(error);\n          recordStep('git_status', {}, `Error: ${msg}`);\n          return `Error: ${msg}`;\n        }\n      },\n    });\n\n    // Git diff tool with path validation\n    tools.git_diff = tool({\n      description: 'Get git diff for staged or unstaged changes',\n      inputSchema: z.object({\n        staged: z.boolean().optional().describe('Show staged changes only'),\n        file: z.string().optional().describe('Specific file to diff'),\n      }),\n      execute: async ({ staged, file }) => {\n        try {\n          const args = staged ? ['--cached'] : [];\n          if (file) {\n            // Security: Validate file path\n            const pathValidation = validatePath(file, this.config.workingDirectory);\n            if (!pathValidation.valid) {\n              recordStep('git_diff', { staged, file }, `Security Error: ${pathValidation.error}`);\n              return `Security Error: ${pathValidation.error}`;\n            }\n            // Use -- to separate paths from options (git best practice)\n            args.push('--', file);\n          }\n          const diff = execSync(`git diff ${args.join(' ')}`, {\n            cwd: this.config.workingDirectory,\n            encoding: 'utf-8',\n          });\n          recordStep('git_diff', { staged, file }, diff || '(no changes)');\n          return diff || '(no changes)';\n        } catch (error) {\n          const msg = error instanceof Error ? error.message : String(error);\n          recordStep('git_diff', { staged, file }, `Error: ${msg}`);\n          return `Error: ${msg}`;\n        }\n      },\n    });\n\n    // File delete tool with approval and path validation\n    tools.delete_file = tool({\n      description: 'Delete a file (may require approval)',\n      inputSchema: z.object({\n        path: z.string().describe('Path to the file to delete'),\n      }),\n      execute: async ({ path }) => {\n        // Security: Validate path to prevent path traversal attacks\n        const pathValidation = validatePath(path, this.config.workingDirectory);\n        if (!pathValidation.valid) {\n          recordStep('delete_file', { path }, `Security Error: ${pathValidation.error}`, false);\n          return `Security Error: ${pathValidation.error}`;\n        }\n        const fullPath = pathValidation.resolvedPath;\n\n        // Always check approval for delete operations\n        const approved = await checkApproval('delete_file', { path });\n        if (!approved) {\n          recordStep('delete_file', { path }, 'Delete rejected by approval', false);\n          return 'Delete operation rejected by approval policy';\n        }\n\n        try {\n          if (!existsSync(fullPath)) {\n            recordStep('delete_file', { path }, `File not found: ${path}`);\n            return `File not found: ${path}`;\n          }\n          unlinkSync(fullPath);\n          recordStep('delete_file', { path }, `Deleted: ${path}`, true);\n          return `Successfully deleted: ${path}`;\n        } catch (error) {\n          const msg = error instanceof Error ? error.message : String(error);\n          recordStep('delete_file', { path }, `Error: ${msg}`);\n          return `Error: ${msg}`;\n        }\n      },\n    });\n\n    // Add MCP tools if available\n    if (this.mcpClients) {\n      const mcpTools = await getMCPTools(this.mcpClients);\n      Object.assign(tools, mcpTools);\n    }\n\n    return tools as ToolSet;\n  }\n\n  // \n  // System Prompt\n  // \n\n  /**\n   * Get the system prompt for the agent\n   */\n  private getSystemPrompt(): string {\n    const features: string[] = [];\n\n    if (this.config.reasoning?.enabled) {\n      features.push('- Extended thinking enabled for complex reasoning');\n    }\n    if (this.config.webSearch?.enabled) {\n      features.push('- Web search available for current information');\n    }\n    if (this.mcpClients) {\n      features.push('- MCP integrations (Cursor, GitHub, Context7) available');\n    }\n\n    return `You are an expert software development agent with access to powerful tools.\n\n## Your Capabilities\n\n### Code Operations (Anthropic Tools)\n- **bash**: Execute shell commands for git, tests, builds, etc.\n- **str_replace_editor**: View and edit files with precision\n- **delete_file**: Delete files (may require approval)\n\n### Git Utilities\n- **git_status**: Quick git status check\n- **git_diff**: View changes in working directory\n\n${features.length > 0 ? `### Special Features\\n${features.join('\\n')}` : ''}\n\n### MCP Integrations (when available)\n- **Cursor Agent MCP**: Spawn and manage background agents\n- **GitHub MCP**: PR/issue management, code search\n- **Context7 MCP**: Up-to-date library documentation\n\n## Working Directory\n${this.config.workingDirectory}\n\n## Guidelines\n\n1. **Be thorough**: Verify your changes work before reporting success\n2. **Use appropriate tools**: Prefer MCP tools for GitHub operations\n3. **Handle errors gracefully**: Try to understand and fix failures\n4. **Document your actions**: Explain what you're doing\n5. **Test your changes**: Run tests and linting after code changes\n${this.config.approval?.requireApproval?.length ? '\\n6. **Respect approval policies**: Some operations require user approval' : ''}\n\n## When Triaging PRs\n1. First understand the current state (CI status, feedback, changes)\n2. Identify all blockers and unaddressed feedback\n3. Fix issues systematically, starting with CI failures\n4. Commit and push changes\n5. Verify CI passes after your changes`;\n  }\n\n  private log(message: string): void {\n    if (this.config.verbose) {\n      console.log(message);\n    }\n  }\n}\n\n// \n// Convenience Functions\n// \n\n/**\n * Run a one-shot task with the agent\n */\nexport async function runTask(task: string, config?: AgentConfig): Promise<AgentResult> {\n  const agent = new Agent(config);\n  try {\n    return await agent.execute(task);\n  } finally {\n    await agent.close();\n  }\n}\n\n/**\n * Run a task with pre-analysis to determine optimal configuration\n */\nexport async function runSmartTask(\n  task: string,\n  config?: Omit<AgentConfig, 'reasoning' | 'webSearch'>\n): Promise<AgentResult> {\n  const agent = new Agent({\n    ...config,\n    reasoning: { enabled: false }, // Disable for analysis\n    webSearch: { enabled: false },\n  });\n\n  try {\n    // First, analyze the task\n    const analysis = await agent.analyzeTask(task);\n\n    console.log(` Task Analysis:`);\n    console.log(`   Complexity: ${analysis.complexity}`);\n    console.log(`   Estimated steps: ${analysis.estimatedSteps}`);\n    console.log(`   Needs reasoning: ${analysis.requiresReasoning}`);\n    console.log(`   Needs web search: ${analysis.requiresWebSearch}`);\n\n    // Execute with optimal settings\n    return await agent.execute(task, {\n      enableReasoning: analysis.requiresReasoning,\n      enableWebSearch: analysis.requiresWebSearch,\n    });\n  } finally {\n    await agent.close();\n  }\n}\n","/**\n * PR Triage Agent\n *\n * Specialized agent for triaging and resolving Pull Requests.\n * Combines MCP tools with AI analysis to:\n * - Analyze PR state and feedback\n * - Identify and fix blockers\n * - Address reviewer comments\n * - Ensure CI passes\n * - Prepare PRs for merge\n */\n\nimport { anthropic } from '@ai-sdk/anthropic';\nimport { generateObject, generateText, stepCountIs } from 'ai';\nimport { z } from 'zod';\nimport { Agent, type AgentConfig, type AgentResult } from './agent.js';\nimport {\n  closeMCPClients,\n  getMCPTools,\n  initializeMCPClients,\n  type MCPClients,\n} from './mcp-clients.js';\n\n// \n// Schemas for structured AI output\n// \n\nconst FeedbackSeveritySchema = z.enum(['critical', 'high', 'medium', 'low', 'suggestion']);\n\nconst FeedbackItemSchema = z.object({\n  id: z.string(),\n  source: z.string().describe('Who provided this feedback (e.g., gemini-code-assist, copilot)'),\n  severity: FeedbackSeveritySchema,\n  category: z.enum([\n    'bug',\n    'security',\n    'performance',\n    'style',\n    'documentation',\n    'suggestion',\n    'question',\n  ]),\n  file: z.string().optional(),\n  line: z.number().optional(),\n  content: z.string(),\n  suggestion: z.string().optional().describe('Specific fix suggestion if provided'),\n  addressed: z.boolean(),\n  addressedBy: z.string().optional().describe('How it was addressed (commit SHA, response, etc.)'),\n});\n\nconst CIStatusSchema = z.object({\n  status: z.enum(['passing', 'failing', 'pending', 'unknown']),\n  checks: z.array(\n    z.object({\n      name: z.string(),\n      status: z.enum(['success', 'failure', 'pending', 'skipped']),\n      url: z.string().optional(),\n      summary: z.string().optional(),\n    })\n  ),\n  failureReasons: z.array(z.string()),\n});\n\nconst PRAnalysisSchema = z.object({\n  prNumber: z.number(),\n  prUrl: z.string(),\n  prTitle: z.string(),\n  status: z.enum(['ready', 'needs_work', 'blocked', 'waiting_ci', 'waiting_review']),\n  ci: CIStatusSchema,\n  feedback: z.object({\n    total: z.number(),\n    unaddressed: z.number(),\n    critical: z.number(),\n    items: z.array(FeedbackItemSchema),\n  }),\n  blockers: z.array(\n    z.object({\n      type: z.enum([\n        'ci_failure',\n        'unaddressed_feedback',\n        'merge_conflict',\n        'missing_approval',\n        'other',\n      ]),\n      description: z.string(),\n      autoResolvable: z.boolean(),\n      suggestedFix: z.string().optional(),\n    })\n  ),\n  summary: z.string(),\n  nextActions: z.array(\n    z.object({\n      action: z.string(),\n      priority: z.enum(['critical', 'high', 'medium', 'low']),\n      automated: z.boolean(),\n      reason: z.string(),\n    })\n  ),\n});\n\nexport type PRAnalysis = z.infer<typeof PRAnalysisSchema>;\nexport type FeedbackItem = z.infer<typeof FeedbackItemSchema>;\n\n// \n// PR Triage Agent\n// \n\nexport interface PRTriageConfig extends AgentConfig {\n  /** Repository in format owner/repo */\n  repository: string;\n}\n\nexport class PRTriageAgent {\n  private config: PRTriageConfig;\n  private agent: Agent;\n  private mcpClients: MCPClients | null = null;\n  private initialized = false;\n  /** Promise-based lock to prevent concurrent initialization race conditions */\n  private initializationPromise: Promise<void> | null = null;\n\n  constructor(config: PRTriageConfig) {\n    this.config = config;\n    this.agent = new Agent(config);\n  }\n\n  /**\n   * Initialize the agent and MCP clients.\n   * Thread-safe: concurrent calls will wait for the same initialization to complete.\n   */\n  async initialize(): Promise<void> {\n    // Fast path: already initialized\n    if (this.initialized) return;\n\n    // If initialization is in progress, wait for it to complete\n    if (this.initializationPromise) {\n      return this.initializationPromise;\n    }\n\n    // Start initialization and store the promise so concurrent calls can wait\n    this.initializationPromise = this.doInitialize();\n\n    try {\n      await this.initializationPromise;\n    } catch (error) {\n      // Reset on failure so retry is possible\n      this.initializationPromise = null;\n      throw error;\n    }\n  }\n\n  /**\n   * Internal initialization logic - only called once due to promise lock\n   */\n  private async doInitialize(): Promise<void> {\n    await this.agent.initialize();\n    this.mcpClients = await initializeMCPClients(this.config.mcp);\n    this.initialized = true;\n  }\n\n  async close(): Promise<void> {\n    await this.agent.close();\n    if (this.mcpClients) {\n      await closeMCPClients(this.mcpClients);\n      this.mcpClients = null;\n    }\n    this.initialized = false;\n  }\n\n  /**\n   * Analyze a PR and return structured analysis\n   */\n  async analyze(prNumber: number): Promise<PRAnalysis> {\n    await this.initialize();\n\n    const tools = this.mcpClients ? await getMCPTools(this.mcpClients) : {};\n\n    // Use AI with tools to gather PR information\n    const gatherResult = await generateText({\n      model: anthropic('claude-sonnet-4-20250514'),\n      tools,\n      stopWhen: stepCountIs(10),\n      system: `You are a PR analysis assistant. Gather all relevant information about the PR.`,\n      prompt: `Analyze PR #${prNumber} in repository ${this.config.repository}.\n\nGather:\n1. PR title, description, and current state\n2. CI/check status (all checks)\n3. All review comments and feedback\n4. Recent commits\n5. Any merge conflicts\n\nUse the available tools to get this information.`,\n    });\n\n    // Now generate structured analysis\n    const analysis = await generateObject({\n      model: anthropic('claude-sonnet-4-20250514'),\n      schema: PRAnalysisSchema,\n      prompt: `Based on this PR information, generate a structured analysis:\n\n${gatherResult.text}\n\nAnalyze:\n- Overall PR status\n- CI status and any failures\n- All feedback items (categorize by severity)\n- Blockers preventing merge\n- Recommended next actions\n\nBe thorough - identify ALL unaddressed feedback items.`,\n    });\n\n    return analysis.object;\n  }\n\n  /**\n   * Generate a human-readable triage report\n   */\n  async generateReport(prNumber: number): Promise<string> {\n    const analysis = await this.analyze(prNumber);\n    return this.formatReport(analysis);\n  }\n\n  /**\n   * Automatically resolve all auto-resolvable issues\n   */\n  async resolve(prNumber: number): Promise<AgentResult> {\n    const analysis = await this.analyze(prNumber);\n\n    const autoResolvable = analysis.blockers.filter((b) => b.autoResolvable);\n    const unaddressedFeedback = analysis.feedback.items.filter((f) => !f.addressed);\n\n    if (autoResolvable.length === 0 && unaddressedFeedback.length === 0) {\n      return {\n        success: true,\n        result: 'No issues to resolve - PR appears ready',\n        steps: [],\n      };\n    }\n\n    // Build resolution task\n    const task = `Resolve issues in PR #${prNumber} (${this.config.repository}):\n\n## Blockers to Fix\n${autoResolvable\n  .map(\n    (b, i) => `${i + 1}. [${b.type}] ${b.description}\n   Suggested fix: ${b.suggestedFix || 'Analyze and fix'}`\n  )\n  .join('\\n\\n')}\n\n## Unaddressed Feedback\n${unaddressedFeedback\n  .map(\n    (f, i) => `${i + 1}. [${f.severity}] ${f.source}: ${f.content}\n   File: ${f.file || 'N/A'}${f.line ? `:${f.line}` : ''}\n   ${f.suggestion ? `Suggestion: ${f.suggestion}` : ''}`\n  )\n  .join('\\n\\n')}\n\n## Instructions\n1. Fix each issue in order of severity (critical > high > medium > low)\n2. For each fix:\n   a. Make the code change\n   b. Verify it doesn't break anything (run tests if applicable)\n   c. Commit with a clear message\n3. Push all changes when done\n4. Report what was fixed and what couldn't be auto-fixed`;\n\n    return await this.agent.execute(task);\n  }\n\n  /**\n   * Run the complete triage workflow until PR is ready\n   */\n  async runUntilReady(\n    prNumber: number,\n    options: {\n      maxIterations?: number;\n      requestReviews?: boolean;\n      autoMerge?: boolean;\n    } = {}\n  ): Promise<{\n    success: boolean;\n    finalStatus: PRAnalysis['status'];\n    iterations: number;\n    report: string;\n  }> {\n    const maxIterations = options.maxIterations ?? 5;\n    let iterations = 0;\n    let lastAnalysis: PRAnalysis | null = null;\n\n    while (iterations < maxIterations) {\n      iterations++;\n      console.log(`\\n Triage iteration ${iterations}/${maxIterations}`);\n\n      // Analyze current state\n      const analysis = await this.analyze(prNumber);\n      lastAnalysis = analysis;\n\n      console.log(`   Status: ${analysis.status}`);\n      console.log(`   CI: ${analysis.ci.status}`);\n      console.log(`   Unaddressed feedback: ${analysis.feedback.unaddressed}`);\n\n      // Check if ready\n      if (analysis.status === 'ready') {\n        if (options.requestReviews) {\n          await this.agent.execute(`Request reviews for PR #${prNumber} if not already requested`);\n        }\n\n        if (options.autoMerge) {\n          await this.agent.execute(\n            `Merge PR #${prNumber} using squash merge and delete the branch`\n          );\n        }\n\n        return {\n          success: true,\n          finalStatus: 'ready',\n          iterations,\n          report: this.formatReport(analysis),\n        };\n      }\n\n      // Check if blocked by non-auto-resolvable issues\n      const nonResolvableBlockers = analysis.blockers.filter((b) => !b.autoResolvable);\n      if (nonResolvableBlockers.length > 0 && analysis.blockers.every((b) => !b.autoResolvable)) {\n        return {\n          success: false,\n          finalStatus: 'blocked',\n          iterations,\n          report:\n            this.formatReport(analysis) +\n            `\\n\\n## Cannot Auto-Resolve\\n` +\n            nonResolvableBlockers.map((b) => `- ${b.description}`).join('\\n'),\n        };\n      }\n\n      // Try to resolve issues\n      const resolution = await this.resolve(prNumber);\n\n      if (!resolution.success) {\n        console.log(`    Resolution failed: ${resolution.result}`);\n      }\n\n      // Wait for CI if needed\n      if (analysis.ci.status === 'pending') {\n        console.log('    Waiting for CI...');\n        await this.waitForCI(prNumber);\n      }\n    }\n\n    return {\n      success: false,\n      finalStatus: lastAnalysis?.status ?? 'needs_work',\n      iterations,\n      report: lastAnalysis ? this.formatReport(lastAnalysis) : 'Analysis failed',\n    };\n  }\n\n  /**\n   * Wait for CI to complete\n   */\n  private async waitForCI(prNumber: number, timeout = 300000): Promise<void> {\n    const startTime = Date.now();\n    const pollInterval = 30000;\n\n    while (Date.now() - startTime < timeout) {\n      await new Promise((resolve) => setTimeout(resolve, pollInterval));\n\n      const analysis = await this.analyze(prNumber);\n      if (analysis.ci.status !== 'pending') {\n        return;\n      }\n    }\n  }\n\n  /**\n   * Format analysis as a readable report\n   */\n  private formatReport(analysis: PRAnalysis): string {\n    const statusEmoji = {\n      ready: '',\n      needs_work: '',\n      blocked: '',\n      waiting_ci: '',\n      waiting_review: '',\n    };\n\n    const severityEmoji = {\n      critical: '',\n      high: '',\n      medium: '',\n      low: '',\n      suggestion: '',\n    };\n\n    let report = `# PR Triage Report: #${analysis.prNumber}\n\n## ${statusEmoji[analysis.status]} Status: ${analysis.status.toUpperCase()}\n\n**${analysis.prTitle}**\n${analysis.prUrl}\n\n## CI Status: ${analysis.ci.status}\n${analysis.ci.checks.map((c) => `- ${c.status === 'success' ? '' : c.status === 'failure' ? '' : ''} ${c.name}`).join('\\n')}\n${analysis.ci.failureReasons.length > 0 ? `\\n### Failures:\\n${analysis.ci.failureReasons.map((r) => `- ${r}`).join('\\n')}` : ''}\n\n## Feedback Summary\n- Total: ${analysis.feedback.total}\n- Unaddressed: ${analysis.feedback.unaddressed}\n- Critical: ${analysis.feedback.critical}\n\n`;\n\n    if (analysis.feedback.items.length > 0) {\n      report += `### Feedback Items\\n`;\n      for (const item of analysis.feedback.items) {\n        const status = item.addressed ? '' : '';\n        report += `${status} ${severityEmoji[item.severity]} **${item.source}** [${item.category}]\n   ${item.content.slice(0, 200)}${item.content.length > 200 ? '...' : ''}\n   ${item.file ? ` ${item.file}${item.line ? `:${item.line}` : ''}` : ''}\n   ${item.addressed ? ` Addressed: ${item.addressedBy}` : ''}\n\n`;\n      }\n    }\n\n    if (analysis.blockers.length > 0) {\n      report += `##  Blockers\\n`;\n      for (const blocker of analysis.blockers) {\n        const autoIcon = blocker.autoResolvable ? '' : '';\n        report += `${autoIcon} **${blocker.type}**: ${blocker.description}\n   ${blocker.suggestedFix ? ` Fix: ${blocker.suggestedFix}` : ''}\n\n`;\n      }\n    }\n\n    report += `##  Next Actions\\n`;\n    for (const action of analysis.nextActions) {\n      const autoIcon = action.automated ? '' : '';\n      report += `${autoIcon} [${action.priority}] ${action.action}\n   ${action.reason}\n\n`;\n    }\n\n    report += `---\n*${analysis.summary}*`;\n\n    return report;\n  }\n}\n\n/**\n * Convenience function for quick PR triage\n */\nexport async function triagePR(\n  repository: string,\n  prNumber: number,\n  options?: Partial<PRTriageConfig>\n): Promise<PRAnalysis> {\n  const agent = new PRTriageAgent({\n    repository,\n    ...options,\n  });\n\n  try {\n    return await agent.analyze(prNumber);\n  } finally {\n    await agent.close();\n  }\n}\n","import { z } from 'zod';\n\n// ============================================================================\n// Core Triage Types\n// ============================================================================\n\n/**\n * Severity levels for feedback items.\n * Used to prioritize which feedback needs immediate attention.\n *\n * @remarks\n * - `critical` - Must be addressed before merge, blocks deployment\n * - `high` - Should be addressed before merge\n * - `medium` - Should be addressed, but not blocking\n * - `low` - Nice to have improvements\n * - `info` - Informational comments, no action required\n */\nexport const FeedbackSeveritySchema = z.enum(['critical', 'high', 'medium', 'low', 'info']);\n\n/** Severity level for feedback items */\nexport type FeedbackSeverity = z.infer<typeof FeedbackSeveritySchema>;\n\n/**\n * Status of a feedback item indicating whether it has been addressed.\n *\n * @remarks\n * - `unaddressed` - Feedback has not been addressed yet\n * - `addressed` - Feedback has been addressed with code changes\n * - `dismissed` - Feedback was reviewed and dismissed as not applicable\n * - `wont_fix` - Feedback acknowledged but won't be fixed in this PR\n */\nexport const FeedbackStatusSchema = z.enum(['unaddressed', 'addressed', 'dismissed', 'wont_fix']);\n\n/** Status of a feedback item */\nexport type FeedbackStatus = z.infer<typeof FeedbackStatusSchema>;\n\n/**\n * Types of blockers that can prevent a PR from being merged.\n *\n * @remarks\n * - `ci_failure` - One or more CI checks have failed\n * - `review_feedback` - Unaddressed review comments\n * - `merge_conflict` - Branch has conflicts with base branch\n * - `missing_approval` - Required approvals not yet received\n * - `branch_protection` - Branch protection rules not satisfied\n * - `stale_branch` - Branch is significantly behind base branch\n */\nexport const BlockerTypeSchema = z.enum([\n  'ci_failure',\n  'review_feedback',\n  'merge_conflict',\n  'missing_approval',\n  'branch_protection',\n  'stale_branch',\n]);\n\n/** Type of blocker preventing PR merge */\nexport type BlockerType = z.infer<typeof BlockerTypeSchema>;\n\n/**\n * Overall status of a pull request in the triage workflow.\n *\n * @remarks\n * - `needs_work` - Has unaddressed blockers requiring code changes\n * - `needs_review` - Waiting for AI or human review\n * - `needs_ci` - Waiting for CI checks to complete\n * - `ready_to_merge` - All checks pass, feedback addressed, ready to merge\n * - `blocked` - Cannot proceed without human intervention\n * - `merged` - PR has been merged\n * - `closed` - PR was closed without merging\n */\nexport const PRStatusSchema = z.enum([\n  'needs_work',\n  'needs_review',\n  'needs_ci',\n  'ready_to_merge',\n  'blocked',\n  'merged',\n  'closed',\n]);\n\n/** Overall status of a pull request */\nexport type PRStatus = z.infer<typeof PRStatusSchema>;\n\n// ============================================================================\n// Feedback Item\n// ============================================================================\n\n/**\n * Schema for a feedback item from a PR review.\n * Represents a single comment or suggestion from a reviewer.\n */\nexport const FeedbackItemSchema = z.object({\n  /** Unique identifier for the feedback item */\n  id: z.string(),\n  /** GitHub username of the reviewer */\n  author: z.string(),\n  /** Content of the feedback comment */\n  body: z.string(),\n  /** File path the feedback relates to, if any */\n  path: z.string().nullable(),\n  /** Line number in the file, if applicable */\n  line: z.number().nullable(),\n  /** Severity level of the feedback */\n  severity: FeedbackSeveritySchema,\n  /** Current status of the feedback */\n  status: FeedbackStatusSchema,\n  /** ISO timestamp when the feedback was created */\n  createdAt: z.string(),\n  /** URL to the feedback comment on GitHub */\n  url: z.string(),\n  /** Whether AI can automatically resolve this feedback */\n  isAutoResolvable: z.boolean(),\n  /** AI-suggested action to address the feedback */\n  suggestedAction: z.string().nullable(),\n  /** Description of how the feedback was resolved */\n  resolution: z.string().nullable(),\n});\n\n/**\n * A feedback item from a PR review.\n * Contains the review comment details, severity, status, and AI analysis.\n */\nexport type FeedbackItem = z.infer<typeof FeedbackItemSchema>;\n\n// ============================================================================\n// Blocker\n// ============================================================================\n\n/**\n * Schema for a blocker preventing PR merge.\n * Represents an issue that must be resolved before the PR can be merged.\n */\nexport const BlockerSchema = z.object({\n  /** Type of blocker */\n  type: BlockerTypeSchema,\n  /** Human-readable description of the blocker */\n  description: z.string(),\n  /** Whether AI can automatically resolve this blocker */\n  isAutoResolvable: z.boolean(),\n  /** Suggested fix for the blocker, if available */\n  suggestedFix: z.string().nullable(),\n  /** URL with more information about the blocker */\n  url: z.string().nullable(),\n  /** Whether the blocker has been resolved */\n  resolved: z.boolean(),\n});\n\n/**\n * A blocker preventing PR merge.\n * Includes the blocker type, description, and resolution status.\n */\nexport type Blocker = z.infer<typeof BlockerSchema>;\n\n// ============================================================================\n// CI Status\n// ============================================================================\n\n/**\n * Schema for a single CI check result.\n */\nexport const CICheckSchema = z.object({\n  /** Name of the CI check */\n  name: z.string(),\n  /** Current status of the check */\n  status: z.enum(['pending', 'in_progress', 'success', 'failure', 'skipped']),\n  /** Final conclusion of the check, if completed */\n  conclusion: z.string().nullable(),\n  /** URL to the CI check details */\n  url: z.string(),\n  /** ISO timestamp when the check started */\n  startedAt: z.string().nullable(),\n  /** ISO timestamp when the check completed */\n  completedAt: z.string().nullable(),\n});\n\n/**\n * A single CI check result.\n * Contains the check name, status, and timing information.\n */\nexport type CICheck = z.infer<typeof CICheckSchema>;\n\n/**\n * Schema for the overall CI status of a PR.\n */\nexport const CIStatusSchema = z.object({\n  /** Whether all CI checks are passing */\n  allPassing: z.boolean(),\n  /** Whether any CI checks are still pending */\n  anyPending: z.boolean(),\n  /** List of all CI checks */\n  checks: z.array(CICheckSchema),\n  /** List of failed CI checks */\n  failures: z.array(CICheckSchema),\n});\n\n/**\n * Overall CI status for a pull request.\n * Aggregates all CI check results with convenience flags.\n */\nexport type CIStatus = z.infer<typeof CIStatusSchema>;\n\n// ============================================================================\n// Triage Result\n// ============================================================================\n\n/**\n * Schema for the complete triage result of a PR.\n * This is the main output of the triage process.\n */\nexport const TriageResultSchema = z.object({\n  /** PR number */\n  prNumber: z.number(),\n  /** URL to the PR on GitHub */\n  prUrl: z.string(),\n  /** Title of the PR */\n  prTitle: z.string(),\n  /** Overall status of the PR */\n  status: PRStatusSchema,\n  /** CI check status */\n  ci: CIStatusSchema,\n  /** Feedback summary and items */\n  feedback: z.object({\n    /** Total number of feedback items */\n    total: z.number(),\n    /** Number of unaddressed feedback items */\n    unaddressed: z.number(),\n    /** List of all feedback items */\n    items: z.array(FeedbackItemSchema),\n  }),\n  /** List of blockers preventing merge */\n  blockers: z.array(BlockerSchema),\n  /** Recommended next actions */\n  nextActions: z.array(\n    z.object({\n      /** Action to take */\n      action: z.string(),\n      /** Priority of the action */\n      priority: FeedbackSeveritySchema,\n      /** Whether the action can be automated */\n      automated: z.boolean(),\n      /** Reason for the recommended action */\n      reason: z.string(),\n    })\n  ),\n  /** Human-readable summary of the triage result */\n  summary: z.string(),\n  /** ISO timestamp when the triage was performed */\n  timestamp: z.string(),\n});\n\n/**\n * Complete triage result for a pull request.\n * Contains PR status, CI results, feedback, blockers, and recommended actions.\n */\nexport type TriageResult = z.infer<typeof TriageResultSchema>;\n\n// ============================================================================\n// Action Result\n// ============================================================================\n\n/**\n * Schema for the result of an automated action.\n */\nexport const ActionResultSchema = z.object({\n  /** Whether the action succeeded */\n  success: z.boolean(),\n  /** Name of the action that was taken */\n  action: z.string(),\n  /** Description of what was done */\n  description: z.string(),\n  /** Error message if the action failed */\n  error: z.string().nullable(),\n  /** List of file changes made by the action */\n  changes: z\n    .array(\n      z.object({\n        /** Path to the changed file */\n        file: z.string(),\n        /** Type of change */\n        type: z.enum(['created', 'modified', 'deleted']),\n      })\n    )\n    .nullable(),\n  /** Git commit SHA if changes were committed */\n  commitSha: z.string().nullable(),\n});\n\n/**\n * Result of an automated action.\n * Contains success status, description, and any file changes made.\n */\nexport type ActionResult = z.infer<typeof ActionResultSchema>;\n\n// ============================================================================\n// Resolution Plan\n// ============================================================================\n\n/**\n * Schema for a resolution plan to address PR blockers.\n */\nexport const ResolutionPlanSchema = z.object({\n  /** PR number this plan is for */\n  prNumber: z.number(),\n  /** Ordered list of steps to resolve blockers */\n  steps: z.array(\n    z.object({\n      /** Order of this step (1-based) */\n      order: z.number(),\n      /** Action to take */\n      action: z.string(),\n      /** Detailed description of the step */\n      description: z.string(),\n      /** Whether this step can be automated */\n      automated: z.boolean(),\n      /** Estimated time to complete this step */\n      estimatedDuration: z.string(),\n      /** Step orders that must be completed before this step */\n      dependencies: z.array(z.number()),\n    })\n  ),\n  /** Estimated total time to complete the plan */\n  estimatedTotalDuration: z.string(),\n  /** Whether the plan requires human intervention */\n  requiresHumanIntervention: z.boolean(),\n  /** Reason human intervention is required, if applicable */\n  humanInterventionReason: z.string().nullable(),\n});\n\n/**\n * A plan to resolve PR blockers.\n * Contains ordered steps with dependencies and time estimates.\n */\nexport type ResolutionPlan = z.infer<typeof ResolutionPlanSchema>;\n","/**\n * Type definitions for agentic-crew CLI integration\n *\n * These types match the JSON output from agentic-crew CLI commands.\n */\n\nimport { z } from 'zod';\n\n/**\n * Configuration for crew tool execution\n */\nexport interface CrewToolConfig {\n  /** How to invoke agentic-crew: 'uv' (default) or 'direct' */\n  invokeMethod?: 'uv' | 'direct';\n  /** Default timeout in milliseconds (default: 300000 = 5 minutes) */\n  defaultTimeout?: number;\n  /** Environment variables to pass to crew execution */\n  env?: Record<string, string>;\n}\n\n/**\n * Options for invoking a crew\n */\nexport interface InvokeCrewOptions {\n  /** Package name (e.g., 'otterfall') */\n  package: string;\n  /** Crew name (e.g., 'game_builder') */\n  crew: string;\n  /** Input specification for the crew */\n  input: string;\n  /** Optional timeout override in milliseconds */\n  timeout?: number;\n  /** Optional additional environment variables */\n  env?: Record<string, string>;\n}\n\n/**\n * Result from crew execution (matches agentic-crew CLI JSON output)\n */\nexport interface CrewResult {\n  /** Whether execution succeeded */\n  success: boolean;\n  /** Crew output (if successful) */\n  output?: string;\n  /** Error message (if failed) */\n  error?: string;\n  /** Framework that was used */\n  framework_used?: string;\n  /** Execution time in milliseconds */\n  duration_ms: number;\n}\n\n/**\n * Information about an available crew (matches agentic-crew CLI JSON output)\n */\nexport interface CrewInfo {\n  /** Package name */\n  package: string;\n  /** Crew name */\n  name: string;\n  /** Crew description */\n  description: string;\n  /** Required framework (null if framework-agnostic) */\n  required_framework: string | null;\n}\n\n/**\n * List crews response\n */\nexport interface CrewListResponse {\n  crews: CrewInfo[];\n}\n\n/**\n * Zod schema for CrewToolConfig validation\n */\nexport const CrewToolConfigSchema = z.object({\n  invokeMethod: z.enum(['uv', 'direct']).default('uv'),\n  defaultTimeout: z.number().positive().default(300000),\n  env: z.record(z.string(), z.string()).optional(),\n});\n\n/**\n * Zod schema for InvokeCrewOptions validation\n */\nexport const InvokeCrewOptionsSchema = z.object({\n  package: z\n    .string()\n    .min(1)\n    .regex(\n      /^[a-zA-Z0-9_.-]+$/,\n      'Package name must be alphanumeric and may include hyphens, underscores, or dots'\n    ),\n  crew: z\n    .string()\n    .min(1)\n    .regex(\n      /^[a-zA-Z0-9_.-]+$/,\n      'Crew name must be alphanumeric and may include hyphens, underscores, or dots'\n    ),\n  input: z.string(),\n  timeout: z.number().positive().optional(),\n  env: z.record(z.string(), z.string()).optional(),\n});\n\n/**\n * Validate CrewToolConfig\n */\nexport function validateConfig(config: unknown): CrewToolConfig {\n  return CrewToolConfigSchema.parse(config);\n}\n\n/**\n * Validate InvokeCrewOptions\n */\nexport function validateInvokeOptions(options: unknown): InvokeCrewOptions {\n  return InvokeCrewOptionsSchema.parse(options);\n}\n","/**\n * CI/CD pipeline orchestration module\n *\n * Provides workflows for:\n * - CI resolution: Automated fixing of failing CI/CD pipelines\n * - PR lifecycle: Pull request creation, review, and management\n * - Issue triage: Automated issue analysis and routing\n *\n * Re-exports GitHub, triage, and handoff capabilities for pipeline automation\n */\n\n// Re-export GitHub operations for PR/issue management\nexport { cloneRepo, GitHubClient, isValidGitRef, isValidRepoFormat } from '../github/index.js';\n// Re-export handoff for agent continuity in pipelines\nexport { HandoffManager, type TakeoverOptions } from '../handoff/index.js';\n// Re-export sandbox for isolated execution in CI environments\nexport type { ContainerConfig, ContainerResult, SandboxOptions } from '../sandbox/index.js';\nexport { ContainerManager, SandboxExecutor } from '../sandbox/index.js';\n// Re-export AI triage for code review and analysis\nexport { AIAnalyzer, type AIAnalyzerOptions } from '../triage/index.js';\n","/**\n * Default Role Definitions\n *\n * These are the built-in ecosystem roles that repositories can use out of the box.\n * Each role has a specific purpose and set of capabilities.\n */\n\nimport type { RoleDefinition } from './types.js';\n\n/**\n * Sage - The intelligent advisor\n *\n * Answers questions, decomposes tasks, routes work to appropriate agents,\n * and helps unblock stuck developers/agents.\n */\nexport const SAGE_ROLE: RoleDefinition = {\n  id: 'sage',\n  name: 'Ecosystem Sage',\n  icon: '',\n  description: 'Intelligent advisor for Q&A, task decomposition, and agent routing',\n  systemPrompt: `You are the Ecosystem Sage - an intelligent advisor for software development.\n\nYour role:\n1. Answer technical questions accurately and concisely\n2. Provide code review feedback when asked\n3. Decompose complex tasks into actionable subtasks\n4. Help unblock stuck developers and agents\n5. Route work to the appropriate agent\n\nAgent Capabilities:\n- CURSOR: Best for quick fixes, single-file changes, debugging, CI fixes\n- JULES: Best for multi-file refactors, documentation, complex features\n- HUMAN: Required for product decisions, security reviews, architecture changes\n\nGuidelines:\n- Be concise and actionable\n- Reference specific files when relevant\n- Never hallucinate - if unsure, say so\n- Provide confidence levels honestly\n- Format responses in Markdown`,\n  triggers: [\n    { type: 'comment', pattern: '@sage' },\n    { type: 'comment', pattern: '/sage' },\n    { type: 'manual' },\n  ],\n  capabilities: [\n    'answer_questions',\n    'decompose_tasks',\n    'route_to_agent',\n    'unblock',\n    'post_comment',\n  ],\n  canSpawnAgents: true,\n  canModifyRepo: false,\n  canMerge: false,\n  defaultModel: 'claude-sonnet-4-20250514',\n  temperature: 0.3,\n};\n\n/**\n * Harvester - PR lifecycle manager\n *\n * Monitors PRs, requests reviews, processes feedback, and manages merges.\n */\nexport const HARVESTER_ROLE: RoleDefinition = {\n  id: 'harvester',\n  name: 'Ecosystem Harvester',\n  icon: '',\n  description: 'Monitors PRs, manages reviews, and harvests completed work',\n  systemPrompt: `You are the Ecosystem Harvester - responsible for PR lifecycle management.\n\nYour role:\n1. Monitor open PRs across the ecosystem\n2. Request AI reviews when PRs are ready\n3. Process review feedback and track resolution\n4. Auto-merge PRs when all criteria are met\n5. Escalate blocked PRs for human attention\n\nMerge Criteria:\n- All CI checks passing\n- At least one AI review completed\n- All critical/high feedback addressed\n- No unresolved conflicts\n\nGuidelines:\n- Be systematic and thorough\n- Follow the AI QA Engagement Protocol\n- Document all decisions\n- Never force-merge without proper review`,\n  triggers: [\n    { type: 'schedule', cron: '*/15 * * * *' }, // Every 15 minutes\n    {\n      type: 'event',\n      events: ['pull_request.opened', 'pull_request.synchronize', 'check_run.completed'],\n    },\n    { type: 'manual' },\n  ],\n  capabilities: ['review_pr', 'post_comment', 'merge_pr', 'update_labels', 'assign_users'],\n  canSpawnAgents: false,\n  canModifyRepo: false,\n  canMerge: true,\n  defaultModel: 'claude-sonnet-4-20250514',\n  temperature: 0.1,\n};\n\n/**\n * Curator - Nightly triage and orchestration\n *\n * Scans repositories, triages issues/PRs, and spawns agents for work.\n */\nexport const CURATOR_ROLE: RoleDefinition = {\n  id: 'curator',\n  name: 'Ecosystem Curator',\n  icon: '',\n  description: 'Nightly triage, issue assessment, and agent orchestration',\n  systemPrompt: `You are the Ecosystem Curator - responsible for nightly orchestration.\n\nYour role:\n1. Scan all repositories for open issues and PRs\n2. Triage issues by priority and complexity\n3. Spawn appropriate agents for work:\n   - Jules for complex multi-file tasks\n   - Cursor for quick fixes and CI failures\n4. Process stuck PRs and unblock them\n5. Generate daily ecosystem status reports\n\nTriage Guidelines:\n- Critical: Security issues, production bugs, blocking issues\n- High: Important features, significant bugs\n- Medium: Improvements, non-critical bugs\n- Low: Nice-to-haves, polish items\n\nAgent Selection:\n- Lines changed < 50: Cursor\n- Multiple files: Jules\n- Documentation: Jules\n- CI fixes: Cursor\n- Security: Human review required`,\n  triggers: [\n    { type: 'schedule', cron: '0 2 * * *' }, // 2am UTC daily\n    { type: 'manual' },\n  ],\n  capabilities: [\n    'triage_issue',\n    'review_pr',\n    'spawn_cursor',\n    'spawn_jules',\n    'post_comment',\n    'update_labels',\n    'assign_users',\n  ],\n  canSpawnAgents: true,\n  canModifyRepo: false,\n  canMerge: false,\n  defaultModel: 'claude-sonnet-4-20250514',\n  temperature: 0.2,\n};\n\n/**\n * Reviewer - AI code review\n *\n * Provides thorough code review for PRs.\n */\nexport const REVIEWER_ROLE: RoleDefinition = {\n  id: 'reviewer',\n  name: 'Ecosystem Reviewer',\n  icon: '',\n  description: 'AI-powered code review for pull requests',\n  systemPrompt: `You are the Ecosystem Reviewer - an expert code reviewer.\n\nYour role:\n1. Review code changes for quality, security, and correctness\n2. Identify bugs, security issues, and performance problems\n3. Suggest improvements and best practices\n4. Provide actionable feedback with severity levels\n\nReview Categories:\n-  Critical: Security vulnerabilities, data loss risks, breaking changes\n-  High: Bugs, significant issues\n-  Medium: Code quality, maintainability\n-  Low: Style, minor suggestions\n\nGuidelines:\n- Be constructive and specific\n- Reference line numbers and files\n- Provide code suggestions when helpful\n- Consider the broader context of changes\n- Don't nitpick on style if there's a formatter`,\n  triggers: [\n    { type: 'event', events: ['pull_request.opened', 'pull_request.synchronize'] },\n    { type: 'comment', pattern: '/review' },\n    { type: 'manual' },\n  ],\n  capabilities: ['review_code', 'review_pr', 'post_comment'],\n  canSpawnAgents: false,\n  canModifyRepo: false,\n  canMerge: false,\n  defaultModel: 'claude-sonnet-4-20250514',\n  temperature: 0.2,\n};\n\n/**\n * Fixer - CI failure resolution\n *\n * Automatically fixes CI failures when possible.\n */\nexport const FIXER_ROLE: RoleDefinition = {\n  id: 'fixer',\n  name: 'Ecosystem Fixer',\n  icon: '',\n  description: 'Automatic CI failure resolution',\n  systemPrompt: `You are the Ecosystem Fixer - specialized in resolving CI failures.\n\nYour role:\n1. Analyze CI failure logs\n2. Identify the root cause\n3. Apply fixes when safe to do so\n4. Escalate complex issues to appropriate agents\n\nFixable Issues (auto-fix):\n- Lint errors\n- Formatting issues\n- Type errors (simple)\n- Missing imports\n- Test assertion updates (snapshots)\n- Dependency conflicts (minor versions)\n\nEscalate To Human:\n- Security-related failures\n- Architecture changes needed\n- Breaking API changes\n- Unclear root cause\n\nGuidelines:\n- Always verify fixes don't introduce new issues\n- Run tests locally before pushing\n- Document what was fixed and why\n- If unsure, escalate rather than guess`,\n  triggers: [\n    { type: 'event', events: ['check_run.completed', 'workflow_run.completed'] },\n    { type: 'comment', pattern: '/fix' },\n    { type: 'manual' },\n  ],\n  capabilities: ['fix_ci', 'create_pr', 'post_comment', 'spawn_cursor'],\n  canSpawnAgents: true,\n  canModifyRepo: true,\n  canMerge: false,\n  defaultModel: 'claude-sonnet-4-20250514',\n  temperature: 0.1,\n};\n\n/**\n * Delegator - Issue to agent routing\n *\n * Delegates issues to appropriate AI agents.\n */\nexport const DELEGATOR_ROLE: RoleDefinition = {\n  id: 'delegator',\n  name: 'Ecosystem Delegator',\n  icon: '',\n  description: 'Delegates issues and tasks to AI agents',\n  systemPrompt: `You are the Ecosystem Delegator - responsible for routing work to agents.\n\nYour role:\n1. Analyze issues and determine the best agent\n2. Create clear, actionable instructions for agents\n3. Spawn agents with proper context\n4. Track delegated work\n\nAgent Selection:\n- Cursor: Quick fixes, single files, debugging, CI\n- Jules: Multi-file, refactoring, documentation, features\n\nBefore Delegating:\n- Ensure issue has clear requirements\n- Check for dependencies or blockers\n- Verify the task is appropriate for automation\n- Add labels for tracking\n\nGuidelines:\n- Include relevant context in agent instructions\n- Reference related issues/PRs\n- Set appropriate labels for tracking\n- Update issue with delegation status`,\n  triggers: [\n    { type: 'comment', pattern: '/cursor' },\n    { type: 'comment', pattern: '/jules' },\n    { type: 'comment', pattern: '/delegate' },\n    { type: 'manual' },\n  ],\n  capabilities: ['route_to_agent', 'spawn_cursor', 'spawn_jules', 'post_comment', 'update_labels'],\n  canSpawnAgents: true,\n  canModifyRepo: false,\n  canMerge: false,\n  defaultModel: 'claude-sonnet-4-20250514',\n  temperature: 0.2,\n};\n\n/**\n * All default roles\n */\nexport const DEFAULT_ROLES: Record<string, RoleDefinition> = {\n  sage: SAGE_ROLE,\n  harvester: HARVESTER_ROLE,\n  curator: CURATOR_ROLE,\n  reviewer: REVIEWER_ROLE,\n  fixer: FIXER_ROLE,\n  delegator: DELEGATOR_ROLE,\n};\n\n/**\n * Get a default role by ID\n */\nexport function getDefaultRole(id: string): RoleDefinition | undefined {\n  return DEFAULT_ROLES[id];\n}\n\n/**\n * Get all default role IDs\n */\nexport function getDefaultRoleIds(): string[] {\n  return Object.keys(DEFAULT_ROLES);\n}\n","/**\n * Role Executor\n *\n * Executes roles with the appropriate handlers based on capabilities.\n */\n\nimport { generateText, type LanguageModel } from 'ai';\nimport { Analyzer } from '../triage/analyzer.js';\nimport { DEFAULT_ROLES, getDefaultRole } from './defaults.js';\nimport type {\n  AgentCapability,\n  RoleConfig,\n  RoleDefinition,\n  RoleExecutionContext,\n  RoleExecutionResult,\n  RolesConfig,\n} from './types.js';\n\n/**\n * Merge role config overrides with default role\n */\nexport function applyRoleConfig(role: RoleDefinition, config?: RoleConfig): RoleDefinition {\n  if (!config) return role;\n\n  const merged = { ...role };\n\n  if (config.systemPrompt) {\n    merged.systemPrompt = config.systemPrompt;\n  }\n\n  if (config.triggers) {\n    merged.triggers = config.triggers;\n  }\n\n  if (config.model) {\n    merged.defaultModel = config.model;\n  }\n\n  // Handle capability modifications\n  let capabilities = [...role.capabilities];\n\n  if (config.additionalCapabilities) {\n    capabilities = [...new Set([...capabilities, ...config.additionalCapabilities])];\n  }\n\n  if (config.revokedCapabilities) {\n    capabilities = capabilities.filter((c) => !config.revokedCapabilities?.includes(c));\n  }\n\n  merged.capabilities = capabilities;\n\n  return merged;\n}\n\n/**\n * Get effective role with config applied\n */\nexport function getEffectiveRole(\n  roleId: string,\n  rolesConfig?: RolesConfig\n): RoleDefinition | undefined {\n  const defaultRole = getDefaultRole(roleId);\n\n  if (!defaultRole) {\n    // Check custom roles\n    return rolesConfig?.custom?.[roleId];\n  }\n\n  // Apply config overrides if present\n  const roleConfig = rolesConfig?.[roleId as keyof RolesConfig] as RoleConfig | undefined;\n\n  if (roleConfig?.enabled === false) {\n    return undefined; // Role is disabled\n  }\n\n  return applyRoleConfig(defaultRole, roleConfig);\n}\n\n/**\n * Check if a role has a specific capability\n */\nexport function roleHasCapability(role: RoleDefinition, capability: AgentCapability): boolean {\n  return role.capabilities.includes(capability);\n}\n\n/**\n * Execute a role with the given context\n */\nexport async function executeRole(context: RoleExecutionContext): Promise<RoleExecutionResult> {\n  const { role, model, trigger } = context;\n  const actions: RoleExecutionResult['actions'] = [];\n\n  try {\n    // Build the full prompt with context\n    let userPrompt = `Trigger: ${trigger.type}\\nSource: ${trigger.source}\\n`;\n\n    if (context.repo) {\n      userPrompt += `\\nRepository: ${context.repo.fullName}`;\n    }\n\n    if (context.issueContext) {\n      userPrompt += `\\n\\nIssue #${context.issueContext.number}: ${context.issueContext.title}`;\n      userPrompt += `\\nAuthor: ${context.issueContext.author}`;\n      userPrompt += `\\nLabels: ${context.issueContext.labels.join(', ') || 'none'}`;\n      userPrompt += `\\n\\n${context.issueContext.body}`;\n    }\n\n    if (context.fileContext?.diff) {\n      userPrompt += `\\n\\nDiff:\\n\\`\\`\\`\\n${context.fileContext.diff.slice(0, 10000)}\\n\\`\\`\\``;\n    }\n\n    // Generate response using the role's system prompt\n    const { text } = await generateText({\n      model,\n      system: role.systemPrompt,\n      prompt: userPrompt,\n      maxOutputTokens: role.maxTokens ?? 4096,\n      temperature: role.temperature ?? 0.3,\n    });\n\n    actions.push({\n      type: 'generate_response',\n      description: 'Generated AI response',\n      result: 'success',\n    });\n\n    return {\n      success: true,\n      response: text,\n      actions,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : String(error),\n      actions,\n    };\n  }\n}\n\n/**\n * Execute Sage role specifically\n *\n * Uses the triage package's Sage handlers for structured output\n */\nexport async function executeSageRole(\n  query: string,\n  model: LanguageModel,\n  context?: Partial<RoleExecutionContext>\n): Promise<RoleExecutionResult> {\n  const role = getDefaultRole('sage');\n  if (!role) {\n    return { success: false, error: 'Sage role not found' };\n  }\n\n  try {\n    // Use Analyzer for quickTriage as a bridge until Sage is in triage package\n    const analyzer = new Analyzer();\n\n    // Build context string\n    let contextStr = query;\n    if (context?.issueContext) {\n      contextStr = `Issue #${context.issueContext.number}: ${context.issueContext.title}\\n\\n${context.issueContext.body}\\n\\nQuery: ${query}`;\n    }\n\n    const triage = await analyzer.quickTriage(contextStr);\n\n    const response = `**Priority**: ${triage.priority} | **Category**: ${triage.category}\n\n${triage.summary}\n\n**Suggested Action**: ${triage.suggestedAction}\n\n*(Confidence: ${Math.round(triage.confidence * 100)}%)*`;\n\n    return {\n      success: true,\n      response,\n      data: triage as unknown as Record<string, unknown>,\n      actions: [\n        { type: 'quick_triage', description: 'Performed quick triage analysis', result: 'success' },\n      ],\n    };\n  } catch (_error) {\n    // Fallback to simple text generation\n    const { text } = await generateText({\n      model,\n      system: role.systemPrompt,\n      prompt: query,\n      temperature: role.temperature ?? 0.3,\n    });\n\n    return {\n      success: true,\n      response: text,\n      actions: [\n        {\n          type: 'fallback_generation',\n          description: 'Used fallback text generation',\n          result: 'success',\n        },\n      ],\n    };\n  }\n}\n\n/**\n * List all available roles (default + custom)\n */\nexport function listRoles(rolesConfig?: RolesConfig): RoleDefinition[] {\n  const roles: RoleDefinition[] = [];\n\n  // Add enabled default roles\n  for (const [id, role] of Object.entries(DEFAULT_ROLES)) {\n    const config = rolesConfig?.[id as keyof RolesConfig] as RoleConfig | undefined;\n    if (config?.enabled !== false) {\n      roles.push(applyRoleConfig(role, config));\n    }\n  }\n\n  // Add custom roles\n  if (rolesConfig?.custom) {\n    for (const role of Object.values(rolesConfig.custom)) {\n      roles.push(role);\n    }\n  }\n\n  return roles;\n}\n\n/**\n * Find a role by trigger pattern\n */\nexport function findRoleByTrigger(\n  pattern: string,\n  rolesConfig?: RolesConfig\n): RoleDefinition | undefined {\n  const normalizedPattern = pattern.toLowerCase().trim();\n\n  for (const role of listRoles(rolesConfig)) {\n    for (const trigger of role.triggers) {\n      if (trigger.type === 'comment') {\n        if (normalizedPattern.startsWith(trigger.pattern.toLowerCase())) {\n          return role;\n        }\n      }\n    }\n  }\n\n  return undefined;\n}\n","/**\n * @agentic-dev-library/control\n *\n * Orchestration layer for AI agent fleet management consuming @agentic/triage primitives.\n *\n * Features:\n * - Multi-agent orchestration (Ollama/Jules/Cursor routing)\n * - CI resolution and PR lifecycle pipelines\n * - GitHub Marketplace actions integration\n * - Intelligent token switching (auto-selects org-appropriate tokens)\n * - Fleet management (spawn, monitor, coordinate agents)\n * - AI-powered triage (conversation analysis, code review)\n * - Station-to-station handoff (agent continuity)\n * - Token-aware GitHub operations\n *\n * @packageDocumentation\n */\n\n// GitHub Actions integration\nexport * from './actions/index.js';\n\n// Core exports (maintaining existing API surface)\nexport * from './core/index.js';\n\n// Crew tool (agentic-crew CLI integration)\nexport * from './crews/index.js';\n\n// Fleet management\nexport {\n  type CoordinationConfig,\n  CursorAPI,\n  type CursorAPIOptions,\n  Fleet,\n  type FleetConfig,\n} from './fleet/index.js';\n// GitHub operations\nexport { cloneRepo, GitHubClient, isValidGitRef, isValidRepoFormat } from './github/index.js';\n// Handoff protocols\nexport { HandoffManager, type TakeoverOptions } from './handoff/index.js';\n// Orchestration layer - Multi-agent routing\nexport * from './orchestrators/index.js';\n// Pipeline automation - CI resolution, PR lifecycle\nexport * from './pipelines/index.js';\n// Roles - Configurable AI agent personas\nexport * from './roles/index.js';\n// Sandbox execution\nexport type { ContainerConfig, ContainerResult, SandboxOptions } from './sandbox/index.js';\nexport { ContainerManager, SandboxExecutor } from './sandbox/index.js';\n// AI Triage\nexport { AIAnalyzer, type AIAnalyzerOptions } from './triage/index.js';\n\n// Version - read from package.json at runtime\nimport { createRequire } from 'node:module';\n\nconst require = createRequire(import.meta.url);\nconst pkg = require('../package.json') as { version: string };\nexport const VERSION = pkg.version;\n"]}